"use strict";var RcWareVisionUserLoginGlob,esgAngularDependencies=["ngRoute","angularCombine","resizeWindowService","ui.bootstrap","I18nService","AngularJSTabbedGraph"];angular.module("RcWareVisionUnitTest",esgAngularDependencies),angular.module("WSFrontEnd2",esgAngularDependencies).run(["$route","$rootScope","$location","ESGVisionConfig","WebpanelData",function(i,r,o,e,t){var l=o.path;o.path=function(e,t){if(!1===t)var a=i.current,n=r.$on("$locationChangeSuccess",function(){i.current=a,n()});return l.apply(o,[e])},t.panelSizeMode=e.DefaultPanelSize,document.title=e.AppTitle,console.log("version: "+e.AppVersion)}]).config(["$routeProvider","$locationProvider","$httpProvider","$compileProvider","angularCombineConfigProvider","$qProvider",function(e,t,a,n,i,r){t.hashPrefix(""),i.addConf(/^html\/templates\//,"html/desktop.html"),e.when("/panel/:id",{controller:PanelCtrl,templateUrl:"html/templates/PanelCtrl.html",reloadOnSearch:!1}).otherwise({controller:PanelCtrl,reloadOnSearch:!1,templateUrl:"html/templates/PanelCtrl.html"})}]);var PanelCtrl=["$scope","$log","$location","$routeParams","$rootScope","$compile","$timeout","RcWareVisionAPI","WebpanelData","ESGVisionConfig","ApiWinResize","EsgLoginUserModal","WebpanelActualUser","I18nService","keyDetection","ModelHmiUser","EsgColor",function(s,e,n,t,a,u,o,r,c,d,i,l,p,g,h,f,m){s.$location=n,s.logView=!1,s.graphView=!1,s.panelView=!0,s.WebpanelData=c,s.ESGVisionConfig=d,s.viewsDefinition=["panel","graph","log","text","alarms","systemConfig"],s.activeViewClass="",s.$watch("WebpanelData.activeView",function(t){s.activeViewClass=t,angular.forEach(s.viewsDefinition,function(e){s[e+"View"]=e==t}),"panel"==t&&(s.activeViewClass+=" "+s.panelType,o(s.setPanelSize,10))}),s.clearPanelPage=function(){s.actualPanel=c.actualPanel=null,s.actualPanelId=null;var e=$(document).find(".panels");$(e).html("")},s.setUserPanels=function(){c.panels={},c.activeView="panel",null!=p.user?r.GetConnectionDefinition(c.webpanelDef.handlers.variables).success(function(e){c.connectionDefinition=e,r.GetPanels(c.webpanelDef.handlers.schemas).success(function(e){null==e?(c.pages=[],s.webpanelDef.pagesMap={}):(c.pages=e.s,s.webpanelDef.pagesMap=e.map),s.setPanelFromUrl()}).error(function(){})}):s.clearPanelPage()},c.setUserPanels=s.setUserPanels,s.setPanelFromUrl=function(){var e=null,t=n.$$path.split("/")[2],a=$(document).find(".panels");if($(a).html(""),0<c.pages.length&&null!=s.webpanelDef){if(null==t&&(t=c.pages[0].id),null==s.webpanelDef.pagesMap[t])return void n.path("/panel/"+c.pages[0].id,!1);e=s.webpanelDef.pagesMap[t];document.title=d.AppTitle+" - "+e,s.setPanel(t)}else s.clearPanelPage(),c.features.graph=!1},s.$watch("$location.$$path",function(e){null!=c.pages&&0<c.pages.length&&s.setPanelFromUrl()}),s.actualPanel=null,s.WebpanelData=c,s.webpanelDef,r.GetWebpanelDefinition().success(function(e){c.webpanelDef=s.webpanelDef=e,null!=e.culture&&g.switchLanguage(e.culture);var t=e.defaultUser,a="",n=window.location.search,i=new URLSearchParams(n);null!=i.get("u")&&(t=i.get("u")),null!=i.get("p")&&(a=i.get("p")),null==e.defaultUser?(c.defaultUserAutoLogin=!1,l.open({ModelUserGroups:c.ModelUserGroups,defaultUserName:"",backdrop:"static"}).success(function(e){null!=e&&s.setUserPanels()})):r.Login(t,c.hashPassword(t,a)).success(function(){c.defaultUserAutoLogin=!0;var e=new f({name:t,password:c.hashPassword(t,a),isDefault:!0});p.setUser(e),s.setUserPanels()}).error(function(){c.defaultUserAutoLogin=!1,l.open({ModelUserGroups:c.ModelUserGroups,defaultUserName:t,backdrop:"static"}).success(function(e){p.setUser(e),null!=e&&s.setUserPanels()})})}),s.setPanel=function(l){c.startGetValuesLoop(),c.preparePanel(l).success(function(e){var t=e.data;s.panelType=e.type,s.activeViewClass=s.WebpanelData.activeView+" "+s.panelType;var a=$(document).find(".panels");if(s.actualPanel=t,$(a).html(""),"text"==e.type){var n=angular.element("<table><tbody></tbody></table>");$(a).append(n),angular.forEach(e.data,function(e){var t=s.$new();t.gadget=e;var a=angular.element(e.getTemplate());u(a)(t,function(e,t){$(n[0].children[0]).append(e),s.actualPanelId=l})})}else{var i=s.$new();i.gadget=t;var r=angular.element(t.getTemplate()),o=d.DefaultSchemaBackround;angular.forEach(t.metadataArray,function(e,t){if("viewer.background.color"==t){var a=new m(e);o=a.toRGBA()}});u(r)(i,function(e,t){$(a).append(e),d.SetBackroundWholePage?a.css("background-color",o):e.css("background-color",o),s.setPanelSize(),s.actualPanelId=l})}})},s.ratio=1,s.ApiWinResize=i,s.$watch("ApiWinResize.size.ratio",function(e,t){null!=s.actualPanel&&1==s.panelView&&s.setPanelSize()}),s.$watch("ApiWinResize.size.width",function(e,t){null!=s.actualPanel&&1==s.panelView&&s.setPanelSize()}),s.$watch("WebpanelData.panelSizeMode",function(){s.setPanelSize()}),s.setPanelSize=function(){if(null!=s.actualPanel&&"text"!=s.panelType){switch(c.panelSizeMode){case 1:var e=i.getHeight()-d.SchemaTopLineHeight,t=e/s.actualPanel.height,a=i.getWidth()-d.SchemaBorderSize;t=e/s.actualPanel.height;a<s.actualPanel.width*t&&(t=a/s.actualPanel.width);break;case 2:var n=0;i.isThereScrollBar("vertical")&&(n=i.getScrollBarWidth());t=(a=i.getWidth()-d.SchemaBorderSize-n)/s.actualPanel.width;break;default:t=1}s.ratio=t}},c.addPopUpGadgets=function(r){s.$apply(function(){var t=r.gadget,i=$(document).find(".webpanel-mainpage .panels"),e=s.$new(),a=angular.element(t.getTemplate());e.gadget=t,e.gadget.left=r.x,e.gadget.top=r.y,e.gadget.panelId=s.actualPanelId;u(a)(e,function(a,e){var n=i[0].childNodes[0].childNodes[0];$(n).append(a),r.closeBinding=function(e){var t=function(e){return e!=n&&(e==a||t(e.parentElement))};t(e.target)},r.removeBinding=function(){$(n).unbind("click",r.closeBinding)},o(function(){$(n).bind("click",r.closeBinding)},0),r.addedElement=a,r.setCloseActions(t,a)})})},h.registerDetectionKey(),h.scope=s}];esgAngularDependencies.push("RcWareVisionAppConfig"),angular.module("RcWareVisionAppConfig",[]).service("ESGVisionConfig",function(){return{AppVersion:"Mervis v.2022.08.24",AppCopyright:"Energocentrum Plus, s.r.o.",ApiFilesPrefix:"",ApiPrefix:"",GetValuesInterval:1e3,AppLogoSmall:"./img/Mervis_WEBPANEL_Color.svg",AppTitle:"Mervis Web Panel",ShowGraphView:!0,ShowAlarmsView:!0,ShowSystemConfigView:!0,SchemaTopLineHeight:56,SchemaBorderSize:24,AddDefaultFont:!0,DefaultSchemaBackround:"#000000FF",SetBackroundWholePage:!1,TpgEveryYearIsLeap:!0,DefaultFontFamily:{Roboto:"sans-serif","Open Sans":"sans-serif",Lora:"serif",Inconsolata:"monospace","Roboto Mono":"monospace","Roboto Slab":"serif","Slabo 27px":"serif",Ubuntu:"sans-serif","Ubuntu Mono":"monospace"},DefaultPanelSize:1,SchemaRootClass:"panels",DisableNetworkSettings:!1}}),esgAngularDependencies.push("RcWareVisionServices"),angular.module("RcWareVisionServices",[]).service("WebpanelData",["$log","$injector","$filter","$timeout","$rootScope","$compile","RcWareVisionAPI","ESGXmlHelper","ESGPromise","ESGVisionConfig","WebpanelVariableType","WebpanelVariable",function(p,g,h,a,e,t,f,m,n,i,r,o){var l={actualPanelId:null,actualPanel:null,panels:{},getValuesLoopRunning:!1,panelSizeMode:i.DefaultPanelSize,activeView:"panel",selectedVariables:[],features:{},capabilities:{alarmHistory:!0},getPanelById:function(t){var a;return angular.forEach(l.pages,function(e){e.id==t&&(a=e)}),a},preparePanel:function(d){var o=n.defer(),e=o.promise;return f.GetPanelDefinition(d,l.webpanelDef.handlers.schemas).success(function(e){if(l.actualPanelId=d,l.actualPanel=l.getPanelById(d),null!=e){var s=e.xmlDoc;if(null==l.panels[l.actualPanelId]&&(l.panels[l.actualPanelId]={gadgets:[],gadgetsMap:{}}),"text"==e.type){var t=m.getXPathResult(s,"hmi:lcdMenu/lcd:menu/lcd:*",f.nsResolver,s),u=[],c=function(e,o,l){angular.forEach(e,function(t){var e=t.tagName.split(":"),a=e[e.length-1];try{var n=g.get("ESG"+a)}catch(e){p.log("missing factory: "+t.tagName)}if(null!=n){var i=new n({node:t,nsResolver:f.nsResolver,xmlDoc:s,panelId:d},g);i.depth=o,i.parentElement=l,i.expanded=!1,i.isVisibleFce=function(){for(var e=i.parentElement;null!=e;){if(0==e.expanded||!1===e.unlocked)return!1;e=e.parentElement}return!0},u.push(i);var r=m.getXPathResult(t,"lcd:subItems/lcd:*",f.nsResolver,s);0<r.length?(c(r,o+1,i),i.hasChilds=!0):i.hasChilds=!1}})};c(t,1,null),l.getValue(!0),o.resolve({data:u,type:"text"})}else{var a=m.getXPathResultSingleNode(s,"/hmi:page",f.nsResolver,s),n=m.getXPathResultSingleNode(a,"hmi:content/hmi:canvas",f.nsResolver,s);try{var i=g.get("ESG"+n.tagName)}catch(e){p.log("missing factory: "+n.tagName),p.log(e)}if(null!=i)try{var r=new i({node:n,nsResolver:f.nsResolver,xmlDoc:s,parentType:"canvas",panelId:d},g);l.getValue(!0),o.resolve({data:r,type:"graphic"})}catch(e){p.log("error in schema: "+d),p.log(e),o.reject()}}}else o.reject()}),e},parseGadget:function(t,e,a,n,i){try{var r=g.get("ESG"+t.tagName)}catch(e){p.log("missing factory: "+t.tagName),p.log(e)}if(null!=r)try{return new r({node:t,nsResolver:f.nsResolver,xmlDoc:e,parentType:a,panelId:n,additionalData:i},g)}catch(e){return p.log("error in schema: "+n),p.log(e),null}},registerGadgetDp:function(e){if(null==l.panels[l.actualPanelId].gadgetsMap[e]){var t={value:null,varRef:e};l.panels[l.actualPanelId].gadgets.push(t),l.panels[l.actualPanelId].gadgetsMap[e]=t;var a=e.replace("varRef://","").split("/");try{var n=l.connectionDefinition.connections[a[0]].variables[a[1]]}catch(e){}null!=n&&(t.variableDef=n)}},selectVariable:function(t){var a=[];-1==l.selectedVariables.indexOf(t)?(angular.forEach(l.selectedVariables,function(e){a.push(e)}),a.push(t)):angular.forEach(l.selectedVariables,function(e){t!=e&&a.push(e)}),l.selectedVariables=a},startGetValuesLoop:function(){0==l.getValuesLoopRunning&&(l.getValue(),l.getValuesLoopRunning=!0)},getValue:function(t){if(null!=l.actualPanelId&&null!=l.panels[l.actualPanelId])if(0<l.panels[l.actualPanelId].gadgets.length)if("panel"==l.activeView||t)try{f.GetValues(l.panels[l.actualPanelId].gadgets).success(function(){1!=t&&a(l.getValue,i.GetValuesInterval)}).error(function(){1!=t&&a(l.getValue,i.GetValuesInterval)})}catch(e){console.log("getValues error"),console.log(e),1!=t&&a(l.getValue,i.GetValuesInterval)}else a(l.getValue,i.GetValuesInterval);else 1!=t&&a(l.getValue,i.GetValuesInterval);else 1!=t&&a(l.getValue,i.GetValuesInterval)}};return l.typeNumToId=r.typeNumToId,l.prepareTpgValue=function(a,e,t){var n=function(e,t,a){switch(a){case"t17_boolean_scheduler":return t==e;case"t18_real_scheduler":case"t19_int_scheduler":return 0==t.cmp(e);default:return!1}},i=[],r=[],o="",l=null;switch(a){case"t17_boolean_scheduler":l=!1,10,224;break;case"t18_real_scheduler":l=null,o=new Big(0),12,392;break;case"t19_int_scheduler":l=new Big(0),o=new Big(0),10,240}var s=!1;if(angular.forEach(h("orderBy")(e,"timeMinutes"),function(e,t){void 0!==d&&d.timeMinutes==e.timeMinutes&&d.value!=e.value&&(s=!0),n(o,e.value,a)&&0!=t||(i.push(e),o=e.value,d=e)}),s)alert("Regular TPG error");else{for(var u=i.length;u<42;u++)i.push(new TpgItemValue({timeMinutes:65535,value:l}));var c=!1,d="";o="",angular.forEach(h("orderBy")(h("orderBy")(t,"timeMinutesFrom",!1),"timeYearFrom",!1),function(e,t){0==t?(r.push(e),d=e):e.timeYearFrom<d.timeYearTo||e.timeYearFrom==d.timeYearTo&&e.timeMinutesFrom<d.timeMinutesTo?n(d.value,e.value,a)?e.timeYearTo<d.timeYearTo||e.timeYearTo==d.timeYearTo&&e.timeMinutesTo<d.timeMinutesTo||(r[r.length-1].timeYearTo=e.timeYearTo,r[r.length-1].timeMinutesTo=e.timeMinutesTo,d=r[r.length-1].timeYearStart):c=!0:(r.push(e),d=e)});for(u=r.length;u<10;u++)r.push(new TpgExceptionValue({timeMinutesFrom:0,timeYearFrom:2e3,timeMinutesTo:0,timeYearTo:2e3,value:l}));if(!c)return{regular:i,exceptions:r};alert("Exception TPG error")}},l.writeVariablePermission=function(e){var t=e.replace("varRef://","").split("/");try{var a=l.connectionDefinition.connections[t[0]].variables[t[1]]}catch(e){return!1}return null==a?(console.log("Missing variable: "+t[1]),!1):0==a.uId&&0==a.offset&&0==a.length?!!l.features.writeRtc:"rw"==a.rights},l.formatValue=function(e,t,a){if(null==e)return"";if("function"==typeof e.getTime)return h("dateFormatC")(e,t,"rtc"!=a);var n;if(19==a){if(null!=t)null!=(i=t.match(/%(.*)f/))&&(t=t.replace(i[0],"%s"));n=e}else if("boolean"==typeof e){if(null!=t){var i=t.match(/%(.*)f/);t=t.replace(i[0],"%s")}n=e}else n="function"==typeof e.toString?parseFloat(e.toString()):e;if(null==t||""==t)return n;try{return sprintf(t,n)}catch(e){console.log("Format value error: "+t)}},l.hashPassword=function(e,t){var a=(null==i.PassPrefix?"st17km8vfu":i.PassPrefix)+t+""+e.toLowerCase()+"hmiuser";return SparkMD5.hash(a)},l.prepareImgSrc=function(e){return(""!=i.ApiFilesPrefix?i.ApiFilesPrefix+"/":"")+e},l.getValueWatchQuery=function(e){return{gadgetValueObj:e,query:"gadgetValueObj.value"}},l.getValueHandleEvalValue=function(e,t,a){return null!=t?t:null!=e.value?e.value.value:void 0},l.valueIncrement=function(e,t,a,n,i){var r=new Big(a.value.value);return 0<(r=r.plus(t)).cmp(e)&&(r=new Big(e)),r},l.valueDecrement=function(e,t,a,n,i){var r=new Big(a.value.value);return(r=r.minus(t)).cmp(e)<0&&(r=new Big(e)),r},l.sendValue=function(e,t,a,n){var i=new o({variableId:e,sourceType:l.typeNumToId(parseInt(a.variableDef.type))});i.setValueFromUserHash({ts:(new Date).getTime(),value:t});var r=i.getHexEncodedValue();null!=n?n.confirmAction().success(function(){f.SendCommand([{varRef:e,value:r,gadget:a,newValue:i}])}):f.SendCommand([{varRef:e,value:r,gadget:a,newValue:i}])},l.sendAlarmValue=function(e,t,a,n){var i=[];i.push({i:"svc://"+a.variableDef.connection.name+"/"+a.variableDef.uId+"["+a.variableDef.offset+"]",set:t}),null!=n?n.confirmAction().success(function(){f.AlarmCommand(i)}):f.AlarmCommand(i)},l.getVariableName=function(e){return e.variableDef.name},l.getInitDefObject=function(e,t){var a={name:l.getVariableName(e),title:t.title,value:l.getValueHandleEvalValue(e,null,!0),valueType:t.valueType,valueRange:{}};return null!=t.minValue&&(a.valueRange.min={value:t.minValue}),null!=t.maxValue&&(a.valueRange.max={value:t.maxValue}),null!=t.step&&(a.valueStep=t.step),a},l}]).service("WebpanelVariableType",[function(){var e={typeNumToId:function(e){switch(e){case 0:return"bool";case 1:return"sint";case 2:return"int";case 3:return"dint";case 4:return"lint";case 5:return"usint";case 6:return"uint";case 7:return"udint";case 8:return"ulint";case 9:return"byte";case 10:return"word";case 11:return"dword";case 12:return"lword";case 13:return"real";case 14:return"lreal";case 15:return"time";case 16:return"date";case 17:return"tod";case 18:return"dt";case 19:return"string";case 21:return"ldate";case 20:return"ltime";case 23:return"ldt";case 22:return"ltod";case 1e6:default:return"undefined"}}};return e}]).service("WebpanelActualUser",[function(){var t={user:null,setUser:function(e){t.user=e},logout:function(){t.user=null}};return t}]).factory("WebpanelGadget",["$log","ESGXmlHelper","EsgColor","RcWareVisionAPI","$injector",function(c,d,p,g,h){var e=function(n){if(this.width=null,this.height=null,this.left=null,this.top=null,this.backgroundColor=null,this.panelId=n.panelId,this.countBorderResolution=!0,null!=n.node){var e=d.getAttributeNS(n.node,"","width"),t=d.getAttributeNS(n.node,"","height");""==e||(this.width=parseFloat(e)),""==t||(this.height=parseFloat(t));var a=d.getXPathResult(n.node,"hmi:metadata/hmi:*",n.nsResolver,n.xmlDoc);null!=a&&(this.metadataArray={},angular.forEach(a,function(e){var t=d.getAttributeNS(e,"","key"),a=d.getAttributeNS(e,"","value");this.metadataArray[t]=a},this),this.left=parseInt(this.metadataArray["canvas.x"]),this.top=parseInt(this.metadataArray["canvas.y"]));var i=d.getAttributeNS(n.node,"","fill");if(""!=i){var r=new p(i);this.backGroundColorObject=r,this.backgroundColor="rgba("+r.r+","+r.g+","+r.b+","+r.a/256+")"}if("layoutPanel"==n.parentType)var o=d.getAttributeNS(n.node,"","horizontalAlignment"),l=d.getAttributeNS(n.node,"","verticalAlignment");if(null!=o&&""!=o)switch((this.horizontalAlignment=o).toLowerCase()){case"stretch":this.width="100%";break;case"left":this.absoluteLeft=0;break;case"right":this.absoluteRight=0;break;case"center":this.absoluteLeft="50%"}if(null!=l&&""!=l)switch((this.verticalAlignment=l).toLowerCase()){case"stretch":this.height="100%";break;case"top":this.absoluteTop="100%";break;case"bottom":this.absoluteBottom=0;break;case"center":this.absoluteTop="50%"}}var s=d.getXPathResult(n.node,"hmi:actions/hmi:*",n.nsResolver,n.xmlDoc);this.actions=[],null!=s&&angular.forEach(s,function(t){try{var e=h.get(t.tagName)}catch(e){c.log("missing action: "+t.tagName)}if(null!=e){var a=new e({node:t,nsResolver:g.nsResolver,xmlDoc:n.xmlDoc,panelId:n.panelId,additionalData:n.additionalData,gadget:this},h);this.actions.push(a)}},this);var u=d.getXPathResult(n.node,"hmi:evaluators/hmi:*",n.nsResolver,n.xmlDoc);this.evaluators=[],null!=u&&angular.forEach(u,function(t){try{var e=h.get(t.tagName)}catch(e){c.log("missing evaluator: "+t.tagName)}if(null!=e){var a=new e({node:t,nsResolver:g.nsResolver,xmlDoc:n.xmlDoc},h);this.evaluators.push(a)}},this)};return e.prototype.getVariables=function(){var a={};return angular.forEach(this.evaluators,function(e){null!=e.varRef&&(a[e.varRef]=e.varRef)}),angular.forEach(this.actions,function(e){null!=e.varRef&&(a[e.varRef]=e.varRef)}),angular.forEach(this.innerGadgets,function(e){if(null!=e.getVariables){var t=e.getVariables();angular.forEach(t,function(e){a[e]=e})}}),angular.forEach(this.states,function(e){if(null!=e.content[0]&&null!=e.content[0].getVariables){var t=e.content[0].getVariables();angular.forEach(t,function(e){a[e]=e})}}),a},e}]).directive("esgStyle",["$log",function(e){return{link:function(a,n,e,t){a.updateStylesFce=function(e,a){void 0!==e&&angular.forEach(e,function(e,t){a.css(t,e)})},a.$watch(e.esgStyle,function(e,t){a.updateStylesFce(e,n)})}}}]).service("schemaElementStyle",["$log",function(e){var t={prepareStyle:function(e,t,a){if(void 0===e)return{};var n={height:e.height,width:e.width,"background-color":e.backgroundColor,"margin-left":e.left,"margin-top":e.top};return null!=e.absoluteRight&&(n.right=e.absoluteRight),null!=e.absoluteLeft&&(n.left=e.absoluteLeft),null!=e.absoluteTop&&(n.top=e.absoluteTop),null!=e.absoluteBottom&&(n.bottom=e.absoluteBottom),null!=e.horizontalAlignment&&"center"==e.horizontalAlignment.toLowerCase()&&(n.transform="translateX(-50%)"),null!=e.verticalAlignment&&"center"==e.verticalAlignment.toLowerCase()&&(n.transform=(null!=n.transform?n.transform+" ":"")+"translateY(-50%)"),null!=e["border-radius"]&&(n["border-radius"]=e["border-radius"]),void 0!==e.font&&(n["font-family"]=e.font["font-type"],n.color=e.font.color,n["font-size"]=e.font["font-size"],n["line-height"]=e.font["line-height"],n["line-height"]>e.height&&(n["line-height"]=e.height),n["z-index"]=e.layer+100,angular.forEach(e.font["font-style"].split(", "),function(e){switch(e){case"Regular":n["font-style"]="normal";break;case"Bold":n["font-weight"]="bold";break;case"Italic":n["font-style"]="italic"}})),void 0!==t&&null!=t&&angular.forEach(t,function(e,t){n[t]=e}),n}};return t}]).directive("schemaElementResize",["ApiWinResize",function(r){return{link:function(n,e,t,a){n.ApiWinResize=r,n.defaultStyle=r.registerStyleElements(n.style),n.$watch("ratio",function(e,t){r.recountStyles(n.defaultSize,n.style);var a=i(n.style,n.defaultStyle,e,n);n.style=$.extend(!0,{},n.style,a)},!0);var i=function(e,n,t,i){if(void 0!==e&&void 0!==t){var r=/^[-0-9]+([,.][0-9]+)?$/,o={};return angular.forEach(n,function(e,t){if(r.test(e)){var a=e*i.ratio;("font-size"==t||"line-height"==t)&&"line-height"==t&&Math.floor(a)>(n.height-4)*i.ratio&&(a=Math.floor((n.height-4)*i.ratio)),o[t]=Math.floor(a)+"px"}}),i.gadget.countBorderResolution&&(void 0===i.gadget.borderStyle||"vision1lowered"!=i.gadget.borderStyle.toLowerCase()&&"vision1raised"!=i.gadget.borderStyle.toLowerCase()||(o.height=Math.floor(n.height*i.ratio)+4,o.width=Math.floor(n.width*i.ratio)+4,o["margin-left"]=Math.floor(n["margin-left"]*i.ratio)-2,o["margin-top"]=Math.floor(n["margin-top"]*i.ratio)-2),void 0===i.gadget.borderStyle||"vision1flatlowered"!=i.gadget.borderStyle.toLowerCase()&&"vision1flatraised"!=i.gadget.borderStyle.toLowerCase()||(o.height=Math.floor(n.height*i.ratio)+2,o.width=Math.floor(n.width*i.ratio)+2,o["margin-left"]=Math.floor(n["margin-left"]*i.ratio)-1,o["margin-top"]=Math.floor(n["margin-top"]*i.ratio)-1),void 0!==i.gadget.borderStyle&&"vision1simple"==i.gadget.borderStyle.toLowerCase()&&(o["margin-left"]=Math.floor(n["margin-left"]*i.ratio)-1,o["margin-top"]=Math.floor(n["margin-top"]*i.ratio)-1)),o}}}}}]).directive("hadleActionClick",["$log","WebpanelData","WebpanelActualUser",function(e,l,t){return{link:function(i,r,e,t){var o=!0;i.$watch("gadget.actions.length",function(e,t){i.handleElementActions()}),i.handleElementActions=function(){if(0<i.gadget.actions.length){var t=!1,a=(l.getPanelById(i.gadget.panelId),[]);if(angular.forEach(i.gadget.actions,function(e){if(null!=e.varRef&&0==l.writeVariablePermission(e.varRef))return $(r).addClass("unclickable"),void(o=!1);switch(t=!0,e.event){case"onLeftDown":null!=e.onLeftDown&&a.push(e)}}),0<a.length&&r.bind("click",function(e){e.ctrlKey||angular.forEach(a,function(e){e.onLeftDown(i.gadget)})}),0==t)return;o&&($(r).addClass("clickable"),o=!1);var n=function(){$(r).removeClass("active"),$(document).unbind("mouseup",n)};r.bind("mousedown",function(e){$(r).addClass("active"),$(document).bind("mouseup",n)})}}}}}]).directive("hadleValueState",["$log","WebpanelData","WebpanelActualUser",function(e,t,a){return{link:function(a,t,e,n){var i=!1;if(null!=a.gadgetValueObj){var r=angular.element('<div class="value-error-element"></div>');a.$watch("gadgetValueObj.value",function(e,t){o(e)}),a.$watch("gadgetValueObj.value.quality",function(e,t){o(a.gadgetValueObj.value)});var o=function(e){null==e||"error"==e.quality?0==i?($(t).append(r),l(a.ratio),i=!0,r.addClass("error")):r.hasClass("writing")&&(r.removeClass("writing"),r.addClass("error")):"writing"==e.quality?0==i&&($(t).append(r),l(a.ratio),i=!0,r.addClass("writing")):i&&(r.removeClass("writing"),r.removeClass("error"),$(r).remove(),i=!1)};a.$watch("ratio",function(e,t){null!=e&&i&&l(e)});var l=function(e){var t=Math.round(3*e);$(r).css("width",t),$(r).css("height",t)}}}}}]).directive("hadleValueStateElm",["$log","WebpanelData","WebpanelActualUser",function(e,t,a){return{transclude:!1,template:'<div class="value-error-element"></div>',replace:!0,restrict:"E",scope:{gadgetValueObj:"="},link:function(a,t,e,n){var i=!1;if(null!=a.gadgetValueObj){var r=t;a.$watch("gadgetValueObj.value",function(e,t){o(e)}),a.$watch("gadgetValueObj.value.quality",function(e,t){o(a.gadgetValueObj.value)});var o=function(e){null==e||"error"==e.quality?0==i?($(t).append(r),l(a.ratio),i=!0,r.addClass("error")):r.hasClass("writing")&&(r.removeClass("writing"),r.addClass("error")):"writing"==e.quality?0==i&&($(t).append(r),l(a.ratio),i=!0,r.addClass("writing")):i&&($(r).remove(),i=!1)};a.$watch("ratio",function(e,t){null!=e&&i&&l(e)});var l=function(e){var t=Math.round(3*e);$(r).css("width",t),$(r).css("height",t)}}return["$scope","iElement","iAttrs","contoller",function(e,t,a,n){}]},controller:["$scope",function(e){}]}}]).directive("handleEvalValue",["$log","$filter","WebpanelData",function(e,t,l){return{link:function(i,e,t,a){if(0<i.gadget.evaluators.length){var r=i.gadget.evaluators[0],o=l.panels[l.actualPanelId].gadgetsMap[r.varRef];if(null!=o){var n=l.getValueWatchQuery(o);i.gadgetValueObj=n.gadgetValueObj,i.$watch(n.query,function(e,t){var a=l.getValueHandleEvalValue(o,e);if(null!=a){if(null!=i.gadgetValueObj.variableDef){var n=i.gadgetValueObj.variableDef.type;0==i.gadgetValueObj.variableDef.uId&&0==i.gadgetValueObj.variableDef.offset&&0==i.gadgetValueObj.variableDef.length&&(n="rtc")}i.textValue=l.formatValue(a.value,r.format,n)}})}}}}}]).directive("handleEvalPropertyValue",["$log","$filter","WebpanelData",function($log,$filter,WebpanelData){return{link:function link(scope,element,attrs,transclude){if(0<scope.gadget.evaluators.length){var evaluator=scope.gadget.evaluators[0],gadgetValueObj=WebpanelData.panels[WebpanelData.actualPanelId].gadgetsMap[evaluator.varRef],evalValue=function(e){if(null!=scope.gadgetValueObj.variableDef)scope.gadgetValueObj.variableDef.type;var t;if("function"==typeof e.toString&&(t=parseFloat(e.value.toString())),null!=evaluator.gadgetTransformation)var a=evaluator.gadgetTransformation.transform(t);"rotation"==evaluator.targetPropertyName?(scope.gadget[evaluator.targetPropertyName]=null!=evaluator.gadgetTransformation?a:t,scope.updateStyles()):(scope.style[evaluator.targetPropertyName]=(null!=evaluator.gadgetTransformation?a:t)*scope.ratio+"px",scope.style=$.extend(!0,{},scope.style))};if(null!=gadgetValueObj){var queryDef=WebpanelData.getValueWatchQuery(gadgetValueObj);scope.gadgetValueObj=queryDef.gadgetValueObj,scope.$watch(queryDef.query,function(e,t){var a=WebpanelData.getValueHandleEvalValue(gadgetValueObj,e);null!=a&&evalValue(a)}),scope.$watch("ratio",function(newValue){var actualValue=eval("scope."+queryDef.query),value=WebpanelData.getValueHandleEvalValue(gadgetValueObj,actualValue);null!=value&&evalValue(value)})}}}}}]).filter("filterLogicalOperators",["$filter",function($filter){return function(string,filter){filter=filter.replace(/AND/g,"&&").replace(/OR/g,"||"),string=$filter("removeAccents")(string),filter=$filter("removeAccents")(filter),string=string.toLowerCase();var filterArray=filter.split(/&&|\|\|/),filteredString=[],stringEval="",offset=0;return angular.forEach(filterArray,function(e,t){" "==e[0]&&(e=e.slice(1,e.length),offset++)," "==e[e.length-1]&&(e=e.slice(0,e.length-1),offset++);var a=!1;1<e.length&&'"'==e[0]&&'"'==e[e.length-1]?(a=!0,e=e.slice(1,e.length-1),offset+=2):'"'==e[0]?(e=e.slice(1,e.length),offset++):'"'==e[e.length-1]&&(e=e.slice(0,e.length),offset++)," "==e[e.length-1]&&(e=e.slice(0,e.length-1),offset++);var n=e.toLowerCase();if(a)0==string.localeCompare(n)?filteredString[t]=!0:filteredString[t]=!1;else{var i=n.replace(/[^\w\s]/g,"\\$&");i=i.replace(/\\\*/g,"[^]*"),string.match(i)?filteredString[t]=!0:filteredString[t]=!1}offset+=e.length,stringEval+=filteredString[t],"&&"!=filter.slice(offset,offset+2)&&"||"!=filter.slice(offset,offset+2)||(stringEval+=filter.slice(offset,offset+2),offset+=2)}),eval(stringEval)}}]).filter("removeAccents",["$filter",function(e){return function(e){var t={"àááâãäåæ":"a","çč":"c","ď":"d","èééêëě":"e","ìíîï":"i","ñň":"n","ðòóóôõö":"o","ř":"r","š":"s","ť":"t","ùúûůü":"u","ýÿ":"y","ž":"z"};if(null!=e)for(var a in t)e=e.replace(new RegExp("["+a+"]","g"),t[a]);return e}}]).filter("HighlightFilter",["$filter",function(p){return function(d,e){if(void 0===e||""===e)return d;var t=e.split(/&&|\|\||AND|OR/);return angular.forEach(t,function(e,t){" "==e[0]&&(e=e.slice(1,e.length))," "==e[e.length-1]&&(e=e.slice(0,e.length-1));var a=!1;'"'==e[0]&&'"'==e[e.length-1]?(a=!0,e=e.slice(1,e.length-1)):'"'==e[0]?e=e.slice(1,e.length):'"'==e[e.length-1]&&(e=e.slice(0,e.length));var n=e.toLowerCase();n=p("removeAccents")(n);var i=d.toLowerCase();if(i=p("removeAccents")(i),a)0==i.localeCompare(n)&&(d='<span class="highlight">'+d+"</span>");else{var r=n.replace(/[^\w\s]/g,"\\$&");r=r.replace(/\\\*/g,"[^]*");for(var o=n.length,l=[],s=[],u=new RegExp(r,"gi");(s=u.exec(i))&&!(l[l.length-1]>=s.index);)l.push(s.index);l.sort(function(e,t){return e-t});for(var c=l.length-1;-1<c;c--)d=(d=String(d.substring(0,l[c])+"%#%"+d.substring(l[c],l[c]+o)+"%##%"+d.substring(l[c]+o))).replace(/%#%/,'<span class="highlight">').replace(/%##%/,"</span>")}}),d}}]).directive("esgMouseenter",["$log",function(e){return{restrict:"A",link:function(a,n,i){a.$watch("focus",function(e,t){n.bind("mouseover",function(e){var t=e||window.event;t.target||t.srcElement;(function(e,t){if(angular.isUndefined(e))return!1;for(;e.parentNode;){if(e==t)return!0;e=e.parentNode}for(;e.offsetParent;){if(e==t)return!0;e=e.offsetParent}return!1})(t.relatedTarget||t.fromElement,n[0])||(a.$eval(i.esgMouseenter),a.$root.$$phase||a.$digest())})})}}}]).directive("esgImg",["$log","$compile","$timeout","BrowserDetection",function(e,n,t,i){return{transclude:!1,template:"<div></div>",replace:!0,restrict:"E",scope:{src:"=",animation:"=",imgStyles:"="},link:function(n,e,t){return n.element=e[0],n.actualImage=null,n.previousImage=null,n.actualImageIndex=0,n.previousImageIndex=null,n.$watch("src",function(e,t){if($(n.element).html(""),null!=e){var a=n.createImg(e);angular.element(n.element).append(a)}},!0),["$scope","iElement","iAttrs","controller",function(e,t,a,n){}]},controller:["$scope",function(a){a.createImg=function(e){var t=angular.element('<img class="visibleImage" ng-style="imgStyles" src="'+e+("Safari"!=i.browser.id?"#svgView(preserveAspectRatio(none))":"")+'" prevent-image-touch-menu></img>');return n(t)(a)}}]}}]).directive("variableSelection",["$log","$rootScope","$timeout","WebpanelData","ESGVisionConfig",function(e,t,a,o,l){return{link:function(n,i,e,t){if(null!=n.gadget.metadataArray.gadgetName&&l.ShowGraphView){var r=n.gadget.getVariables(),a=0;if(angular.forEach(r,function(){a++}),0==a)return;i.mousedown(function(e){e.ctrlKey&&!e.isDefaultPrevented()&&(n.toggleSelection(r)&&e.preventDefault(),n.$apply())}),n.toggleSelection=function(e){var t=!(n.disableHighlightFce=!0);return angular.forEach(e,function(e){o.selectVariable(e),t=!0}),n.disableHighlightFce=!1,t},n.gadgetIsHighlighted=!1,n.disableHighlightFce=!1,n.WebpanelData=o,n.$watch("WebpanelData.selectedVariables",function(){n.highlightGadget()}),n.highlightGadget=function(e){var t=!0,a=!1;angular.forEach(r,function(e){0==(-1!=o.selectedVariables.indexOf(e))?t=!1:a=!0}),1==t?($(i).css("outline","2px dashed black"),n.gadgetIsHighlighted=!0):1==a?$(i).css("outline","2px dashed grey"):($(i).css("outline",""),n.gadgetIsHighlighted=!1)}}}}}]).filter("useTableFilter",["$filter","$log",function(a,e){return function(e,t){return void 0!==t?a(t.name)(e,t.param):e}}]).service("keyDetection",["$log","$rootScope",function(e,a){var n={scope:{},detectionArrowsReg:!1,detectionArrowsProjFce:{}};function t(e){var t=window.event?event:e;if(a.$broadcast("RcWareKeyDown",e),t.altKey)switch(e.charCode){case 83:n.scope.currentProject.currentView="schema",null==n.scope.currentProject.currentSchema&&(n.scope.currentProject.currentSchema=n.scope.currentProject.schemas[0]),n.scope.$digest();break;case 84:n.scope.currentProject.currentView="table",n.scope.$digest();break;case 71:n.scope.currentProject.currentView="graph",n.scope.$digest()}}function i(e){if(a.$broadcast("RcWareKeyDown",e),null!=n.scope.currentProject&&"table"==n.scope.currentProject.currentView){var t=window.event?event:e;switch(e.keyCode){case 37:n.detectionArrowsProjFce[n.scope.currentProject.id][0](-1,!0)&&e.preventDefault();break;case 38:n.detectionArrowsProjFce[n.scope.currentProject.id][0](-1,!1)&&e.preventDefault();break;case 39:n.detectionArrowsProjFce[n.scope.currentProject.id][0](1,!0)&&e.preventDefault();break;case 40:n.detectionArrowsProjFce[n.scope.currentProject.id][0](1,!1)&&e.preventDefault();break;case 32:n.detectionArrowsProjFce[n.scope.currentProject.id][0](1,!0)&&e.preventDefault();break;case 33:n.detectionArrowsProjFce[n.scope.currentProject.id][0]("up",!1)&&e.preventDefault();break;case 34:n.detectionArrowsProjFce[n.scope.currentProject.id][0]("down",!1)&&e.preventDefault();break;case 36:n.detectionArrowsProjFce[n.scope.currentProject.id][0]("start",!1)&&e.preventDefault();break;case 35:n.detectionArrowsProjFce[n.scope.currentProject.id][0]("end",!1)&&e.preventDefault();break;case 83:t.altKey&&(n.detectionArrowsProjFce[n.scope.currentProject.id][1](),e.preventDefault());break;case 85:t.altKey&&(n.detectionArrowsProjFce[n.scope.currentProject.id][2](),e.preventDefault())}}}return n.registerDetectionKey=function(){document.onkeypress=t},n.registerDetectionArrowsClick=function(e,t){n.detectionArrowsReg||(document.onkeydown=i,n.detectionArrowsReg=!0),n.detectionArrowsProjFce[e.id]=t},n}]).factory("ESGDigest",[function(e){return function(e,t){var a=e.$root.$$phase;"$apply"==a||"$digest"==a?t&&e.$eval(t):t?e.$digest(t):e.$digest()}}]).directive("handleVisibility",["$log",function(e){return{link:function(e,t,a,n){}}}]).directive("handleGadgetTooltip",["$log",function(e){return{link:function(e,t,a,n){null!=e.gadget.metadataArray.tooltip&&""!=e.gadget.metadataArray.tooltip&&t[0].setAttribute("title",e.gadget.metadataArray.tooltip)}}}]),esgAngularDependencies.push("ESGPanelsContainer"),angular.module("ESGPanelsContainer",[]).directive("panelContainer",["$log","$rootScope","$compile","schemaElementStyle",function(e,i,r,t){return{transclude:!1,template:'<div esg-style="style" schema-element-resize></div>',replace:!0,restrict:"E",scope:{gadget:"=",ratio:"="},link:function(e,n,t,a){return angular.forEach(e.gadget.innerGadgets,function(e){var t=i.$new(),a=angular.element(e.getTemplate());t.gadget=e;r(a)(t,function(e,t){$(n).append(e)})}),["$scope","iElement","iAttrs","contoller",function(e,t,a,n){}]},controller:["$scope",function(e){e.style=t.prepareStyle(e.gadget,{"white-space":"nowrap"})}]}}]),esgAngularDependencies.push("ESGPanelsHeader"),angular.module("ESGPanelsHeader",[]).directive("webpanelHeader",["$log","$location","ESGVisionConfig","WebpanelData","EsgLoginUserModal","WebpanelActualUser","RcWareVisionAPI","ModelHmiUser","EsgCreateAboutBox",function(e,t,a,i,r,o,l,s,u){return{transclude:!1,template:'<div class="webpanel-header">                     <div class="buttons-line">                       <div class="brand">                         <img ng-src="{{ESGVisionConfig.AppLogoSmall}}" alt="{{ESGVisionConfig.AppTitle}}" title="{{ESGVisionConfig.AppTitle}}" ng-style="styles" />                       </div>                       <esg-dropdown-search-filter value="WebpanelData.actualPanel" use-function="true" list-values="WebpanelData.pages" show-ico="true" class="dropdown-projects" ico-class="icon-energo-dropdown" offset-top="28" search-string="buttonProject.searchString" display-property="title" callback-function="switchProjectGoToSchema(view)" item-class="{commErrorOccurred: item.viewObject.commErrorOccurred}"></esg-dropdown-search-filter>                       <div class="active-panel" ng-class="{active: WebpanelData.activeView == \'panel\'}" ng-show="WebpanelData.actualPanel != null" ng-click="WebpanelData.activeView = \'panel\'">{{WebpanelData.actualPanel.title}}</div>                       <button esg-i18n="title:Fit schema to window without scrolling" ng-show="WebpanelData.actualPanel != null" class="btn-ico btn-panel-fit-window" ng-click="setPanelSize(1)" ng-class="{buttonActive: WebpanelData.panelSizeMode == 1}"><i class="icon-energo-schema-without-scrolling icon-energo"></i></button>                       <button esg-i18n="title:Fit schema to width of window" class="btn-ico btn-panel-fit-width" ng-show="WebpanelData.actualPanel != null" ng-click="setPanelSize(2)" ng-class="{buttonActive: WebpanelData.panelSizeMode == 2}"><i class="icon-energo-schema-with-scrolling icon-energo"></i></button>                       <button esg-i18n="title:Show schema in original size" class="btn-ico btn-panel-original-size" ng-show="WebpanelData.actualPanel != null" ng-click="setPanelSize(0)" ng-class="{buttonActive: WebpanelData.panelSizeMode == 0}"><i class="icon-energo-schema-original icon-energo"></i></button>                       <button esg-i18n="title:Show graph" ng-if="ESGVisionConfig.ShowGraphView && WebpanelData.features.graph" class="btn-ico btn-show-graph" ng-click="WebpanelData.activeView = \'graph\'" ng-class="{buttonActive: WebpanelData.activeView == \'graph\'}"><span class="graphVarCount" ng-show="WebpanelData.selectedVariables.length > 0">{{WebpanelData.selectedVariables.length}}</span><i class="icon-energo-graph-view icon-energo"></i></button>                       <button esg-i18n="title:Show system log" ng-if="ESGVisionConfig.ShowLogView && WebpanelData.features.log" class="btn-ico btn-show-log" ng-click="WebpanelData.activeView = \'log\'" ng-class="{buttonActive: WebpanelData.activeView == \'log\'}"><i class="icon-energo-log icon-energo"></i></button>                                             <div class="right-buttons">                          <button esg-i18n="title:Show system configuration" ng-if="ESGVisionConfig.ShowSystemConfigView && WebpanelData.features.readSystemConfiguration" class="btn-ico ico-system-config" ng-click="WebpanelData.activeView = \'systemConfig\'" ng-class="{buttonActive: WebpanelData.activeView == \'systemConfig\'}"><i class="icon-advanced-settings icon-energo"></i></button>                          <button esg-i18n="title:Show alarms" ng-if="ESGVisionConfig.ShowAlarmsView && WebpanelData.features.readAlarms" class="btn-ico btn-show-alarms" ng-click="WebpanelData.activeView = \'alarms\'" ng-class="{buttonActive: WebpanelData.activeView == \'alarms\'}"><i class="icon-energo-alarms icon-energo"></i></button>                          <button class="btn-ico margin-left-info ico-about" ng-click="aboutBox()" esg-i18n="title:About application"><i class="icon-energo-info icon-energo"></i></button> <div class="user-indicator" ng-show="WebpanelActualUser.user" ng-click="changeUser()">     <span esg-i18n="title:Logged user">       <i class="icon-user"></i>       <span class="label">{{WebpanelActualUser.user.name}}</span>     </span>   </div>                          <button class="btn-ico margin-left-logout ico-logout" ng-click="logout()" esg-i18n="title:Log out" ng-show="WebpanelActualUser.user != null && (WebpanelActualUser.user.isDefault != true || (WebpanelActualUser.user.isDefault == true && WebpanelData.defaultUserAutoLogin == false))"><i class="icon-energo-logout icon-energo" esg-is-clickable=""></i></button>                       </div>                     </div>                     <div class="top-color-line"></div>                   </div>',replace:!0,restrict:"E",scope:{gadget:"=",ratio:"="},link:function(e,t,a,n){return e.logout=function(){null!=i.webpanelDef.defaultUser&&1==i.defaultUserAutoLogin?l.Login(i.webpanelDef.defaultUser,i.hashPassword(i.webpanelDef.defaultUser,"")).success(function(){var e=new s({name:i.webpanelDef.defaultUser,password:i.hashPassword(i.webpanelDef.defaultUser,""),isDefault:!0});o.setUser(e),i.setUserPanels()}).error(function(){o.logout(),i.setUserPanels(),r.open({ModelUserGroups:i.ModelUserGroups,defaultUserName:i.webpanelDef.defaultUser,backdrop:"static"}).success(function(e){null!=e&&i.setUserPanels()})}):(o.logout(),i.setUserPanels(),r.open({ModelUserGroups:i.ModelUserGroups,defaultUserName:i.webpanelDef.defaultUser,backdrop:"static"}).success(function(e){null!=e&&i.setUserPanels()}))},e.aboutBox=function(){u.open()},e.changeUser=function(){r.open({ModelUserGroups:i.ModelUserGroups,defaultUserName:""}).success(function(e){null!=e&&i.setUserPanels()})},e.setPanelSize=function(e){"panel"==i.activeView&&(i.panelSizeMode=e)},["$scope","iElement","iAttrs","contoller",function(e,t,a,n){}]},controller:["$scope",function(e){e.ESGVisionConfig=a,e.WebpanelData=i,e.WebpanelActualUser=o,e.switchProjectGoToSchema=function(e){i.activeView="panel",t.path("/panel/"+e.id,!1)}}]}}]),esgAngularDependencies.push("ESGPanelsFooter"),angular.module("ESGPanelsFooter",[]).directive("webpanelFooter",["$log","$rootScope","$compile","schemaElementStyle",function(e,t,a,n){return{transclude:!1,template:'<div class="webpanel-footer"></div>',replace:!0,restrict:"E",scope:{},link:function(e,t,a,n){return["$scope","iElement","iAttrs","contoller",function(e,t,a,n){}]},controller:["$scope",function(e){}]}}]),esgAngularDependencies.push("ESGAlarmsView"),angular.module("ESGAlarmsView",[]).directive("alarmsView",["$log","$rootScope","$filter","$timeout","RcWareVisionAPI","WebpanelData","EsgTaskBar",function(e,t,i,a,r,o,l){return{transclude:!1,template:'<div class="log-view" ng-show="isVisible" ng-class="{showAlarmLog: showAlarmLog}">                     <div class="alarm-log-wrapper">                       <button ui-button esg-is-clickable ui-button-remove esg-i18n="title:Show or hide alarm history panel" ng-show="WebpanelData.capabilities.alarmHistory" ng-class="{selected: showAlarmLog==true}" class="btn-ico" ng-click="showAlarmLog = !showAlarmLog"><i class="icon-energo-show-history icon-energo"></i></button>                       <rc-ware-vision-project-progress-bar-short-wrapper />                     </div>                     <esg-view-table table-structure="tableStructure" show-from-to-settings="false" table-elements-size-default="tableElementsSizeDefault" table-id="tableIdString" table-print-title="printTitle" special-interval="specialInterval" table-force-update="forceUpdateAlarms(forceUpdate, from, to)" table-data-from="dataFrom" table-data-to="dataTo" table-own-time-range="ownTimeRange" limit="tableLimit" page="tablePage" filter="tableFilter" offset-begin="tableOffsetStart" set-alarm-history-url="setEventLogUrl()"></esg-view-table>                     <div class="alarm-history-log" ng-show="showAlarmLog && WebpanelData.capabilities.alarmHistory">                       <esg-view-table table-structure="tableStructureHistory" show-from-to-settings="false" table-elements-size-default="tableElementsSizeHistoryDefault" table-id="tableIdString" table-print-title="printTitle" special-interval="specialInterval" table-force-update="forceUpdateAlarmHistory(forceUpdate, from, to)" table-data-from="dataFrom" table-data-to="dataTo" table-own-time-range="ownTimeRange" limit="tableLimit" page="tablePage" filter="tableFilter" offset-begin="tableOffsetStart" set-alarm-history-url="setEventLogUrl()"></esg-view-table>                     </div>                   </div>',replace:!0,restrict:"E",scope:{isVisible:"="},link:function(t,e,a,n){return t.eventLogSettings={},t.ownTimeRange=!1,t.showAlarmLog=!1,t.tableLimit=100,t.tablePage=1,t.tableOffsetStart=0,t.tableFilter={},t.tableIdString={title:"alarms"},t.printTitle=i("i18n")("Alarms"),t.lastDataLoad=null,t.autoUpdateIsRunning=!1,t.specialInterval=null,t.actionSuggestions={},t.dataTo=new Date,t.dataFrom=new Date(t.dataTo.getTime()),t.dataFrom.setHours(0,0,0,0),t.tableElementsSizeDefault={},t.tableStructure={column:[],data:[],dataRange:!1},t.tableStructureHistory={column:[],data:[],dataRange:!1},t.setTableStructure=function(e){t.tableStructure.column=[{id:"time",name:i("i18n")("Time"),filter:!1,addFreeSpace:0,angularFilter:{name:"date",param:"dd.MM.yyyy H:mm:ss"}},{id:"desc",name:i("i18n")("Message"),filter:!0,addFreeSpace:.5},{id:"stateText",name:i("i18n")("State"),filter:!0,addFreeSpace:0}],e&&t.tableStructure.column.push({id:"connection",name:i("i18n")("Connection"),filter:!0,addFreeSpace:0}),t.tableStructure.column.push({id:"actions",name:i("i18n")("Actions"),filter:!1,addFreeSpace:.5,type:"buttons",sortable:!1}),t.tableElementsSizeDefault={time:{width:156},desc:{width:244},stateText:{width:131},actions:{width:211}},e&&(t.tableElementsSizeDefault.connection={width:111})},t.setTableStructureHistory=function(e){t.tableStructureHistory.column=[{id:"time",name:i("i18n")("Time"),filter:!1,addFreeSpace:0,angularFilter:{name:"date",param:"dd.MM.yyyy H:mm:ss"}},{id:"desc",name:i("i18n")("Message"),filter:!0,addFreeSpace:.5},{id:"stateText",name:i("i18n")("State"),filter:!0,addFreeSpace:0},{id:"sId",name:i("i18n")("Source Id"),filter:!0,addFreeSpace:0}],e&&t.tableStructureHistory.column.push({id:"connection",name:i("i18n")("Connection"),filter:!0,addFreeSpace:0}),t.tableStructureHistory.column.push({id:"n",name:i("i18n")("Note"),filter:!0,addFreeSpace:.5}),t.tableElementsSizeHistoryDefault={time:{width:156},desc:{width:244},stateText:{width:131},sId:{width:111},n:{width:111}},e&&(t.tableElementsSizeHistoryDefault.connection={width:111})},t.setTableStructureHistory(),t.setTableStructure(),["$scope","iElement","iAttrs","contoller",function(e,t,a,n){}]},controller:["$scope",function(n){n.WebpanelData=o,n.forceUpdateAlarms=function(e,t,a){null!=t&&(n.dataFrom=t),null!=a&&(n.dataTo=a),n.getLogData()},n.forceUpdateAlarmHistory=function(e,t,a){null!=t&&(n.dataFrom=t),null!=a&&(n.dataTo=a),n.getHistoryData()},n.confirmAlarm=function(e){var t=[];t.push({i:"svc://"+e.connection+"/"+e.commId+"["+e.offset+"]",set:"ack"}),r.AlarmCommand(t).success(function(){n.reloadData()}).error(function(){})},n.resetAlarm=function(e){var t=[];t.push({i:"svc://"+e.connection+"/"+e.commId+"["+e.offset+"]",set:"rst"}),r.AlarmCommand(t).success(function(){n.reloadData()}).error(function(){})},n.reloadDataLoop=function(){n.isVisible&&(n.reloadData(),a(n.reloadDataLoop,6e4))},n.reloadData=function(){n.getLogData(),1==n.showAlarmLog&&n.getHistoryData()},n.getLogData=function(){null!=n.graphBar&&(n.graphBar.terminateAction(),l.removeBar(n.graphBar));var a=n.graphBar=l.registerTaskBar(i("i18n")("Graph"),!1);n.graphBar.progress=null,n.graphBar.disablePercent=!0,r.GetActiveAlarms(n.dataFrom,n.dataTo).success(function(e){n.setTableStructure(1<e.connectionsLength);var t=e.alarms;angular.forEach(t,function(e){e.actions=[],o.features.ackAlarms&&(1==e.state?e.actions.push({title:"Confirm",fce:n.confirmAlarm}):4!=e.state&&3!=e.state||e.actions.push({title:"Reset",fce:n.resetAlarm}))}),n.tableStructure.data=t,null!=n.graphBar&&(n.graphBar.setProgress(100),l.removeBar(a),n.graphBar=null)}).error(function(){null!=n.graphBar&&(n.graphBar.setError(3e3),n.graphBar=null)})},n.$watch("showAlarmLog",function(e){1==e&&n.getHistoryData()}),n.getHistoryData=function(){null!=n.graphBarHistory&&(n.graphBarHistory.terminateAction(),l.removeBar(n.graphBarHistory));var a=n.graphBarHistory=l.registerTaskBar(i("i18n")("Graph"),!1);n.graphBarHistory.progress=null,n.graphBarHistory.disablePercent=!0,r.GetAlarmsHistoryLog().success(function(e){n.setTableStructureHistory(1<e.connectionsLength);var t=e.alarms;n.tableStructureHistory.data=t,null!=n.graphBarHistory&&(n.graphBarHistory.setProgress(100),l.removeBar(a),n.graphBarHistory=null)}).error(function(){null!=n.graphBarHistory&&(n.graphBarHistory.setError(3e3),n.graphBarHistory=null)})},n.$watch("isVisible",function(e){e&&0==n.tableStructure.data.length&&(n.tableStructure.data=[],n.getLogData(),n.session=new Date,a(function(){n.reloadDataLoop(n.session)},6e4))})}]}}]),esgAngularDependencies.push("ESGSystemConfigView"),angular.module("ESGSystemConfigView",[]).directive("systemConfigView",["$log","$rootScope","$filter","RcWareVisionAPI","WebpanelData","EsgTaskBar","ESGVisionConfig",function(e,t,i,r,a,o,l){return{transclude:!1,template:'<div class="system-config-view" ng-show="isVisible">                     <div><rc-ware-vision-project-progress-bar-short-wrapper /></div>                     <div class="content" ng-if="dataLoaded">                       <div class="line h1" esg-i18n="System configuration" ng-show="false"></div>                       <div class="network">                         <div class="line h2" esg-i18n="Network settings"></div>                           <div class="line">                               <span class="line-settings-name" esg-i18n="Use DHCP"></span>                               <span class="line-settings-value"><select ng-options="item as item.label for item in networkModes track by item.id" ng-model="configModel.network.interfaces[0].ipv4.mode" ng-disabled="WebpanelData.features.writeSystemConfiguration != true || ESGVisionConfig.DisableNetworkSettings"></select></span>                             </div>                             <div class="line" ng-show="configModel.network.interfaces[0].ipv4.mode.id != \'dhcp\'">                               <span class="line-settings-name" esg-i18n="IP address"></span>                               <span class="line-settings-value"><input type="text" ng-model="configModel.network.interfaces[0].ipv4.ip" ng-disabled="WebpanelData.features.writeSystemConfiguration != true || ESGVisionConfig.DisableNetworkSettings"></input></span>                             </div>                             <div class="line" ng-show="configModel.network.interfaces[0].ipv4.mode.id != \'dhcp\'">                               <span class="line-settings-name" esg-i18n="Network Mask"></span>                               <span class="line-settings-value"><input type="text" ng-model="configModel.network.interfaces[0].ipv4.mask" ng-disabled="WebpanelData.features.writeSystemConfiguration != true || ESGVisionConfig.DisableNetworkSettings"></input></span>                             </div>                             <div class="line" ng-show="configModel.network.interfaces[0].ipv4.mode.id != \'dhcp\'">                               <span class="line-settings-name" esg-i18n="Default Gateway"></span>                               <span class="line-settings-value"><input type="text" ng-model="configModel.network.gw[0].ipv4" ng-disabled="WebpanelData.features.writeSystemConfiguration != true || ESGVisionConfig.DisableNetworkSettings"></input></span>                             </div>                             <div class="line" ng-show="configModel.network.interfaces[0].ipv4.mode.id != \'dhcp\'">                               <span class="line-settings-name" esg-i18n="DNS"></span>                               <span class="line-settings-value"><input type="text" ng-model="configModel.network.dns" ng-disabled="WebpanelData.features.writeSystemConfiguration != true || ESGVisionConfig.DisableNetworkSettings"></input></span>                             </div>                                                          <div class="line" ng-show="configModel.network.interfaces[0].ipv4.mode.id == \'dhcp\' && configModelDhcp != null">                               <span class="line-settings-name" esg-i18n="IP address"></span>                               <span class="line-settings-value"><input type="text" ng-model="configModelDhcp.network.interfaces[0].ipv4.ip" ng-disabled="true"></input></span>                             </div>                             <div class="line" ng-show="configModel.network.interfaces[0].ipv4.mode.id == \'dhcp\' && configModelDhcp != null">                               <span class="line-settings-name" esg-i18n="Network Mask"></span>                               <span class="line-settings-value"><input type="text" ng-model="configModelDhcp.network.interfaces[0].ipv4.mask" ng-disabled="true"></input></span>                             </div>                             <div class="line" ng-show="configModel.network.interfaces[0].ipv4.mode.id == \'dhcp\' && configModelDhcp != null">                               <span class="line-settings-name" esg-i18n="Default Gateway"></span>                               <span class="line-settings-value"><input type="text" ng-model="configModelDhcp.network.gw[0].ivp4" ng-disabled="true"></input></span>                             </div>                             <div class="line" ng-show="configModel.network.interfaces[0].ipv4.mode.id == \'dhcp\' && configModelDhcp != null">                               <span class="line-settings-name" esg-i18n="DNS"></span>                               <span class="line-settings-value"><input type="text" ng-model="configModelDhcp.network.dns" ng-disabled="true"></input></span>                             </div>                                                         <div ng-if="configModel.proxy != null">                               <div class="line h2" esg-i18n="Proxy settings"></div>                               <div class="line">                                 <span class="line-settings-name" esg-i18n="Enabled"></span>                                 <span class="line-settings-value"><select ng-options="item.id as item.label for item in booleanValues" ng-model="configModel.proxy.enabled" ng-disabled="WebpanelData.features.writeSystemConfiguration != true"></select></span>                               </div>                               <div class="line">                                 <span class="line-settings-name" esg-i18n="Certificate validation"></span>                                 <span class="line-settings-value"><select ng-options="item.id as item.label for item in booleanValues" ng-model="configModel.proxy.certValidation" ng-disabled="WebpanelData.features.writeSystemConfiguration != true"></select></span>                               </div>                               <div class="line">                                 <span class="line-settings-name" esg-i18n="URL"></span>                                 <span class="line-settings-value"><input type="text" ng-model="configModel.proxy.url" ng-disabled="WebpanelData.features.writeSystemConfiguration != true"></input></span>                               </div>                               <div class="line">                                 <span class="line-settings-name" esg-i18n="Proxy ID"></span>                                 <span class="line-settings-value"><input type="text" ng-model="configModel.proxy.proxyId" ng-disabled="WebpanelData.features.writeSystemConfiguration != true"></input></span>                               </div>                               <div class="line">                                 <span class="line-settings-name" esg-i18n="Keep alive"></span>                                 <span class="line-settings-value"><input type="number" ng-model="configModel.proxy.keepAlive" ng-disabled="WebpanelData.features.writeSystemConfiguration != true"></input></span>                               </div>                             <div>                                                         <div ng-if="configModel.db != null">                               <div class="line h2" esg-i18n="Database settings"></div>                               <div class="line">                                 <span class="line-settings-name" esg-i18n="Enabled"></span>                                 <span class="line-settings-value"><select ng-options="item.id as item.label for item in booleanValues" ng-model="configModel.db.enabled" ng-disabled="WebpanelData.features.writeSystemConfiguration != true"></select></span>                               </div>                               <div class="line">                                 <span class="line-settings-name" esg-i18n="Certificate validation"></span>                                 <span class="line-settings-value"><select ng-options="item.id as item.label for item in booleanValues" ng-model="configModel.db.certValidation" ng-disabled="WebpanelData.features.writeSystemConfiguration != true"></select></span>                               </div>                               <div class="line">                                 <span class="line-settings-name" esg-i18n="URL"></span>                                 <span class="line-settings-value"><input type="text" ng-model="configModel.db.url" ng-disabled="WebpanelData.features.writeSystemConfiguration != true"></input></span>                               </div>                               <div class="line">                                 <span class="line-settings-name" esg-i18n="User"></span>                                 <span class="line-settings-value"><input type="text" ng-model="configModel.db.user" ng-disabled="WebpanelData.features.writeSystemConfiguration != true"></input></span>                               </div>                               <div class="line">                                 <span class="line-settings-name" esg-i18n="Password"></span>                                 <span class="line-settings-value"><input type="password" ng-model="configModel.db.password" ng-disabled="WebpanelData.features.writeSystemConfiguration != true"></input></span>                               </div>                               <div class="line">                                 <span class="line-settings-name" esg-i18n="Communication period"></span>                                 <span class="line-settings-value"><input type="number" ng-model="configModel.db.commPeriod" ng-disabled="WebpanelData.features.writeSystemConfiguration != true"></input></span>                               </div>                             <div>                                                   <div class="actions line"><button esg-i18n="Refresh" ng-click="getData()"/><button esg-i18n="Set" ng-click="setData()" ng-show="WebpanelData.features.writeSystemConfiguration == true"/></div>                     </div>                   </div>',replace:!0,restrict:"E",scope:{isVisible:"="},link:function(e,t,a,n){return["$scope","iElement","iAttrs","contoller",function(e,t,a,n){}]},controller:["$scope",function(n){n.configModel=null,n.configModelDhcp=null,n.dataLoaded=!1,n.WebpanelData=a,n.ESGVisionConfig=l,n.networkModes=[{id:"dhcp",label:i("i18n")("Yes")},{id:"static",label:i("i18n")("No")}],n.booleanValues=[{id:!0,label:i("i18n")("Yes")},{id:!1,label:i("i18n")("No")}],n.getData=function(){null!=n.graphBar&&(n.graphBar.terminateAction(),o.removeBar(n.graphBar));var a=n.graphBar=o.registerTaskBar(i("i18n")("Graph"),!1);n.graphBar.progress=null,n.graphBar.disablePercent=!0,r.GetSysConf().success(function(t){r.GetSysInfoNetwork().success(function(e){"dhcp"==t.network.interfaces[0].ipv4.mode&&(n.configModelDhcp={network:e}),n.configModel=t,n.configModel.network.interfaces[0].ipv4.mode="dhcp"==n.configModel.network.interfaces[0].ipv4.mode?n.networkModes[0]:n.networkModes[1],n.configModel.network.dns=null!=n.configModel.network.dns?n.configModel.network.dns[0]:"",n.dataLoaded=!0,a.setProgress(100),o.removeBar(a),n.graphBar=null}).error(function(){a.setError(3e3),n.graphBar=null})}).error(function(){a.setError(3e3),n.graphBar=null})},n.setData=function(){null!=n.graphBar&&(n.graphBar.terminateAction(),o.removeBar(n.graphBar));var t=n.graphBar=o.registerTaskBar(i("i18n")("Graph"),!1);n.graphBar.progress=null,n.graphBar.disablePercent=!0;var a={network:{interfaces:[{name:"default",ipv4:{mode:n.configModel.network.interfaces[0].ipv4.mode.id}}]}};"dhcp"!=n.configModel.network.interfaces[0].ipv4.mode.id&&1!=l.DisableNetworkSettings&&(a.network.dns=[n.configModel.network.dns],a.network.gw=[],angular.forEach(n.configModel.network.gw,function(e){a.network.gw.push({dst:e.dst,ipv4:e.ipv4})}),a.network.interfaces[0].ipv4.ip=n.configModel.network.interfaces[0].ipv4.ip,a.network.interfaces[0].ipv4.mask=n.configModel.network.interfaces[0].ipv4.mask),null!=n.configModel.proxy&&(a.proxy=n.configModel.proxy),null!=n.configModel.db&&(a.db=n.configModel.db),r.SetSysConf(a).success(function(e){t.setProgress(100),o.removeBar(t),n.graphBar=null}).error(function(){t.setError(3e3),n.graphBar=null})},n.$watch("isVisible",function(e){e&&n.getData()})}]}}]),esgAngularDependencies.push("RcWareVisionTpgEditorModalWindow"),angular.module("RcWareVisionTpgEditorModalWindow",[]).factory("EsgTpgEditorModal",["$log","ESGPromise","EsgModalWindow","BrowserDetection","$timeout","$filter","RcWareVisionAPI","I18nService","$rootScope",function(e,m,a,r,t,v,n,o,l){var i={open:function(n){var i=m.defer(),e=i.promise,t={backdrop:!0,keyboard:!1,backdropClick:!1,templateUrl:"html/desktop/ModalWindows/modalWindow.tpgEditor.html",windowClass:"tpgModalWindow"+(r.isTabletVariable?" ipad-scroll":""),controller:["$scope","$modalInstance",function(f,t){switch(f.title=n.title,f.modalElement=$(document).find("initModalWindow")[0],f.focusSet=!0,f.tpgSettings={},f.itemsTransitionsMessage={text:""},f.exceptionLimitMessage={text:""},angular.forEach(n.tpgSettings,function(e,t){f.tpgSettings[t]=e}),f.tpgItems=e={items:n.items.items,exceptions:[]},null!=n.exceptions&&(f.tpgItems.specialItems=n.exceptions.items),f.itemsLimit=n.items.limit,null!=n.exceptions&&(f.exceptionsLimit=n.exceptions.limit),f.tpgType=n.tpgType,f.tpgExceptionDisabled=function(){return 0==n.tpgExceptionEnabled||null==n.exceptions},f.showDrawEditorVal=!1,f.showDrawEditor=function(e){f.showDrawEditorVal=!0},f.hideDrawEditor=function(e){f.showDrawEditorVal=!1},f.countTpgTransitions=function(e){var t=0,a=null;return angular.forEach(e,function(e){(null==a||null!=e.value.toPrecision&&e.value.toPrecision()!=a.toPrecision()||null==e.value.toPrecision&&e.value!=a)&&t++,a=e.value}),f.tpgSettings.transitions=t,f.itemsTransitionsMessage.text=v("i18n")("Schedule will be converted to $ state change.",t),t>f.itemsLimit?f.itemsTransitionsMessage.text+=" "+v("i18n")("It exceeds available $ state change.",f.itemsLimit):f.itemsTransitionsMessage.text+=" "+v("i18n")("Available $ state change.",f.itemsLimit),l.$root.$$phase||f.$digest(),f.verifyTpg(f.tpgRegularArray,f.tpgExceptionArray).success(function(){f.message.value=""}).error(function(e){f.message.value=e}),t},f.countTpgExceptions=function(e){var t=0,a=null;return angular.forEach(e,function(e){(null==a||null!=e.value.toPrecision&&e.value.toPrecision()!=a.toPrecision()||null==e.value.toPrecision&&e.value!=a)&&t++,a=e.value}),f.tpgSettings.exceptions=t,f.exceptionLimitMessage.text=v("i18n")("Exception list will be merged to $ item.",t),t>f.exceptionsLimit?f.exceptionLimitMessage.text+=" "+v("i18n")("It exceeds available $ exception.",n.exceptions.limit):f.exceptionLimitMessage.text+=" "+v("i18n")("Available $ exception.",n.exceptions.limit),l.$root.$$phase||f.$digest(),f.verifyTpg(f.tpgRegularArray,f.tpgExceptionArray).success(function(){f.message.value=""}).error(function(e){f.message.value=e}),t},f.tpgSettings.countTpgTransitions=f.countTpgTransitions,f.tpgSettings.countTpgExceptions=f.countTpgExceptions,f.tpgType){case"Int":f.wpSourceType="t19_int_scheduler";break;case"Bool":f.wpSourceType="t17_boolean_scheduler";break;case"Double":f.wpSourceType="t18_real_scheduler"}var e;0==f.tpgItems.items.length&&f.tpgItems.items.push(new TpgItemValue({timeMinutes:0,value:n.defaultValue})),f.hasExceptions=!1,f.isVisible=!0,f.message={value:""},r.isTabletVariable?f.ipadClass="device-ipad-scroll":f.ipadClass="device-nonipad",f.detectEnter=function(e){window.event&&event;switch(e.charCode){case 13:f.save()}},f.dp=n.dp,f.userSettingsActive=n.userSettingsActive,f.tpgRegularArray=[],f.tpgExceptionArray=[],f.getColorOfValue=function(e,t,a){isNaN(e)&&(e=0);return f.makeJetColor(255*e)},f.makeJetColor=function(e){var t={red:255,green:255,blue:255};e<0&&(e=0),255<e&&(e=255);var a=255;return e<63.75?(t.red=0,t.green=Math.round(4*(e-0)/a*255)):e<127.5?(t.red=0,t.blue=Math.round(255*(1+4*(63.75-e)/a))):(e<191.25?t.red=Math.round(4*(e-0-127.5)/a*255):t.green=Math.round(255*(1+4*(191.25-e)/a)),t.blue=0),t.cssColor="#"+f.hexify(t.red)+f.hexiy(t.green)+f.hexiy(t.blue),t},f.hexify=function(e){var t="0123456789ABCDEF",a=e%16;return t.charAt((e-a)/16)+t.charAt(a)},f.lastTpgExceptionId=0,f.isValidReal=function(e){return"boolean"==typeof e&&null==f.tpgSettings.min&&null==f.tpgSettings.max||!(e.cmp(f.tpgSettings.min)<0||0<e.cmp(f.tpgSettings.max))},f.verifyTpg=function(e,t){var a=m.defer(),n=a.promise,i=function(e,t,a){if(null===e||""===e)return!1;switch(a){case"t17_boolean_scheduler":return t==e;case"t18_real_scheduler":case"t19_int_scheduler":return t.toPrecision()==e.toPrecision();default:return!1}},r=[],o=[],l=!1,s="";function u(e){return null!=e&&("number"==typeof e||!isNaN(e-0))}angular.forEach(v("orderBy")(e,"timeMinutes"),function(e,t){0<t&&d.timeMinutes==e.timeMinutes&&!i(s,e.value,f.wpSourceType)&&(l=!0),i(s,e.value,f.wpSourceType)&&0!=t||(u(e.value)?(r.push(e),s=e.value,d=e):l=!0),"t18_real_scheduler"!=f.wpSourceType||f.isValidReal(e.value)||(l=!0)});var c=!1;s="";var d,p=new Date,g=f.lastTpgExceptionId,h=[];return angular.forEach(v("orderBy")(t,["timeYearFrom","timeMinutesFrom"],!1),function(e,t){if(1972==e.timeYearFrom&&"6e193816-5a30-49e4-b69a-0d6e7217cf4d"!=f.dp.valueProperties.Source.type){for(var a=0;a<5;a++){h.push(new TpgExceptionValue({timeMinutesFrom:e.timeMinutesFrom,timeYearFrom:p.getFullYear()+a,timeMinutesTo:e.timeMinutesTo,timeYearTo:p.getFullYear()+a,value:e.value,id:null!=e.id?e.id:g++})),!(new Date(p.getFullYear()+a,1,29).getMonth()-1)&&(84960<e.timeMinutesFrom&&(h[h.length-1].timeMinutesFrom+=1440),84960<e.timeMinutesTo&&(h[h.length-1].timeMinutesTo+=1440))}exceptionId++}else{if(e.timeYearFrom>e.timeYearTo){var n=e.timeYearFrom;e.timeYearTo=e.timeYearFrom,e.timeYearFrom=n;var i=e.timeMinutesTo;e.timeMinutesTo=e.timeMinutesFrom,e.timeMinutesFrom=i}if(e.timeYearFrom==e.timeYearTo&&e.timeMinutesFrom>e.timeMinutesTo){i=e.timeMinutesTo;e.timeMinutesTo=e.timeMinutesFrom,e.timeMinutesFrom=i}h.push(new TpgExceptionValue({timeMinutesFrom:e.timeMinutesFrom,timeYearFrom:e.timeYearFrom,timeMinutesTo:e.timeMinutesTo,timeYearTo:e.timeYearTo,value:e.value,id:null!=e.id?e.id:g++}))}}),angular.forEach(v("orderBy")(h,["timeYearFrom","timeMinutesFrom"],!1),function(e,t){u(e.value)||(c=!0),0==t?(o.push(e),d=e):e.timeYearFrom<d.timeYearTo||e.timeYearFrom==d.timeYearTo&&e.timeMinutesFrom<d.timeMinutesTo?i(d.value,e.value,f.wpSourceType)?e.timeYearTo<d.timeYearTo||e.timeYearTo==d.timeYearTo&&e.timeMinutesTo<=d.timeMinutesTo||(o[o.length-1].timeYearTo=e.timeYearTo,o[o.length-1].timeMinutesTo=e.timeMinutesTo,d=o[o.length-1].timeYearStart):c=!0:(o.push(e),d=e),"t18_real_scheduler"!=f.wpSourceType||f.isValidReal(e.value)||(c=!0)}),f.tpgSettings.transitions>f.itemsLimit&&(l=!0),f.tpgSettings.exceptions>f.exceptionsLimit&&(c=!0),c&&l?a.reject(v("i18n")("TPG items and exceptions items error.")):l?a.reject(v("i18n")("TPG items error.")):c?a.reject(v("i18n")("TPG exception items error.")):a.resolve({regular:r,exception:o}),n},angular.forEach(e.items,function(e){f.tpgRegularArray.push(new TpgItemValue({timeMinutes:parseInt(e.timeMinutes),value:e.value}))});f.countTpgTransitions(f.tpgRegularArray);var s={};angular.forEach(e.specialItems,function(e){var t=e.start,a=e.end;null!=e.type&&1!=e.type||(t=new Date(e.timeYearFrom,0,0,0,e.timeMinutesFrom),a=new Date(e.timeYearTo,0,0,0,e.timeMinutesTo));var n=!(new Date(t.getFullYear(),1,29).getMonth()-1),i=!(new Date(a.getFullYear(),1,29).getMonth()-1),r=t.getMonth(),o=a.getMonth(),l=(t.getFullYear(),a.getFullYear(),new TpgExceptionValue({timeMinutesFrom:e.timeMinutesFrom,timeYearFrom:e.timeYearFrom,timeMinutesTo:e.timeMinutesTo,timeYearTo:e.timeYearTo,value:e.value,id:e.id}));2==e.type&&(n&&1<r&&(l.timeMinutesFrom+=1440),i&&1<o&&(l.timeMinutesTo+=1440)),l.id>=f.lastTpgExceptionId&&(f.lastTpgExceptionId=l.id+1),f.tpgExceptionArray.push(l),s[e.id]=l}),1!=f.tpgExceptionDisabled()&&f.countTpgExceptions(f.tpgExceptionArray),f.tpgValues={},f.tpgPossibleValues={},f.tpgEditorRoundTo=15,f.tpgEditorRoundToValues=[{value:1,title:v("i18n")("$ minute",1),weight:1},{value:5,title:v("i18n")("$ minute",5),weight:2},{value:10,title:v("i18n")("$ minute",10),weight:3},{value:15,title:v("i18n")("$ minute",15),weight:4},{value:30,title:v("i18n")("$ minute",30),weight:5}];var a=null;angular.forEach(n.states,function(e){f.tpgValues[e.value]={color:e.color,name:e.label},f.tpgPossibleValues[e.value]={value:e.value,title:e.label},a=e.value,0}),f.tpgValues.unknown={color:"brown",name:"unknown"},f.tpgPossibleValues.unknown={value:"unknown",title:"unknown"},null!=a?f.tpgItemNewValue=a:"t17_boolean_scheduler"==f.wpSourceType?f.tpgItemNewValue=!1:f.tpgItemNewValue=new Big(0),f.wpTpgType="",f.dayWeek={},f.dayWeek=o.getDateTimeFormat("day"),f.itemsDayWeek=new Array({value:0,title:f.dayWeek[1]},{value:1,title:f.dayWeek[2]},{value:2,title:f.dayWeek[3]},{value:3,title:f.dayWeek[4]},{value:4,title:f.dayWeek[5]},{value:5,title:f.dayWeek[6]},{value:6,title:f.dayWeek[0]}),f.save=function(){f.verifyTpg(f.tpgRegularArray,f.tpgExceptionArray).success(function(e){f.isVisible=!1,i.resolve({regular:e.regular,exception:e.exception}),t.close("close")}).error(function(e){f.message.value=e})},f.close=function(){f.isVisible=!1,i.reject(),t.close("close")}}]};return a.open(t).success(function(){}).error(function(){}),e}};return i}]),esgAngularDependencies.push("RcWareVisionLoginUserModalWindow"),angular.module("RcWareVisionLoginUserModalWindow",[]).factory("EsgLoginUserModal",["$log","$rootScope","ESGPromise","EsgModalWindow","BrowserDetection","$timeout","$filter","RcWareVisionAPI","I18nService","WebpanelData","WebpanelActualUser","ModelHmiUser",function(e,r,n,o,t,a,i,l,s,u,c,d){var p={open:function(e){var i=n.defer(),t=i.promise,a={backdrop:"static"!=e.backdrop||"static",keyboard:!1,backdropClick:!1,templateUrl:"html/desktop/ModalWindows/modalWindow.userLogin.html",controller:["$scope","$modalInstance",function(a,n){a.canClose=null!=c.user,a.UserName=e.defaultUserName,a.UserPassword="",r.$on("RcWareKeyDown",function(e,t){switch(t.keyCode){case 13:a.login(),r.$root.$$phase||a.$digest()}}),a.login=function(){if(a.userNameElm=$(document.body).find("#username"),a.userPasswordElm=$(document.body).find("#userpassword"),a.UserName=a.userNameElm.val(),a.UserPassword=a.userPasswordElm.val(),a.message=null,""!=a.UserName){var t=u.hashPassword(a.UserName,a.UserPassword);l.Login(a.UserName,t).success(function(){var e=new d({name:a.UserName,password:t,isDefault:a.UserName==u.webpanelDef.defaultUser});c.setUser(e),i.resolve(e),n.close("close")}).error(function(e){a.message=null==e?"PLC isn't responding":"error"==e?"Wrong username or password":"PLC isn't responding"})}},a.close=function(){a.isVisible=!1,i.reject(),n.close("close")}}]};return o.open(a).success(function(){}).error(function(){}),t}};return p}]),esgAngularDependencies.push("RcWareVisionDateTimeEditModalWindow"),angular.module("RcWareVisionDateTimeEditModalWindow",[]).factory("EsgDateTimeEditModal",["$log","ESGPromise","EsgModalWindow","BrowserDetection","$timeout","$filter","I18nService",function(e,n,i,o,t,a,r){var l={open:function(e){var r=n.defer(),t=r.promise,a={backdrop:!0,keyboard:!1,backdropClick:!1,templateUrl:"html/desktop/ModalWindows/modalWindow.dateTimeEdit.html",windowClass:"initModalWindow",controller:["$scope","$modalInstance",function(n,i){n.value=e.gadgetValueObj.value,n.timezone=e.timezone,n.title=e.title,n.modalElement=$(document).find("initModalWindow")[0],n.focusSet=!0,n.dp=e.dp,n.showDate=0!=e.showDate,n.showTime=0!=e.showTime,n.isVisible=!0,n.message={value:""},n.padNumber=function(e,t,a){var n="";for(e<0&&(n="-",e=-e),e=""+e;e.length<t;)e="0"+e;return a&&(e=e.substr(e.length-t)),n+e},n.dateOptions={dateFormat:"d.m.yy",changeMonth:!0,changeYear:!0,yearRange:"c-10:c+10",firstDay:1,minDate:"1.1.2000",everyYearChar:!0},n.dateFrom={value:n.value.value.getUTCDate()+"."+(n.value.value.getUTCMonth()+1)+"."+n.value.value.getUTCFullYear()},n.timeFrom={value:n.padNumber(n.value.value.getUTCHours(),2)+":"+n.padNumber(n.value.value.getUTCMinutes(),2)+":"+n.padNumber(n.value.value.getUTCSeconds(),2)},o.isTabletVariable?n.ipadClass="device-ipad-scroll":n.ipadClass="device-nonipad",n.save=function(){var e=n.dateFrom.value.split("."),t=n.timeFrom.value.split(":"),a=new Date(parseInt(e[2]),parseInt(e[1])-1,parseInt(e[0]));a.setUTCHours(parseInt(t[0])),a.setUTCMinutes(parseInt(t[1])),a.setUTCSeconds(parseInt(t[2])),a.setUTCDate(parseInt(e[0])),a.setUTCMonth(parseInt(e[1])-1),a.setUTCFullYear(parseInt(e[2])),r.resolve(a),i.close("close")},n.close=function(){n.isVisible=!1,r.reject(),i.close("close")}}]};return i.open(a).success(function(){}).error(function(){}),t}};return l}]),esgAngularDependencies.push("RcWareVisionConfirmAction"),angular.module("RcWareVisionConfirmAction",[]).factory("EsgConfirmAction",["$log","$timeout","ESGPromise","EsgModalWindow","RcWareVisionAPI",function(e,t,i,r,a){var n={open:function(a){var n=i.defer(),e=n.promise,t={backdrop:!0,keyboard:!1,backdropClick:!1,templateUrl:"html/desktop/modalWindow/modalWindow.confirmAction.html",windowClass:"initModalWindow",controller:["$scope","$modalInstance",function(e,t){e.message=a,e.confirm=function(){n.resolve(!0),t.close("close")},e.close=function(){n.resolve(!1),t.close("close")}}]};return r.open(t).success(function(){}).error(function(){}),e}};return n}]),esgAngularDependencies.push("RcWareVisionGraphExport"),angular.module("RcWareVisionGraphExport",[]).factory("EsgGraphExport",["$log","ESGPromise","EsgModalWindow","$filter",function(e,i,r,o){var t={open:function(a){var e=i.defer(),t=e.promise,n={backdrop:!0,keyboard:!1,backdropClick:!1,templateUrl:"html/desktop/ModalWindows/modalWindow.graphExport.html",windowClass:"serverStats",controller:["$scope","$modalInstance",function(t,e){t.settingsFunctions=a.functions,t.equidistantIntervals=[{name:"Week",value:6048e5},{name:"Day",value:864e5},{name:o("i18n")("$ hour",3),value:108e5},{name:"Hour",value:36e5},{name:"30 min",value:18e5},{name:"15 min",value:9e5},{name:"5 min",value:3e5},{name:"1 min",value:6e4}],t.currentEquidistantInterval=t.equidistantIntervals[1],t.setEquidistantInterval=function(e){t.currentEquidistantInterval=t.equidistantIntervals[e]},t.set=function(){e.close("close")},t.close=function(){e.close("close")}}]};return r.open(n).success(function(){e.reject()}).error(function(){e.reject()}),t}};return t}]),esgAngularDependencies.push("RcWareVisionChangeRangeTable"),angular.module("RcWareVisionChangeRangeTable",[]).factory("EsgChangeRangeTable",["$log","ESGPromise","EsgModalWindow","$filter",function(e,n,i,r){var t={open:function(s){var e=n.defer(),t=e.promise,a={backdrop:!0,keyboard:!1,backdropClick:!1,templateUrl:"html/desktop/modalWindow/modalWindow.changeRangeTable.html",windowClass:"serverStats",controller:["$scope","$modalInstance",function(o,l){var e=r("dateFormatCSharp")(s.tableDataFrom,"dd\".\"MM'.'yyyy"),t=r("dateFormatCSharp")(s.tableDataTo,"dd\".\"MM'.'yyyy"),a=r("dateFormatCSharp")(s.tableDataFrom,"HH|:mm"),n=r("dateFormatCSharp")(s.tableDataTo,"HH|:mm"),i=s.dateOptions;o.title=s.tablePrintTitle,o.graphDateFrom=e,o.graphDateTo=t,o.timeFrom=a,o.timeTo=n,o.dateOptions=i,o.set=function(){var e=o.graphDateFrom.split("."),t=new Date(parseInt(e[2]),parseInt(e[1])-1,parseInt(e[0])),a=o.graphDateTo.split("."),n=new Date(parseInt(a[2]),parseInt(a[1])-1,parseInt(a[0])),i=o.timeFrom.split(":"),r=o.timeTo.split(":");t.setHours(i[0],i[1],0,0),n.setHours(r[0],r[1],0,0),t.getTime()<n.getTime()?(s.tableForceUpdate({forceUpdate:!0,from:t,to:n}),s.setAlarmHistoryUrl(),l.close("close")):alert("Wrong date range!")},o.close=function(){l.close("close")},o.setDefault=function(){s.tableForceUpdate({forceUpdate:!0}),l.close("close")}}]};return i.open(a).success(function(){e.reject()}).error(function(){e.reject()}),t}};return t}]),esgAngularDependencies.push("RcWareVisionInitModalWindow"),angular.module("RcWareVisionInitModalWindow",[]).factory("EsgInitModal",["$log","ESGPromise","EsgModalWindow","BrowserDetection","$timeout","$filter","EsgTimeSpan","$rootScope","ESGDigest",function(e,i,r,l,s,u,c,d,p){var t={open:function(t){var a=i.defer(),e=a.promise,n={backdrop:!0,keyboard:!1,backdropClick:!1,templateUrl:"html/desktop/ModalWindows/modalWindow.init.html",windowClass:"initModalWindow",controller:["$scope","$modalInstance",function(o,e){null!=t.valueRange&&(null!=t.valueRange.min&&(o.valueMin=t.valueRange.min.value),null!=t.valueRange.max&&(o.valueMax=t.valueRange.max.value)),o.step=t.valueStep,o.value={value:t.value,inputValue:""},o.valueType={value:t.valueType},"timespan"==o.valueType.value&&(o.timespan=new c(o.value.value)),o.dpName=t.name,o.modalElement=$(document).find("initModalWindow")[0],o.focusSet=!0,o.title=t.title,o.dp=t.dp,o.isVisible=!0,o.message={value:""},d.$on("RcWareKeyDown",function(e,t){switch(t.keyCode){case 13:o.save()}p(d)}),o.valueMinShow=function(){return null!=o.valueMin},o.valueMaxShow=function(){return null!=o.valueMax},l.isTabletVariable?o.ipadClass="device-ipad-scroll":o.ipadClass="device-nonipad",o.detectEnter=function(e){window.event&&event;switch(e.charCode){case 13:o.save()}},o.updateValueFromInput=function(e){if("text"==o.valueType.value)o.value.value=o.value.inputValue;else try{o.value.value=new Big(o.value.inputValue)}catch(e){}o.rawInputValue=o.value.inputValue},o.$watch("value.value",function(e){null!=e&&("function"==typeof e.toString?"-0"==o.rawInputValue?o.value.inputValue=o.rawInputValue:(o.value.inputValue=e.toString(),"function"==typeof e.toFixed&&-1<o.value.inputValue.indexOf("e-")&&(o.value.inputValue=e.toFixed(0))):o.value.inputValue=e)}),o.$watch("modalElement.clientWidth",function(e){o.focusSet&&s(function(){$(document).find(".modal-window-init-input")[0].select(),$(document).find(".modal-window-init-input")[0].onkeypress=o.detectEnter,o.focusSet=!1},100)}),o.validateValueFormat=function(e){if("90d4f1b9-c18c-4ce9-9799-d1475d949139"==o.valueType)return!isNaN(e)||!isNaN(e.replace(",","."));if("cf56eb71-1737-44d1-9c24-73f0728fd58b"!=o.valueType)return!0;return null!=/^(-|)?P([0-9]+Y|)?([0-9]+M|)?([0-9]+D|)?T?([0-9]+H|)?([0-9]+M|)?([0-9]+S|)?$/.exec(e)},o.validateValueRange=function(e,t,a){if("timespan"==o.valueType.value){var n=new c(e).getTimeSpanSeconds();if(null!=t)var i=t.getTimeSpanSeconds();if(null!=a)var r=a.getTimeSpanSeconds()}else n=parseFloat(e),i=parseFloat(t),r=parseFloat(a);return!(null!=i&&n<i)&&!(null!=r&&r<n)},o.changeValue=function(){o.value.value=o.timespan.timeSpanToString()},o.$watch("value.value",function(e,t){o.validateValueFormat(o.value.value)?o.validateValueRange(o.value.value,o.valueMin,o.valueMax)?o.message.value="":o.message.value=u("i18n")("Value not allowed"):o.message.value=u("i18n")("Wrong value format")}),o.save=function(){o.validateValueFormat(o.value.value)&&o.validateValueRange(o.value.value,o.valueMin,o.valueMax)&&("timestamp"==o.valueType.value&&void 0!==o.value.value.replace?a.resolve(o.value.value.replace(",",".")):a.resolve(o.value.value),e.close("close"))},o.close=function(){o.isVisible=!1,a.reject(),e.close("close")}}]};return r.open(n).success(function(){}).error(function(){}),e}};return t}]),esgAngularDependencies.push("RcWareVisionAboutBox"),angular.module("RcWareVisionAboutBox",[]).factory("EsgCreateAboutBox",["$log","ESGPromise","EsgModalWindow","ESGVisionConfig","I18nService","$location","WebpanelActualUser",function(e,n,i,r,o,l,s){var t={open:function(e){var t=n.defer().promise,a={backdrop:!0,keyboard:!1,backdropClick:!1,templateUrl:"html/desktop/modalWindow/modalWindow.about.html",windowClass:"initModalWindow",controller:["$scope","$modalInstance",function(e,t){e.appVersion=r.appVersion,e.ESGVisionConfig=r,e.I18nService=o,e.WebpanelActualUser=s,e.location=l,e.navigator=navigator,e.actualYear=(new Date).getFullYear(),e.message="",e.label=l.$$absUrl,e.close=function(){t.close("close")}}]};return i.open(a).success(function(){}).error(function(){}),t}};return t}]),esgAngularDependencies.push("RcWareVisionDigitalSetter"),angular.module("RcWareVisionDigitalSetter",[]).factory("EsgDigitalSetterModal",["$log","ESGPromise","EsgModalWindow","BrowserDetection","$timeout","$filter","EsgTimeSpan","$rootScope",function(e,i,r,o,t,a,n,l){var s={open:function(e){var n=i.defer(),t=n.promise,a={backdrop:!0,keyboard:!1,backdropClick:!1,templateUrl:"html/desktop/ModalWindows/modalWindow.digitalSetter.html",windowClass:"initModalWindow",controller:["$scope","$modalInstance",function(t,a){t.statesDefinition=e.statesDefinition,t.value={value:e.value},t.actualState=e.actualState,t.dpName=e.name,t.modalElement=$(document).find("initModalWindow")[0],t.focusSet=!0,t.title=e.title,t.dp=e.dp,t.isVisible=!0,t.message={value:""},o.isTabletVariable?t.ipadClass="device-ipad-scroll":t.ipadClass="device-nonipad",t.buttonIsActive=function(e){return t.actualState==e},t.actionButtonClicked=function(e){n.resolve(e),a.close("close")},t.save=function(){t.validateValueFormat(t.value.value)&&t.validateValueRange(t.value.value,t.valueMin,t.valueMax)&&("90d4f1b9-c18c-4ce9-9799-d1475d949139"==t.valueType&&void 0!==t.value.value.replace?n.resolve(t.value.value.replace(",",".")):n.resolve(t.value.value),a.close("close"))},t.close=function(){t.isVisible=!1,n.reject(),a.close("close")}}]};return r.open(a).success(function(){}).error(function(){}),t}};return s}]),esgAngularDependencies.push("RcWareVisionGraphSelectTimeRange"),angular.module("RcWareVisionGraphSelectTimeRange",[]).factory("EsgGraphSelectTimeRange",["$log","ESGPromise","EsgModalWindow","$filter","I18nService",function(e,r,s,u,c){var t={open:function(n,o,e,t){var l=r.defer(),a=l.promise,i={backdrop:!0,keyboard:!1,backdropClick:!1,templateUrl:"html/desktop/modalWindow/modalWindow.graphSelectTimeRange.html",windowClass:"serverStats",controller:["$scope","$modalInstance",function(i,r){i.graphDateFrom="",i.graphDateTo="",i.label=n;var e=o.getFromTo(o.additionalSettingsGraph.graphTimeRange.interval,o.additionalSettingsGraph.intervalFromTo);i.graphDate={},i.graphDate.from=u("dateFormatCSharp")(e.from,"dd\".\"MM'.'yyyy"),i.graphDate.to=u("dateFormatCSharp")(e.to,"dd\".\"MM'.'yyyy"),i.dateOptions=o.dateOptions,i.isNewSetSameEnd=i.isNew;var t=c.getDateTimeFormat("month"),a=c.getDateTimeFormat("shortday");null!=t&&(i.dateOptions.monthNamesShort=t),null!=a&&(i.dateOptions.dayNamesMin=a),i.set=function(){var e=i.graphDate.from.split("."),t=new Date(parseInt(e[2]),parseInt(e[1])-1,parseInt(e[0])),a=i.graphDate.to.split("."),n=new Date(parseInt(a[2]),parseInt(a[1])-1,parseInt(a[0]));t.setHours(0,0,0,0),n.setHours(23,59,59,999),t.getTime()<n.getTime()?(r.close("close"),o.additionalSettingsGraph.intervalFromTo.from=t,o.additionalSettingsGraph.intervalFromTo.to=n,l.resolve()):alert("Wrong date range!")},i.close=function(){l.reject(),r.close("close")}}]};return s.open(i).success(function(){l.reject()}).error(function(){l.reject()}),a}};return t}]),esgAngularDependencies.push("ESGTpgEditor"),angular.module("ESGTpgEditor",[]).directive("wpTpgValueSelect",["$log","$locale","$filter","$timeout",function(e,t,a,i){return{transclude:!1,templateUrl:"html/templates/modules/tpg/tpg.wpTpgValueSelectTemplate.html",replace:!0,restrict:"E",scope:{selectValue:"=",selectPossibleValues:"=",disableSelection:"=",tpgValueChanged:"="},link:function(a,e,t,n){return a.selectIndexType=typeof a.selectValue,a.selectElm=e.find("select"),a.selectElm.bind("change",function(){var e=this;a.$apply(function(){"number"==a.selectIndexType&&0==isNaN(angular.element(e).value)?a.selectValue=a.selectPossibleValues[a.selectPossibleValuesItem[parseInt(angular.element(e).val())].index].value:a.selectValue=a.selectPossibleValues[a.selectPossibleValuesItem[angular.element(e).val()].index].value,null!=a.tpgValueChanged&&i(function(){a.tpgValueChanged()},0)})}),a.$watch("selectPossibleValues",function(e){void 0!==e&&(void 0===a.selectPossibleValues[a.selectValue]?void 0!==a.selectPossibleValues.unknown&&(a.actualSelectValueTitle=a.selectPossibleValues.unknown.title):a.actualSelectValueTitle=a.selectPossibleValues[a.selectValue].title)}),a.selectPossibleValuesItem={},angular.forEach(a.selectPossibleValues,function(e,t){void 0!==a.selectPossibleValues[a.selectValue]&&"unknown"==e.value||(a.selectPossibleValuesItem[e.value]={value:e.value,title:e.title},void 0===a.selectPossibleValuesItem[e.value].weight&&(a.selectPossibleValuesItem[e.value].weight=t+1),a.selectPossibleValuesItem[e.value].index=t)}),a.selectStyle=t.style,["$scope","iElement","iAttrs","controller",function(e,t,a,n){}]},controller:["$scope",function(t){void 0===t.disableSelection?t.disableSelectionElem=!1:t.disableSelectionElem=t.disableSelection,t.isSelected=function(e){return t.evalValue(e.value)==t.evalValue(t.selectValue)},t.showOption=function(e){if(void 0!==t.selectPossibleValues[t.evalValue(t.selectValue)]&&"unknown"==e.value)return!0},t.evalValue=function(e){return"object"==typeof e&&"function"==typeof e.toString?e.toString():e}}]}}]).directive("ngModelInputOnblurTPG",function(){return{restrict:"A",require:"ngModel",link:function(e,t,a,n){"radio"!==a.type&&"checkbox"!==a.type&&(t.unbind("input").unbind("keydown").unbind("change"),t.bind("blur",function(){e.$apply(function(){n.$setViewValue(t.val())})}))}}}).directive("wpTpgTimeSelectRegular",["$locale","$log","$timeout",function(e,t,i){function r(e,t){var a=t-e.toString().length+1;return Array(+(0<a&&a)).join("0")+e}return{transclude:!1,templateUrl:"html/templates/modules/tpg/tpg.wpTpgTimeSelectRegularTemplate.html",replace:!1,restrict:"E",scope:{wpTpg:"=",itemsDayWeek:"=",wpDisableSelectionTime:"=",tpgValueChanged:"="},link:function(e,t,a,n){return void 0===e.wpDisableSelectionTime?e.disableSelectionTime=!1:e.disableSelectionTime=e.wpDisableSelectionTime,["$scope","iElement","iAttrs","controller",function(e,t,a,n){}]},controller:["$scope",function(n){function a(){var e=Math.floor(n.wpTpg.timeMinutes/1440),t=Math.floor(n.wpTpg.timeMinutes%1440/60),a=Math.floor(n.wpTpg.timeMinutes%60);n.wpTpgIdDay=e,n.wpTpgIdHour=t,n.wpTpgIdMinute=a,n.time=r(n.wpTpgIdHour,2)+":"+r(n.wpTpgIdMinute,2)}n.$watch("time",function(e,t){e!=t&&n.setWpTpgTime()}),n.$watch("wpTpgIdDay",function(e,t){e!=t&&n.setWpTpgTime()}),n.$watch("wpTpg",function(e,t){a()}),n.language=e.id,n.setWpTpgTime=function(){var e=n.time.split(":");""!=e[0]&&""!=e[1]&&(n.wpTpg.timeMinutes=24*n.wpTpgIdDay*60+60*parseInt(e[0],10)+parseInt(e[1],10),null!=n.tpgValueChanged&&i(function(){n.tpgValueChanged()},0))},a()}]}}]).directive("wpTpgValueReal",["$log","$timeout",function(e,n){return{transclude:!1,templateUrl:"html/templates/modules/tpg/tpg.wpTpgValueRealTemplate.html",replace:!1,restrict:"E",scope:{selectValue:"=",disableModification:"=",min:"=",max:"=",step:"=",tpgValueChanged:"="},link:function(e,t,a,n){return void 0===e.disableModification?e.disableModificationValue=!1:e.disableModificationValue=e.disableModification,e.inputStyle={},["$scope","iElement","iAttrs","controller",function(e,t,a,n){}]},controller:["$scope","$log",function(a,e){a.updateValueInput=function(e){var t=new Big(a.selectValue);a.selectValue=t,"function"==typeof a.tpgValueChanged&&n(a.tpgValueChanged,0)},a.isValid=function(e){return"boolean"==typeof e&&null==a.min&&null==a.max||!(null!=a.min&&e.cmp(a.min)<0)&&!(null!=a.max&&0<e.cmp(a.max))},a.decreaseValue=function(){"number"==typeof a.selectValue?(null==a.min||a.selectValue>a.min)&&(null!=a.min&&a.selectValue-(null==a.step?1:a.step)<a.min?a.selectValue=a.min:a.selectValue=a.selectValue-(null==a.step?1:a.step),"function"==typeof a.tpgValueChanged&&n(a.tpgValueChanged,0)):0!=a.selectValue.cmp(a.min)&&(a.selectValue.minus(a.step).cmp(a.min)<0?a.selectValue=new Big(a.min):a.selectValue=a.selectValue.minus(a.step),"function"==typeof a.tpgValueChanged&&n(a.tpgValueChanged,0))},a.increaseValue=function(){"number"==typeof a.selectValue?(null==a.max||a.selectValue<a.max)&&(null!=a.max&&a.selectValue+(null==a.step?1:a.step)>a.max?a.selectValue=a.max:a.selectValue=a.selectValue+(null==a.step?1:a.step),"function"==typeof a.tpgValueChanged&&n(a.tpgValueChanged,0)):0!=a.selectValue.cmp(a.max)&&(0<a.selectValue.plus(a.step).cmp(a.max)?a.selectValue=new Big(a.max):a.selectValue=a.selectValue.plus(a.step),"function"==typeof a.tpgValueChanged&&n(a.tpgValueChanged,0))},a.$watch("selectValue",function(e){if(void 0!==e&&"."!=e[e.length-1]){null==(t=e)||"number"!=typeof t&&isNaN(t-0)?a.inputStyle={backgroundColor:"red"}:("string"==typeof e&&(a.selectValue=new Big(parseFloat(e))),0==a.isValid(a.selectValue)?a.inputStyle={backgroundColor:"red"}:a.inputStyle={})}var t})}]}}]).directive("wpTpgDisplayRegular",["$filter",function(t){return{transclude:!1,templateUrl:"html/templates/modules/tpg/tpg.wpTpgDisplayRegularTemplate.html",replace:!1,restrict:"E",scope:{wpTpgType:"=",tpgItemNewValueDefault:"=",tpgArray:"=",itemsDayWeek:"=",wpSourceType:"=",tpgValues:"=tpgValues",tpgPossibleValues:"=",userSettingItem:"=",tpgSettings:"="},link:function(e,t,a,n){return e.changeItem=function(e,t){e},["$scope","iElement","iAttrs","controller",function(e,t,a,n){}]},controller:["$scope","$log",function(a,e){a.newTpg=new TpgItemValue({timeMinutes:0,value:a.tpgItemNewValueDefault}),a.tpgValueChanged=function(){a.tpgSettings.countTpgTransitions(a.tpgArray)},a.wpTpgItemDelete=function(e){var t=a.tpgArray.indexOf(e);a.tpgArray.splice(t,1),a.tpgSettings.countTpgTransitions(a.tpgArray)},a.wpTpgItemChangeValue=function(e){e.value=!e.value,a.tpgSettings.countTpgTransitions(a.tpgArray)},a.wpTpgAddItem=function(){a.tpgArray.push(a.newTpg);var e=t("orderBy")(a.tpgArray,"timeMinutes");a.tpgArray.length=0,angular.forEach(e,function(e){a.tpgArray.push(e)}),a.newTpg={},a.newTpg=new TpgItemValue({timeMinutes:0,value:a.tpgItemNewValueDefault}),a.tpgSettings.countTpgTransitions(a.tpgArray)},a.tpgValueClass=function(e){return 1==e?"trueClass":"falseClass"}}]}}]).directive("wpTpgDisplayException",["$filter","$log","ESGVisionConfig",function(e,t,s){return{transclude:!1,templateUrl:"html/templates/modules/tpg/tpg.wpTpgDisplayExceptionTemplate.html",replace:!1,restrict:"E",scope:{wpTpgType:"=",tpgItemNewValueDefault:"=",tpgArray:"=",wpSourceType:"=",tpgPossibleValues:"=",userSettingItem:"=",tpgSettings:"="},link:function(e,t,a,n){return["$scope","iElement","iAttrs","controller",function(e,t,a,n){}]},controller:["$scope","$filter",function(a,o){function e(){for(var e,t=new Date,a=1,n=t.getDate()-1,i=(e=parseInt(o("date")(t,"yyyy")),!0===s.TpgEveryYearIsLeap||!(new Date(e,1,29).getMonth()-1));a<=t.getMonth();)n+=l(a,i),a++;var r=new Big(n).times(1440).plus(60*t.getHours()+t.getMinutes());return parseInt(r.toFixed(0))}var l=function(e,t){var a=31;return 4!=e&&6!=e&&9!=e&&11!=e||(a=30),2==e&&(a=t?29:28),a};a.tpgNewItem=new TpgExceptionValue({timeMinutesFrom:parseInt(e()),timeYearFrom:parseInt(o("date")(new Date,"yyyy")),timeMinutesTo:parseInt(e()+1),timeYearTo:parseInt(o("date")(new Date,"yyyy")),value:a.tpgItemNewValueDefault}),a.wpTpgItemDelete=function(e){var t=a.tpgArray.indexOf(e);a.tpgArray.splice(t,1),a.tpgValueChanged()},a.wpTpgItemChangeValue=function(e){e.value=!e.value},a.wpTpgItemChangeValueNew=function(e){a.tpgItemNewValue=!a.tpgItemNewValue},a.wpTpgAddItem=function(){a.tpgArray.push(a.tpgNewItem),a.tpgNewItem={},a.tpgNewItem=new TpgExceptionValue({timeMinutesFrom:a.tpgArray[a.tpgArray.length-1].timeMinutesFrom,timeYearFrom:a.tpgArray[a.tpgArray.length-1].timeYearFrom,timeMinutesTo:a.tpgArray[a.tpgArray.length-1].timeMinutesFrom+1,timeYearTo:a.tpgArray[a.tpgArray.length-1].timeYearFrom,value:a.tpgItemNewValueDefault}),a.tpgValueChanged()},a.tpgValueChanged=function(){a.tpgSettings.countTpgExceptions(a.tpgArray)},a.tpgValueClass=function(e){return 1==e?"trueClass":"falseClass"},a.updateValueInput=function(e){e.value=new Big(e.value)}}]}}]).directive("wpTpgTimeSelectException",["ESGVisionConfig",function(r){function o(e,t,a){var n="";for(e<0&&(n="-",e=-e),e=""+e;e.length<t;)e="0"+e;return a&&(e=e.substr(e.length-t)),n+e}return{transclude:!0,templateUrl:"html/templates/modules/tpg/tpg.wpTpgTimeSelectExceptionTemplate.html",replace:!0,restrict:"E",scope:{wpTpg:"=",wpDisableSelectionTime:"=",isNew:"=",tpgValueChanged:"="},link:function(e,t,a,n){return void 0===e.wpDisableSelectionTime?e.disableSelectionTime=!1:e.disableSelectionTime=e.wpDisableSelectionTime,["$scope","iElement","iAttrs","controller",function(e,t,a,n){}]},controller:["$scope","$filter","$log","I18nService",function(s,e,t,a){var n,i;s.dateOptions={dateFormat:"dd.mm.yy",changeMonth:!0,changeYear:!0,yearRange:"c-10:c+10",firstDay:1,minDate:"01.01.2000",everyYearChar:!0},s.isNewSetSameEnd=s.isNew,n=a.getDateTimeFormat("month"),i=a.getDateTimeFormat("shortday"),null!=n&&(s.dateOptions.monthNamesShort=n),null!=i&&(s.dateOptions.dayNamesMin=i),s.leapYear=1972,s.errorDate={from:!1,to:!1},s.validateDate=function(e,t){var a=e.split(".");if(3!=a.length)return!0;var n="*"!=a[2]?parseInt(a[2]):s.leapYear,i=new timezoneJS.Date(n,parseInt(a[1])-1,parseInt(a[0]),0,0,0);if(isNaN(i.getTime()))return!0;if(31<parseInt(a[0]))return!0;if(i.getDate()!=parseInt(a[0])||i.getMonth()!=parseInt(a[1])-1||i.getFullYear()!=n)return!0;if(12<parseInt(a[1]))return!0;var r=new Date;return parseInt(a[2])>r.getFullYear()+20||parseInt(a[2])<r.getFullYear()-20},s.$watch("wpTpg",function(e,t){d()}),s.$watch("dateTo",function(e,t){e!=t&&null!=e&&(s.errorDate.to=s.validateDate(e),s.setWpTpgTimeTo())}),s.$watch("dateFrom",function(e,t){e!=t&&null!=e&&(s.errorDate.from=s.validateDate(e),s.setWpTpgTimeFrom("date"))}),s.$watch("timeTo",function(e,t){e!=t&&s.setWpTpgTimeTo()}),s.$watch("timeFrom",function(e,t){e!=t&&s.setWpTpgTimeFrom("time")});var u=function(e,t){var a=31;return 4!=e&&6!=e&&9!=e&&11!=e||(a=30),2==e&&(a=t?29:28),a};function c(e){return!0===r.TpgEveryYearIsLeap||!(new Date(e,1,29).getMonth()-1)}function d(){for(var e=1,t=Math.floor(s.wpTpg.timeMinutesFrom/1440)+1,a=c(s.wpTpg.timeYearFrom);t>u(e,a);)t-=u(e,a),e++;e=e<=12?e:12,s.wpTpgIdMonthFrom=o(e,2),s.wpTpgIdDayFrom=o(t,2),s.wpTpgIdHourFrom=o(Math.floor(s.wpTpg.timeMinutesFrom%1440/60),2),s.wpTpgIdMinuteFrom=o(s.wpTpg.timeMinutesFrom%60,2),s.wpTpg.timeYearFrom!=s.leapYear?s.dateFrom=s.wpTpgIdDayFrom+"."+s.wpTpgIdMonthFrom+"."+s.wpTpg.timeYearFrom:s.dateFrom=s.wpTpgIdDayFrom+"."+s.wpTpgIdMonthFrom+".*",s.timeFrom=s.wpTpgIdHourFrom+":"+s.wpTpgIdMinuteFrom;var n=1,i=Math.floor(s.wpTpg.timeMinutesTo/1440)+1;for(a=c(s.wpTpg.timeYearTo);i>u(n,a);)i-=u(n,a),n++;n=n<=12?n:12,s.wpTpgIdMonthTo=o(n,2),s.wpTpgIdDayTo=o(i,2),s.wpTpgIdHourTo=o(Math.floor(s.wpTpg.timeMinutesTo%1440/60),2),s.wpTpgIdMinuteTo=o(s.wpTpg.timeMinutesTo%60,2),s.wpTpg.timeYearTo!=s.leapYear?s.dateTo=s.wpTpgIdDayTo+"."+s.wpTpgIdMonthTo+"."+s.wpTpg.timeYearTo:s.dateTo=s.wpTpgIdDayTo+"."+s.wpTpgIdMonthTo+".*",s.timeTo=s.wpTpgIdHourTo+":"+s.wpTpgIdMinuteTo}s.setWpTpgTimeFrom=function(e){var t=!1,a=s.dateFrom.split("."),n=s.timeFrom.split(":");"*"==a[2]&&(a[2]=s.leapYear,s.wpTpg.timeYearTo=parseInt(s.leapYear),t=!0),s.wpTpg.timeYearTo==s.leapYear&&(s.wpTpg.timeYearTo=a[2],t=!0);var i=1,r=parseInt(a[0])-1;s.wpTpg.timeYearFrom=parseInt(a[2],10);for(var o=c(parseInt(a[2]));i<parseInt(a[1]);)r+=u(i,o),i++;12<i&&(s.wpTpg.timeYearFrom+=Math.floor(i/12),i%=12);var l=new Big(r).times(1440).plus(60*parseInt(n[0])+parseInt(n[1]));s.wpTpg.timeMinutesFrom=parseInt(l.toFixed(0)),1==s.isNewSetSameEnd&&"date"==e&&(s.wpTpg.timeYearTo=s.wpTpg.timeYearFrom,s.wpTpg.timeMinutesTo=s.wpTpg.timeMinutesFrom+1,s.isNewSetSameEnd=!1),t&&d(),null!=s.tpgValueChanged&&s.tpgValueChanged()},s.setWpTpgTimeTo=function(){var e=!1,t=s.dateTo.split("."),a=s.timeTo.split(":");"*"==t[2]&&(t[2]=s.leapYear,s.wpTpg.timeYearFrom=parseInt(s.leapYear),e=!0),s.wpTpg.timeYearFrom==s.leapYear&&(s.wpTpg.timeYearFrom=t[2],e=!0);var n=parseInt(t[0])-1;s.wpTpg.timeYearTo=parseInt(t[2],10);for(var i=c(parseInt(t[2])),r=1;r<parseInt(t[1]);)n+=u(r,i),r++;12<r&&(s.wpTpg.timeYearTo+=Math.floor(r/12),r%=12);var o=new Big(n).times(1440).plus(60*parseInt(a[0])+parseInt(a[1]));s.wpTpg.timeMinutesTo=parseInt(o.toFixed(0)),s.isNewSetSameEnd=!1,e&&d(),null!=s.tpgValueChanged&&s.tpgValueChanged()},d()}]}}]).directive("wpTpgDrawSelect",["$log","$filter","$window","ApiWinResize","EsgColor",function(e,A,t,u,y){function f(e,t){var a=t-e.toString().length+1;return Array(+(0<a&&a)).join("0")+e}return{transclude:!1,templateUrl:"html/templates/modules/tpg/tpg.wpTpgDrawSelectTemplate.html",replace:!0,restrict:"E",scope:{tpgArray:"=wpTpgArray",wpSourceType:"=",tpgValues:"=",newTpgValue:"=",tpgPossibleValues:"=",itemsDayWeek:"=",tpgIsVisible:"=",tpgRoundTo:"=",tpgRoundToValues:"=",userSettingItem:"=",errorMessage:"=",isVisible:"=",tpgSettings:"="},link:function(n,i,e,t){var a=i.find("#myCanvasSelection"),r=$(i).find(".canvas-background");function o(e){0!=n.tpgArray.length&&"BUTTON"!=e.target.tagName&&"INPUT"!=e.target.tagName&&"SELECT"!=e.target.tagName&&(n.selectClick?n.selectClick=!1:(n.selectionActive=!0,n.setSelectionStart(e),$(r).css("zIndex",1),$(document).bind("mousemove",l),$(document).on("selectstart",!1)))}function l(e){0!=n.tpgArray.length&&"BUTTON"!=e.target.tagName&&"INPUT"!=e.target.tagName&&"SELECT"!=e.target.tagName&&(e.preventDefault(),n.selectionActive&&n.userSettingItem&&(e.preventDefault(),n.draged=!0,n.drawSelect(e),n.showAdditionalInfo(e,!1)))}function s(e){0!=n.tpgArray.length&&"BUTTON"!=e.target.tagName&&"INPUT"!=e.target.tagName&&"SELECT"!=e.target.tagName&&($(r).css("zIndex",-1),n.selectionActive=!1,n.draged&&(n.draged=!1,n.makeTpgFromSelection(e),n.drawTpgItem(),n.actualSelection={start:{x:0,y:0},ctx:{x:0,y:0,w:0,h:0}},n.showAdditionalInfo(e),$(document).unbind("mousemove",l)))}return n.canvasElement=a,n.element=i,n.ApiWinResize=u,n.canvasDocumentPositionSetted=!1,n.canvasDocumentPosition={topX:null,topY:null,height:i[0].clientHeight,width:i[0].clientWidth},n.$watch("ApiWinResize.size.ratio",function(e,t){n.canvasDocumentPositionSetted=!1}),n.getDevicePixelRatio=function(){return 1},n.setcanvasDocumentPosition=function(e){n.canvasDocumentPositionSetted=!0,n.canvasDocumentPosition={topX:null,topY:null,height:i[0].clientHeight,width:i[0].clientWidth},n.mainModalElement=n.getMainModalElement(i,"modal");var t=null==e.offsetX?e.originalEvent.layerX:e.offsetX,a=null==e.offsetY?e.originalEvent.layerY:e.offsetY;n.canvasDocumentPosition.topX=e.screenX/n.getDevicePixelRatio()-t,n.canvasDocumentPosition.topY=e.screenY/n.getDevicePixelRatio()-a-n.mainModalElement.scrollTop(),0!=n.actualSelection.start.x&&0!=n.actualSelection.start.y&&(n.actualSelection.start.x=n.actualSelection.start.x-n.canvasDocumentPosition.topX,n.actualSelection.start.y=n.actualSelection.start.y-n.canvasDocumentPosition.topY,n.actualSelection.start.x<0&&(n.actualSelection.start.x=0),n.actualSelection.start.x>n.canvasDocumentPosition.width&&(n.actualSelection.start.x=n.canvasDocumentPosition.width),n.actualSelection.start.y<0&&(n.actualSelection.start.y=0),n.actualSelection.start.y>n.canvasDocumentPosition.height&&(n.actualSelection.start.y=n.canvasDocumentPosition.height))},n.getMainModalElement=function(e,t){for(var a=e;a=$(a).parent(),!$(a).hasClass(t););return a},n.isMouseDown=!1,n.$watch("tpgIsVisible",function(e){"udnefined"!=typeof e&&(1==e?($(document).bind("mouseup",s),n.userSettingItem&&($(n.element).bind("mousedown",o),$(n.element).bind("mousemove",l),$(n.element).bind("mouseup",s))):($(i[0].children[0]).unbind("mousedown",o),$(i[0].children[0]).unbind("mousemove",l),$(i[0].children[0]).unbind("mouseup",s)))}),n.selectClick=!1,$(n.element).find(".select-background").bind("mousedown",function(e){n.selectClick=!0}),$(a).on("mousedown",function(e){n.selectionActive=!0,0==n.canvasDocumentPositionSetted&&n.setcanvasDocumentPosition(e),n.setSelectionStart(e),e.preventDefault()}),$(a).on("mouseup",function(e){n.selectionActive=!1,n.draged||(n.highlightSelectedTpg(),n.drawTpgItem())}),$(a).on("mousemove",function(e){n.showAdditionalInfo(e),0==n.canvasDocumentPositionSetted&&n.setcanvasDocumentPosition(e)}),n.element=i[0],n.$watch("isVisible",function(e,t){1==e&&n.drawTpgItem()}),["$scope","iElement","iAttrs","controller",function(e,t,a,n){}]},controller:["$scope","$log",function(D,e){function n(e){var t="0123456789ABCDEF",a=e%16;return t.charAt((e-a)/16)+t.charAt(a)}D.draged=!1,D.selection={first:{x:-1,y:-1},second:{x:-1,y:-1},show:!1,active:!1},D.selectionActive=!1,D.savedhandlers={},D.mouseUpHandler=null,D.selection={mode:null,color:"#e8cfac",shape:"round",minSize:5},D.canvasPx={x:26,y:32},D.actualSelection={start:{x:0,y:0},ctx:{x:0,y:0,w:0,h:0}},D.highlightedTpgItem=!1,D.showAdditionalInfo=function(e,t){void 0===t&&(t=!0);$(window).scrollTop();void 0===D.mainModalElement&&(D.mainModalElement=D.getMainModalElement(D.element,"modal"));null==e.offsetX?e.originalEvent.layerX:e.offsetX,null==e.offsetY?e.originalEvent.layerY:e.offsetY;var a=e.screenX/D.getDevicePixelRatio()-D.canvasDocumentPosition.topX+1,n=e.screenY/D.getDevicePixelRatio()-D.canvasDocumentPosition.topY+D.mainModalElement.scrollTop(),i=D.canvasElement[0],r=i.getContext("2d"),o=Math.round(a*(60/D.canvasPx.x)/D.tpgRoundTo)*D.tpgRoundTo;a=Math.round(o/(60/D.canvasPx.x)),1440<o?o=1440:o<0&&(o=0),a<2?a=2:a>i.width+2&&(a=i.width-2);var l=Math.floor(o/60),s=Math.ceil(o%60),u=f(l,2)+":"+f(s,2),c=24*Math.floor(n/D.canvasPx.y)*60+60*l+s;t&&r.clearRect(0,0,i.width,i.height),r.beginPath(),r.moveTo(a,0),r.lineTo(a,i.height),r.lineWidth=2,r.strokeStyle="#FFFFFF",r.stroke(),r.save(),r.translate(5,15),r.rotate(Math.PI/2),r.textAlign="center";Math.round(),a+18>i.width?r.fillText(u,2,17-a):r.fillText(u,2,-a),r.restore();for(var d=0;d<D.tpgArray.length&&!(D.tpgArray[d].timeMinutes>c);d++);if(!D.draged){r=i.getContext("2d");var p=Math.floor(n/D.canvasPx.y)*D.canvasPx.y;if(0==d)var g=0;else(g=(D.tpgArray[d-1].timeMinutes-24*Math.floor(n/D.canvasPx.y)*60)*(D.canvasPx.x/60))<0&&(g=0);if(void 0!==D.tpgArray[d]&&D.tpgArray[d].timeMinutes-24*Math.floor(n/D.canvasPx.y)*60<1440)var h=(D.tpgArray[d].timeMinutes-24*Math.floor(n/D.canvasPx.y)*60)*(D.canvasPx.x/60);else h=24*D.canvasPx.x;r.save(),r.fillStyle="rgba(255, 255, 255, 0.6)",r.fillRect(g,p+.5,h-g,D.canvasPx.y-.5),D.highlightedTpgItem=0<d?d-1:0,r.restore()}},D.drawBasic=function(){var e=$(D.element).find("#myCanvasTpgData")[0],t=e.getContext("2d");t.save();for(var a=1;a<=8;a++)t.beginPath(),t.moveTo(0,D.canvasPx.y*a+.5),t.lineTo(e.width,D.canvasPx.y*a+.5),t.lineWidth=1,t.strokeStyle="rgba(0,0,0,0.25)",t.stroke();t.restore();for(a=1;a<=24;a++)t.beginPath(),t.moveTo(D.canvasPx.x*a+.5,0),t.lineTo(D.canvasPx.x*a+.5,e.height),t.lineWidth=1,t.strokeStyle="rgba(0,0,0,0.25)",t.stroke();t.restore()},D.highlightSelectedTpg=function(){},D.usedColors={},D.itemColor={},D.drawTpgItem=function(){var e=$(D.element).find("#myCanvasTpgData")[0],f=e.getContext("2d");f.clearRect(0,0,e.width,e.height);var m=$(D.element).find("#myCanvasBasicInfo")[0].getContext("2d");m.clearRect(0,0,e.width,e.height);var t=A("orderBy")(D.tpgArray,"timeMinutes");D.tpgArray.length=0,angular.forEach(t,function(e){D.tpgArray.push(e)});var a,n,i,r,v,x,b,S,o=function(e,t,a,n,i){for(var r=e;r<=a;r++){x=e<r?(v=0,r*D.canvasPx.y):(v=t/(60/D.canvasPx.x),D.canvasPx.y*e),S=r<a?(b=D.canvasPx.y,24*D.canvasPx.x-v):(b=D.canvasPx.y,n*(D.canvasPx.x/60)-v);var o=null;if(void 0!==D.tpgValues[i.value])f.fillStyle=o=D.tpgValues[i.value].color;else if("t18_real_scheduler"!=D.wpSourceType)f.fillStyle=o=D.tpgValues.unknown.color;else{if(void 0===D.itemColor[i.value]){var l=16.5,s=i.value.toString();s=s.replace(".",""),s=parseInt(s);var u=Math.ceil(s/l)%l/l/l;s<0&&(s=Math.abs(s)+5.5),D.itemColor[i.value]=D.getColorOfValue(s%l/l+u)}f.fillStyle=o=D.itemColor[i.value].cssColor}if(f.fillRect(v,x,S,b),0<S){m.fillStyle=null!=o&&128<=new y(o).brightness()?"#1d1d1d":"White",m.font="bold 15px Arial";var c=i.value;if("unknown"!=(c="t18_real_scheduler"!=D.wpSourceType?void 0!==D.tpgValues[i.value]?D.tpgValues[i.value].name.toString():"unknown":c.toString())){var d=10*c.length;if(S<d){var p=Math.floor(S/10);h=(h=c).slice(0,p);var g=(S-10*h.length)/2+v}else{g=(S-d)/2+v;var h=c}m.fillText(h,g,r*D.canvasPx.y+.7*D.canvasPx.y)}else{g=(S-8*D.tpgValues.unknown.name.toString().length)/2+v;m.fillText(D.tpgValues.unknown.name,g,r*D.canvasPx.y+.7*D.canvasPx.y)}}}};0<D.tpgArray.length&&0!=D.tpgArray[0].timeMinutes&&(r=void 0!==D.tpgArray[0]?(i=Math.floor(D.tpgArray[0].timeMinutes/1440),Math.floor(D.tpgArray[0].timeMinutes%1440)):(i=6,1440),o(0,0,i,r,{value:D.tpgArray[D.tpgArray.length-1].value}));for(var l=0;l<D.tpgArray.length;l++)a=Math.floor(D.tpgArray[l].timeMinutes/1440),n=Math.floor(D.tpgArray[l].timeMinutes%1440),r=void 0!==D.tpgArray[l+1]?(i=Math.floor(D.tpgArray[l+1].timeMinutes/1440),Math.floor(D.tpgArray[l+1].timeMinutes%1440)):(i=6,1440),o(a,n,i,r,D.tpgArray[l]);D.drawBasic()},D.setSelectionStart=function(e){if(D.canvasDocumentPositionSetted){var t=e.screenX/D.getDevicePixelRatio()-D.canvasDocumentPosition.topX,a=e.screenY/D.getDevicePixelRatio()-D.canvasDocumentPosition.topY+D.mainModalElement.scrollTop();t<0&&(t=0),t>D.canvasDocumentPosition.width&&(t=D.canvasDocumentPosition.width),a<0&&(a=0),a>D.canvasDocumentPosition.height&&(a=D.canvasDocumentPosition.height),D.actualSelection.start.x=t,D.actualSelection.start.y=a}else D.actualSelection.start.x=e.screenX/D.getDevicePixelRatio(),D.actualSelection.start.y=e.screenY/D.getDevicePixelRatio()},D.drawSelect=function(e){var t,a,n,i,r=(l=D.canvasElement[0]).getContext("2d");if(r.save(),r.clearRect(0,0,l.width,l.height),D.canvasDocumentPositionSetted)t=e.screenX/D.getDevicePixelRatio()-D.canvasDocumentPosition.topX,a=e.screenY/D.getDevicePixelRatio()-D.canvasDocumentPosition.topY+D.mainModalElement.scrollTop();else{if(null==D.canvasDocumentPosition.topX&&null==D.canvasDocumentPosition.topY)return;t=D.actualSelection.start.x-D.canvasDocumentPosition.topX,a=D.actualSelection.start.y-D.canvasDocumentPosition.topY-scope.mainModalElement.scrollTop(),t>scope.canvasDocumentPosition.width&&scope.canvasDocumentPosition.width,a>scope.canvasDocumentPosition.height&&D.canvasDocumentPosition.height}t<0&&(t=0),a<0&&(a=0),t>D.canvasDocumentPosition.width&&(t=D.canvasDocumentPosition.width),a>D.canvasDocumentPosition.height&&(a=D.canvasDocumentPosition.height),i=Math.floor(D.actualSelection.start.y/D.canvasPx.y)*D.canvasPx.y<=a?(n=Math.floor(D.actualSelection.start.y/D.canvasPx.y)*D.canvasPx.y,Math.ceil(a/D.canvasPx.y)*D.canvasPx.y):(n=Math.ceil(D.actualSelection.start.y/D.canvasPx.y)*D.canvasPx.y,Math.floor(a/D.canvasPx.y)*D.canvasPx.y);var o={first:{x:D.actualSelection.start.x,y:n},second:{x:t,y:i}},l=$.color.parse(D.selection.color);if(r.strokeStyle=l.scale("a",.8).toString(),r.lineWidth=1,r.lineJoin=D.selection.shape,r.fillStyle=l.scale("a",.6).toString(),1<D.tpgRoundTo){var s=Math.round(o.first.x*(60/D.canvasPx.x)/D.tpgRoundTo)*D.tpgRoundTo;o.first.x=Math.round(s/(60/D.canvasPx.x));s=Math.round(o.second.x*(60/D.canvasPx.x)/D.tpgRoundTo)*D.tpgRoundTo;o.second.x=Math.round(s/(60/D.canvasPx.x))}var u=Math.min(o.first.x,o.second.x)+.5,c=Math.min(o.first.y,o.second.y)+.5,d=Math.abs(o.second.x-o.first.x)-1,p=Math.abs(o.second.y-o.first.y)-1;D.actualSelection.ctx={x:u,y:c,w:d,h:p},r.fillRect(u,c,d,p),r.strokeRect(u,c,d,p),r.restore()},D.makeTpgFromSelection=function(e){var t=e.screenX/D.getDevicePixelRatio()-D.canvasDocumentPosition.topX,a=e.screenY/D.getDevicePixelRatio()-D.canvasDocumentPosition.topY+D.mainModalElement.scrollTop();if(0!=D.canvasDocumentPosition.height){if(t<0&&(t=0),a<0&&(a=0),t>D.canvasDocumentPosition.width&&(t=D.canvasDocumentPosition.width),a>D.canvasDocumentPosition.height&&(a=D.canvasDocumentPosition.height),D.actualSelection.start.x>D.canvasDocumentPosition.width&&(D.actualSelection.start.x=D.canvasDocumentPosition.width),D.actualSelection.start.y>D.canvasDocumentPosition.height&&(D.actualSelection.start.y=D.canvasDocumentPosition.height),t<D.actualSelection.start.x)var n=t,i=D.actualSelection.start.x;else n=D.actualSelection.start.x,i=t;if(a<D.actualSelection.start.y)var r=a,o=D.actualSelection.start.y;else r=D.actualSelection.start.y,o=a;var l=Math.floor(r/D.canvasPx.y),s=Math.floor(o/D.canvasPx.y);if(!(6<l&&6<s)){l<0&&(l=0),6<s&&(s=6);for(var u=Math.floor(n*(60/D.canvasPx.x)+1440*l),c=Math.floor(i*(60/D.canvasPx.x)+1440*s),d=(u=Math.round(u/D.tpgRoundTo)*D.tpgRoundTo,c=Math.round(c/D.tpgRoundTo)*D.tpgRoundTo,l);d<=s;d++){var p=[],g={},h=u+1440*(d-l),f=c+1440*(d-s);f<h&&(h=c+1440*(d-s),f=u+1440*(d-l)),1440*(d+1)<f&&(f=1440*(d+1));for(var m=0,v=0;v<D.tpgArray.length;v++){if(D.tpgArray[v].timeMinutes!=h&&D.tpgArray[v].timeMinutes!=f||(p.push(v),m++),D.tpgArray[v].timeMinutes>f){g=D.tpgArray[v-1];break}v+1<D.tpgArray.length&&D.tpgArray[v].timeMinutes>h&&D.tpgArray[v+1].timeMinutes<f&&p.push(v),h<D.tpgArray[v].timeMinutes&&D.tpgArray[v].timeMinutes<f&&m++}var x=0;m-p.length==1&&(10080!=f&&D.tpgArray.push(new TpgItemValue({timeMinutes:f,value:D.tpgArray[v-1].value})),D.tpgArray[v-1].timeMinutes==f?(D.tpgArray.splice(v-2,1),v-2<=p[0]&&(x=1)):D.tpgArray.splice(v-1,1)),m-p.length==0&&void 0!==g.value?10080!=f&&D.tpgArray.push(new TpgItemValue({timeMinutes:f,value:g.value})):m-p.length==0&&void 0===g.value&&10080!=f&&D.tpgArray.push(new TpgItemValue({timeMinutes:f,value:D.tpgArray[v-1].value})),0<p.length&&D.tpgArray.splice(p[0]-x,p.length),D.tpgArray.push(new TpgItemValue({timeMinutes:h,value:D.newTpgValue}));var b=[],S="";angular.forEach(A("orderBy")(D.tpgArray,"timeMinutes"),function(e,t){D.evalValue(e.value)==D.evalValue(S)&&0!=t||(b.push(e),S=e.value)});var y=A("orderBy")(b,"timeMinutes");D.tpgArray.length=0,angular.forEach(y,function(e){D.tpgArray.push(e)})}D.tpgSettings.countTpgTransitions(D.tpgArray);var w=D.canvasElement[0].getContext("2d");w.save(),w.clearRect(D.actualSelection.ctx.x-1,D.actualSelection.ctx.y-1,D.actualSelection.ctx.w+2,D.actualSelection.ctx.h+2)}}},D.evalValue=function(e){return"object"==typeof e&&"function"==typeof e.toString?e.toString():e},D.changeNewTpgValue=function(){D.newTpgValue=!D.newTpgValue},D.newTpgValueClass=function(e){return 1==e?"trueClass":"falseClass"},D.colorsBrushes="#FF00FFFF;#FF00008B;#FF008B8B;#FFB8860B;#FFA9A9A9;#FF006400;#FFBDB76B;#FF8B008B;#FF556B2F;#FFFF8C00;#FF9932CC;#FF8B0000;#FFE9967A;#FF8FBC8F;#FF483D8B;#FF2F4F4F;#FF00CED1;#FF9400D3;#FFFF1493;#FF00BFFF;#FF696969;#FF1E90FF;#FFB22222;#FFFFFAF0;#FF228B22;#FFFF00FF;#FFDCDCDC;#FFF8F8FF;#FFFFD700;#FFDAA520;#FF808080;#FF008000;#FFADFF2F;#FFF0FFF0;#FFFF69B4;#FFCD5C5C;#FF4B0082;#FFFFFFF0;#FFF0E68C;#FFE6E6FA;#FFFFF0F5;#FF7CFC00;#FFFFFACD;#FFADD8E6;#FFF08080;#FFE0FFFF;#FFFAFAD2;#FFD3D3D3;#FF90EE90;#FFFFB6C1;#FFFFA07A;#FF20B2AA;#FF87CEFA;#FF778899;#FFB0C4DE;#FFFFFFE0;#FF00FF00;#FF32CD32;#FFFAF0E6;#FFFF00FF;#FF800000;#FF66CDAA;#FF0000CD;#FFBA55D3;#FF9370DB;#FF3CB371;#FF7B68EE;#FF00FA9A;#FF48D1CC;#FFC71585;#FF191970;#FFF5FFFA;#FFFFE4E1;#FFFFE4B5;#FFFFDEAD;#FF000080;#FFFDF5E6;#FF808000;#FF6B8E23;#FFFFA500;#FFFF4500;#FFDA70D6;#FFEEE8AA;#FF98FB98;#FFAFEEEE;#FFDB7093;#FFFFEFD5;#FFFFDAB9;#FFCD853F;#FFFFC0CB;#FFDDA0DD;#FFB0E0E6;#FF800080;#FFFF0000;#FFBC8F8F;#FF4169E1;#FF8B4513;#FFFA8072;#FFF4A460;#FF2E8B57;#FFFFF5EE;#FFA0522D;#FFC0C0C0;#FF87CEEB;#FF6A5ACD;#FF708090;#FFFFFAFA;#FF00FF7F;#FF4682B4;#FFD2B48C;#FF008080;#FFD8BFD8;#FFFF6347;#00FFFFFF;#FF40E0D0;#FFEE82EE;#FFF5DEB3;#FFFFFFFF;#FFF5F5F5;#FFFFFF00;#FF9ACD32",D.colorsBrushesArray=[],angular.forEach(D.colorsBrushes.split(";"),function(e){D.colorsBrushesArray.push(new y(e))}),D.valuesColors={},D.valuesColorCount=0,D.getColorOfValue=function(e){isNaN(e)&&(e=0);var t={};return null==D.valuesColors[e]&&(D.valuesColors[e]=D.colorsBrushesArray[D.valuesColorCount],D.valuesColorCount++),t.cssColor=D.valuesColors[e].toRGBA(),t},D.makeJetColor=function(e){var t={red:255,green:255,blue:255};e<0&&(e=0),255<e&&(e=255);var a=255;return e<63.75?(t.red=0,t.green=Math.round(4*(e-0)/a*255)):e<127.5?(t.red=0,t.blue=Math.round(255*(1+4*(63.75-e)/a))):(e<191.25?t.red=Math.round(4*(e-0-127.5)/a*255):t.green=Math.round(255*(1+4*(191.25-e)/a)),t.blue=0),t.cssColor="#"+n(t.red)+n(t.green)+n(t.blue),t}}]}}]);var TpgItemValue=function(e){this.timeMinutes=e.timeMinutes,this.value=e.value};TpgItemValue.prototype.update=function(e){this.timeMinutes=e.timeMinutes,this.value=e.value};var TpgExceptionValue=function(e){this.timeMinutesFrom=e.timeMinutesFrom,this.timeYearFrom=e.timeYearFrom,this.timeMinutesTo=e.timeMinutesTo,this.timeYearTo=e.timeYearTo,this.value=e.value,void 0!==e.id?this.id=e.id:this.id=null};function concat(e,t,a){return e.concat(e.slice.call(t,a))}function padNumber(e,t,a){var n="";for(e<0&&(n="-",e=-e),e=""+e;e.length<t;)e="0"+e;return a&&(e=e.substr(e.length-t)),n+e}TpgExceptionValue.prototype.update=function(e){this.timeMinutesFrom=e.timeMinutesFrom,this.timeYearFrom=e.timeYearFrom,this.timeMinutesTo=e.timeMinutesTo,this.timeYearTo=e.timeYearTo,this.value=e.value},esgAngularDependencies.push("RcWareVisionTimepicker"),angular.module("RcWareVisionTimepicker",[]).directive("esgTimepicker",["$timeout",function(o){return{restrict:"A",link:function(e,t,a,n){void 0!==e.$parent[a.ngModel]?t.value=e.$parent:t.value=e,t.valueName=a.ngModel,t.attr("data-toggle","timepicker"),t.parent().addClass("bootstrap-timepicker bootstrap-timepicker-22"),t.timepicker();var i=t.data("timepicker");t.on("hide",function(e){o(function(){t.value[t.valueName]=t.val()})});var r=t[0].nextSibling;$(r).on("click",function(){}),e.$on("$destroy",function(){$(i.$widget).remove()})}}}]),esgAngularDependencies.push("RcWareVisionDatepicker"),angular.module("RcWareVisionDatepicker",[]).directive("esgDatepicker",function(){return{require:"?ngModel",restrict:"A",dateFrom:"",link:function(n,i,r,o){var e,l;return l=function(e){return n.$apply(function(){return i.blur(),o.$setViewValue(e.timeStamp)})},null!=o&&(e=o.$render,o.render=function(){return e(),i.datepicker.date=o.$viewValue}),r.$observe("esgDatepicker",function(e){var t;t={},angular.isObject(e)&&(t=e),"string"==typeof e&&0<e.length&&(t=angular.fromJson(e));var a=i.siblings('[data-toggle="datepicker"]');return a.length&&a.on("click",function(){i.trigger("focus")}),void 0!==n.$parent[r.ngModel]?i.value=n.$parent:i.value=n,i.valueName=r.ngModel,i.bind("change",function(){var e=this;n.$apply(function(){return i.blur(),i.value[i.valueName]=i.val(),o.$setViewValue(angular.element(e).val())})}),o.$viewValue=i.datepicker.date,i.datepicker(t).on("close",l)})}}}),esgAngularDependencies.push("RcWareVisionServices.API"),angular.module("RcWareVisionServices.API",["ESGHelpers","ESGPromise","BrowserDetection"]).service("RcWareVisionAPI",["$log","WebpanelActualUser",function(e,a){var t={ns:{hmi:"http://dev.rcware.eu/shark-hmi",lcd:"http://dev.rcware.net/xml/esglcd"},nsResolver:function(e){return t.ns[e]||null},credentials:function(e,t){2==t?e.c={u:a.user.name,p:a.user.password}:e.cred={n:a.user.name,p:a.user.password,pe:1}}};return t}]),esgAngularDependencies.push("Webpanel.Api.GetPanels"),angular.module("Webpanel.Api.GetPanels",[]).run(["RcWareVisionAPI","ESGPromise","ESGVisionConfig","$http","ESGXmlHelper",function(r,o,l,s,e){r.GetPanels=function(e){var n=o.defer(),t=n.promise,a={ver:1};r.credentials(a,2);var i=function(e){if("ok"==e.data.code){var t=[],a={};angular.forEach(e.data.s,function(e){t.push({id:e.i,title:e.t}),a[e.i]=e.t}),n.resolve({s:t,map:a})}else n.resolve()};return e?s({method:"POST",url:l.ApiPrefix+"/schemas.cgi",data:a,headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(i).catch(function(){n.reject()}):s.get(l.ApiFilesPrefix+"/schemas.cgi"+ESGGetWebpanelVersion()).then(i).catch(function(e){n.reject()}),t}}]),esgAngularDependencies.push("Webpanel.Api.GetPanelDefinition"),angular.module("Webpanel.Api.GetPanelDefinition",[]).run(["RcWareVisionAPI","ESGPromise","ESGVisionConfig","$http","ESGXmlHelper",function(o,l,s,u,c){o.GetPanelDefinition=function(a,e){var n=l.defer(),t=n.promise,i={ver:1};o.credentials(i,2),i.s=a;var r=function(e){if(null!=e.data.code)return console.log(a+": "+e.data.msg),void n.resolve();var t=c.getDocumentFromXmlString(e.data,o.ns);0==c.getXPathResult(t,"hmi:lcdMenu",o.nsResolver,t).length?n.resolve({xmlDoc:t,type:"graphic"}):n.resolve({xmlDoc:t,type:"text"})};return e?u({method:"POST",url:s.ApiPrefix+"/schema.cgi",data:i,headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(r).catch(function(){n.reject()}):u.get(s.ApiFilesPrefix+"/"+a+".cgi"+ESGGetWebpanelVersion()).then(r).catch(function(e){n.reject()}),t}}]),esgAngularDependencies.push("Webpanel.Api.GetValues"),angular.module("Webpanel.Api.GetValues",[]).run(["RcWareVisionAPI","ESGPromise","ESGVisionConfig","$http","ESGXmlHelper","WebpanelVariable","WebpanelData",function(a,i,c,d,e,p,g){a.GetValues=function(e){var r=i.defer(),t=r.promise,n={ver:1};a.credentials(n,2);var o=[],l={},s=null;angular.forEach(e,function(e){if(null!=e.variableDef){var t="svc://"+e.variableDef.connection.name+"/"+e.variableDef.uId+"["+e.variableDef.offset+","+e.variableDef.length+"]";if(0==e.variableDef.uId&&0==e.variableDef.offset&&0==e.variableDef.length)return void(s={varRef:e.varRef,gadget:e});l[t]={varRef:e.varRef,gadget:e},o.push(t)}}),null!=s&&a.GetRtc().success(function(e){var t=s.gadget,a=new p({variableId:t.varRef,sourceType:g.typeNumToId("date")}),n=new Date,i=new Big(e).div(1e4);a.ts=new Big(n.getTime()).times(1e4).plus("621355968000000000").toFixed(0),a.value=new Date(parseInt(i.toString())-621355968e5),t.value=a}).error(function(){null!=s.gadget.value&&(s.gadget.value.quality="error")});var u=function(t){var i={};if(null!=t){var e=function(e,t){if(null==g.rspBuffSize)return 100;for(var a=g.rspBuffSize/2*(2/3),n=0,i=0;e+i<t.length&&(n+=l[t[e+i]].gadget.variableDef.length,n+=Math.ceil(t[e+i].length/2),!(a<(n+=20)))&&!(10<=i);i++);return 0==i&&(i=1),i}(t,o);n.v=o.slice(t,t+e),t+=e,angular.forEach(n.v,function(e){i[e]=l[e]})}else n.v=o,i=l;var a=function(e,a){angular.forEach(e,function(e){var t="svc://"+e.gadget.variableDef.connection.name+"/"+e.gadget.variableDef.uId+"["+e.gadget.variableDef.offset+","+e.gadget.variableDef.length+"]";1!=a[t]&&null!=e.gadget.value&&(e.gadget.value.quality="error")})};d({method:"POST",url:c.ApiPrefix+"/values.cgi",data:n,headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(e){if("ok"!=e.data.code)return angular.forEach(i,function(e){null!=e.gadget.value&&(e.gadget.value.quality="error")}),void r.reject();new Date;var n={};angular.forEach(e.data.v,function(e){try{var t=i[e.i].gadget,a=new p({variableId:t.varRef,sourceType:g.typeNumToId(parseInt(t.variableDef.type))});a.setValueFromPlcHash({ts:e.t,value:e.v}),t.value=a,n[e.i]=!0}catch(e){console.log(e)}}),a(i,n),null!=t&&t<o.length?u(t):r.resolve()}).catch(function(){r.reject(),a(i,{})})};return 0<o.length?u(0):r.resolve(),t}}]),esgAngularDependencies.push("Webpanel.Api.SendCommand"),angular.module("Webpanel.Api.SendCommand",[]).run(["RcWareVisionAPI","ESGPromise","ESGVisionConfig","$http","$timeout","ESGXmlHelper","WebpanelVariable","WebpanelData",function(n,r,o,l,e,t,a,s){n.SendCommand=function(e){var t=r.defer(),a=t.promise,i={ver:1,v:[]};return n.credentials(i,2),angular.forEach(e,function(e){if(null!=e.gadget.variableDef){var t={i:null,set:null},a="svc://"+e.gadget.variableDef.connection.name+"/"+e.gadget.variableDef.uId+"["+e.gadget.variableDef.offset+","+e.gadget.variableDef.length+"]";if(t.i=a,t.set=e.value,null!=e.newValue&&null!=s.panels[s.actualPanelId].gadgetsMap[e.varRef]){var n=s.panels[s.actualPanelId].gadgetsMap[e.varRef];n.value=e.newValue,n.value.quality="writing"}i.v.push(t)}}),l({method:"POST",url:o.ApiPrefix+"/command.cgi",data:i,headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(e){t.resolve()}).catch(function(){t.reject()}),a}}]),esgAngularDependencies.push("Webpanel.Api.GetConnectionDefinition"),angular.module("Webpanel.Api.GetConnectionDefinition",[]).run(["RcWareVisionAPI","ESGPromise","ESGVisionConfig","$http","ESGXmlHelper","ModelConnectionProfile",function(r,o,l,s,e,t){r.GetConnectionDefinition=function(e){var a=o.defer(),t=a.promise,n={ver:1};r.credentials(n,2);var i=function(e){if("ok"==e.data.code){var t={};angular.forEach(e.data.connections,function(e){var a={variables:{},name:null};a.name=e.n,angular.forEach(e.variables,function(e){var t={name:e.n,uId:e.uId,length:e.l,offset:e.o,type:e.t,rights:e.r,connection:a};a.variables[t.name]=t}),t[a.name]=a}),a.resolve({connections:t})}else a.reject()};return e?s({method:"POST",url:l.ApiPrefix+"/variables.cgi",data:n,headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(i).catch(function(e){a.resolve()}):s.get(l.ApiFilesPrefix+"/variables.cgi"+ESGGetWebpanelVersion()).then(i).catch(function(e){a.reject()}),t}}]),esgAngularDependencies.push("Webpanel.Api.GetTpgValue"),angular.module("Webpanel.Api.GetTpgValue",[]).run(["RcWareVisionAPI","ESGPromise","ESGVisionConfig","$http","ESGXmlHelper","WebpanelVariable",function(i,r,o,l,e,t){i.GetTpgValue=function(e){var t=r.defer(),a=t.promise,n={ver:1,v:[]};i.credentials(n,2);return angular.forEach(e,function(e){if(null!=e.variableDef){var t="svc://"+e.variableDef.connection.name+"/"+e.variableDef.uId+"["+e.variableDef.offset+","+e.variableDef.length+"]";n.v.push(t)}}),l({method:"POST",url:o.ApiPrefix+"/values.cgi",data:n,headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(e){"ok"==e.data.code&&null!=e.data&&null!=e.data.v&&0<e.data.v.length?t.resolve(e.data.v):t.reject()}).catch(function(){t.reject()}),a}}]),esgAngularDependencies.push("Webpanel.Api.GetUserGroups"),angular.module("Webpanel.Api.GetUserGroups",[]).run(["RcWareVisionAPI","ESGPromise","ESGVisionConfig","$http","ESGXmlHelper","ModelUserGroups",function(i,a,r,o,l,s){i.GetUserGroups=function(e){var n=a.defer(),t=n.promise;return o.get(r.ApiFilesPrefix+"/"+e+".userGroups"+ESGGetWebpanelVersion()).then(function(e){var t=l.getDocumentFromXmlString(e.data,i.ns),a=new s({node:t,nsResolver:i.nsResolver,xmlDoc:t});n.resolve(a)}).catch(function(e){n.resolve()}),t}}]),esgAngularDependencies.push("Webpanel.Api.GetWebpanelDefinition"),angular.module("Webpanel.Api.GetWebpanelDefinition",[]).run(["RcWareVisionAPI","ESGPromise","ESGVisionConfig","$http","ESGXmlHelper",function(o,t,a,n,l){o.GetWebpanelDefinition=function(){var i=t.defer(),e=i.promise,r={};return n.get(a.ApiFilesPrefix+"/hmisettings.xml"+ESGGetWebpanelVersion()).then(function(e){var t=l.getDocumentFromXmlString(e.data,o.ns),a=l.getXPathResultSingleNode(t,"/hmi:hmiSettings",o.nsResolver,t);r.defaultUser=l.getSingleSubElementValueNS(a,o.nsResolver("hmi"),"defaultUser"),r.culture=l.getSingleSubElementValueNS(a,o.nsResolver("hmi"),"culture");var n=l.getXPathResult(a,"hmi:handlers/hmi:*",o.nsResolver,t);r.handlers={},angular.forEach(n,function(e){r.handlers[e.nodeName]="true"==e.innerHTML}),i.resolve(r)}).catch(function(e){i.reject()}),e}}]),esgAngularDependencies.push("Webpanel.Api.GetHistory"),angular.module("Webpanel.Api.GetHistory",[]).run(["RcWareVisionAPI","ESGPromise","ESGVisionConfig","$http","ESGXmlHelper","WebpanelVariable","WebpanelData",function(p,g,h,f,e,m,v){p.GetHistory=function(e,t,a){var n=g.defer(),i=n.promise,r={ver:1,v:[]};p.credentials(r,2);var o={},l={},s=new Big(t.getTime()).times(1e4).plus("621355968000000000").toFixed(0),u=new Big(a.getTime()).times(1e4).plus("621355968000000000").toFixed(0);angular.forEach(e,function(e){if(null!=e.variableDef){var t="svc://"+e.variableDef.connection.name+"/"+e.variableDef.uId+"["+e.variableDef.offset+","+e.variableDef.length+"]";o[t]={varRef:e.varRef,variable:e};var a={i:t,from:"_"+s+"_",to:"_"+u+"_",o:0,m:1e3};l[t]=a,r.v.push(a)}});var c={},d=function(a){var e=JSON.stringify(a);e=(e=e.replace(/"_/g,"")).replace(/_"/g,""),f({method:"POST",url:h.ApiPrefix+"/history.cgi",data:e,headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(e){if("ok"==e.data.code){new Date;var t=[];angular.forEach(e.data.v,function(e){try{var n=o[e.i].variable;null==c[e.i]&&(c[e.i]={data:[],endWithNull:!1,state:e.state});var i=c[e.i].data;e.n>=l[e.i].o+l[e.i].m&&(l[e.i].o=e.n,t.push(l[e.i])),angular.forEach(e.v,function(e){var t=new m({variableId:n.varRef,sourceType:v.typeNumToId(parseInt(n.variableDef.type))});t.setValueFromPlcHash({ts:e.t,value:e.v});var a=new Big(e.t).minus("621355968000000000").div(1e4).toFixed(0);"real"!=t.sourceType&&"lreal"!=t.sourceType||1!=isNaN(t.value)&&t.value!=1/0&&t.value!=-1/0?"bool"==v.typeNumToId(parseInt(n.variableDef.type))?i.push([new Date(parseInt(a)),1==t.value?1:0]):null!=t.value.toFixed?i.push([new Date(parseInt(a)),parseFloat(t.value.toFixed(6))]):i.push([new Date(parseInt(a)),t.value]):0<i.length&&null!=i[i.length-1]&&i.push(null)})}catch(e){console.log(e)}0<i.length&&null==i[i.length-1]&&(i.splice(i.length-1,1),c[e.i].endWithNull=!0)}),0<t.length?(a.v=t,d(a)):n.resolve(c)}else n.reject()}).catch(function(){n.reject()})};return d(r),i}}]),esgAngularDependencies.push("Webpanel.Api.GetLog"),angular.module("Webpanel.Api.GetLog",[]).run(["RcWareVisionAPI","ESGPromise","ESGVisionConfig","$http","ESGXmlHelper","WebpanelVariable","WebpanelData",function(o,l,s,u,e,t,a){o.GetLog=function(e,t){var a=l.defer(),n=a.promise,i={ver:1,from:"_"+new Big(e.getTime()).times(1e4).plus("621355968000000000").toFixed(0)+"_",to:"_"+new Big(t.getTime()).times(1e4).plus("621355968000000000").toFixed(0)+"_"};o.credentials(i,2);var r=JSON.stringify(i);return r=(r=r.replace(/"_/g,"")).replace(/_"/g,""),u({method:"POST",url:s.ApiPrefix+"/systemlog.cgi",data:r,headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(e){var t=e.data;"ok"!=t.code&&a.resolve();var i=[];angular.forEach(t.connections,function(n){angular.forEach(n.entries,function(e){var t=new Big(e.ts).minus("621355968000000000").div(1e4).toFixed(0),a={connection:n.n,time:t,message:e.m,source:e.s,level:e.l};i.push(a)})}),a.resolve(i)}).catch(function(e){a.resolve()}),n}}]),esgAngularDependencies.push("Webpanel.Api.GetTextDefinition"),angular.module("Webpanel.Api.GetTextDefinition",[]).run(["RcWareVisionAPI","ESGPromise","ESGVisionConfig","$http","ESGXmlHelper","WebpanelVariable","WebpanelData",function(n,t,i,r,o,e,a){n.GetTextDefinition=function(){var a=t.defer(),e=a.promise;return n.credentials({ver:1,s:0},2),r.get(i.ApiFilesPrefix+"/textDefinition.connectionProfile"+ESGGetWebpanelVersion()).then(function(e){var t=o.getDocumentFromXmlString(e.data,n.ns);a.resolve(t)}).catch(function(e){a.resolve()}),e}}]),esgAngularDependencies.push("Webpanel.Api.Login"),angular.module("Webpanel.Api.Login",[]).run(["RcWareVisionAPI","ESGPromise","ESGVisionConfig","$http","ESGXmlHelper","WebpanelVariable","WebpanelData",function(e,r,o,l,t,a,s){e.Login=function(e,t){var n=r.defer(),a=n.promise,i={ver:1,c:{u:e,p:t}};return l({method:"POST",url:o.ApiPrefix+"/login.cgi",data:i,headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(e){if("ok"==e.data.code){var t=e.data.f;s.features.graph=!0,null!=t&&(s.features.log=t.systemLog,s.features.readSystemConfiguration=t.readSystemConfiguration,s.features.writeSystemConfiguration=t.writeSystemConfiguration,s.features.readAlarms=t.readAlarms,s.features.ackAlarms=t.ackAlarms,s.features.writeRtc=t.writeRTC);var a=e.data.c;null!=a&&null!=a.disableAlarmHistoryLog&&(s.capabilities.alarmHistory=!a.disableAlarmHistoryLog),null!=e.data.rspBuffSize&&(s.rspBuffSize=e.data.rspBuffSize),n.resolve()}else n.reject(e.data.code)}).catch(function(){n.reject()}),a}}]),esgAngularDependencies.push("Webpanel.Api.GetActiveAlarms"),angular.module("Webpanel.Api.GetActiveAlarms",[]).run(["RcWareVisionAPI","ESGPromise","ESGVisionConfig","$http","ESGXmlHelper","WebpanelData",function(l,s,u,c,e,d){l.GetActiveAlarms=function(e){var t=s.defer(),a=t.promise,i={ver:1};l.credentials(i,2),null!=d.rspBuffSize&&(i.offset=0);var r=[],n=function(e){if("ok"==e.data.code){var a={0:"OK",1:"Active",2:"Active Ack.",3:"Memory Ack.",4:"Memory"},n=new Date;angular.forEach(e.data.connections,function(t){angular.forEach(t.entries,function(e){r.push({commId:e.commId,offset:e.offset,desc:e.desc,stateText:a[e.state],state:e.state,connection:t.n,time:n})})}),null!=d.rspBuffSize&&null!=e.data.nextOffset&&-1!=e.data.nextOffset?(i.offset=e.data.nextOffset,o()):t.resolve({alarms:r,connectionsLength:e.data.connections.length})}else t.reject()};function o(){e?c({method:"POST",url:u.ApiPrefix+"/alarm/view.cgi",data:i,headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(n).catch(function(){t.reject()}):c.get(u.ApiFilesPrefix+"/schemas.cgi"+ESGGetWebpanelVersion()).then(n).catch(function(e){t.reject()})}return o(),a}}]),esgAngularDependencies.push("Webpanel.Api.GetAlarmsHistoryLog"),angular.module("Webpanel.Api.GetAlarmsHistoryLog",[]).run(["RcWareVisionAPI","ESGPromise","ESGVisionConfig","$http","ESGXmlHelper",function(i,r,o,l,e){i.GetAlarmsHistoryLog=function(e){var t=r.defer(),a=t.promise,n={ver:1};i.credentials(n,2);return l({method:"POST",url:o.ApiPrefix+"/alarm/log.cgi",data:n,headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(e){if("ok"==e.data.code){var n=[],i={0:"OK",1:"Active",2:"Active Ack.",3:"Memory Ack.",4:"Memory"};angular.forEach(e.data.connections,function(a){angular.forEach(a.entries,function(e){var t=new Big(e.ts).minus("621355968000000000").div(1e4).toFixed(0);n.push({offset:e.offset,desc:e.aId,stateText:i[e.s],state:e.s,sId:e.sId,note:e.n,connection:a.n,time:t})})}),t.resolve({alarms:n,connectionsLength:e.data.connections.length})}else t.reject()}).catch(function(){t.reject()}),a}}]),esgAngularDependencies.push("Webpanel.Api.AlarmCommand"),angular.module("Webpanel.Api.AlarmCommand",[]).run(["RcWareVisionAPI","ESGPromise","ESGVisionConfig","$http","ESGXmlHelper",function(i,r,o,l,e){i.AlarmCommand=function(e){var t=r.defer(),a=t.promise,n={ver:1,a:e};i.credentials(n,2);return l({method:"POST",url:o.ApiPrefix+"/alarm/cmd.cgi",data:n,headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(e){200==e.status?t.resolve():t.reject()}).catch(function(){t.reject()}),a}}]),esgAngularDependencies.push("Webpanel.Api.GetRtc"),angular.module("Webpanel.Api.GetRtc",[]).run(["RcWareVisionAPI","ESGPromise","ESGVisionConfig","$http","ESGXmlHelper",function(n,i,r,o,e){n.GetRtc=function(){var t=i.defer(),e=t.promise,a={ver:1};n.credentials(a,2);return o({method:"POST",url:r.ApiPrefix+"/rtc/get.cgi",data:a,headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(e){200==e.status&&"error"!=e.data.code?t.resolve(e.data.rtc):t.reject()}).catch(function(){t.reject()}),e}}]),esgAngularDependencies.push("Webpanel.Api.SetRtc"),angular.module("Webpanel.Api.SetRtc",[]).run(["RcWareVisionAPI","ESGPromise","ESGVisionConfig","$http","ESGXmlHelper",function(i,r,o,l,e){i.SetRtc=function(e){var t=r.defer(),a=t.promise,n={ver:1,rtc:e};i.credentials(n,2);return l({method:"POST",url:o.ApiPrefix+"/rtc/set.cgi",data:n,headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(e){"ok"==e.data.code?t.resolve():t.reject()}).catch(function(){t.reject()}),a}}]),esgAngularDependencies.push("Webpanel.Api.GetSysConf"),angular.module("Webpanel.Api.GetSysConf",[]).run(["RcWareVisionAPI","ESGPromise","ESGVisionConfig","$http","ESGXmlHelper",function(n,i,r,o,e){n.GetSysConf=function(){var a=i.defer(),e=a.promise,t={ver:1};n.credentials(t,2);return o({method:"POST",url:r.ApiPrefix+"/sysconf/get.cgi",data:t,headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(e){if(200==e.status&&null!=e.data&&null!=e.data.cfg){var t=e.data.cfg;a.resolve(t)}else a.reject()}).catch(function(){a.reject()}),e}}]),esgAngularDependencies.push("Webpanel.Api.SetSysConf"),angular.module("Webpanel.Api.SetSysConf",[]).run(["RcWareVisionAPI","ESGPromise","ESGVisionConfig","$http","ESGXmlHelper",function(i,r,o,l,e){i.SetSysConf=function(e){var t=r.defer(),a=t.promise,n={ver:1,cfg:e};i.credentials(n,2);return l({method:"POST",url:o.ApiPrefix+"/sysconf/set.cgi",data:n,headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(e){200==e.status&&"ok"==e.data.code?t.resolve():t.reject()}).catch(function(){t.reject()}),a}}]),esgAngularDependencies.push("Webpanel.Api.GetSysInfoNetwork"),angular.module("Webpanel.Api.GetSysInfoNetwork",[]).run(["RcWareVisionAPI","ESGPromise","ESGVisionConfig","$http","ESGXmlHelper",function(n,i,r,o,e){n.GetSysInfoNetwork=function(){var a=i.defer(),e=a.promise,t={ver:1};n.credentials(t,2);return o({method:"POST",url:r.ApiPrefix+"/sysinfo.cgi",data:t,headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(e){if(200==e.status&&null!=e.data&&null!=e.data.network){var t=e.data.network;a.resolve(t)}else a.reject()}).catch(function(){a.reject()}),e}}]),angular.module("BrowserDetection",[]).service("BrowserDetection",["$q","$log",function(e,t){var i={browser:{}};if(0<=navigator.userAgent.search("MSIE")){i.browser.name="MS Internet Explorer",i.browser.id="MSIE";var a=navigator.userAgent.search("MSIE")+5,n=navigator.userAgent.search("; Windows");i.browser.version=parseInt(navigator.userAgent.substring(a,n))}else if(0<=navigator.userAgent.search("Chrome")){i.browser.name="Chrome",i.browser.id="Chrome";a=navigator.userAgent.search("Chrome")+7,n=navigator.userAgent.search(" Safari");i.browser.version=navigator.userAgent.substring(a,n)}else if(0<=navigator.userAgent.search("Firefox")){i.browser.name="Mozilla Firefox",i.browser.id="Firefox";a=navigator.userAgent.search("Firefox")+8;i.browser.version=navigator.userAgent.substring(a)}else if(0<=navigator.userAgent.search("Safari")&&navigator.userAgent.search("Chrome")<0){i.browser.name="Apple Safari",i.browser.id="Safari";a=navigator.userAgent.search("Version")+8,n=navigator.userAgent.search(" Safari");i.browser.version=navigator.userAgent.substring(a,n)}else if(0<=navigator.userAgent.search("Opera")){i.browser.name="Opera",i.browser.id="Opera";a=navigator.userAgent.search("Version")+8;i.browser.version=navigator.userAgent.substring(a)}else i.browser.name="Unknown",i.browser.id="Unknown",i.browser.version="Unknown";var r={apple:navigator.userAgent.match(/(iPhone|iPod|iPad)/),blackberry:navigator.userAgent.match(/BlackBerry/),android:navigator.userAgent.match(/Android/)};i.isIpadVariable=null!=r.apple&&r.apple,i.isTabletVariable=null!=r.apple||null!=r.blackberry||null!=r.android,i.isMobileVariable=i.isTabletVariable,i.browserFullScreen=function(){},i.browserDetection=function(){return i.browser},i.connectionSpeed=[],i.actualSpeed=0;var o=!(i.newDownloadSpeed=function(e,t,a){var n=e/(t/1e3);i.connectionSpeed.push({speed:n,time:a})});return 0==o&&(o=!0),i.fullScreenSupported=function(){var e=!1;switch(i.browser.id){case"MSIE":11<=parseInt(i.browser.version)&&(e=!0);break;case"Chrome":27<=parseInt(i.browser.version)&&(e=!0);break;case"Firefox":5<=parseInt(i.browser.version)&&(e=!0);break;case"Opera":23<=parseInt(i.browser.version)&&(e=!0)}return e},i.fullScreenSupportedVar=i.fullScreenSupported(),i}]),angular.module("ESGHelpers",[]).service("ESGXmlHelper",["$log",function(e){var o={getDocumentFromXmlString:function(e,t){var a=null;window.DOMParser&&(a=(new DOMParser).parseFromString(e,"text/xml"));if(!angular.isDefined(a.evaluate)&&angular.isDefined(window.ActiveXObject)||"ActiveXObject"in window){(a=angular.isDefined(window.ActiveXObject)?new ActiveXObject("Microsoft.XMLDOM"):new ActiveXObject("Msxml2.DOMDocument.6.0")).async=!1;a.loadXML(e);var n="";angular.forEach(t,function(e,t){n+="xmlns:"+t+"='"+e+"' "}),a.setProperty("SelectionNamespaces",n),angular.isDefined(window.ActiveXObject)&&a.setProperty("SelectionLanguage","XPath");a.getProperty("SelectionNamespaces")}return a},getXPathResult:function(e,t,a,n){var i=[],r=null;if(angular.isDefined(n)&&null!=n||(n=document),angular.isDefined(document.evaluate))for(var o=(r=n.evaluate(t,e,a,XPathResult.ANY_TYPE,null)).iterateNext();o;)i.push(o),o=r.iterateNext();else if(r=e.selectNodes(t),angular.isDefined(window.ActiveXObject))angular.forEach(r,function(e){i.push(e)});else for(o=r.nextNode();o;)i.push(o),o=r.nextNode();return i},getXPathResultSingleNode:function(e,t,a,n){var i=o.getXPathResult(e,t,a,n);return 0<i.length?i[0]:null},getElementsByTagNameNS:function(e,t,a){var n=[],i=null;return angular.isDefined(e.getElementsByTagNameNS)?(i=e.getElementsByTagNameNS(t,a),angular.forEach(i,function(e){n.push(e)})):(i=e.getElementsByTagName("*"),angular.forEach(i,function(e){e.namespaceURI==t&&e.baseName==a&&n.push(e)})),n},getAttributeNS:function(e,t,a){if(void 0===e||null==e)return null;if(angular.isDefined(e.getAttributeNS)){var n=e.getAttributeNS(t,a);return null!=n?n:""}for(var i=null,r=0;r<e.attributes.length;r++)if((i=e.attributes[r]).baseName==a&&i.namespaceURI==t)return i.value;return""},getSingleSubElementValueNS:function(e,t,a){var n=o.getElementsByTagNameNS(e,t,a),i=null;if(0<n.length){if(n[0].hasChildNodes()){i="";for(var r=0;r<n[0].childNodes.length;r++)i+=n[0].childNodes[r].nodeValue}else i=n[0].nodeValue}return i},createXmlDocument:function(e,t,a,n){var i=null;if(window.DOMParser&&(i=document.implementation.createDocument(e,t,a)),!angular.isDefined(i.evaluate)&&angular.isDefined(window.ActiveXObject)){(i=new ActiveXObject("Microsoft.XMLDOM")).async=!1;o.createXmlElementNS(i,e,t);var r="xmlns='"+e+"'";angular.forEach(n,function(e){r+=" "+e.name+"='"+e.namespaceUri+"'"}),i.loadXML("<"+t+" "+r+"></"+t+">");o.getElementsByTagName(i,t);i.setProperty("SelectionNamespaces",r)}else angular.forEach(n,function(e){i.documentElement.setAttributeNS(e.default,e.name,e.namespaceUri)});return i},setAttributeNS:function(e,t,a,n){!angular.isDefined(e.evaluate)&&angular.isDefined(window.ActiveXObject)?e.setAttribute(a,n):e.setAttributeNS(t,a,n)},createXmlElementNS:function(e,t,a){return!angular.isDefined(e.evaluate)&&angular.isDefined(window.ActiveXObject)?null!=t?e.createNode(1,a,t):e.createNode(1,a,""):e.createElementNS(t,a)},xmlToString:function(e,t){var a="";return 0==(a=(a=!angular.isDefined(e.evaluate)&&angular.isDefined(window.ActiveXObject)?e.xml:(new XMLSerializer).serializeToString(e)).replace(/xmlns=""/g,"")).indexOf('<?xml version="1.0"?>')&&(a=a.replace('<?xml version="1.0"?>',"")),void 0===t||1==t?'<?xml version="1.0" encoding="UTF-8"?>'+a:a},xmlSetNodeValue:function(e,t){!angular.isDefined(e.evaluate)&&angular.isDefined(window.ActiveXObject)?e.text=t:e.textContent=t},getElementsByTagName:function(e,t){return!angular.isDefined(e.evaluate)&&angular.isDefined(window.ActiveXObject),e.getElementsByTagName(t)[0]},getElementPositionInParentNode:function(a){var n=null;return angular.forEach(a.parentNode.childNodes,function(e,t){e==a&&(n=t)}),n}};return o}]),angular.module("ESGPromise",[]).service("ESGPromise",["$q",function(i){var t={defer:function(){var t,a,e=i.defer(),n=e.promise;return n.then(function(e){null!=t&&t(e)},function(e){null!=a&&a(e)}),n.success=function(e){return t=e,n},n.error=function(e){return a=e,n},e},qAll:function(r){var o=t.defer(),e=o.promise,l=0,s=function(e){var t=e[0],a=e[1],n=e[2],i=e[3];t.apply(null,a).success(function(e){"function"==typeof n&&n(e),void 0!==r[l+1]?s(r[++l]):o.resolve()}).error(function(e){"function"==typeof i&&i(e),void 0!==r[l+1]?s(r[++l]):o.resolve()})};return 0<r.length?s(r[l]):o.resolve(),e}};return t}]),angular.module("I18nService",["Dictionary"]).service("I18nService",["Dictionary","$locale",function(r,t){var i={actualLanguage:""};return i.jed=new Jed({}),i.defaulLanguage="en",i.addKeyTranslations=function(i,e){angular.forEach(e,function(e,n){angular.isDefined(r[n])&&angular.forEach(e,function(e,t){var a=i+""+t;angular.isArray(e)?angular.isDefined(e[0])&&null==e[0]?r[n][a]=e:r[n][a]=[null].concat(e):r[n][a]=[null,e]})})},i.switchLanguage=function(e){var t,a={locale_data:{messages:{}}};t=angular.isDefined(e)?e.toString().split("-")[0]:i.getBrowserLanguage(),angular.isDefined(r[t])&&(a.locale_data.messages=r[t],i.actualLanguage=t,i.jed.options.locale_data=a.locale_data),document.documentElement.lang=e},i.getBrowserLanguage=function(){var e=t.id;return window.navigator.language?e=window.navigator.language.split("-",1)[0]:window.navigator.userLanguage&&(e=window.navigator.userLanguage.split("-",1)[0]),angular.isDefined(r[e])||(e=i.defaulLanguage),e},i.getDateTimeFormat=function(e,t){return void 0===t&&(t=i.getActualLanguage()),angular.isDefined(r[t][""].datetime_formats)||(t=defaulLanguage),angular.isDefined(r[t][""].datetime_formats)?angular.isDefined(r[t][""].datetime_formats[e])?r[t][""].datetime_formats[e]:"monthInflection"==e&&angular.isDefined(r[t][""].datetime_formats.month)?r[t][""].datetime_formats.month:null:null},i.getActualLanguage=function(){return i.actualLanguage},i.missingStrings={},i.i18nTranslate=function(e,t,a){var n="";return angular.isDefined(a)||(a=""),angular.isDefined(e)&&null!==e&&""!==e?(angular.isDefined(t)&&null!==t&&""!==t?"string"==typeof t?(n=i.jed.translate(e).withContext(a).fetch(),n=""===i?e:i.replace("$",t)):(t=parseInt(t),n=i.jed.translate(e).withContext(a).ifPlural(t,"").fetch(t),""===i&&(n=e)):n=i.jed.translate(e).withContext(a).fetch(),n):""},i.switchLanguage(),i}]).directive("esgI18n",["$log","$filter","I18nService",function(e,h,f){return{link:function(c,d,p,e){function g(e,t){var a="",n=null,i="",r=!1;angular.isDefined(p.esgI18nVar)&&"true"==p.esgI18nVar&&(e=c.$eval(e));var o=null;if(c.cache.actualLanguage!=f.actualLanguage||c.cache.text!=e){if(null!=e&&"function"==typeof e.charAt)switch(e.charAt(0)){case"{":o=c.$eval(e),angular.isDefined(o.number)&&(n=o.number),angular.isDefined(o.str)&&(a=o.str),angular.isDefined(o.target)&&(i=o.target),r=!0;break;case"[":o=c.$eval(e);for(var l=0;l<o.length;l++)g(o[l]);break;default:var s=e.indexOf(":");a=-1!=s&&s!=e.length-1?(i=(o=e.split(":"))[0],o[1]):e,r=!0}if(r){if(""==i){var u=h("i18n")(a,n,t);d.text(u)}else{u=h("i18n")(a,n,t);d.attr(i,u)}c.cache.translatedText=u,c.cache.actualLanguage=f.actualLanguage,c.cache.text=e}}}c.I18nService=f,c.cache={},c.$watch("I18nService.actualLanguage",function(e,t){e!=t&&g(p.esgI18n)}),p.$observe("esgI18n",function(e){g(e)});var t="";angular.isDefined(p.esgI18nContext)&&(t=p.esgI18nContext),g(p.esgI18n,t)}}}]).filter("i18n",["$log","I18nService",function(e,n){return function(e,t,a){return n.i18nTranslate(e,t,a)}}]).filter("dateFormatCSharp",["$filter","$log","$locale","I18nService",function(e,t,c,i){var d=/^(\d{4})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,p=/^\d+$/,g=!1;function h(e){return parseInt(e,10)}function a(a,n,i,r){return function(e){var t;if(t="QuarterYear"==a?Math.ceil((e.getMonth()+1)/3):e["get"+(1==g?"UTC":"")+a](),(0<i||-i<t)&&(t+=i),0!==t||-12!=i)return padNumber(t,n,r);t=12}}function n(a,n,i,r,o,l){return function(e){var t=Math.floor(e["get"+(1==g?"UTC":"")+a]()/1e3*Math.pow(10,n));return(0<o||-o<t)&&(t+=o),0!=t||i?padNumber(t,n,l)+r:""}}function r(t,a){return function(e){return i.getDateTimeFormat(t)[e["get"+(1==g?"UTC":"")+a]()]}}function o(t){return function(e){return i.getDateTimeFormat(t)}}function l(n){return function(e){var t=Math.ceil((60*e.getHours()*60*1e3+60*e.getMinutes()*1e3+1e3*e.getSeconds()+e.getMilliseconds())/432e5)-1,a=i.getDateTimeFormat("ampms");return 1==n?a[t][0]:a[t]}}function s(n){return function(e){var t=-1*e.getTimezoneOffset(),a=0<=t?"+":"";return 1==n?a+t/60:2==n?a+padNumber(t/60,2):a+=padNumber(Math[0<t?"floor":"ceil"](t/60),2)+":"+padNumber(Math.abs(t%60),2)}}var f={d:a("Date",1),dd:a("Date",2,0),ddd:r("shortday","Day"),dddd:r("day","Day"),f:n("Milliseconds",1,!0,""),ff:n("Milliseconds",2,!0,""),fff:n("Milliseconds",3,!0,""),ffff:n("Milliseconds",3,!0,"0"),fffff:n("Milliseconds",3,!0,"00"),ffffff:n("Milliseconds",3,!0,"000"),fffffff:n("Milliseconds",3,!0,"0000"),F:n("Milliseconds",1,!1,""),FF:n("Milliseconds",2,!1,""),FFF:n("Milliseconds",3,!1,""),FFFF:n("Milliseconds",3,!1,"0"),FFFFF:n("Milliseconds",3,!1,"00"),FFFFFF:n("Milliseconds",3,!1,"000"),FFFFFFF:n("Milliseconds",3,!1,"0000"),h:a("Hours",1,-12),hh:a("Hours",2,-12),H:a("Hours",1),HH:a("Hours",2),K:s(4),m:a("Minutes",1),mm:a("Minutes",2),M:a("Month",1,1),MM:a("Month",2,1),MMM:r("shortmonth","Month"),MMMM:r("monthInflection","Month"),MMMMM:r("month","Month"),s:a("Seconds",1),ss:a("Seconds",2),t:l(1),tt:l(2),q:a("QuarterYear",1),y:a("FullYear",1,0,-2),yy:a("FullYear",2,0,!0),yyy:a("FullYear",3),yyyy:a("FullYear",4),yyyyy:a("FullYear",5),z:s(1),zz:s(2),zzz:s(4),":":o("timeSeparator"),"/":o("dateSeparator"),"%":function(){return""}};return function(a,e,t){1==t&&(g=!0);var n,i,r="",o=[],l="",s=/((?:\"[\s\S]*\"+)|(?:\'[\s\S]*\'+)|(?:[^%ytMdHhmsfFaZ^EKz'])|(?:\/|E+|y+|M+|d+|H+|h+|m+|s+|f+|F+|a|Z|K|z+|t+'))(.*)/;if("string"==typeof a)if(p.test(a))a=h(a);else{var u=new Date(a);a=isNaN(new Date(a).getTime())?function(e){var t;if(t=e.match(d)){var a=new Date(0),n=0,i=0;return t[9]&&(n=h(t[9]+t[10]),i=h(t[9]+t[11])),a.setUTCFullYear(h(t[1]),h(t[2])-1,h(t[3])),a.setUTCHours(h(t[4]||0)-n,h(t[5]||0)-i,h(t[6]||0),h(t[7]||0)),a}return e}(a):u}if("number"==typeof a&&(a=new Date(a)),n=a,"[object Date]"!==Object.prototype.toString.call(n)&&(void 0===n||null==n||"[object Date]"!==Object.prototype.toString.call(n._dateProxy)))return a;for(;e;)e=(i=s.exec(e))?(o=concat(o,i,1)).pop():(o.push(e),null);return angular.forEach(o,function(e){if(-1!=l.indexOf("\\")||-1!=l.indexOf("|"))r+=e;else{var t=f[e];r+=t?t(a,c.DATETIME_FORMATS):e.replace(/(^'|'$)/g,"").replace(/''/g,"'")}l=e}),r=r.replace(/("|'|\\|\|)/g,"")}}]).filter("dateFormatC",["$filter","$log","$locale","I18nService",function(e,t,o,a){var l=/^(\d{4})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,s=/^\d+$/,u=!1;function c(e){return parseInt(e,10)}function n(a,n,i,r){return function(e){var t;if(t="QuarterYear"==a?Math.ceil((e.getMonth()+1)/3):e["get"+(1==u?"UTC":"")+a](),(0<i||-i<t)&&(t+=i),0!==t||-12!=i)return padNumber(t,n,r);t=12}}var d={"%d":n("Date",2,0),"%H":n("Hours",2),"%M":n("Minutes",2),"%m":n("Month",2,1),"%S":n("Seconds",2),"%Y":n("FullYear",4)};return function(i,e,t){1==t&&(u=!0);var a,r="";if("string"==typeof i)if(s.test(i))i=c(i);else{var n=new Date(i);i=isNaN(new Date(i).getTime())?function(e){var t;if(t=e.match(l)){var a=new Date(0),n=0,i=0;return t[9]&&(n=c(t[9]+t[10]),i=c(t[9]+t[11])),a.setUTCFullYear(c(t[1]),c(t[2])-1,c(t[3])),a.setUTCHours(c(t[4]||0)-n,c(t[5]||0)-i,c(t[6]||0),c(t[7]||0)),a}return e}(i):n}return"number"==typeof i&&(i=new Date(i)),a=i,"[object Date]"===Object.prototype.toString.call(a)||void 0!==a&&null!=a&&"[object Date]"===Object.prototype.toString.call(a._dateProxy)?(r=e,angular.forEach(d,function(e,t){var a=e(i,o.DATETIME_FORMATS),n=new RegExp(t,"g");r=r.replace(n,a)}),r):i}}]).filter("numberFormatCSharp",["$filter","$log","$locale","I18nService",function(e,t,a,n){function v(e){return n.getDateTimeFormat(e)}function x(e,t,a){var n=padNumber(e,t);if(a){var i=n,r=v("groupSeparator");if(3<i.length){n="";for(var o=0,l=i.length%3;o<i.length;o++)o==l&&(0!=l&&(n+=r),l+=3),n+=i[o]}}return n}function b(e,t,a){var n=e;if(a)for(var i=e.length;i<t;i++)n+="0";return n}return function(e,t){var a="";a=e.toString();var n="",i=[],r=/((?:\"[\s\S]*\"+)|(?:\'[\s\S]*\'+)|(?:[0#]+)|(?:[^0#']+)|(?:'(?:[^']|'')*')|(?:0+|#+|\.|,|%|‰"))(.*)/;-1!=t.indexOf("%")&&(a=(e*=100).toString()),-1!=t.indexOf("‰")&&(a=(e*=1e3).toString());for(;t;){var o=r.exec(t);t=o?(i=concat(i,o,1)).pop():(i.push(t),null)}if(angular.forEach(i,function(e,t){e.match(",+")&&(0==c?g=e.length:void 0===i[t+1]?g=e.length:void 0!==i[t+1]&&-1==i[t+1].indexOf("0")&&-1==i[t+1].indexOf("#")&&(g=e.length),0<g&&(i[t]=""))}),0<g){var l=a.indexOf(".");-1!=l&&(l=0),"."==(a=a.slice(0,a.length-3*g)+"."+a.slice(a.length-3*g))[0]&&(a="0"+a)}var s=!1;if(-1!=i.indexOf(",")){var u=i.indexOf(",");s=!0,i[u-1]+=i[u+1],i.splice(u,2)}var c=!0,d=0,p={},g=0;angular.forEach(i,function(e,t){if(-1==e.indexOf('"')&&-1==e.indexOf("'")&&" "!=e&&-1==e.indexOf("%")&&","!=e&&("."==e?c=!1:c||(d+=e.length)),-1!=e.indexOf("0")||-1!=e.indexOf("#")){-1!=e.indexOf("0")&&-1!=e.indexOf("#")?p[t]=e.split(0).length-1:-1!=e.indexOf("0")?p[t]=e.length:p[t]=0;var a=e[0];i[t]=a}});for(var h="",f=0;f<a.length&&"."!=a[f];f++)h+=a[f];f=h.toString().length+1;for(var m="";f<a.toString().length;f++)m+=a.toString()[f];if(d<m.length){if(a=function(e,t,a){var n=0,i="",r=Math.round("0."+parseInt(e[a+t+1]).toString());if(0<r)for(var o=a+t;0<=o;o--)"."==e[o]?""!=i&&(i="."+i):i="-"==e[o]?e[o]+i:(10==(n=parseInt(e[o])+r)?(r=1,0!=o&&(n=0)):r=0,n.toString()+i);else i=0==t?e.slice(0,a):e.slice(0,a+1+t);return i}(a.toString(),d,h.toString().length),0<d)h=a.slice(0,a.length-1-d);else h=a;for(f=h.toString().length+1,m="";f<a.toString().length;f++)m+=a.toString()[f]}c=!0;return angular.forEach(i,function(e,t){switch(e){case"e":if(void 0!==p[t+1])p[t+1];break;case-1!=e.indexOf('"'):case-1!=e.indexOf("'"):case-1!=e.indexOf("%"):case-1!=e.indexOf("‰"):n+=e;break;case".":(""!=m||void 0!==i[t+1]&&-1<i[t+1].indexOf("0"))&&(n+=v("decimalPoint")),c=!1;break;case"0":n+=c?x(h,p[t],s):b(m,p[t],!0);break;case"#":n+=c?x(h,p[t],s):b(m,p[t],!1);break;default:n+=e}}),n=n.replace(/("|'|\\)/g,"")}}]).service("timeSpan",["$log",function(e){var t={timeSpanFromString:function(e){for(var t={},a=1,n=!1,i=1;a<e.length;){for("T"==e[a]&&(n=!0,4,"T"==e[i=++a]&&(n=!0,4,i=++a));a<e.length&&(!isNaN(e[a])||"."==e[a]);a++);var r=parseFloat(e.substring(i,a));switch(e[a]){case"Y":t.years=r;break;case"M":n?t.minutes=r:t.months=r;break;case"D":t.days=r;break;case"H":t.hours=r;break;case"S":t.seconds=r;break;default:!0}i=++a}return t},timeSpanFromMinutes:function(e){var t={},a=e%60,n=Math.floor(e/60)%24,i=Math.floor(e/60/24);return 0<a&&(t.minutes=a),0<n&&(t.hours=n),0<i&&(t.days=i),t},getTimeSpanSeconds:function(e){var a=0;return angular.forEach(e,function(e,t){switch(t){case"days":a+=24*e*60*60;break;case"hours":a+=60*e*60;break;case"minutes":a+=60*e;break;case"seconds":a+=e}}),a},timeSpanToString:function(e){var t="",a="",n="";return void 0!==e.years&&0!=e.years&&(n+=e.years+"Y"),void 0!==e.months&&0!=e.months&&(n+=e.months+"M"),void 0!==e.days&&0!=e.days&&(n+=e.days+"D"),void 0!==e.hours&&0!=e.hours&&(a+=e.hours+"H"),void 0!==e.minutes&&0!=e.minutes&&(a+=e.minutes+"M"),void 0!==e.seconds&&0!=e.seconds&&(a+=e.seconds+"S"),""==n&&""==a?t="PT0S":(t="P"+n,""!=a&&(t+="T"+a)),t}};return t}]).filter("orderByCzech",["$log","$filter",function(e,t){return function(e,i){for(var t,a,n=" aáäaaâbcćčdďeéěëeefghhiíiiîjklĺľmnńňnoóôooöőpqrŕřsśštťuúuůüuuvwxyýzźž0123456789".toUpperCase(),r={},o=0;o<e.length;o++)if(t=[],void 0!==(a=e[o][i])){a.replace("/s+/g"," ");for(var l,s,u=0;u<a.length;u++)l=a.substr(u,1).toUpperCase(),u+1<a.length&&"C"==l&&"H"==a.substr(u+1,1).toUpperCase()?(s=22,u++):s=n.indexOf(l),t.push(s<10?"0"+s:s);r[a]=t.join("")}return e.sort(function(e,t){var a=r[e[i]],n=r[t[i]];return n<a?1:a<n?-1:0})}}]),function(e,i){var t=Array.prototype,a=Object.prototype,n=t.slice,o=a.hasOwnProperty,l=t.forEach,s={},r={forEach:function(e,t,a){var n,i,r;if(null!==e)if(l&&e.forEach===l)e.forEach(t,a);else if(e.length===+e.length){for(n=0,i=e.length;n<i;n++)if(n in e&&t.call(a,e[n],n,e)===s)return}else for(r in e)if(o.call(e,r)&&t.call(a,e[r],r,e)===s)return},extend:function(a){return this.forEach(n.call(arguments,1),function(e){for(var t in e)a[t]=e[t]}),a}},p=function(e){if(this.defaults={locale_data:{messages:{"":{domain:"messages",lang:"en",plural_forms:"nplurals=2; plural=(n != 1);"}}},domain:"messages"},this.options=r.extend({},this.defaults,e),this.textdomain(this.options.domain),e.domain&&!this.options.locale_data[this.options.domain])throw new Error("Text domain set to non-existent domain: `"+e.domain+"`")};function g(e){return p.PF.compile(e||"nplurals=2; plural=(n != 1);")}function u(e,t){this._key=e,this._i18n=t}p.context_delimiter=String.fromCharCode(4),r.extend(u.prototype,{onDomain:function(e){return this._domain=e,this},withContext:function(e){return this._context=e,this},ifPlural:function(e,t){return this._val=e,this._pkey=t,this},fetch:function(e){return"[object Array]"!={}.toString.call(e)&&(e=[].slice.call(arguments)),(e&&e.length?p.sprintf:function(e){return e})(this._i18n.dcnpgettext(this._domain,this._context,this._key,this._pkey,this._val),e)}}),r.extend(p.prototype,{translate:function(e){return new u(e,this)},textdomain:function(e){if(!e)return this._textdomain;this._textdomain=e},gettext:function(e){return this.dcnpgettext.call(this,i,i,e)},dgettext:function(e,t){return this.dcnpgettext.call(this,e,i,t)},dcgettext:function(e,t){return this.dcnpgettext.call(this,e,i,t)},ngettext:function(e,t,a){return this.dcnpgettext.call(this,i,i,e,t,a)},dngettext:function(e,t,a,n){return this.dcnpgettext.call(this,e,i,t,a,n)},dcngettext:function(e,t,a,n){return this.dcnpgettext.call(this,e,i,t,a,n)},pgettext:function(e,t){return this.dcnpgettext.call(this,i,e,t)},dpgettext:function(e,t,a){return this.dcnpgettext.call(this,e,t,a)},dcpgettext:function(e,t,a){return this.dcnpgettext.call(this,e,t,a)},npgettext:function(e,t,a,n){return this.dcnpgettext.call(this,i,e,t,a,n)},dnpgettext:function(e,t,a,n,i){return this.dcnpgettext.call(this,e,t,a,n,i)},dcnpgettext:function(e,t,a,n,i){var r;if(n=n||a,e=e||this._textdomain,i=void 0===i?1:i,!this.options)return(r=new p).dcnpgettext.call(r,void 0,void 0,a,n,i);if(!this.options.locale_data)throw new Error("No locale data provided.");if(!this.options.locale_data[e])throw new Error("Domain `"+e+"` was not found.");if(!this.options.locale_data[e][""])throw new Error("No locale meta information provided.");if(!a)throw new Error("No translation key found.");if("number"!=typeof i&&(i=parseInt(i,10),isNaN(i)))throw new Error("The number that was passed in is not a number.");var o,l=t?t+p.context_delimiter+a:a,s=this.options.locale_data,u=s[e],c=u[""].plural_forms||(s.messages||this.defaults.locale_data.messages)[""].plural_forms,d=g(c)(i)+1;if(!u)throw new Error("No domain named `"+e+"` could be found.");return!(o=u[l])||d>=o.length?(this.options.missing_key_callback&&this.options.missing_key_callback(l),[null,a,n][g(c)(i)+1]):o[d]||[null,a,n][g(c)(i)+1]}});var c,f=function(){function g(e){return Object.prototype.toString.call(e).slice(8,-1).toLowerCase()}function h(e,t){for(var a=[];0<t;a[--t]=e);return a.join("")}var e=function(){return e.cache.hasOwnProperty(arguments[0])||(e.cache[arguments[0]]=e.parse(arguments[0])),e.format.call(null,e.cache[arguments[0]],arguments)};return e.format=function(e,t){var a,n,i,r,o,l,s,u=1,c=e.length,d="",p=[];for(n=0;n<c;n++)if("string"===(d=g(e[n])))p.push(e[n]);else if("array"===d){if((r=e[n])[2])for(a=t[u],i=0;i<r[2].length;i++){if(!a.hasOwnProperty(r[2][i]))throw f('[sprintf] property "%s" does not exist',r[2][i]);a=a[r[2][i]]}else a=r[1]?t[r[1]]:t[u++];if(/[^s]/.test(r[8])&&"number"!=g(a))throw f("[sprintf] expecting number but found %s",g(a));switch(null==a&&(a=""),r[8]){case"b":a=a.toString(2);break;case"c":a=String.fromCharCode(a);break;case"d":a=parseInt(a,10);break;case"e":a=r[7]?a.toExponential(r[7]):a.toExponential();break;case"f":a=r[7]?parseFloat(a).toFixed(r[7]):parseFloat(a);break;case"o":a=a.toString(8);break;case"s":a=(a=String(a))&&r[7]?a.substring(0,r[7]):a;break;case"u":a=Math.abs(a);break;case"x":a=a.toString(16);break;case"X":a=a.toString(16).toUpperCase()}a=/[def]/.test(r[8])&&r[3]&&0<=a?"+"+a:a,l=r[4]?"0"==r[4]?"0":r[4].charAt(1):" ",s=r[6]-String(a).length,o=r[6]?h(l,s):"",p.push(r[5]?a+o:o+a)}return p.join("")},e.cache={},e.parse=function(e){for(var t=e,a=[],n=[],i=0;t;){if(null!==(a=/^[^\x25]+/.exec(t)))n.push(a[0]);else if(null!==(a=/^\x25{2}/.exec(t)))n.push("%");else{if(null===(a=/^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-fosuxX])/.exec(t)))throw"[sprintf] huh?";if(a[2]){i|=1;var r=[],o=a[2],l=[];if(null===(l=/^([a-z_][a-z_\d]*)/i.exec(o)))throw"[sprintf] huh?";for(r.push(l[1]);""!==(o=o.substring(l[0].length));)if(null!==(l=/^\.([a-z_][a-z_\d]*)/i.exec(o)))r.push(l[1]);else{if(null===(l=/^\[(\d+)\]/.exec(o)))throw"[sprintf] huh?";r.push(l[1])}a[2]=r}else i|=2;if(3===i)throw"[sprintf] mixing positional and named placeholders is not (yet) supported";n.push(a)}t=t.substring(a[0].length)}return n},e}();p.parse_plural=function(e,t){return e=e.replace(/n/g,t),p.parse_expression(e)},p.sprintf=function(e,t){return"[object Array]"=={}.toString.call(t)?(a=e,(n=[].slice.call(t)).unshift(a),f.apply(null,n)):f.apply(this,[].slice.call(arguments));var a,n},p.prototype.sprintf=function(){return p.sprintf.apply(this,arguments)},(p.PF={}).parse=function(e){var t=p.PF.extractPluralExpr(e);return p.PF.parser.parse.call(p.PF.parser,t)},p.PF.compile=function(e){var a=p.PF.parse(e);return function(e){return!0===(t=p.PF.interpreter(a)(e))?1:t||0;var t}},p.PF.interpreter=function(t){return function(e){switch(t.type){case"GROUP":return p.PF.interpreter(t.expr)(e);case"TERNARY":return p.PF.interpreter(t.expr)(e)?p.PF.interpreter(t.truthy)(e):p.PF.interpreter(t.falsey)(e);case"OR":return p.PF.interpreter(t.left)(e)||p.PF.interpreter(t.right)(e);case"AND":return p.PF.interpreter(t.left)(e)&&p.PF.interpreter(t.right)(e);case"LT":return p.PF.interpreter(t.left)(e)<p.PF.interpreter(t.right)(e);case"GT":return p.PF.interpreter(t.left)(e)>p.PF.interpreter(t.right)(e);case"LTE":return p.PF.interpreter(t.left)(e)<=p.PF.interpreter(t.right)(e);case"GTE":return p.PF.interpreter(t.left)(e)>=p.PF.interpreter(t.right)(e);case"EQ":return p.PF.interpreter(t.left)(e)==p.PF.interpreter(t.right)(e);case"NEQ":return p.PF.interpreter(t.left)(e)!=p.PF.interpreter(t.right)(e);case"MOD":return p.PF.interpreter(t.left)(e)%p.PF.interpreter(t.right)(e);case"VAR":return e;case"NUM":return t.val;default:throw new Error("Invalid Token found.")}}},p.PF.extractPluralExpr=function(e){e=e.replace(/^\s\s*/,"").replace(/\s\s*$/,""),/;\s*$/.test(e)||(e=e.concat(";"));var t,a=/nplurals\=(\d+);/,n=e.match(a);if(!(1<n.length))throw new Error("nplurals not found in plural_forms string: "+e);if(n[1],!((t=(e=e.replace(a,"")).match(/plural\=(.*);/))&&1<t.length))throw new Error("`plural` expression not found: "+e);return t[1]},p.PF.parser=((c={trace:function(){},yy:{},symbols_:{error:2,expressions:3,e:4,EOF:5,"?":6,":":7,"||":8,"&&":9,"<":10,"<=":11,">":12,">=":13,"!=":14,"==":15,"%":16,"(":17,")":18,n:19,NUMBER:20,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",6:"?",7:":",8:"||",9:"&&",10:"<",11:"<=",12:">",13:">=",14:"!=",15:"==",16:"%",17:"(",18:")",19:"n",20:"NUMBER"},productions_:[0,[3,2],[4,5],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,1],[4,1]],performAction:function(e,t,a,n,i,r,o){var l=r.length-1;switch(i){case 1:return{type:"GROUP",expr:r[l-1]};case 2:this.$={type:"TERNARY",expr:r[l-4],truthy:r[l-2],falsey:r[l]};break;case 3:this.$={type:"OR",left:r[l-2],right:r[l]};break;case 4:this.$={type:"AND",left:r[l-2],right:r[l]};break;case 5:this.$={type:"LT",left:r[l-2],right:r[l]};break;case 6:this.$={type:"LTE",left:r[l-2],right:r[l]};break;case 7:this.$={type:"GT",left:r[l-2],right:r[l]};break;case 8:this.$={type:"GTE",left:r[l-2],right:r[l]};break;case 9:this.$={type:"NEQ",left:r[l-2],right:r[l]};break;case 10:this.$={type:"EQ",left:r[l-2],right:r[l]};break;case 11:this.$={type:"MOD",left:r[l-2],right:r[l]};break;case 12:this.$={type:"GROUP",expr:r[l-1]};break;case 13:this.$={type:"VAR"};break;case 14:this.$={type:"NUM",val:Number(e)}}},table:[{3:1,4:2,17:[1,3],19:[1,4],20:[1,5]},{1:[3]},{5:[1,6],6:[1,7],8:[1,8],9:[1,9],10:[1,10],11:[1,11],12:[1,12],13:[1,13],14:[1,14],15:[1,15],16:[1,16]},{4:17,17:[1,3],19:[1,4],20:[1,5]},{5:[2,13],6:[2,13],7:[2,13],8:[2,13],9:[2,13],10:[2,13],11:[2,13],12:[2,13],13:[2,13],14:[2,13],15:[2,13],16:[2,13],18:[2,13]},{5:[2,14],6:[2,14],7:[2,14],8:[2,14],9:[2,14],10:[2,14],11:[2,14],12:[2,14],13:[2,14],14:[2,14],15:[2,14],16:[2,14],18:[2,14]},{1:[2,1]},{4:18,17:[1,3],19:[1,4],20:[1,5]},{4:19,17:[1,3],19:[1,4],20:[1,5]},{4:20,17:[1,3],19:[1,4],20:[1,5]},{4:21,17:[1,3],19:[1,4],20:[1,5]},{4:22,17:[1,3],19:[1,4],20:[1,5]},{4:23,17:[1,3],19:[1,4],20:[1,5]},{4:24,17:[1,3],19:[1,4],20:[1,5]},{4:25,17:[1,3],19:[1,4],20:[1,5]},{4:26,17:[1,3],19:[1,4],20:[1,5]},{4:27,17:[1,3],19:[1,4],20:[1,5]},{6:[1,7],8:[1,8],9:[1,9],10:[1,10],11:[1,11],12:[1,12],13:[1,13],14:[1,14],15:[1,15],16:[1,16],18:[1,28]},{6:[1,7],7:[1,29],8:[1,8],9:[1,9],10:[1,10],11:[1,11],12:[1,12],13:[1,13],14:[1,14],15:[1,15],16:[1,16]},{5:[2,3],6:[2,3],7:[2,3],8:[2,3],9:[1,9],10:[1,10],11:[1,11],12:[1,12],13:[1,13],14:[1,14],15:[1,15],16:[1,16],18:[2,3]},{5:[2,4],6:[2,4],7:[2,4],8:[2,4],9:[2,4],10:[1,10],11:[1,11],12:[1,12],13:[1,13],14:[1,14],15:[1,15],16:[1,16],18:[2,4]},{5:[2,5],6:[2,5],7:[2,5],8:[2,5],9:[2,5],10:[2,5],11:[2,5],12:[2,5],13:[2,5],14:[2,5],15:[2,5],16:[1,16],18:[2,5]},{5:[2,6],6:[2,6],7:[2,6],8:[2,6],9:[2,6],10:[2,6],11:[2,6],12:[2,6],13:[2,6],14:[2,6],15:[2,6],16:[1,16],18:[2,6]},{5:[2,7],6:[2,7],7:[2,7],8:[2,7],9:[2,7],10:[2,7],11:[2,7],12:[2,7],13:[2,7],14:[2,7],15:[2,7],16:[1,16],18:[2,7]},{5:[2,8],6:[2,8],7:[2,8],8:[2,8],9:[2,8],10:[2,8],11:[2,8],12:[2,8],13:[2,8],14:[2,8],15:[2,8],16:[1,16],18:[2,8]},{5:[2,9],6:[2,9],7:[2,9],8:[2,9],9:[2,9],10:[2,9],11:[2,9],12:[2,9],13:[2,9],14:[2,9],15:[2,9],16:[1,16],18:[2,9]},{5:[2,10],6:[2,10],7:[2,10],8:[2,10],9:[2,10],10:[2,10],11:[2,10],12:[2,10],13:[2,10],14:[2,10],15:[2,10],16:[1,16],18:[2,10]},{5:[2,11],6:[2,11],7:[2,11],8:[2,11],9:[2,11],10:[2,11],11:[2,11],12:[2,11],13:[2,11],14:[2,11],15:[2,11],16:[2,11],18:[2,11]},{5:[2,12],6:[2,12],7:[2,12],8:[2,12],9:[2,12],10:[2,12],11:[2,12],12:[2,12],13:[2,12],14:[2,12],15:[2,12],16:[2,12],18:[2,12]},{4:30,17:[1,3],19:[1,4],20:[1,5]},{5:[2,2],6:[1,7],7:[2,2],8:[1,8],9:[1,9],10:[1,10],11:[1,11],12:[1,12],13:[1,13],14:[1,14],15:[1,15],16:[1,16],18:[2,2]}],defaultActions:{6:[2,1]},parseError:function(e,t){throw new Error(e)},parse:function(e){var t=this,a=[0],n=[null],i=[],r=this.table,o="",l=0,s=0,u=0;this.lexer.setInput(e),this.lexer.yy=this.yy,this.yy.lexer=this.lexer,void 0===this.lexer.yylloc&&(this.lexer.yylloc={});var c=this.lexer.yylloc;function d(){var e;return"number"!=typeof(e=t.lexer.lex()||1)&&(e=t.symbols_[e]||e),e}i.push(c),"function"==typeof this.yy.parseError&&(this.parseError=this.yy.parseError);for(var p,g,h,f,m,v,x,b,S,y,w={};;){if(h=a[a.length-1],void 0===(f=this.defaultActions[h]?this.defaultActions[h]:(null==p&&(p=d()),r[h]&&r[h][p]))||!f.length||!f[0]){if(!u){for(v in S=[],r[h])this.terminals_[v]&&2<v&&S.push("'"+this.terminals_[v]+"'");var D="";D=this.lexer.showPosition?"Parse error on line "+(l+1)+":\n"+this.lexer.showPosition()+"\nExpecting "+S.join(", ")+", got '"+this.terminals_[p]+"'":"Parse error on line "+(l+1)+": Unexpected "+(1==p?"end of input":"'"+(this.terminals_[p]||p)+"'"),this.parseError(D,{text:this.lexer.match,token:this.terminals_[p]||p,line:this.lexer.yylineno,loc:c,expected:S})}if(3==u){if(1==p)throw new Error(D||"Parsing halted.");s=this.lexer.yyleng,o=this.lexer.yytext,l=this.lexer.yylineno,c=this.lexer.yylloc,p=d()}for(;!(2..toString()in r[h]);){if(0==h)throw new Error(D||"Parsing halted.");y=1,a.length=a.length-2*y,n.length=n.length-y,i.length=i.length-y,h=a[a.length-1]}g=p,p=2,f=r[h=a[a.length-1]]&&r[h][2],u=3}if(f[0]instanceof Array&&1<f.length)throw new Error("Parse Error: multiple actions possible at state: "+h+", token: "+p);switch(f[0]){case 1:a.push(p),n.push(this.lexer.yytext),i.push(this.lexer.yylloc),a.push(f[1]),p=null,g?(p=g,g=null):(s=this.lexer.yyleng,o=this.lexer.yytext,l=this.lexer.yylineno,c=this.lexer.yylloc,0<u&&u--);break;case 2:if(x=this.productions_[f[1]][1],w.$=n[n.length-x],w._$={first_line:i[i.length-(x||1)].first_line,last_line:i[i.length-1].last_line,first_column:i[i.length-(x||1)].first_column,last_column:i[i.length-1].last_column},void 0!==(m=this.performAction.call(w,o,s,l,this.yy,f[1],n,i)))return m;x&&(a=a.slice(0,-1*x*2),n=n.slice(0,-1*x),i=i.slice(0,-1*x)),a.push(this.productions_[f[1]][0]),n.push(w.$),i.push(w._$),b=r[a[a.length-2]][a[a.length-1]],a.push(b);break;case 3:return!0}}return!0}}).lexer={EOF:1,parseError:function(e,t){if(!this.yy.parseError)throw new Error(e);this.yy.parseError(e,t)},setInput:function(e){return this._input=e,this._more=this._less=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this},input:function(){var e=this._input[0];return this.yytext+=e,this.yyleng++,this.match+=e,this.matched+=e,e.match(/\n/)&&this.yylineno++,this._input=this._input.slice(1),e},unput:function(e){return this._input=e+this._input,this},more:function(){return this._more=!0,this},pastInput:function(){var e=this.matched.substr(0,this.matched.length-this.match.length);return(20<e.length?"...":"")+e.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var e=this.match;return e.length<20&&(e+=this._input.substr(0,20-e.length)),(e.substr(0,20)+(20<e.length?"...":"")).replace(/\n/g,"")},showPosition:function(){var e=this.pastInput(),t=new Array(e.length+1).join("-");return e+this.upcomingInput()+"\n"+t+"^"},next:function(){if(this.done)return this.EOF;var e,t;this._input||(this.done=!0),this._more||(this.yytext="",this.match="");for(var a=this._currentRules(),n=0;n<a.length;n++)if(e=this._input.match(this.rules[a[n]]))return(t=e[0].match(/\n.*/g))&&(this.yylineno+=t.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:t?t[t.length-1].length-1:this.yylloc.last_column+e[0].length},this.yytext+=e[0],this.match+=e[0],this.matches=e,this.yyleng=this.yytext.length,this._more=!1,this._input=this._input.slice(e[0].length),this.matched+=e[0],this.performAction.call(this,this.yy,this,a[n],this.conditionStack[this.conditionStack.length-1])||void 0;if(""===this._input)return this.EOF;this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var e=this.next();return void 0!==e?e:this.lex()},begin:function(e){this.conditionStack.push(e)},popState:function(){return this.conditionStack.pop()},_currentRules:function(){return this.conditions[this.conditionStack[this.conditionStack.length-1]].rules},topState:function(){return this.conditionStack[this.conditionStack.length-2]},pushState:function(e){this.begin(e)},performAction:function(e,t,a,n){switch(a){case 0:break;case 1:return 20;case 2:return 19;case 3:return 8;case 4:return 9;case 5:return 6;case 6:return 7;case 7:return 11;case 8:return 13;case 9:return 10;case 10:return 12;case 11:return 14;case 12:return 15;case 13:return 16;case 14:return 17;case 15:return 18;case 16:return 5;case 17:return"INVALID"}},rules:[/^\s+/,/^[0-9]+(\.[0-9]+)?\b/,/^n\b/,/^\|\|/,/^&&/,/^\?/,/^:/,/^<=/,/^>=/,/^</,/^>/,/^!=/,/^==/,/^%/,/^\(/,/^\)/,/^$/,/^./],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17],inclusive:!0}}},c),"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=p),exports.Jed=p):("function"==typeof define&&define.amd&&define("jed",function(){return p}),e.Jed=p)}(this),esgAngularDependencies.push("RcWareVisionDropdownMenu"),angular.module("RcWareVisionDropdownMenu",[]).directive("dropdownToggleScrollable",["$document","$location","$window","$log","ApiWinResize","$timeout",function(r,e,t,a,o,l){var s=null,u=angular.noop;return{restrict:"CA",scope:{},link:function(n,i,e){n.$watch("$location.path",function(){u()}),n.ApiWinResize=o,n.element=i[0];var t=i.parent().find(".dropdown-menu-scrollable")[0];void 0===t&&(t=i.parent()[0].children[1]),$(n.element).onmousewheel=function(e){var t;return document.getElementById("a").scrollTop-=e.wheelDeltaY,(t=(t=e)||window.event).preventDefault&&t.preventDefault(),t.returnValue=!1},n.mainDivElement=t,n.setMaxHeight=function(){var e=i.parent().find(".dropdown-menu-scrollable")[0];void 0===e&&(e=i.parent()[0].children[1]);var t=e.getBoundingClientRect().top;if(e.scrollHeight+t+12>o.getHeight()){var a=$(window)[0].innerHeight-t-12;$(e).css("max-height",a),$(e).addClass("scroll-enabled")}else $(e).css("max-height","none"),$(e).removeClass("scroll-enabled")},n.$watch("mainDivElement.clientHeight",function(e,t){0!==e&&i===s&&n.setMaxHeight()}),n.$watch("ApiWinResize.size.ratio",function(e,t){0!==e&&i===s&&n.setMaxHeight()}),i.parent().bind("click",function(){u()}),i.bind("click",function(e){e.preventDefault(),e.stopPropagation();var t=i===s;if(s&&u(),!t){i.parent().addClass("open");var a=i.parent().find("input")[0];void 0!==a&&l(function(){a.focus()},0),n.setMaxHeight(),s=i,u=function(e){e&&(e.preventDefault(),e.stopPropagation()),r.unbind("click",u),i.parent().removeClass("open"),u=angular.noop,s=null},r.bind("click",u)}})}}}]).directive("esgDropdownSearchFilter",["$log","$sce","$filter","BrowserDetection","ApiWinResize",function(e,n,i,o,t){return{transclude:!1,templateUrl:"html/templates/esgDropdownTemplate.html",replace:!0,restrict:"E",scope:{value:"=",listValues:"=",showIco:"=",icoClass:"@",offsetTop:"=",searchString:"=",disableSearch:"=",displayProperty:"@",filter:"@",esgCallbackFunction:"&callbackFunction",useFunction:"=",itemClass:"@"},link:function(r,a,e){r.openElement=a,r.dropdownElement=r.openElement.find(".dropdown-menu")[0],r.dropdownElementIcon=r.openElement.find(".dropdown-toggle-scrollable"),r.browser=o.browserDetection(),r.timer=null,r.callbackFceUsed=!1,void 0!==(r.attrs=e).esgCallbackFunction&&(r.callbackFceUsed=!0),!0===r.disableSearch?r.hideSearch=!0:r.hideSearch=!1,r.mainDivElement=a.find("dropdown-toggle-scrollable").prevObject;var t=a.find("input");return r.elm=a.find(".dropdown-menu-scrollable"),r.listValuesFiltered=function(){return r.listValuesFilteredArray},r.mouseEnter=function(e){r.setValue(r.listValuesFilteredArray[e]),r.activeRow=r.defaultItem,r.mainDivElement.trigger("click"),r.openElement=null},$(t).bind("focus",function(e){r.focus=!0,r.$digest()}),r.handleKeydown=function(e){var t;if(0<r.listValuesFilteredArray.length)if(40==e.keyCode){if(r.activeRow==r.defaultItem&&r.store>r.defaultItem)r.store<r.listValuesFilteredArray.length-1?r.activeRow=r.store:r.activeRow=r.listValuesFilteredArray.length-1;else if(r.activeRow<r.listValuesFilteredArray.length-1){for(t=r.activeRow;t++,0==r.isVisible(r.listValuesFilteredArray[t])&&t<=r.listValuesFilteredArray.length-1;);t<=r.listValuesFilteredArray.length-1&&(r.activeRow=t)}else r.activeRow=r.listValuesFilteredArray.length-1;r.store=r.defaultItem;for(var a=r.elm.find("ul"),n=0,i=0;i<r.activeRow+1;i++)n+=a[0].children[i].clientHeight;0<(n-=r.elm[0].scrollTop+r.elm[0].clientHeight)&&(r.elm[0].scrollTop+=n),e.preventDefault()}else if(38==e.keyCode){if(r.activeRow==r.defaultItem&&r.store>r.defaultItem)r.activeRow=r.store;else if(0<r.activeRow){for(t=r.activeRow;t--,!r.isVisible(r.listValuesFilteredArray[t])&&0<t;);t>r.defaultItem&&r.isVisible(r.listValuesFilteredArray[t])?r.activeRow=t:r.activeRow=r.defaultItem}else r.activeRow=r.defaultItem;r.store=r.defaultItem;for(a=r.elm.find("ul"),n=0,i=0;i<r.activeRow;i++)n+=a[0].children[i].clientHeight;(n-=r.elm[0].scrollTop)<0&&(r.elm[0].scrollTop+=n),e.preventDefault()}else 13==e.keyCode?(r.activeRow==r.defaultItem&&r.store>r.defaultItem&&(r.activeRow=r.store,r.store=r.defaultItem),r.mouseEnter(r.activeRow)):27==e.keyCode&&(r.store=r.defaultItem,r.activeRow=r.defaultItem,r.mainDivElement.trigger("click"),r.openElement=null)},r.setActiveRow=function(e,t){void 0!==r.listValuesFilteredArray[t]&&(r.activeRow=e)},r.itemMouseover=function(e,t){r.storeActiveRow(e),r.setActiveRow(e,t),r.$digest()},r.storeActiveRow=function(e){r.store=e},r.setValue=function(e){r.useFunction?r.esgCallbackFunction({view:e}):r.value=e},r.searchClick=function(e){e.stopPropagation()},r.highlightSafeHtml=function(e){return n.trustAsHtml(i("HighlightFilter")(e,r.searchString))},r.addClass=function(e,t){var a=!1;return r.isVisible(t)&&-1<e&&e==r.activeRow&&(a=!0),a},r.$watch("searchDelay",function(e,t){void 0!==e&&(clearTimeout(r.timer),r.timer=setTimeout(function(){r.$apply(function(){0!=r.hideSearch&&(r.searchString=e),r.search=e,0==r.isVisible(r.listValuesFilteredArray[r.activeRow])&&r.setDefaultItem()})},300))}),r.$watch("dropdownMenuScrollElement.clientHeight",function(e,t){void 0!==e&&0!==e&&a===r.openElement&&r.setScrollVariables()}),r.$watch("dropdownElement.clientHeight",function(e,t){void 0!==e&&0!==e&&(void 0===r.activeRow||r.activeRow<0)&&r.setDefaultItem()}),r.dropdownElementIcon.bind("click",function(){r.$digest()}),r.$watch("ApiWinResize.size.ratio",function(e,t){void 0!==e&&0!==e&&a===r.openElement&&r.setScrollVariables()}),["$scope","iElement","iAttrs","controller",function(e,t,a,n){}]},controller:["$scope",function(a){a.focus=!1,a.listValuesFilteredArray=[],a.defaultItem=0,a.searchDelay="",a.isVisible=function(e){return void 0!==e&&(""==a.search||-1<e[a.displayProperty].toLowerCase().indexOf(a.search.toLowerCase()))},a.createListValues=function(){return void 0!==a.filter?i(a.filter)(a.listValues):a.listValues},a.$watch("listValues.length",function(){a.listValuesArray=a.createListValues(),a.filterAndTrimData()}),a.$watch("search",function(e,t){a.filterAndTrimData()}),a.filterAndTrimData=function(){a.listValuesFilteredArray=[],angular.forEach(a.listValuesArray,function(e){i("filterLogicalOperators")(e[a.displayProperty],a.search)&&a.listValuesFilteredArray.push(e)})},a.clearInput=function(){a.search="",void 0!==a.searchString?a.searchString="":a.searchDelay=""},a.setDefaultItem=function(){var e=a.defaultItem;if(-1<e)for(;0==a.isVisible(a.listValuesFilteredArray[e])&&e<=a.listValuesFilteredArray.length-1;)e++;a.activeRow=e,a.store=e},a.clearInput(),a.ApiWinResize=t,a.setScrollVariables=function(){a.dropdownMenuScrollElement=a.elm[0],a.aElement=a.elm.find("a"),void 0!==a.aElement[0]?a.heightOfLine=a.aElement[0].clientHeight:a.heightOfLine=22,a.offsetBottom=a.offsetTop+a.dropdownMenuScrollElement.clientHeight}}]}}]).directive("rcWareDropdown",["$log","$filter",function(e,t){return{transclude:!1,templateUrl:"html/templates/rcWareDropdownTemplate.html",replace:!0,restrict:"E",scope:{selectSettings:"="},link:function(a,e,t,n){return a.filterIsUsed=!1,void 0!==a.selectSettings.filterValues&&(a.filterIsUsed=!0),a.$watch("selectSettings.selectPossibleValues",function(e,t){void 0!==e&&0<e.length&&(void 0!==a.selectSettings&&a.selectSettings.filterValues,null==a.selectSettings.selectValue&&(a.selectSettings.selectValue=e[0]))}),["$scope","iElement","iAttrs","controller",function(e,t,a,n){}]},controller:["$scope",function(e){}]}}]),angular.module("Dictionary",[]).service("Dictionary",function(){return{cs:{"":{domain:"messages",lang:"cs",plural_forms:"nplurals=3; plural=n==0 ? 2 : n==1 ? 0 : n<5 ? 1 : 2;",datetime_formats:{month:["leden","únor","březen","duben","květen","červen","červenec","srpen","září","říjen","listopad","prosinec"],monthInflection:["ledna","února","března","dubna","května","června","července","srpna","září","října","listopadu","prosince"],shortmonth:["led","úno","bře","dub","kvě","čvn","čvc","srp","zář","říj","lis","pro"],day:{0:"neděle",1:"pondělí",2:"úterý",3:"středa",4:"čtvrtek",5:"pátek",6:"sobota"},shortday:["ne","po","út","st","čt","pá","so"],ampms:["dop.","odp."],medium:"d.M.yyyy H:mm:ss",short:"d.M.yy H:mm",fullDate:"EEEE, d. MMMM y",longDate:"d. MMMM y",mediumDate:"d.M.yyyy",shortDate:"d.M.yy",mediumTime:"H:mm:ss",shortTime:"H:mm",timeSeparator:":",dateSeparator:".",decimalPoint:",",groupSeparator:" "}},monday:[null,"pondělí"],tuesday:[null,"úterý"],wednesday:[null,"středa"],thursday:[null,"čtvrtek"],friday:[null,"pátek"],saturday:[null,"sobota"],sunday:[null,"neděle"],january:[null,"leden"],february:[null,"únor"],march:[null,"březen"],april:[null,"duben"],may:[null,"květen"],june:[null,"červen"],july:[null,"červenec"],august:[null,"srpen"],september:[null,"září"],october:[null,"říjen"],november:[null,"listopad"],december:[null,"prosinec"],Username:[null,"Uživatelské jméno"],Password:[null,"Heslo"],Login:[null,"Přihlášení"],"$ minute":[null,"%d minuta","%d minuty","%d minut"],"$ day":[null,"%d den","%d dny","%d dnů"],"$ hour":[null,"%d hodina","%d hodiny","%d hodin"],"$ week":[null,"%d týden","%d týdny","%d týdnů"],"$ month":[null,"%d měsíc","%d měsíce","%d měsíců"],"$ year":[null,"%d rok","%d roky","%d let"],"It exceeds available $ exception.":[null,"Přesahuje dosupnou %d výjimku.","Přesahuje dostupné %d výjimky.","Přesahuje dostupných %d výjimek."],"Available $ exception.":[null,"Dosupná %d výjimka.","Dostupné %d výjimky.","Dostupných %d výjimek."],"Exception list will be merged to $ item.":[null,"Seznam výjimek bude spojen do %d položky.","Seznam výjimek bude spojen do %d položek.","Seznam výjimek bude spojen do %d položek."],"It exceeds available $ state change.":[null,"Přesahuje dostupný %d přechod.","Přesahuje dostupné %d přechody.","Přesahuje dostupných %d přechodů."],"Available $ state change.":[null,"Dostupný %d přechod.","Dostupné %d přechody.","Dostupných %d přechodů."],"Schedule will be converted to $ state change.":[null,"Časový program bude shrnut do %d přechodu.","Časový program bude shrnut do %d přechodů.","Časový program bude shrnut do %d přechodů."],"Table view":[null,"Tabulka"],Exceptions:[null,"Výjimky"],Set:[null,"Nastavit"],Cancel:[null,"Storno"],Close:[null,"Zavřít"],Create:[null,"Vytvořit"],Update:[null,"Aktualizovat"],TPG:[null,"TPG"],"No events":[null,"Žádné události"],"No exceptions":[null,"Žádné výjimky"],From:[null,"Od"],"From:":[null,"Od:"],"To:":[null,"Do:"],To:[null,"Do"],Add:[null,"Přidat"],"Round time":[null,"Zaokrouhlovat čas"],Delete:[null,"Smazat"],"TPG items error.":[null,"Chyba v časovém programu."],"TPG items and exceptions items error.":[null,"Chyba v časovém programu a výjimkách."],"TPG exception items error.":[null,"Chyba ve výjimkách."],"User login":[null,"Přihlášení"],"Log in":[null,"Přihlásit"],"History data export":[null,"Export historických dat"],"Logged user":[null,"Přihlášený uživatel"],"Fit schema to window without scrolling":[null,"Přizpůsobit velikost schématu velikosti prohlížeče"],"Fit schema to width of window":[null,"Zobrazit schéma na šířku prohlížeče"],"Show schema in original size":[null,"Zobrazit schéma v originální velikosti"],"Round time:":[null,"Zaokrouhlovat čas:"],Yes:[null,"Ano"],No:[null,"Ne"],"Show/hide series points":[null,"Zobrazit všechny body"],Quarterhour:[null,"Čtvrthodina","Čtvrthodiny","Čtvrthodin"],Hour:[null,"Hodina","Hodiny","Hodin"],Day:[null,"Den","Dny","Dnů"],Week:[null,"Týden","Týdny","Týdnů"],Month:[null,"Měsíc","Měsíce","Měsíců"],Year:[null,"Rok","Roky","Let"],"from/to":[null,"od/do"],Today:[null,"Dnešní den"],Yesterday:[null,"Včerejší den"],"¼ hour":[null,"čtvrhodina"],minute:[null,"minuta"],Line:[null,"Čárový"],"Pan left":[null,"Posunout vlevo"],"Pan right":[null,"Posunout vpravo"],"Zoom in":[null,"Přiblížit"],"Zoom out":[null,"Oddálit"],"Show graph in full screen mode":[null,"Zobrazit graf přes celou obrazovku"],"Show graph controls":[null,"Zobrazit ovládání grafu"],"Hide graph controls":[null,"Skrýt ovládání grafu"],"Full legend":[null,"Kompletní legenda"],"Simple legend":[null,"Zkrácená legenda"],"No legend":[null,"Žádná legenda"],"no data":[null,"chybějící data"],"Log out":[null,"Odhlásit"],Filter:[null,"Filtr"],"Select series graph range":[null,"Vybrat časové období"],"Oscilloscope mode":[null,"Osciloskopický režim"],"Show graph":[null,"Zobrazit graf"],"Reload all data":[null,"Znovu načíst data zobrazená v grafu"],"Graph Export":[null,"Export grafu"],"Cancel variables selection":[null,"Zrušit vybrané body"],"Data point":[null,"Datový bod"],"Hide tooltips":[null,"Skrýt popisky"],Date:[null,"Datum"],Value:[null,"Hodnota"],"Wrong username or password":[null,"Špatné uživatelské jméno nebo heslo"],"PLC isn't responding":[null,"PLC neodpovídá"],"About application":[null,"O aplikaci"],"Licences:":[null,"Licence:"],"Show or hide alarm history panel":[null,"Zobrazit/schovat panel s historií alarmů"],Alarms:[null,"Alarmy"],Time:[null,"Čas"],Message:[null,"Zpráva"],State:[null,"Stav"],Actions:[null,"Akce"],"Source Id":[null,"Zdroj"],Note:[null,"Poznámka"],"No items":[null,"Prázdné"],"Previous page":[null,"Předchozí strana"],"Next page":[null,"Následující strana"],Refresh:[null,"Obnovit"],"Export data as CSV":[null,"Export dat ve formátu CSV"],"Change date range":[null,"Zvolit časové období"],"Change table sorting":[null,"Změnit řazení tabulky"],"Show system configuration":[null,"Zobrazit systémovou konfiguraci"],Graph:[null,"Graf"],"System configuration":[null,"Systémová konfigurace"],"Network settings":[null,"Nastavení sítě"],"Use DHCP":[null,"Použít DHCP"],"IP address":[null,"IP adresa"],"Network Mask":[null,"Maska sítě"],"Default Gateway":[null,"Výchozí brána"],"Show alarms":[null,"Zobrazit alarmy"],"Show system log":[null,"Zobrazit systémový log"],"Actual Value":[null,"Aktuální hodnota"],"Allowed values":[null,"Povolené hodnoty"],"Insert PIN":[null,"Vložte PIN"],Lock:[null,"Otevřít"],Unlock:[null,"Zavřít"]},en:{"":{domain:"messages",lang:"en","plural-forms":"nplurals=2; plural=(n != 1);",datetime_formats:{month:["January","February","March","April","May","June","July","August","September","October","November","December"],shortmonth:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],day:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortday:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],ampms:["AM","PM"],medium:"MMM d, y h:mm:ss a",short:"M/d/yy h:mm a",fullDate:"EEEE, MMMM d, y",longDate:"MMMM d, y",mediumDate:"MMM d, y",shortDate:"M/d/yy",mediumTime:"h:mm:ss a",shortTime:"h:mm a",timeSeparator:":",dateSeparator:"/",decimalPoint:".",groupSeparator:","}},"$ minute":[null,"%d minute","%d minutes"],"$ hour":[null,"%d hour","%d hours"],"$ day":[null,"%d day","%d days"],"$ week":[null,"%d week","%d weeks"],"$ month":[null,"%d month","%d months"],"$ year":[null,"%d year","%d years"],"It exceeds available $ exception.":[null,"It exceeds available %d exception.","It exceeds available %d exceptions."],"Available $ exception.":[null,"Available %d exception.","Available %d exceptions."],"Exception list will be merged to $ item.":[null,"Exception list will be merged to %d item.","Exception list will be merged to %d items."],"It exceeds available $ state change.":[null,"It exceeds available %d state change.","It exceeds available %d state changes."],"Available $ state change.":[null,"Available %d state change.","Available %d state changes."],"Schedule will be converted to $ state change.":[null,"Schedule will be converted to %d state change.","Schedule will be converted to %d state changes."],commError:[null,"comm error"],noData:[null,"no data"],notDefined:[null,"not defined"],unknownVar:[null,"unknown var"],insufficientRights:[null,"insufficient rights"]},es:{"":{domain:"messages",lang:"es",plural_forms:"nplurals=3; plural=n==0 ? 2 : n==1 ? 0 : n<5 ? 1 : 2;",datetime_formats:{month:["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],monthInflection:["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],shortmonth:["Ene","Feb","Mar","Abr","May","Jun","Jul","Ago","Sep","Oct","Nov","Dic"],day:["Domingo","Lunes","Martes","Miércoles","Jueves","Viernes","Sabado"],shortday:["Dom","Lun","Mar","Mie","Jue","Vie","Sab"],ampms:["AM","PM"],medium:"MMM d, y h:mm:ss a",short:"M/d/yy h:mm a",fullDate:"EEEE, MMMM d, y",longDate:"MMMM d, y",mediumDate:"MMM d, y",shortDate:"M/d/yy",mediumTime:"h:mm:ss a",shortTime:"h:mm a",timeSeparator:":",dateSeparator:"/",decimalPoint:".",groupSeparator:","}},monday:[null,"Lunes"],tuesday:[null,"Martes"],wednesday:[null,"Miércoles"],thursday:[null,"Jueves"],friday:[null,"Viernes"],saturday:[null,"Sabado"],sunday:[null,"Domingo"],january:[null,"Enero"],february:[null,"Febrero"],march:[null,"Marzo"],april:[null,"Abril"],may:[null,"Mayo"],june:[null,"Junio"],july:[null,"Julio"],august:[null,"Agosto"],september:[null,"Septiembre"],october:[null,"Octubre"],november:[null,"Noviembre"],december:[null,"Diciembre"],Username:[null,"Usuario"],Password:[null,"Contraseña"],Login:[null,"Iniciar sesión"],"$ minute":[null,"%d minuto","%d minutos","%d minutos"],"$ day":[null,"%d día","%d días","%d días"],"$ hour":[null,"%d hora","%d horas","%d horas"],"$ week":[null,"%d semana","%d semanas","%d semanas"],"$ month":[null,"%d mes","%d meses","%d meses"],"$ year":[null,"%d año","%d años","%d años"],"It exceeds available $ exception.":[null,"Excede la excepción %d disponible.","Excede los %d excepciónes disponibles.","Excede los %d excepciónes disponibles."],"Available $ exception.":[null,"%d excepción disponible.","%d excepcións disponibles.","%d excepcións disponibles."],"Exception list will be merged to $ item.":[null,"La lista de excepciones se fusionará con %d.","La lista de excepciones se fusionará con %d.","La lista de excepciones se fusionará con %d."],"It exceeds available $ state change.":[null,"Excede el cambio de estado disponible %d.","Excede el cambio de estados disponibles %d.","Excede el cambio de estados disponibles %d."],"Available $ state change.":[null,"Disponible cambio de estado %d.","Disponible cambios de estado %d.","Disponible cambios de estado %d."],"Schedule will be converted to $ state change.":[null,"El horario se convertirá a %d cambio de estado.","El horario se convertirá a %d cambios de estado.","El horario se convertirá a %d cambios de estado."],"Table view":[null,"Vista de tabla"],Exceptions:[null,"Excepciones"],Set:[null,"Ajustar"],Cancel:[null,"Cancelar"],Close:[null,"Cerrar"],Create:[null,"Crear"],Update:[null,"Actualizar"],TPG:[null,"TPG"],"No events":[null,"Sin eventos"],"No exceptions":[null,"Sin excepciones"],From:[null,"De"],"From:":[null,"De:"],"To:":[null,"A:"],To:[null,"A"],Add:[null,"Añadir"],"Round time":[null,"Redondear de tiempo"],Delete:[null,"Eliminar"],"TPG items error.":[null,"Error de artículos TPG."],"TPG items and exceptions items error.":[null,"Error de artículos TPG y artículos de excepciones."],"TPG exception items error.":[null,"Error de elementos de excepción de TPG."],"User login":[null,"Iniciar sesión de usuario"],"Log in":[null,"Iniciar sesión"],"History data export":[null,"Exportación de históricos"],"Logged user":[null,"Usuario registrado"],"Fit schema to window without scrolling":[null,"Ajustar esquema a la ventana sin desplazarse"],"Fit schema to width of window":[null,"Ajustar esquema al ancho de la ventana"],"Show schema in original size":[null,"Mostrar esquema en tamaño original"],"Round time:":[null,"Redondear de tiempo:"],Yes:[null,"Si"],No:[null,"No"],"Show/hide series points":[null,"Mostrar/ocultar todos los puntos"],Quarterhour:[null,"Cuarto de hora","Cuartos de hora","Cuartos de hora"],Hour:[null,"Hora","Horas","Horas"],Day:[null,"Día","Día","Días"],Week:[null,"Semana","Semanas","Semanas"],Month:[null,"Mes","Meses","Meses"],Year:[null,"Año","Años","Años"],"from/to":[null,"de/a"],Today:[null,"Hoy"],Yesterday:[null,"Ayer"],"¼ hour":[null,"¼ hora"],minute:[null,"minuto"],Line:[null,"Línea"],"Pan left":[null,"Mover a la izquierda"],"Pan right":[null,"Mover a la derecha"],"Zoom in":[null,"Acercar"],"Zoom out":[null,"Alejar"],"Show graph in full screen mode":[null,"Mostrar gráfico en pantalla completa"],"Show graph controls":[null,"Mostrar controles de gráficos"],"Hide graph controls":[null,"Ocultar controles de gráficos"],"Full legend":[null,"Leyenda completa"],"Simple legend":[null,"Leyenda simple"],"No legend":[null,"Sin leyenda"],"no data":[null,"Datos no disponibles"],"Log out":[null,"Cerrar sesión"],Filter:[null,"Filtro"],"Select series graph range":[null,"Seleccione un periodo de tiempo"],"Oscilloscope mode":[null,"Modo osciloscopio"],"Show graph":[null,"Mostrar gráfico"],"Reload all data":[null,"Actualizar todos los datos"],"Graph Export":[null,"Exportar Gráfico"],"Cancel variables selection":[null,"Cancelar selección de variables"],"Data point":[null,"Punto"],"Hide tooltips":[null,"Ocultar información sobre herramientas"],Date:[null,"Fecha"],Value:[null,"Valor"],"Wrong username or password":[null,"Nombre de usuario o contraseña incorrectos"],"PLC isn't responding":[null,"El PLC no responde"],"About application":[null,"Acerca de"],"Licences:":[null,"Licencias:"],"Show or hide alarm history panel":[null,"Mostrar u ocultar el panel del historial de alarmas"],Alarms:[null,"Alarmas"],Time:[null,"Hora"],Message:[null,"Mensaje"],State:[null,"Estado"],Actions:[null,"Acciones"],"Source Id":[null,"Id de fuente"],Note:[null,"Nota"],"No items":[null,"No hay artículos"],"Previous page":[null,"Página anterior"],"Next page":[null,"Página siguiente"],Refresh:[null,"Actualizar"],"Export data as CSV":[null,"Exportar datos a CSV"],"Change date range":[null,"Cambiar rango de fechas"],"Change table sorting":[null,"Cambiar la clasificación de la tabla"],"Show system configuration":[null,"Mostrar la configuración del sistema"],Graph:[null,"Gráfico"],"System configuration":[null,"Configuración del sistema"],"Network settings":[null,"Ajustes de red"],"Use DHCP":[null,"Usar DHCP"],"IP address":[null,"Dirección IP"],"Network Mask":[null,"Mascara de subred"],"Default Gateway":[null,"Puerta de enlace predeterminada"],"Show alarms":[null,"Alarmas"],"Show system log":[null,"Registro del sistema"],"Actual Value":[null,"Valor actual"],"Allowed values":[null,"Valores permitidos"],"Insert PIN":[null,"Insertar PIN"],Lock:[null,"Bloquear"],Unlock:[null,"Desbloquear"]}}}),esgAngularDependencies.push("RcWareVisionModalWindow"),angular.module("RcWareVisionModalWindow",[]).service("EsgModalWindowSettings",["$log",function(e){var i={openedWindows:[],registerWindow:function(e,t){i.openedWindows.push({modalWindow:e,opts:t})},deleteWindow:function(a){var n=-1;angular.forEach(i.openedWindows,function(e,t){e.modalWindow==a&&(n=t)}),-1<n&&i.openedWindows.splice(n,1)},closeAllWindows:function(){angular.forEach(i.openedWindows,function(e,t){0!=e.opts.hideWhenUrlChanged&&e.modalWindow.close()})}};return i}]).factory("EsgModalWindow",["$log","$modal","ESGPromise","EsgModalWindowSettings","$rootScope",function(e,i,r,o,l){var t={open:function(e){var t=r.defer(),a=t.promise;$("body").css("overflow","hidden"),$(window).scroll(function(e){e.preventDefault()});var n=i.open(e);return o.registerWindow(n,e),l.$on("RcWareKeyDown",function(e,t){if(0<o.openedWindows.length&&o.openedWindows[o.openedWindows.length-1].modalWindow==n&&"static"!=o.openedWindows[o.openedWindows.length-1].opts.backdrop)switch(t.keyCode){case 27:n.close()}}),n.result.then(function(){o.deleteWindow(n),0==o.openedWindows.length&&$("body").css("overflow","auto"),t.resolve()},function(){o.deleteWindow(n),0==o.openedWindows.length&&$("body").css("overflow","auto"),t.reject()}),a}};return t}]).directive("makeModalWindowScrollable",["$log","ApiWinResize","BrowserDetection",function(e,i,r){return{link:function(n,e,t,a){n.modalBody=e[0].children[1],void 0===n.modalBody&&(n.modalBody=e[0]),n.modalEl=e[0].parentElement,n.ApiWinResize=i,n.cacheModalMargin=null,n.isModalSmall=!1,n.isModalBackdrop=!1,n.$watch("ApiWinResize.size.ratio",function(e,t){0<e&&0<t&&n.handelModalScrollable()}),n.$watch("modalBody.offsetHeight",function(e,t){if(n.handelModalScrollable(),0==n.isModalBackdrop&&0==$(".modal-backdrop").length){var a=angular.element('<div class="modal-backdrop"></div>');$(document.body).append(a)}else n.isModalBackdrop=!0}),n.handelModalScrollable=function(){null==n.cacheModalMargin&&(n.cacheModalMargin={top:$(n.modalEl).css("top"),bottom:$(n.modalEl).css("bottom")}),1.3*n.modalEl.children[0].clientHeight>$(window)[0].innerHeight?n.isModalSmall||($(n.modalEl).css("top","20px"),$(n.modalEl).css("bottom","20px"),$(n.modalEl).css("overflow","auto"),r.isIpadVariable&&$(n.modalEl).find(".ipad-scroll").css("height",$(n.modalEl).css("height")),n.isModalSmall=!0):n.isModalSmall&&($(n.modalEl).css("top",n.cacheModalMargin.top),$(n.modalEl).css("bottom","auto"),r.isIpadVariable&&$(n.modalEl).find(".ipad-scroll").css("height","inherit"),n.isModalSmall=!1)}}}}]),esgAngularDependencies.push("RcWareVisionTimeSpan"),angular.module("RcWareVisionTimeSpan",[]).factory("EsgTimeSpan",["$log",function(e){var t=function(e){this.seconds=0,this.minutes=0,this.hours=0,this.days=0,this.months=0,this.years=0,"string"==typeof e?this.setTimeSpanFromString(e):"number"==typeof e?this.setTimeSpanFromMinutes(e):"object"==typeof e&&(void 0!==e.seconds&&(this.seconds=e.seconds),void 0!==e.minutes&&(this.minutes=e.minutes),void 0!==e.hours&&(this.hours=e.hours),void 0!==e.days&&(this.days=e.days),void 0!==e.months&&(this.months=e.months),void 0!==e.years&&(this.years=e.years))};return t.prototype.setTimeSpanFromMinutes=function(e){var t=e%60,a=Math.floor(e/60)%24,n=Math.floor(e/60/24);0<t&&(this.minutes=t),0<a&&(this.hours=a),0<n&&(this.days=n)},t.prototype.timeSpanToString=function(){var e="",t="",a="";return void 0!==this.years&&0!=this.years&&(a+=this.years+"Y"),void 0!==this.months&&0!=this.months&&(a+=this.months+"M"),void 0!==this.days&&0!=this.days&&(a+=this.days+"D"),void 0!==this.hours&&0!=this.hours&&(t+=this.hours+"H"),void 0!==this.minutes&&0!=this.minutes&&(t+=this.minutes+"M"),void 0!==this.seconds&&0!=this.seconds&&(t+=this.seconds+"S"),""==a&&""==t?e="PT0S":(e="P"+a,""!=t&&(e+="T"+t)),e},t.prototype.getTimeSpanSeconds=function(){var e=0;return e+=24*this.days*60*60,e+=60*this.hours*60,e+=60*this.minutes,e+=this.seconds},t.prototype.getSecondsFromDate=function(){var e=0;return e+=366*this.years*24*60*60,e+=31*this.months*24*60*60,e+=24*this.days*60*60,e+=60*this.hours*60,e+=60*this.minutes,e+=this.seconds},t.prototype.setTimeSpanFromString=function(e){for(var t=1,a=!1,n=1;t<e.length;){for("T"==e[t]&&(a=!0,4,"T"==e[n=++t]&&(a=!0,4,n=++t));t<e.length&&(!isNaN(e[t])||"."==e[t]);t++);var i=parseFloat(e.substring(n,t));switch(e[t]){case"Y":this.years=i;break;case"M":a?this.minutes=i:this.months=i;break;case"D":this.days=i;break;case"H":this.hours=i;break;case"S":this.seconds=i;break;default:!0}n=++t}},t.prototype.isEqual=function(e){var t=!0;return void 0!==e.seconds&&this.seconds==e.seconds||(t=!1),void 0!==e.minutes&&this.minutes==e.minutes||(t=!1),void 0!==e.hours&&this.hours==e.hours||(t=!1),void 0!==e.days&&this.days==e.days||(t=!1),void 0!==e.months&&this.months==e.months||(t=!1),void 0!==e.years&&this.years==e.years||(t=!1),t},t.prototype.toString=function(){return this.timeSpanToString()},t}]),esgAngularDependencies.push("RcWareVisionTable"),angular.module("RcWareVisionTable",[]).directive("esgViewTable",["$log","$filter","ApiWinResize","$timeout","ESGVisionConfig","EsgChangeRangeTable",function(e,d,i,r,t,a){return{transclude:!1,templateUrl:"html/templates/viewTableTemplate.html",replace:!0,restrict:"E",scope:{tableElementsSizeDefault:"=",tableStructure:"=",tableId:"=",tablePrintTitle:"=",tableDataFrom:"=",tableDataTo:"=",tableForceUpdate:"&tableForceUpdate",limit:"=",page:"=",filter:"=",offsetBegin:"=",setAlarmHistoryUrl:"&setAlarmHistoryUrl",specialInterval:"=",showFromToSettings:"="},link:function(a,e,t,n){return a.offsetEnd=a.limit,a.dataLength=0,a.previousPage=!0,a.nextPage=!0,a.dataFiltered=[],a.filtersAreVisible=!0,a.showFromTo=null==a.showFromToSettings||a.showFromToSettings,a.$watch("tableStructure",function(e,t){void 0!==e&&null==a.filtersAreVisible&&(a.filtersAreVisible=!1,angular.forEach(a.tableStructure.column,function(e){1==e.filter&&(a.filtersAreVisible=!0),null==e.sortable&&(e.sortable=!0)}))}),a.dateFilter="dd\".\"MM'.'yyyy HH|:mm",a.dateOptions={dateFormat:"dd.mm.yy",changeMonth:!0,changeYear:!0,yearRange:"c-10:c+10",firstDay:1,minDate:"01.01.2000",maxDate:d("dateFormatCSharp")(new Date,"dd\".\"MM'.'yyyy"),everyYearChar:!1},a.selectedItemIndex=-1,a.element=e[0],a.tableElement=e.find(".main-table")[0],a.selectItem=function(e){$(a.tableElement.children[1].children[a.selectedItemIndex]).removeClass("selected"),a.selectedItemIndex=e,$(a.tableElement.children[1].children[e]).addClass("selected")},a.forceUpdateFunction=function(){a.specialInterval?a.tableForceUpdate({forceUpdate:!0,from:a.tableDataFrom,to:a.tableDataTo}):a.tableForceUpdate({forceUpdate:!0})},a.$watch("tableStructure.data",function(){a.eventLogDataFiltered=a.filterAndTrimData(a.tableStructure.data,a.filter),r(function(){a.recountTableSize()},10)}),a.$watch("sort.column",function(e,t){void 0!==e&&void 0!==t&&(a.eventLogDataFiltered=a.filterAndTrimData(a.tableStructure.data,a.filter))}),a.$watch("sort.descending",function(e,t){void 0!==e&&void 0!==t&&(a.eventLogDataFiltered=a.filterAndTrimData(a.tableStructure.data,a.filter))}),a.$watch("tableStructure.column",function(){angular.forEach(a.tableStructure.column,function(e){e.filter&&(a.filter[e.id]="",a.$watch("filter."+e.id,function(){a.offsetBegin=0,a.offsetEnd=a.limit,a.eventLogDataFiltered=a.filterAndTrimData(a.tableStructure.data,a.filter),a.setAlarmHistoryUrl()}))})}),a.pagerNext=function(){0<=a.offsetBegin&&a.offsetBegin+a.limit<a.dataLength&&(a.offsetBegin+=a.limit,a.offsetEnd=a.offsetBegin+a.limit,a.offsetEnd>a.dataLength&&(a.offsetEnd=a.dataLength),a.eventLogDataFiltered=a.dataFiltered.slice(a.offsetBegin,a.offsetEnd),a.checkPagerButton())},a.pagerPrevious=function(){0<a.offsetBegin&&(a.offsetBegin-=a.limit,a.offsetEnd=a.offsetBegin+a.limit,a.eventLogDataFiltered=a.dataFiltered.slice(a.offsetBegin,a.offsetEnd),a.checkPagerButton())},a.checkPagerButton=function(){0==a.offsetBegin?a.previousPage=!1:a.previousPage=!0,a.offsetEnd==a.dataLength?a.nextPage=!1:a.nextPage=!0},a.$watch("element.clientWidth",function(e,t){0!=e&&a.recountTableSize()}),a.ApiWinResize=i,a.element=e[0],a.$watch("element.clientWidth",function(e,t){0!=e&&a.recountTableSize()}),a.$watch("tableElementsSizeDefault",function(){a.tableElementsSize={},angular.forEach(a.tableStructure.column,function(e){a.tableElementsSize[e.id]={width:a.tableElementsSizeDefault[e.id].width+"px"}})}),a.recountTableSize=function(){var t=0;if(0!=e[0].clientWidth&&null!=a.tableElementsSize){767<e[0].clientWidth&&(t=e[0].clientWidth,angular.forEach(a.tableStructure.column,function(e){t-=a.tableElementsSizeDefault[e.id].width})),angular.forEach(a.tableStructure.column,function(e){a.tableElementsSize[e.id].width=a.tableElementsSizeDefault[e.id].width+Math.floor(t*e.addFreeSpace)+"px"}),a.noDataItemWidth={width:e[0].clientWidth+"px;"}}},["$scope","iElement","iAttrs","controller",function(e,t,a,n){}]},controller:["$scope",function(c){c.sort={column:"time",descending:!0},c.ESGVisionConfig=t;c.$watch("tableId",function(e,t){}),c.ChangeSorting=function(e){var t=c.sort;t.column==e?t.descending=!t.descending:(t.column=e,t.descending=!1)},c.ClassSelectedSort=function(e){if(e==c.sort.column)return 1==c.sort.descending?"icon-chevron-down":"icon-chevron-up"},c.exportDataCSVFunction=function(){if(0<c.dataFiltered.length){if(1==c.dataFiltered.length)return void alert("There are not any data to export!");var e="",n=[],i="",r=0,t=0;angular.forEach(c.tableStructure.column,function(e){angular.isDefined(n[r])||(n[r]=[]),n[r][t]=e.name,t++}),r++,angular.forEach(c.dataFiltered,function(t){angular.isDefined(n[r])||(n[r]=[]);var a=0;angular.forEach(c.tableStructure.column,function(e){i=null!=e.angularFilter?d("useTableFilter")(t[e.id],e.angularFilter):t[e.id],n[r][a]=i,a++}),r++});for(var a=n.length,o=0,l=0;l<a;l++)n[l].length>o&&(o=n[l].length);for(var s=0;s<a;s++){for(l=0;l<o;l++)angular.isDefined(n[s][l])?e+=n[s][l]:e+=";",e+=";";e+="\n"}var u=new Blob([e],{type:"data:text/csv;charset=utf-8,",endings:"native"});URL.createObjectURL(u);window.saveAs(u,c.tablePrintTitle+"-"+d("dateFormatCSharp")(new Date,"yyyy-MM-dd-HH-mm-ss")+".csv")}},c.filterAndTrimData=function(e,t){var a=[],n=!0;return angular.forEach(t,function(e,t){""!=e&&(n=!1)}),n&&(a=e),a=void 0===t?e:d("filter")(e,function(a){var n=!0;return angular.forEach(t,function(e,t){void 0!==a[t]&&null!=a[t]&&"function"==typeof a[t].toLowerCase&&-1==a[t].toLowerCase().indexOf(e.toLowerCase())&&(n=!1)}),n}),c.offsetBegin+c.limit>=a.length?c.offsetEnd=a.length:c.offsetEnd=c.offsetBegin+c.limit,c.dataLength=a.length,c.dataFiltered=d("orderBy")(a,c.sort.column,c.sort.descending),c.checkPagerButton(),c.dataFiltered.slice(c.offsetBegin,c.offsetEnd)},c.openModalWindow=function(){a.open(c)}}]}}]).directive("searchInput",["$log","BrowserDetection",function(e,i){return{transclude:!1,templateUrl:"html/templates/searchInputTemplate.html",replace:!0,restrict:"E",scope:{searchString:"=",searchSuggestions:"="},link:function(a,e,t,n){return a.searchSuggestionsActual=[],a.$watch("searchSuggestions",function(e,t){a.searchSuggestionsActual.splice(0,a.searchSuggestionsActual.length),angular.forEach(e,function(e,t){a.searchSuggestionsActual.push(t),a.searchSuggestionsActual.sort()})},!0),a.browser=i.browserDetection(),a.activeRow=-1,a.focus=!1,["$scope","iElement","iAttrs","controller",function(e,t,a,n){}]},controller:["$scope",function(a){a.timer=null,a.searchString="",a.searchStringDelay="",a.clearInput=function(){a.searchString=""},a.suggestionIsVisible=!1,void 0!==a.searchSuggestions&&(a.suggestionIsVisible=!0),a.$watch("searchString",function(e,t){void 0!==e&&e!=a.searchStringDelay&&(a.searchStringDelay=e)}),a.$watch("searchStringDelay",function(e,t){void 0!==e&&e!=a.searchString&&(clearTimeout(a.timer),a.timer=setTimeout(function(){a.$apply(function(){a.searchString=e})},300))}),a.tableClass=function(e){return a.searchSuggestionsActual.indexOf(e)==a.activeRow?"selected":""},a.mouseEnter=function(e){""==e.toString()?a.searchString="":a.searchString=e}}]}}]),esgAngularDependencies.push("ESGLogView"),angular.module("ESGLogView",[]).directive("logView",["$log","$rootScope","$filter","RcWareVisionAPI","WebpanelData","EsgTaskBar",function(e,t,i,a,r,o){return{transclude:!1,template:'<div class="log-view" ng-show="isVisible">                     <div class="log-view-wrapper"><rc-ware-vision-project-progress-bar-short-wrapper /></div>                     <esg-view-table table-structure="tableStructure" table-elements-size-default="tableElementsSizeDefault" table-id="tableIdString" table-print-title="printTitle" special-interval="specialInterval" table-force-update="forceUpdateEventLog(forceUpdate, from, to)" table-data-from="dataFrom" table-data-to="dataTo" table-own-time-range="ownTimeRange" limit="tableLimit" page="tablePage" filter="tableFilter" offset-begin="tableOffsetStart" set-alarm-history-url="setEventLogUrl()"></esg-view-table>                   </div>',replace:!0,restrict:"E",scope:{isVisible:"="},link:function(e,t,a,n){return e.eventLogSettings={},e.ownTimeRange=!1,e.tableLimit=100,e.tablePage=1,e.tableOffsetStart=0,e.tableFilter={},e.tableIdString={title:"eventLog"},e.printTitle=i("i18n")("Event log"),e.lastDataLoad=null,e.autoUpdateIsRunning=!1,e.specialInterval=null,e.actionSuggestions={},e.dataTo=new Date,e.dataFrom=new Date(e.dataTo.getTime()),e.dataFrom.setHours(0,0,0,0),e.tableElementsSizeDefault={},e.tableStructure={column:[{id:"time",name:i("i18n")("Time"),filter:!1,addFreeSpace:0,angularFilter:{name:"date",param:"dd.MM.yyyy H:mm:ss"}},{id:"source",name:i("i18n")("Source"),filter:!0,addFreeSpace:0},{id:"level",name:i("i18n")("Level"),filter:!0,addFreeSpace:0},{id:"message",name:i("i18n")("Message"),filter:!0,addFreeSpace:1}],data:[],dataRange:!0},e.tableElementsSizeDefault={time:{width:138},source:{width:111},level:{width:81},message:{width:412}},["$scope","iElement","iAttrs","contoller",function(e,t,a,n){}]},controller:["$scope",function(n){n.WebpanelData=r,n.forceUpdateEventLog=function(e,t,a){null!=t&&(n.dataFrom=t),null!=a&&(n.dataTo=a),n.getLogData()},n.getLogData=function(){null!=n.graphBar&&(n.graphBar.terminateAction(),o.removeBar(n.graphBar));var t=n.graphBar=o.registerTaskBar(i("i18n")("Graph"),!1);n.graphBar.progress=null,n.graphBar.disablePercent=!0,a.GetLog(n.dataFrom,n.dataTo).success(function(e){n.tableStructure.data=e,n.graphBar.setProgress(100),o.removeBar(t),n.graphBar=null}).error(function(){n.graphBar.setError(3e3),n.graphBar=null})},n.$watch("isVisible",function(e){e&&0==n.tableStructure.data.length&&(n.tableStructure.data=[],n.getLogData())})}]}}]),esgAngularDependencies.push("ESGGraphView"),angular.module("ESGGraphView",[]).directive("graphView",["$log","$rootScope","$compile","$timeout","$filter","$window","RcWareVisionAPI","WebpanelData","ApiWinResize","EsgGraphSettings","ESGPromise","EsgTaskBar","EsgGraphExport","EsgGraphSelectTimeRange",function(e,t,a,i,S,y,o,u,n,l,c,d,r,p){return{transclude:!1,template:'<div class="graph-view" ng-show="isVisible">                     <div class="graph-buttons" style="height:32px;margin-bottom:4px;">  <div class="dropdown graph-time-range graph-time-range-select">       <a class="btn-ico dropdown-toggle-scrollable" esg-i18n="title:Select series graph range" esg-is-clickable>         <span class="labelButton">{{additionalSettingsGraph.graphTimeRange.option}}</span>         <span class="caret"></span>       </a>         <div class="dropdown-menu dropdown-menu-scrollable ipad-scroll" make-dropdown-scrollable offset-top="63">           <div class="sub-ipad-scroll">             <ul>               <li ng-repeat="item in projectGraphDataInterval">                 <a ng-click="setGraphTimeRange(item)" esg-is-clickable>{{item.option}}</a>               </li>             </ul>          </div>       </div>     </div> <span class="button-container graphShowPoints"><span class="graph-show-points"  ng-show="additionalSettingsGraph.projectGraphPlotType.value == \'Line\'"><button class="btn-ico" ng-class="{selected: additionalSettingsGraph.graphShowPoints == true}" ng-click="graphShowPoints()" esg-i18n="title:Show/hide series points"><i class="icon-energo-show-points icon-energo"></i></button></span></span>  <span class="button-container graphOscilloscopeRegim"><span class="graph-show-points" ng-show="additionalSettingsGraph.projectGraphPlotType.value == \'Line\' && additionalSettingsGraph.graphTimeRange.interval != \'fromTo\'"><button esg-is-clickable="" class="btn-ico ico-selection" ng-class="{selected: additionalSettingsGraph.graphOscilloscopeRegime == true}" ng-click="graphOscilloscopeRegime()" esg-i18n="title:Oscilloscope mode"><i class="icon-energo-oscillo icon-energo"></i></button></span></span> <span class="button-container graphReload"><span class="graph-reload"><button class="btn-ico" ng-click="graphReload()" esg-i18n="title:Reload all data"><i class="icon-energo-reload icon-energo"></i></button></span></span> <span class="button-container graphExport"><span class="graph-export"><button class="btn-ico" ng-click="graphExport()" esg-i18n="title:Graph Export"><span class="labelButton"></span><i class="icon-energo-download icon-energo"></i></button></span></span> <span class="button-container removeSelectedVariables" ng-show="WebpanelData.selectedVariables.length > 0"><span class="remove-selected-variables"><button  esg-i18n="title:Cancel variables selection" class="btn-ico" ng-click="removeVariables()"><i class="icon-energo-remove-dp icon-energo"></i></button></span></span> <rc-ware-vision-project-progress-bar-short-wrapper />                     </div>                     <tabbed-graph graph-data="graphData" graph-width="width" graph-height="height" graph-style="graphStyle" graph-options="graphOptions" graph-string-dictionary="stringDictionary" graph-enable-tooltip="graphEnableTooltip" graph-commands="graphCommands" additional-settings="additionalSettingsGraph"></tabbed-graph>                   <div class="graph-float-control" ng-show="graphData.length > 0">             <div ng-show="floatControlVisible == true" class="float-control">                 <span class="show-legend">                     <button esg-is-clickable class="btn-ico" ng-class="{active: additionalSettingsGraph.legendSettings == legendSettingsItems[0]}" ng-click="additionalSettingsGraph.legendSettings = legendSettingsItems[0]" esg-i18n="title:No legend">                         <i class="icon-energo-legend-hide icon-energo"></i>                     </button>                 </span>                 <span class="simple-legend">                     <button esg-is-clickable class="btn-ico" ng-class="{active: additionalSettingsGraph.legendSettings == legendSettingsItems[1]}" ng-click="additionalSettingsGraph.legendSettings = legendSettingsItems[1]" esg-i18n="title:Simple legend">                         <i class="icon-energo-legend-collapse icon-energo"></i>                     </button>                 </span>                 <span class="tooltip-hide">                     <button esg-is-clickable class="btn-ico" ng-class="{active: additionalSettingsGraph.tooltipsHidden}" ng-click="additionalSettingsGraph.tooltipsHidden = !additionalSettingsGraph.tooltipsHidden" esg-i18n="title:Hide tooltips">                         <i class="icon-energo-tooltip-hide icon-energo"></i>                     </button>                 </span>                 <span class="graph-move-left">                     <button esg-is-clickable class="btn-ico ico-selection" ng-class="{buttonDisabled: additionalSettingsGraph.activeMoveButtons.panLeft == false}" ng-click="graphMoveLeft()" esg-i18n="title:Pan left">                         <i class="icon-energo-move-left icon-energo"></i>                     </button>                 </span>                 <span class="graph-move-right">                     <button esg-is-clickable class="btn-ico ico-selection" ng-class="{buttonDisabled: additionalSettingsGraph.activeMoveButtons.panRight == false}" ng-click="graphMoveRight()" esg-i18n="title:Pan right">                         <i class="icon-energo-move-right icon-energo"></i>                     </button>                 </span>                 <span class="graph-move-left">                     <button esg-is-clickable class="btn-ico ico-selection" ng-class="{buttonDisabled: additionalSettingsGraph.activeMoveButtons.zoomIn == false}" ng-click="graphZoomIn()" esg-i18n="title:Zoom in">                         <i class="icon-energo-zoom-in icon-energo"></i>                     </button>                 </span>                 <span class="graph-move-left">                     <button esg-is-clickable class="btn-ico ico-selection" ng-class="{buttonDisabled: additionalSettingsGraph.activeMoveButtons.zoomOut == false}" ng-click="graphZoomOut()" esg-i18n="title:Zoom out">                         <i class="icon-energo-zoom-out icon-energo"></i>                     </button>                 </span>             </div>             <span class="float-control-show" ng-show="floatControlVisible == false">                 <button esg-is-clickable class="btn-ico ico-selection" ng-click="floatControlVisible = !floatControlVisible" esg-i18n="title:Show graph controls">                     <i class="icon-energo-control-show icon-energo"></i>                 </button>             </span>             <span class="float-control-hide" ng-show="floatControlVisible == true">                 <button esg-is-clickable class="btn-ico ico-selection" ng-click="floatControlVisible = !floatControlVisible" esg-i18n="title:Hide graph controls">                     <i class="icon-energo-control-hide icon-energo"></i>                 </button>             </span>         </div>                   </div>',replace:!0,restrict:"E",scope:{isVisible:"="},link:function(s,e,t,a){return s.element=e[0],s.dateOptions={dateFormat:"dd.mm.yy",changeMonth:!0,changeYear:!0,yearRange:"c-10:c+10",firstDay:1,minDate:"01.01.2000",everyYearChar:!1},s.setGraphTimeRange=function(e){"fromTo"!=e.interval&&(s.additionalSettingsGraph.graphTimeRange=e),"fromTo"==e.interval?p.open(S("i18n")("Select time range"),s,null,e).success(function(){s.additionalSettingsGraph.graphTimeRange=e,s.loadData()}).error(function(){}):s.loadData()},s.endWithNull={},s.prepareSeries=function(e,o,t){var l=[];angular.forEach(e,function(e,t){var a,n=[],i="svc://"+e.variableDef.connection.name+"/"+e.variableDef.uId+"["+e.variableDef.offset+","+e.variableDef.length+"]";angular.forEach(o,function(e,t){t==i&&(n=e.data,a=e.state,s.endWithNull[t]=e.endWithNull)});var r={idx:i,label:e.variableDef.name,fullLabel:e.variableDef.name,data:n,serieOrder:t,lines:{show:!0,steps:!1},points:{show:!0},status:a};"bool"==u.typeNumToId(parseInt(e.variableDef.type))&&(r.dictionary={false:0,true:1},r.stringDictionaryExplicitly=!1,r.lines.steps=!0),"string"==u.typeNumToId(parseInt(e.variableDef.type))&&(r.dictionary={},r.innermappingDictionary=[],r.stringDictionaryExplicitly=!1,r.lines.steps=!0),l.push(r)}),1!=t?(s.graphData=S("orderBy")(l,["+lines.steps","+serieOrder"]),"Line"==s.additionalSettingsGraph.projectGraphPlotType.value?s.additionalSettingsGraph.multipleAxisSelectedDp&&"function"==typeof s.setSeriesMultipleAxis&&s.setSeriesMultipleAxis(s.additionalSettingsGraph.multipleAxisSelectedDp):s.setSeriesMultipleAxis(!1)):angular.forEach(l,function(t){angular.forEach(s.graphData,function(e){t.idx==e.idx&&(e.data=t.data,e.dictionary=t.dictionary)})});new Date;1!=t?(s.changeSeriesList=!1,s.graphDataAreLoaded=!1):s.oscilloRefreshGraph()},s.loadData=function(t){var a=c.defer(),e=a.promise;1!=t&&(s.graphData=[]);var n=[];if(angular.forEach(u.selectedVariables,function(e){var t=e.replace("varRef://","").split("/"),a=u.connectionDefinition.connections[t[0]].variables[t[1]];n.push({variableDef:a,varRef:e})}),null!=n&&0!=n.length||s.showLoadingScreen(),1==s.graphDataAreLoaded&&null!=s.graphBar&&(s.graphBar.terminateAction(),d.removeBar(s.graphBar)),null!=n&&0<n.length){s.changeSeriesList=!1,s.showLoadingScreen();s.additionalSettingsGraph.graphTimeRange.interval;1!=t&&(s.graphDataAreLoaded=!0);var i=s.graphBar=d.registerTaskBar(S("i18n")("Graph"),!1);s.graphBar.progress=null,s.graphBar.disablePercent=!0;var r=s.getFromTo(s.additionalSettingsGraph.graphTimeRange.interval,s.additionalSettingsGraph.intervalFromTo);o.GetHistory(n,r.from,r.to).success(function(e){s.graphBar==i?(s.prepareSeries(n,e,t),a.resolve(),s.graphBar.setProgress(100),d.removeBar(i),s.graphBar=null):a.reject()}).error(function(){s.prepareSeries(n,[],t),s.graphBar.setError(3e3),s.graphBar=null})}return e},s.graphShowPoints=function(){s.additionalSettingsGraph.graphShowPoints=!s.additionalSettingsGraph.graphShowPoints,s.graphOptions.series.points.show=s.additionalSettingsGraph.graphShowPoints,s.refreshGraph()},s.graphOscilloscopeRegime=function(){s.additionalSettingsGraph.graphOscilloscopeRegime=!s.additionalSettingsGraph.graphOscilloscopeRegime,s.additionalSettingsGraph.graphOscilloscopeRegime&&1!=s.oscilloIsRunning&&s.oscilloTimer()},s.graphReload=function(){s.loadData()},s.graphExport=function(){r.open({functions:{exportAsPng:s.savePNG,exportAsCSV:s.saveDataCSV,exportAsCSVEquidistant:s.saveDataCSVEquidistant}}).success(function(){})},s.removeVariables=function(){u.selectedVariables=[],s.loadData()},s.$watch("isVisible",function(e){1==e&&(i(s.setGraphSize,10),(s.changeSeriesList||0==s.graphData.length)&&s.loadData())}),s.$watch("ApiWinResize.size.ratio",function(e,t){0!=s.element.clientWidth&&s.isVisible&&s.setGraphSize()}),s.setGraphSize=function(e){s.width=s.element.clientWidth,s.height=s.element.clientHeight-36},["$scope","iElement","iAttrs","contoller",function(e,t,a,n){}]},controller:["$scope",function(b){b.sampleRate=2e3,b.ApiWinResize=n,b.lastWindowSize={w:null,h:null},b.floatControlVisible=!0,b.stringDictionary={},b.graphData=[],b.dpHistoryLoaded={},b.changeSeriesList=!1,b.project={},b.graphSettingsLocal=l.getGraphSettings(),b.projectGraphDataInterval=b.graphSettingsLocal.graphDataInterval,b.WebpanelData=u,b.stringDictionary=b.graphSettingsLocal.stringDictionary,b.legendSettingsItems=l.getGraphSettings().legendSettings;var e=b.graphSettingsLocal;b.additionalSettingsGraph={graphShowPoints:!1,graphYaxisGlobalRange:!1,projectGraphPlotType:e.graphPlotType[0],projectGraphPlotTypeFull:e.graphPlotTypeFull[0],projectGraphTimeRange:b.projectGraphDataInterval[5],reloadSeries:null,actualInterval:e.barInterval[2],actualBarInterval:e.barInterval[2],intervalFromTo:{from:null,to:null},graphBarNorm:!1,barDataCountType:e.barDataCountType[0],barDataType:e.barDataType[0],activeMoveButtons:{panLeft:!0,panRight:!0,zoomIn:!0,zoomOut:!0},actualSettingsGraphSerie:null,actualSettingsSerieType:e.graphPlotType[0],carpetColorScale:e.carpetColorScale[0],graphSettingsForOneSerie:!1,graphOscilloscopeRegime:!1,linearTransformation:!1,graphShowAggreagation:!1,multipleAxis:!1,graphShowFullLegend:!1,graphShowLegend:!0,legendSettings:e.legendSettings[1],ignoreNullValues:!1,graphTimeRange:b.projectGraphDataInterval[1],labelFormatterStatus:function(e){var t="";return"ok"!=e.status&&(null==e.status?t+=' - <span class="error">'+S("i18n")("error")+"</span>":t+=" - <span>"+S("i18n")(e.status)+"</span>"),t}},b.additionalSettingsGraph.selectDataDelete=!1,b.additionalSettingsGraph.selectedData={},b.graphEnableTooltip=!0,b.graphStyle={"background-color":"white"},b.graphOptions={series:{lines:{show:!0,ignoreNullValues:!1},points:{show:!1},carpet:{show:!1},moduloCarpet:{show:!1},modulo:{show:!1},bars:{show:!1}},touch:{pan:"x",scale:"x"},legend:{show:!0,clickable:!0},yaxis:{globalRange:!1,font:{color:"rgb(84, 84, 84)",variant:"normal",style:"normal",family:"'Trebuchet MS'",weight:"400",lineHeight:20,size:12}},xaxis:{font:{color:"rgb(84, 84, 84)",variant:"normal",style:"normal",family:"'Trebuchet MS'",weight:"400",lineHeight:20,size:12}},colors:[],crosshair:{mode:"x"},grid:{margin:{}}},b.graphCommands={reset:!1,clear:!1,panLeft:!1,panRight:!1,redraw:!1,changeZoomIn:!1,changeZoomOut:!1,changeGraphType:!1,trimData:!1,applyRegression:!1,showLoadingScreen:!1,removeSeriesDataFromCache:!1,setOscilloView:!1,resetGraphRecountBarData:!1,graphWasRedrawed:!1},b.lastSettedPlotType=null,b.$watch("graph.graphSettings.actualBarInterval",function(e,t){b.refreshGraph()}),b.$watch("graph.graphSettings.barDataCountType",function(e,t){b.refreshGraph()}),b.changeGraphType=function(){var e=b.graphCommands;e.changeGraphType=!e.changeGraphType,b.graphCommands=e},b.resetGraph=function(){var e=b.graphCommands;e.reset=!e.reset,b.graphCommands=e},b.showLoadingScreen=function(){var e=b.graphCommands;e.showLoadingScreen=!e.showLoadingScreen,b.graphCommands=e},b.resetGraphRecountBarData=function(){var e=b.graphCommands;e.resetGraphRecountBarData=!e.resetGraphRecountBarData,b.graphCommands=e},b.removeSeriesDataFromCache=function(){var e=b.graphCommands;e.removeSeriesDataFromCache=!e.removeSeriesDataFromCache;var t=[];angular.forEach(b.project.selectedDataPoints,function(e){t.push(e.project.id+e.id)}),b.additionalSettingsGraph.newSeriesActual=t,b.graphCommands=e},b.setOscilloView=function(){var e=b.graphCommands;e.setOscilloView=!e.setOscilloView,b.graphCommands=e},b.refreshGraph=function(){var e=b.graphCommands;e.redraw=!e.redraw,b.graphCommands=e},b.trimData=function(){var e=b.graphCommands;e.trimData=!e.trimData,b.graphCommands=e},b.setShowPoints=function(){b.additionalSettingsGraph.graphShowPoints=!b.additionalSettingsGraph.graphShowPoints,b.graphOptions.series.points.show=b.additionalSettingsGraph.graphShowPoints,b.refreshGraph()},b.graphIgnoreNullValues=function(){b.additionalSettingsGraph.ignoreNullValues=!b.additionalSettingsGraph.ignoreNullValues,b.graphOptions.series.lines.ignoreNullValues=b.additionalSettingsGraph.ignoreNullValues,b.refreshGraph()},b.hideTooltips=function(){b.additionalSettingsGraph.tooltipsHidden=!b.additionalSettingsGraph.tooltipsHidden},b.graphShowMultipleAxis=function(){b.additionalSettingsGraph.multipleAxisSelectedDp=!b.additionalSettingsGraph.multipleAxisSelectedDp,b.setSeriesMultipleAxis(b.additionalSettingsGraph.multipleAxisSelectedDp),b.refreshGraph()},b.setSeriesMultipleAxis=function(a){var n=1;angular.forEach(b.graphData,function(e,t){void 0===e.steps||0==e.steps?a&&"Line"==b.additionalSettingsGraph.projectGraphPlotType.value&&1!=e.lines.steps?(b.graphData[t].yaxis=n,b.graphData[t].yaxisIndexEsg=n,b.additionalSettingsGraph.multipleAxis=!0,n++):(b.graphData[t].yaxis=1,b.graphData[t].yaxisIndexEsg=1):(b.graphData[t].yaxis=1,b.graphData[t].yaxisIndexEsg=1,b.additionalSettingsGraph.multipleAxis=!1)})},b.graphMoveLeft=function(e){if(0!=b.additionalSettingsGraph.activeMoveButtons.panLeft){var t=b.graphCommands;t.panLeft=!t.panLeft,b.graphCommands=t}},b.graphMoveRight=function(e){if(0!=b.additionalSettingsGraph.activeMoveButtons.panRight){var t=b.graphCommands;t.panRight=!t.panRight,b.graphCommands=t}},b.graphZoomIn=function(){0!=b.additionalSettingsGraph.activeMoveButtons.zoomIn&&(b.graphCommands.changeZoomIn=!b.graphCommands.changeZoomIn)},b.graphZoomOut=function(){0!=b.additionalSettingsGraph.activeMoveButtons.zoomOut&&(b.graphCommands.changeZoomOut=!b.graphCommands.changeZoomOut)},b.graphResetZoom=function(){b.graphCommands.resetZoom=!b.graphCommands.resetZoom},b.$watch("additionalSettingsGraph.legendSettings",function(e,t){void 0!==e&&e.value!=t.value&&(0==e.value?b.additionalSettingsGraph.graphShowLegend=!1:1==e.value?(0==b.additionalSettingsGraph.graphShowLegend&&(b.additionalSettingsGraph.graphShowLegend=!0),b.additionalSettingsGraph.graphShowFullLegend=!1):2==e.value&&(0==b.additionalSettingsGraph.graphShowLegend&&(b.additionalSettingsGraph.graphShowLegend=!0),b.additionalSettingsGraph.graphShowFullLegend=!0),b.previousLegendSettings=t)}),b.setLegendSettings=function(e){b.additionalSettingsGraph.legendSettings=e},b.updateGraphActualValues=function(){null!=b.graph.graphSettings.projectGraphTimeRange&&"fromTo"!=b.graph.graphSettings.projectGraphTimeRange.interval&&(angular.forEach(b.graph.selectedWscos,function(e,t){var a=e.unit.getValuePropertyByWSCO(e.wsco.guid);for(var n in b.graphData)if(0==b.graphData[n].idx.localeCompare(e.unit.guid+e.wsco.guid)){var i=b.graphData[n];break}null!=i&&(a!=i.data[i.data.length-1][1]?i.data.push([new Date,a]):i.data.push([new Date,i.data[i.data.length-1][1]]))}),b.oscilloRefreshGraph())},b.oscilloRefreshGraph=function(e){e?b.resetGraph():void 0!==b.graphOptions.series.bars&&b.graphOptions.series.bars.show?b.resetGraphRecountBarData():b.refreshGraph()},b.oscilloTimer=function(){var l=!1;if(b.additionalSettingsGraph.graphOscilloscopeRegime){b.oscilloIsRunning=!0;var n=[];angular.forEach(u.selectedVariables,function(e){var t=e.replace("varRef://","").split("/"),a=u.connectionDefinition.connections[t[0]].variables[t[1]];n.push({variableDef:a,varRef:e})}),o.GetValues(n).success(function(){var o=!1;angular.forEach(n,function(e,t){l=!0;var a="svc://"+e.variableDef.connection.name+"/"+e.variableDef.uId+"["+e.variableDef.offset+","+e.variableDef.length+"]",n=null;if(angular.forEach(b.graphData,function(e){a==e.idx&&(n=e)}),null!=n&&null!=e.value){var i=new Big(e.value.ts).minus("621355968000000000").div(1e4).toFixed(0);if(i=parseInt(i),!(0<n.data.length&&i==n.data[n.data.length-1][0].getTime())){var r=u.typeNumToId(parseInt(e.variableDef.type));if("real"==r||"lreal"==r){if(1==isNaN(e.value.value)||e.value.value==1/0||e.value.value==-1/0)return void(0<n.data.length&&null!=n.data[n.data.length-1]&&(b.endWithNull[a]=!0));b.endWithNull[a]&&(b.endWithNull[a]=!1,n.data.push(null))}"bool"==r?n.data.push([new Date(i),1==e.value.value?1:0]):"string"==r?(null==n.dictionary[e.value.value]&&(n.dictionary[e.value.value]=n.innermappingDictionary.length,n.innermappingDictionary.push(e.value.value),o=!0),n.data.push([new Date(i),n.dictionary[e.value.value]])):n.data.push([new Date(i),parseFloat(e.value.value.toFixed(6))]),0<n.data.length&&(n.status="ok"),1==n.data.length&&(o=!0)}}}),l&&b.oscilloRefreshGraph(o),b.additionalSettingsGraph.graphOscilloscopeRegime?i(b.oscilloTimer,b.sampleRate):b.oscilloIsRunning=!1}).error(function(){b.additionalSettingsGraph.graphOscilloscopeRegime?i(b.oscilloTimer,b.sampleRate):b.oscilloIsRunning=!1})}else b.oscilloIsRunning=!1},b.updateGraphData=function(){b.generateData()},b.getFromTo=function(e,t){var a={from:null,to:null};if("fromTo"==e)a.from=t.from,a.to=t.to;else{a.to=new Date;var n=l.getGraphSettings().dataInterval[e];a.from=new Date(a.to.getFullYear()-n.years,a.to.getMonth()-n.months,a.to.getDate()-n.days,a.to.getHours()-n.hours,a.to.getMinutes()-n.minutes,0,0),-1==e.indexOf("hour")&&-1==e.indexOf("minute")&&a.from.setHours(0,0,0,0)}switch(e){case"-1week":case"-2weeks":var i=new Date(a.from);i.setHours(0,0,0,0);var r=i.getDay();i=i.getTime(),1!=r&&(0!=r?a.from.setTime(i-864e5*(r-1)):a.from.setTime(i-5184e5));break;case"-1month":case"-2months":case"-3months":case"-6months":case"-9months":a.from.setDate(1);break;case"-1year":case"-2years":a.from.setHours(0,0,0,0),a.from.setMonth(0),a.from.setDate(1)}return a},b.$watch("WebpanelData.selectedVariables",function(t,e){if(void 0!==t&&(t.length!=e.length&&(b.changeSeriesList=!0,b.graphOscilloscopeRegime&&angular.forEach(t,function(e){})),t.length<e.length)){var a=new Array;a=jQuery.grep(e,function(e){return jQuery.inArray(e,t)<0}),b.graphOscilloscopeRegime&&angular.forEach(a,function(e){})}}),b.savePNG=function(){var e=$(b.element).find(".chart").get(0).chart.getData();if(0!=e.length&&(1!=e.length||void 0!==e[0].idx)){var t=$(b.element).find(".chart").get(0),a=t.chart.getOptions(),n=t.chart.getPlotOffset(),i=t.chart.getCanvas(),r=t.children[0].children[1],o=r.width,l=r.height,s=document.createElement("canvas"),p=s.getContext("2d");s.width=o,s.height=l,p.drawImage(i,0,0),(void 0!==a.series.bars&&1==a.series.bars.show||1!=b.additionalSettingsGraph.tooltipsHidden)&&p.drawImage(r,0,0),p.globalCompositeOperation="destination-over",p.beginPath(),p.fillStyle="white",p.fillRect(0,0,o,l),p.closePath(),p.globalCompositeOperation="source-over";var u=$(b.element).find(".legend").get(0),c=0,d=n.left+15,g=[],h=0,f="";if(0!=b.additionalSettingsGraph.legendSettings.value){angular.forEach(u.children[1].children[0].children[0].children,function(e){"line-through"!=$(e.children[1].children[0]).css("text-decoration")&&(f=2==b.additionalSettingsGraph.legendSettings.value&&void 0!==e.children[1].children[1]&&""!=e.children[1].children[1]?void 0!==e.children[1].children[1].innerText?e.children[1].children[1].innerText:e.children[1].children[1].textContent:void 0!==e.children[1].children[0].innerText?e.children[1].children[0].innerText:e.children[1].children[0].textContent,g.push({label:f,color:$(e.children[0].children[0].children[0]).css("borderTopColor")}),7.5*f.length>h&&(h=7.5*f.length))});var m=y.devicePixelRatio;p.beginPath(),p.fillStyle="rgba(255, 255, 255, 0.8)",p.fillRect((d-5)*m,12*m,h*m,(20*g.length-1+10)*m),p.closePath(),angular.forEach(g,function(e){p.beginPath(),p.fillStyle=e.color,p.fillRect(d*m,(30+20*c-9)*m,14*m,10*m),p.fillStyle="#08c",p.font="bold "+12*m+"px Trebuchet MS",p.fillText(e.label,(d+20)*m,(30+20*c)*m),p.closePath(),c++})}if(1!=b.additionalSettingsGraph.tooltipsHidden&&"Line"==b.additionalSettingsGraph.projectGraphPlotType.value){var v=$(b.element).find(".tool-tip-container").get(0);null!=v&&angular.forEach(v.children,function(e,t){var a=parseInt($(e.children[0]).css("left")),n=parseInt($(e.children[0]).css("top")),i=parseInt($(e.children[0]).css("width")),r=parseInt($(e.children[0]).css("height"));if(0<t){if(-10<n){a+=6;var o=e.children[0].children[0].children[0],l=e.children[0].children[0].children[1],s=e.children[0].children[0].children[2];if(p.beginPath(),p.fillStyle="rgba(255, 255, 255, 0.9)",p.fillRect(a*m,n*m,i*m,r*m),p.closePath(),p.beginPath(),p.fillStyle="#545454",p.font=14*m+"px Trebuchet MS",void 0!==o.innerText)var u=o.innerText;else u=o.textContent;if(p.fillText(u,(a+8)*m,(n+15)*m),p.fillStyle=$(l).css("backgroundColor"),p.fillRect((a+8+parseInt($(o).css("width"))+8)*m,(n+5)*m,14*m,10*m),p.fillStyle="#545454",p.font=14*m+"px Trebuchet MS",void 0!==o.innerText)var c=s.innerText;else c=s.textContent;p.fillText(c,(a+8+parseInt($(o).css("width"))+14+8+8)*m,(n+15)*m),p.closePath()}}else{p.beginPath(),i+=12,r+=6,p.fillStyle="rgba(255, 255, 255, 0.9)",p.fillRect(a*m,n*m,i*m,r*m),p.strokeStyle="#00000",p.lineWidth=1,p.strokeRect((a+.5)*m,(n+.5)*m,(i+.5)*m,(r+.5)*m),p.closePath(),p.beginPath(),p.fillStyle="#545454",p.font=12*m+"px Trebuchet MS",p.textAlign="center";var d=e.children[0].children[0].innerHTML.replace("&nbsp;"," ").split("<br>");p.fillText(d[0],(a+i/2)*m,(n+18.5)*m),p.fillText(d[1],(a+i/2)*m,(n+38.5)*m),p.closePath(),p.textAlign="left"}})}var x=function(e){for(var t=atob(e.split(",")[1]),a=[],n=0;n<t.length;n++)a.push(t.charCodeAt(n));return new Blob([new Uint8Array(a)],{type:"image/png"})}(s.toDataURL("image/png"));window.saveAs(x,"Graph-"+S("dateFormatCSharp")(new Date,"yyyy-MM-dd-HH-mm-ss")+".png")}},b.saveDataCSVEquidistant=function(e){var t=$(b.element).find(".chart").get(0).chart.getData();EsgTables.createTableEquidistant(t,e);!function(e){if(0<e.data.length){var t="";e.data[0].length,e.data.length,angular.forEach(e.headers,function(e){t+=e+";"}),t+="\n",angular.forEach(e.data,function(e){angular.forEach(e,function(e){t+=null!=e?e+";":";"}),t+="\n"});var a=new Blob([t],{encoding:"UTF-8",type:"data:text/csv;charset=utf-8",endings:"native"});URL.createObjectURL(a),window.saveAs(a,"Graph-"+S("dateFormatCSharp")(new Date,"yyyy-MM-dd-HH-mm-ss")+".csv")}}(EsgTables.tableEquidistant)},b.saveDataCSV=function(){var e=$(b.element).find(".chart").get(0).chart,t=e.getData();if(1==t.length&&t[0].images.show)alert("There are not any data to export!");else{var o=e.getAxes(),a="",l=[],s="",u=0;angular.forEach(t,function(i){if(0==i.isVisible)return!1;angular.isDefined(l[u])||(l[u]=[]),l[u][0]="Date;"+i.fullLabel+(void 0!==i.dpUnit&&""!=i.dpUnit&&null!=i.dpUnit?" ("+i.dpUnit+")":"");var r=1;if(void 0!==i.modulo||0==i.modulo.show);else i.range;angular.forEach(i.data,function(e){if(null!=e){if("function"==typeof e[0].getTime)var t=e[0].getTime();else t=e[0];var a={};if(void 0!==i.dictionary&&angular.forEach(i.dictionary,function(e,t){a[e]=t}),null!=e&&t>=o.xaxis.min&&t<=o.xaxis.max){var n=e[1];null==n&&(n=""),s=new Date(e[0]).toISOString()+";"+(void 0!==a[n]?a[n]:n),l[u][r]=s,r++}}}),u++});for(var n=l.length,i=0,r=0;r<n;r++)l[r].length>i&&(i=l[r].length);for(r=0;r<=i;r++){for(var c=0;c<n;c++)angular.isDefined(l[c][r])?a+=l[c][r]:a+=";",a+=";";a+="\n"}var d=new Blob([a],{type:"data:text/csv;charset=utf-8,",endings:"native"});URL.createObjectURL(d);window.saveAs(d,"Graph-"+S("dateFormatCSharp")(new Date,"yyyy-MM-dd-HH-mm-ss")+".csv")}}}]}}]).service("EsgGraphSettings",["$filter","$log","I18nService","EsgTimeSpan","ESGVisionConfig",function(e,t,a,n,i){var r={graphSettings:{},getGraphSettings:function(){return r.graphSettingsLanguage!=a.actualLanguage&&r.updateSettings(),r.graphSettings},createSettings:function(){return r.graphSettingsLanguage=a.actualLanguage,{dataInterval:{"-1minutes":new n({minutes:1}),"-15minutes":new n({minutes:15}),"-1hours":new n({hours:1}),"-3hours":new n({hours:3}),"-1days":new n({days:1}),"-3days":new n({days:3}),"-1week":new n({days:7}),"-2weeks":new n({days:14}),"-1month":new n({months:1}),"-2months":new n({months:2}),"-3months":new n({months:3}),"-6months":new n({months:6}),"-9months":new n({months:9}),"-1year":new n({years:1}),"-2years":new n({years:2}),fromTo:new n({})},moduloInterval:[{value:"day",label:e("i18n")("Day")},{value:"week",label:e("i18n")("Week")},{value:"year",label:e("i18n")("Year")}],barInterval:[{value:"quarterhour",label:e("i18n")("¼ hour"),active:!0},{value:"hour",label:e("i18n")("Hour"),active:!0},{value:"day",label:e("i18n")("Day"),active:!0},{value:"week",label:e("i18n")("Week"),active:!0},{value:"month",label:e("i18n")("Month"),active:!0},{value:"year",label:e("i18n")("Year"),active:!0}],moduloCarpetInterval:[{value:"week-hour",label:e("i18n")("Week")+" - "+e("i18n")("Hour"),xAxisUnit:new n({hours:1}),yAxisUnit:new n({days:1}),xAxisMax:24,yAxisMax:7,yearIsAggregated:!0},{value:"week-quarterhour",label:e("i18n")("Week")+" - 1/4 "+e("i18n")("Hour"),xAxisUnit:new n({minutes:15}),yAxisUnit:new n({days:1}),xAxisMax:96,yAxisMax:7,yearIsAggregated:!0},{value:"month-hour",label:e("i18n")("Month")+" - "+e("i18n")("Hour"),xAxisUnit:new n({hours:1}),yAxisUnit:new n({months:1}),xAxisMax:24,yAxisMax:12,yearIsAggregated:!0},{value:"month-quarterhour",label:e("i18n")("Month")+" - 1/4 "+e("i18n")("Hour"),xAxisUnit:new n({minutes:15}),yAxisUnit:new n({months:1}),xAxisMax:96,yAxisMax:12,yearIsAggregated:!0},{value:"month_year-week",label:e("i18n")("Month")+"_"+e("i18n")("Year")+" - "+e("i18n")("Week"),xAxisUnit:new n({days:1}),yAxisUnit:new n({months:1}),xAxisMax:7,yAxisMax:12,yearIsAggregated:!1},{value:"month_year-hour",label:e("i18n")("Month")+"_"+e("i18n")("Year")+" - "+e("i18n")("Hour"),xAxisUnit:new n({hours:1}),yAxisUnit:new n({months:1}),xAxisMax:24,yAxisMax:12,yearIsAggregated:!1},{value:"month_year-quarterhour",label:e("i18n")("Month")+"_"+e("i18n")("Year")+" - 1/4 "+e("i18n")("Hour"),xAxisUnit:new n({minutes:15}),yAxisUnit:new n({months:1}),xAxisMax:96,yAxisMax:12,yearIsAggregated:!1}],graphDataInterval:[{interval:"-1minutes",option:e("i18n")("$ minute",1)},{interval:"-15minutes",option:e("i18n")("$ minute",15)},{interval:"-1hours",option:e("i18n")("$ hour",1)},{interval:"-3hours",option:e("i18n")("$ hour",3)},{interval:"-1days",option:e("i18n")("$ day",1)},{interval:"-3days",option:e("i18n")("$ day",3)},{interval:"-1week",option:e("i18n")("$ week",1)},{interval:"-2weeks",option:e("i18n")("$ week",2)},{interval:"-1month",option:e("i18n")("$ month",1)},{interval:"-2months",option:e("i18n")("$ month",2)},{interval:"-3months",option:e("i18n")("$ month",3)},{interval:"-6months",option:e("i18n")("$ month",6)},{interval:"fromTo",option:e("i18n")("From")+" - "+e("i18n")("To")}],graphPlotType:[{value:"Line",label:e("i18n")("Line")}],barDataCountType:[],moduloCarpetDataCountType:[],barDataType:[],carpetColorScale:[],legendSettings:[{value:0,label:e("i18n")("No legend")},{value:1,label:e("i18n")("Simple legend")},{value:2,label:e("i18n")("Full legend")}],graphPlotTypeFull:[{value:"Line",label:e("i18n")("Line")}],stringDictionary:{NE:0,ANO:1,STOP:2,CHOD:3,VYP:4,ZAP:5,"1.ST":6,"STUPEN 1":7,"2.ST":8,OK:9,ALARM:10,NoAlarm:11,Warning:12,WarningNoAck:13,Shutdown:14,ShutdownNoAck:15,Online:19,Error:20}}},updateSettings:function(){var n=r.createSettings();angular.forEach(r.graphSettings,function(e,a){0<e.length&&void 0!==e[0]&&(void 0!==e[0].label||void 0!==e[0].option)&&angular.forEach(e,function(e,t){void 0!==r.graphSettings[a][t].label?r.graphSettings[a][t].label=n[a][t].label:void 0!==r.graphSettings[a][t].option&&(r.graphSettings[a][t].option=n[a][t].option)})}),r.graphSettingsLanguage=a.actualLanguage}};return r.graphSettings=r.createSettings(),r}]),esgAngularDependencies.push("ESGTextView"),angular.module("ESGTextView",[]).directive("textView",["$log","$rootScope","$injector","$filter","$compile","ESGXmlHelper","RcWareVisionAPI","WebpanelData",function(r,e,o,t,n,a,l,i){return{transclude:!1,template:'<div class="text-view" ng-show="isVisible">                     <table>                       <tbody class="table-body">                       </tbody>                     </table>                   </div>',replace:!0,restrict:"E",scope:{isVisible:"="},link:function(e,t,a,n){return e.element=t[0],e.elementTableBody=$(e.element).find(".table-body"),["$scope","iElement","iAttrs","contoller",function(e,t,a,n){}]},controller:["$scope",function(i){i.$watch("isVisible",function(e){e&&(i.lines=[],l.GetTextDefinition().success(function(n){var e=a.getXPathResult(n,"lcd:lcd-splc-menu/lcd:menu/lcd:*",l.nsResolver,n);angular.forEach(e,function(t){try{var e=o.get("ESG"+t.tagName)}catch(e){r.log("missing factory: "+t.tagName)}if(null!=e){var a=new e({node:t,nsResolver:l.nsResolver,xmlDoc:n},o);i.lines.push(a)}}),i.updateTable()}))}),i.updateTable=function(){$(i.elementTableBody).html(""),angular.forEach(i.lines,function(e){var t=i.$new();t.gadget=e;var a=angular.element(e.getTemplate());n(a)(t,function(e,t){$(i.elementTableBody).append(e)})})}}]}}]),esgAngularDependencies.push("Gadget.ESGCanvas"),angular.module("Gadget.ESGCanvas",[]).factory("ESGcanvas",["$log","$injector","ESGXmlHelper","WebpanelGadget","WebpanelData",function(e,t,n,i,r){var a=function(a){i.call(this,a);var e=n.getXPathResult(a.node,"hmi:children/hmi:*",a.nsResolver,a.xmlDoc);this.innerGadgets=[],angular.forEach(e,function(e){var t=r.parseGadget(e,a.xmlDoc,"canvas",a.panelId,a.additionalData);null!=t&&this.innerGadgets.push(t)},this),this.getTemplate=function(){return'<esg-canvas gadget="gadget" ratio="ratio"></esg-canvas>'}};return angular.extend(a.prototype,i.prototype),a.prototype.getChildrens=function(){return this.innerGadgets},a}]).directive("esgCanvas",["$log","$rootScope","$compile","schemaElementStyle",function(e,t,r,a){return{transclude:!1,template:'<div esg-style="style" class="canvas" handle-gadget-tooltip schema-element-resize><div></div></div>',replace:!0,restrict:"E",scope:{gadget:"=",ratio:"="},link:function(n,i,e,t){return angular.forEach(n.gadget.innerGadgets,function(e){var t=n.$new(),a=angular.element(e.getTemplate());t.gadget=e;r(a)(t,function(e,t){$(i[0].children).append(e)})}),["$scope","iElement","iAttrs","contoller",function(e,t,a,n){}]},controller:["$scope",function(e){e.style=a.prepareStyle(e.gadget,{"white-space":"nowrap"})}]}}]),esgAngularDependencies.push("Gadget.ESGlayoutPanel"),angular.module("Gadget.ESGlayoutPanel",[]).factory("ESGlayoutPanel",["$log","ESGXmlHelper","WebpanelGadget","WebpanelData",function(e,t,i,r){var a=function(a){i.call(this,a);var e=t.getXPathResult(a.node,"hmi:children/hmi:*",a.nsResolver,a.xmlDoc);this.innerGadgets=[];var n="gadgetTemplate"==this.metadataArray.gadgetName?{templateAddPosition:{x:parseInt(this.metadataArray["canvas.x"]),y:parseInt(this.metadataArray["canvas.y"])}}:null;null!=n&&(null==a.additionalData?a.additionalData=n:(a.additionalData.templateAddPosition.x+=n.templateAddPosition.x,a.additionalData.templateAddPosition.y+=n.templateAddPosition.y)),angular.forEach(e,function(e){var t=r.parseGadget(e,a.xmlDoc,"layoutPanel",a.panelId,n,a.additionalData);null!=t&&this.innerGadgets.push(t)},this),this.getTemplate=function(){return'<esg-layout-panel gadget="gadget" ratio="ratio"></esg-layout-panel>'}};return angular.extend(a.prototype,i.prototype),a.prototype.getChildrens=function(){return this.innerGadgets},a}]).directive("esgLayoutPanel",["$log","$compile","schemaElementStyle",function(e,r,t){return{transclude:!1,template:'<div esg-style="style" class="webpanel-gadget layout-panel gadget-name-{{gadget.metadataArray.gadgetName}}" handle-gadget-tooltip schema-element-resize hadle-action-click variable-selection handle-eval-property-value><div></div></div>',replace:!0,restrict:"E",scope:{gadget:"=",ratio:"="},link:function(n,i,e,t){return angular.forEach(n.gadget.innerGadgets,function(e){var t=n.$new(),a=angular.element(e.getTemplate());t.gadget=e;r(a)(t,function(e,t){$(i[0].children).append(e)})}),["$scope","iElement","iAttrs","contoller",function(e,t,a,n){}]},controller:["$scope",function(e){e.style=t.prepareStyle(e.gadget,{"white-space":"nowrap"})}]}}]),esgAngularDependencies.push("Gadget.ESGRectangle"),angular.module("Gadget.ESGRectangle",[]).factory("ESGrectangle",["$log","ESGXmlHelper","WebpanelGadget",function(e,r,o){var t=function(e){o.call(this,e);var t=r.getAttributeNS(e.node,"","cornerRadius"),a=r.getAttributeNS(e.node,"","cornerRadiusMask");if(""!=t)if(""!=a){var n=a.split(","),i=parseInt(t);this["border-radius"]=(1==n[0]?i+"px ":"0 ")+(1==n[1]?i+"px ":"0 ")+(1==n[2]?i+"px ":"0 ")+(1==n[3]?i+"px":"0")}else this["border-radius"]=parseInt(t);this.getTemplate=function(){return'<esg-rectangle gadget="gadget" ratio="ratio"></esg-rectangle>'}};return angular.extend(t.prototype,o.prototype),t}]).directive("esgRectangle",["$log","schemaElementStyle",function(e,t){return{transclude:!1,template:'<div esg-style="style" class="webpanel-gadget rectangle" handle-gadget-tooltip schema-element-resize handle-eval-property-value></div>',replace:!0,restrict:"E",scope:{gadget:"=",ratio:"="},link:function(e,t,a,n){return["$scope","iElement","iAttrs","contoller",function(e,t,a,n){}]},controller:["$scope",function(e){e.style=t.prepareStyle(e.gadget,{"white-space":"nowrap"})}]}}]),esgAngularDependencies.push("Gadget.ESGTextBlock"),angular.module("Gadget.ESGTextBlock",[]).factory("ESGtextBlock",["$log","ESGXmlHelper","WebpanelGadget","EsgColor","ESGVisionConfig",function(e,o,l,s,u){var t=function(e){l.call(this,e),this.text=o.getAttributeNS(e.node,"","text"),""==this.text&&(this.text=" ");var t=o.getAttributeNS(e.node,"","font");this.font={"font-type":""!=t?t:""};var a=u.DefaultFontFamily[t];null!=a?this.font["font-type"]+=", "+a:u.AddDefaultFont&&(this.font["font-type"]+=""!=t?", Trebuchet MS":"Trebuchet MS");var n=o.getAttributeNS(e.node,"","color");if(""!=n){var i=new s(n);this.font.color="rgba("+i.r+","+i.g+","+i.b+",1)"}var r=o.getAttributeNS(e.node,"","fontSize");""!=r&&(this.font["font-size"]=parseInt(r)),this.font["font-style"]="","true"==o.getAttributeNS(e.node,"","bold")&&(this.font["font-style"]+="Bold"),"true"==o.getAttributeNS(e.node,"","italic")&&(""!=this.font["font-style"]&&(this.font["font-style"]+=", "),this.font["font-style"]+="Italic"),this.getTemplate=function(){return'<esg-text-block gadget="gadget" ratio="ratio"></esg-text-block>'}};return angular.extend(t.prototype,l.prototype),t}]).directive("esgTextBlock",["$log","schemaElementStyle",function(e,t){return{transclude:!1,template:'<div esg-style="style" class="webpanel-gadget text" handle-gadget-tooltip schema-element-resize handle-eval-value hadle-action-click hadle-value-state>{{textValue}}</div>',replace:!0,restrict:"E",scope:{gadget:"=",ratio:"="},link:function(e,t,a,n){return["$scope","iElement","iAttrs","contoller",function(e,t,a,n){}]},controller:["$scope",function(e){e.style=t.prepareStyle(e.gadget),e.textValue=e.gadget.text}]}}]),esgAngularDependencies.push("Gadget.ESGImage"),angular.module("Gadget.ESGImage",[]).factory("ESGimage",["$log","ESGXmlHelper","WebpanelGadget","ESGVisionConfig","WebpanelData",function(e,o,l,t,s){var a=function(e){l.call(this,e);var t=o.getAttributeNS(e.node,"","source");""!=t&&(this.source=s.prepareImgSrc(t,e.panelId));var a=o.getAttributeNS(e.node,"","stretch").toLowerCase();"none"!=a&&(this.stretch=a);var n=o.getAttributeNS(e.node,"","rotation").toLowerCase();"None"!=n&&(this.rotation=parseInt(n));var i=o.getAttributeNS(e.node,"","mirror").toLowerCase();if("None"!=i&&(this.mirror=i),"fill"==this.stretch&&(90==this.rotation||270==this.rotation)){var r=this.width;this.width=this.height,this.height=r}90==this.rotation?this.rotation=270:270==this.rotation&&(this.rotation=90),this.getTemplate=function(){return'<esg-image gadget="gadget" ratio="ratio"></esg-image>'}};return angular.extend(a.prototype,l.prototype),a}]).directive("esgImage",["$log","schemaElementStyle",function(e,t){return{transclude:!1,template:'<div ng-style="style" class="webpanel-gadget image stretch-{{gadget.stretch}}" handle-gadget-tooltip schema-element-resize hadle-action-click handle-eval-property-value><esg-img img-styles="styleToEsgImg" src="gadget.source"></esg-img></div>',replace:!0,restrict:"E",scope:{gadget:"=",ratio:"="},link:function(n,i,e,t){return n.defaultTransform="",n.updateStyles=function(){void 0!==n.gadget.rotation&&null!=n.gadget.rotation&&(n.styleToEsgImg.width=i[0].offsetWidth+"px",n.styleToEsgImg.height=i[0].offsetHeight+"px",n.style.transform="translateX(-50%) translateY(-50%) rotate("+Math.round(n.gadget.rotation)+"deg)")},n.$watch("ratio",function(e,t){var a="";90!=n.gadget.rotation&&270!=n.gadget.rotation&&"fill"==n.gadget.stretch||(a+=" translate(-50%, -50%)"),"fill"==n.gadget.stretch?(a+=n.defaultTransform,90==n.gadget.rotation||270==n.gadget.rotation?(n.styleToEsgImg.width=i[0].offsetHeight+"px",n.styleToEsgImg.height=i[0].offsetWidth+"px"):(n.styleToEsgImg.width=i[0].offsetWidth+"px",n.styleToEsgImg.height=i[0].offsetHeight+"px")):(a+=" scale("+e+") ",a+=n.defaultTransform,n.styleToEsgImg.position="absolute"),"horizontal"==n.gadget.mirror?(a+="scaleX(-1)",null==n.gadget.stretch&&(a+="translate(50%, 50%)")):"vertical"==n.gadget.mirror&&(a+="scaleY(-1)",null==n.gadget.stretch&&(a+="translate(50%, 50%)")),"vertical"!=n.gadget.mirror&&"horizontal"!=n.gadget.mirror&&null==n.gadget.stretch&&(a+=" translate(50%, 50%)"),n.styleToEsgImg.transform=a}),void 0!==n.gadget.mirror&&$(i[0].children[0]).addClass("mirror-image-"+n.gadget.mirror),void 0===n.gadget.rotation&&null==n.gadget.rotation||(90==n.gadget.rotation&&($(i[0].children[0]).addClass("rotate-90-image"),n.defaultTransform="rotate(-90deg)"),180==n.gadget.rotation&&($(i[0].children[0]).addClass("rotate-180-image"),n.defaultTransform="rotate(-180deg)"),270==n.gadget.rotation&&($(i[0].children[0]).addClass("rotate-270-image"),n.defaultTransform="rotate(-270deg)")),["$scope","iElement","iAttrs","contoller",function(e,t,a,n){}]},controller:["$scope",function(e){e.style=t.prepareStyle(e.gadget,{"white-space":"nowrap"}),e.styleToEsgImg={},e.textValue=e.gadget.text}]}}]),esgAngularDependencies.push("Gadget.ESGuniformGrid"),angular.module("Gadget.ESGuniformGrid",[]).factory("ESGuniformGrid",["$log","ESGXmlHelper","WebpanelGadget","WebpanelData",function(e,t,n,i){var a=function(a){n.call(this,a),this.rows=parseInt(t.getAttributeNS(a.node,"","rows")),this.columns=parseInt(t.getAttributeNS(a.node,"","columns"));var e=t.getXPathResult(a.node,"hmi:children/hmi:*",a.nsResolver,a.xmlDoc);this.innerGadgets=[],angular.forEach(e,function(e){var t=i.parseGadget(e,a.xmlDoc,"uniformGrid",a.panelId);null!=t&&this.innerGadgets.push(t)},this),this.getTemplate=function(){return'<esg-uniform-grid gadget="gadget" ratio="ratio"></esg-uniform-grid>'}};return angular.extend(a.prototype,n.prototype),a.prototype.getChildrens=function(){return this.innerGadgets},a}]).directive("esgUniformGrid",["$log","$compile","schemaElementStyle",function(e,s,t){return{transclude:!1,template:'<div esg-style="style" class="webpanel-gadget uniform-grid" handle-gadget-tooltip schema-element-resize></div>',replace:!0,restrict:"E",scope:{gadget:"=",ratio:"="},link:function(i,e,t,a){i.element=e,i.grid=[];for(var n=0;n<i.gadget.rows;n++){var r=$('<div style="width: 100%; height: '+100/i.gadget.rows+'%;" class="uniform-grid-row"></div>');$(i.element[0]).append(r[0]);for(var o=0;o<i.gadget.columns;o++){var l=$('<div style="height: 100%; width: '+100/i.gadget.columns+'%;" class="uniform-grid-column"></div>');r.append(l[0]),i.grid.push(l)}}return angular.forEach(i.gadget.innerGadgets,function(e,a){if(!(a>=i.grid.length)){var t=i.$new(),n=angular.element(e.getTemplate());t.gadget=e;s(n)(t,function(e,t){$(t.grid[a]).append(e)})}}),["$scope","iElement","iAttrs","contoller",function(e,t,a,n){}]},controller:["$scope",function(e){e.style=t.prepareStyle(e.gadget,{"white-space":"nowrap"})}]}}]),esgAngularDependencies.push("Gadget.ESGSwitch"),angular.module("Gadget.ESGSwitch",[]).factory("ESGswitch",["$log","ESGXmlHelper","WebpanelGadget","WebpanelData","SwitchState",function(e,t,n,a,i){var r=function(a){n.call(this,a);var e=t.getXPathResult(a.node,"hmi:states/hmi:switchState",a.nsResolver,a.xmlDoc);this.states={},angular.forEach(e,function(e){var t=new i({node:e,xmlDoc:a.xmlDoc,nsResolver:a.nsResolver,parentType:a.parentType,panelId:a.panelId});null!=t&&(this.states[t.state]=t)},this),this.getTemplate=function(){return'<esg-switch gadget="gadget" ratio="ratio"></esg-switch>'}};return angular.extend(r.prototype,n.prototype),r.prototype.getChildrens=function(){return this.states},r}]).directive("esgSwitch",["$log","$compile","schemaElementStyle","WebpanelData",function(e,r,t,a){return{transclude:!1,template:'<div esg-style="style" class="webpanel-gadget switch" handle-gadget-tooltip schema-element-resize hadle-action-click><div></div></div>',replace:!0,restrict:"E",scope:{gadget:"=",ratio:"="},link:function(n,i,e,t){return n.element=i,n.actualState=null,n.setState=function(e){if(n.actualState!=e){n.actualState=e;var t=n.$new(),a=angular.element(e.getTemplate());t.gadget=e;r(a)(t,function(e,t){$(i[0].children).empty(),$(i[0].children).append(e)})}},["$scope","iElement","iAttrs","contoller",function(e,t,a,n){}]},controller:["$scope",function(n){if(n.style=t.prepareStyle(n.gadget,{"white-space":"nowrap"}),0<n.gadget.evaluators.length){var i=n.gadget.evaluators[0],e=a.panels[a.actualPanelId].gadgetsMap[i.varRef];null!=e&&(n.gadgetValueObj=e,n.showDefaultState=function(){null!=n.gadget.states[i.defaultState]?n.setState(n.gadget.states[i.defaultState].content[0]):$(n.element[0].children).empty()},n.$watch("gadgetValueObj.value",function(e,t){if(null!=e){var a=i.getState(e.value);null!=n.gadget.states[a]?n.setState(n.gadget.states[a].content[0]):n.showDefaultState()}else n.showDefaultState()}))}}]}}]),esgAngularDependencies.push("Gadget.ESGchart"),angular.module("Gadget.ESGchart",["AngularJSTabbedGraph"]).factory("ESGchart",["$log","ESGXmlHelper","WebpanelGadget","EsgColor","WebpanelData","EsgTimeSpan",function(e,c,n,d,p,t){var a=function(e){n.call(this,e),this.graphType=c.getAttributeNS(e.node,"","type"),this.sampleRate=parseInt(c.getAttributeNS(e.node,"","sampleRate")),this.duration=parseInt(c.getAttributeNS(e.node,"","duration")),this.legend="hide"!=c.getAttributeNS(e.node,"","legend");var t=c.getXPathResult(e.node,"hmi:axisCollection/hmi:yAxis",e.nsResolver,e.xmlDoc);this.axis={};var r=1;angular.forEach(t,function(e){var t=c.getAttributeNS(e,"","id"),a=c.getAttributeNS(e,"","min"),n=c.getAttributeNS(e,"","max"),i=c.getAttributeNS(e,"","color");this.axis[t]={id:t,min:a,max:n,color:null!=i?new d(i):null,index:r},r++},this),this.multipleAxis=2<r;var a=c.getXPathResult(e.node,"hmi:seriesCollection/hmi:series",e.nsResolver,e.xmlDoc);this.series=[],this.variables=[],angular.forEach(a,function(e){var t=c.getAttributeNS(e,"","name"),a=c.getAttributeNS(e,"","color"),n=c.getAttributeNS(e,"","thickness"),i="true"==c.getAttributeNS(e,"","showPoints"),r=c.getAttributeNS(e,"","stringFormat"),o=c.getAttributeNS(e,"","yAxisRef"),l=c.getAttributeNS(e,"","varRef"),s=l.replace("varRef://","").split("/");try{var u=p.connectionDefinition.connections[s[0]].variables[s[1]]}catch(e){}null!=u&&this.variables.push({variableDef:u,varRef:l}),this.series.push({name:t,thickness:n,showPoints:i,stringFormat:r,axis:this.axis[o],variableDef:u,color:null!=a?new d(a):null})},this),this.getTemplate=function(){return'<esg-chart gadget="gadget" ratio="ratio"></esg-chart>'}};return a.prototype=n,a}]).directive("esgChart",["$log","$filter","$timeout","schemaElementStyle","RcWareVisionAPI","WebpanelData","ESGDigest",function(t,d,e,a,n,p,i){return{transclude:!1,template:'<div esg-style="style" class="webpanel-gadget chart" handle-gadget-tooltip schema-element-resize><tabbed-graph graph-data="graphData" graph-width="width" graph-height="height" graph-style="graphStyle" graph-options="graphOptions" graph-string-dictionary="stringDictionary" graph-enable-tooltip="graphEnableTooltip" graph-commands="graphCommands" graph-tooltip-style="toolStyle" additional-settings="additionalSettingsGraph"></tabbed-graph></div>',replace:!0,restrict:"E",scope:{gadget:"=",ratio:"="},link:function(o,e,t,a){o.additionalSettingsGraph={graphShowPoints:!0,graphShowPointsSeries:!0,multipleAxis:o.gadget.multipleAxis,graphOscilloscopeRegime:!0,projectGraphTimeRange:{interval:"fromToa",option:d("i18n")("from/to")},oscilloShowRightSpace:!1,labelFormatterStatus:function(e){var t="";return"ok"!=e.status&&(null==e.status?t+=' - <span class="error">'+d("i18n")("error")+"</span>":t+=" - <span>"+d("i18n")(e.status)+"</span>"),t}},o.element=e,o.graphElement=e[0],o.graphSettingsValues={dataInterval:{"-3days":{day:3,month:0,year:0},"-1week":{day:7,month:0,year:0},"-2weeks":{day:14,month:0,year:0},"-1month":{day:0,month:1,year:0},"-2months":{day:0,month:2,year:0},"-3months":{day:0,month:3,year:0},"-6months":{day:0,month:6,year:0},"-9months":{day:0,month:9,year:0},"-1year":{day:0,month:0,year:1},"-2years":{day:0,month:0,year:2},fromTo:{day:0,month:0,year:0}},moduloInterval:[{value:"day",label:d("i18n")("Day")},{value:"week",label:d("i18n")("Week")},{value:"year",label:d("i18n")("Year")}],barInterval:[{value:"quarterhour",label:d("i18n")("¼ hour"),active:!0},{value:"hour",label:d("i18n")("Hour"),active:!0},{value:"day",label:d("i18n")("Day"),active:!0},{value:"week",label:d("i18n")("Week"),active:!0},{value:"month",label:d("i18n")("Month"),active:!0},{value:"year",label:d("i18n")("Year"),active:!0}],moduloCarpetInterval:[{value:"month-hour",label:d("i18n")("Month")+"-"+d("i18n")("Hour")},{value:"week-hour",label:d("i18n")("Week")+"-"+d("i18n")("Hour")}],graphDataInterval:[{interval:"-3days",option:d("i18n")("$ day",3)},{interval:"-1week",option:d("i18n")("$ week",1)},{interval:"-2weeks",option:d("i18n")("$ week",2)},{interval:"-1month",option:d("i18n")("$ month",1)},{interval:"-2months",option:d("i18n")("$ month",2)},{interval:"-3months",option:d("i18n")("$ month",3)},{interval:"-6months",option:d("i18n")("$ month",6)},{interval:"-9months",option:d("i18n")("$ month",9)},{interval:"-1year",option:d("i18n")("$ year",1)},{interval:"-2years",option:d("i18n")("$ year",2)},{interval:"fromTo",option:d("i18n")("from/to")}],graphPlotType:[{value:"Line",label:d("i18n")("Line")}],barDataCountType:[],barDataType:[]},o.$watch("ratio",function(e,t){if(void 0!==e){var a=/^[0-9]+([,.][0-9]+)?$/;angular.forEach(o.toolDefaultStyle,function(e,t){if(a.test(e)){o.toolStyle[t]}})}}),o.graphEnableTooltip=!0,o.graphStyle={"background-color":"white"},o.graphOptions={series:{lines:{show:!0},points:{show:!0,selfSeries:!0},carpet:{show:!1}},touch:!1,selection:{mode:null},legend:{show:!0},grid:{margin:{}},colors:[],xaxis:{font:{color:"rgb(84, 84, 84)",variant:"normal",style:"normal",family:"'Trebuchet MS'",weight:"400",lineHeight:20,size:12}},yaxis:{font:{color:"rgb(84, 84, 84)",variant:"normal",style:"normal",family:"'Trebuchet MS'",weight:"400",lineHeight:20,size:12}}},o.graphOptions.quarterMaximum=!1,0==o.gadget.legend&&(o.graphOptions.legend.show=!1),o.graphData=[],o.projectGraphPlotTypeValues=[{value:"Line",label:"Line"},{value:"CarpetLinear",label:"Carpet - Linear"},{value:"CarpetJet",label:"Carpet - JET"}],o.graphCommands={reset:!1,clear:!1,panLeft:!1,panRight:!1,redraw:!1,resetGraphRecountBarData:!1},o.width=o.gadget.width*o.ratio,o.height=o.gadget.height*o.ratio,o.$watch("ratio",function(e,t){void 0!==o.ratio&&("100%"==o.gadget.width?o.width=o.element[0].clientWidth:o.width=o.gadget.width*o.ratio,"100%"==o.gadget.height?o.height=o.element[0].clientHeight:o.height=o.gadget.height*o.ratio)});(new Date).getTime();isNaN(o.gadget.duration)||null!=o.gadget.timeAlign||(o.additionalSettingsGraph.fixViewRange=1e3*parseFloat(o.gadget.duration));var n=new Date;if(isNaN(o.gadget.duration))if(null!=o.graphSettingsValues.dataInterval[o.gadget.duration]){var i=o.graphSettingsValues.dataInterval[o.gadget.duration];switch(r=new Date(n.getFullYear()-i.year,n.getMonth()-i.month,n.getDate()-i.day,0,0,0,0),o.gadget.duration){case"-1week":case"-2weeks":s=864e5;(l=new Date(n)).setHours(0,0,0,0);u=l.getDay();l=l.getTime(),1!=u&&(0!=u?r.setTime(l-s*(u-1)):r.setTime(l-6*s));break;case"-1month":case"-2months":case"-3months":case"-6months":case"-9months":r.setDate(1);break;case"-1year":case"-2years":r.setHours(0,0,0,0),r.setMonth(0),r.setDate(1)}}else switch(o.gadget.duration){case"week":break;case"month":r=new Date(n);n.setHours(23,59,59,999),void 0!==o.gadget.moveDataSpan&&null!=o.gadget.moveDataSpan&&r.getDate()==o.gadget.moveDataSpan.days&&r.setMonth(r.getMonth()-1),r.setDate(1+(void 0!==o.gadget.moveDataSpan&&null!=o.gadget.moveDataSpan?o.gadget.moveDataSpan.days:0)),r.setHours(0,0,0,0)}else{var r=new Date(n.getTime()-1e3*parseFloat(o.gadget.duration));if(null!=o.gadget.timeAlign)switch(o.gadget.timeAlign){case"Day":r.setHours(0,0,0,0);break;case"Week":var l,s=864e5;(l=new Date(r)).setHours(0,0,0,0);var u=l.getDay();l=l.getTime(),1!=u&&(0!=u?r.setTime(l-s*(u-1)):r.setTime(l-6*s))}if(n.getTime()<r.getTime()){var c=r;r=n,n=c}}return o.formateValueFce=function(e,t,a){return p.formatValue(e,t.stringFormat,a.type)},o.setSeries=function(){var n=[],i=[],r=[];angular.forEach(o.gadget.axis,function(e){}),angular.forEach(o.gadget.series,function(t,e){var a={idx:"svc://"+t.variableDef.connection.name+"/"+t.variableDef.uId+"["+t.variableDef.offset+","+t.variableDef.length+"]",label:t.name,fullLabel:t.name,data:[],serieOrder:e,color:null!=t?t.color.toRGBString():null,lines:{show:!0,steps:!1,lineWidth:t.thickness},points:{show:t.showPoints},formateValueFce:function(e){return o.formateValueFce(e,t,t.variableDef)}};a.yaxis=t.axis.index,a.yaxisIndexEsg=t.axis.index,"auto"==t.axis.min&&"auto"==t.axis.max||(a.yaxisObj={},"auto"!=t.axis.min&&(a.yaxisObj.min=parseFloat(t.axis.min)),"auto"!=t.axis.max&&(a.yaxisObj.max=parseFloat(t.axis.max))),"bool"==p.typeNumToId(parseInt(t.variableDef.type))&&(a.dictionary={false:0,true:1},a.stringDictionaryExplicitly=!1,a.lines.steps=!0),"string"==p.typeNumToId(parseInt(t.variableDef.type))&&(a.dictionary={},a.innermappingDictionary=[],a.stringDictionaryExplicitly=!1,a.lines.steps=!0),n.push(a),$.isEmptyObject(a.dictionary)?r.push(a):i.push(a)}),i=d("orderBy")(i,"label",!0),o.graphData=d("orderBy")(n,["+lines.steps","+serieOrder"]),angular.forEach(o.graphData,function(e,t){o.dpIdToSeries[e.idx]=parseInt(t)})},o.setData=function(){0==o.gadget.series.length?o.graphData=[]:1==o.historyLoaded&&1!=$scope.oscilloIsRunning?o.oscilloTimer():o.getHistoryData()},o.dpIdToSeries={},o.setData(),o.refreshGraph=function(){var e=o.graphCommands;e.redraw=!e.redraw,o.graphCommands=e},o.resetGraph=function(){var e=o.graphCommands;e.reset=!e.reset,o.graphCommands=e},o.resetGraphRecountBarData=function(){var e=o.resetGraphRecountBarData;e.resetGraphRecountBarData=!e.resetGraphRecountBarData,o.graphCommands=e},o.$watch("WebpanelData.actualPanel",function(e){e.id==o.gadget.panelId&&0==o.oscilloIsRunning&&1==o.historyLoaded&&o.oscilloTimer()}),["$scope","iElement","iAttrs","contoller",function(e,t,a,n){}]},controller:["$scope",function(u){u.style=a.prepareStyle(u.gadget,{"white-space":"nowrap"}),u.WebpanelData=p,u.historyLoaded=!1,u.oscilloIsRunning=!1,u.endWithNull={},u.getHistoryData=function(){var e=new Date((new Date).getTime()-1e3*u.gadget.duration*1.1);n.GetHistory(u.gadget.variables,e,new Date).success(function(e){u.setSeries(),angular.forEach(e,function(t,a){var n=null;angular.forEach(u.graphData,function(e){a==e.idx&&(n=e,u.endWithNull[a]=t.endWithNull)}),null!=n&&(n.data=t.data,n.status=t.state)}),u.historyLoaded=!0,p.actualPanel.id==u.gadget.panelId&&1!=u.oscilloIsRunning&&(u.oscilloTimer(),u.resetGraph())}).error(function(){t.log("error - getVariableHistory"),u.historyLoaded=!0,p.actualPanel.id==u.gadget.panelId&&1!=u.oscilloIsRunning&&u.oscilloTimer()})},u.oscilloTimer=function(){var l=!1;if(p.actualPanel.id==u.gadget.panelId){var s=!(u.oscilloIsRunning=!0);n.GetValues(u.gadget.variables).success(function(){angular.forEach(u.gadget.variables,function(e,t){l=!0;var a="svc://"+e.variableDef.connection.name+"/"+e.variableDef.uId+"["+e.variableDef.offset+","+e.variableDef.length+"]",n=null;if(angular.forEach(u.graphData,function(e){a==e.idx&&(n=e)}),null!=n&&null!=e.value){var i=new Big(e.value.ts).minus("621355968000000000").div(1e4).toFixed(0);if(i=parseInt(i),1<n.data.length){if(i==n.data[n.data.length-1][0].getTime())return;var r=n.data[1];null==r&&null!=n.data[1]&&(r=n.data[1]),null!=r&&i-n.data[1][0].getTime()>1e3*u.gadget.duration*1.1&&n.data.splice(0,1)}var o=p.typeNumToId(parseInt(e.variableDef.type));if("real"==o||"lreal"==o){if(1==isNaN(e.value.value)||e.value.value==1/0||e.value.value==-1/0)return void(0<n.data.length&&null!=n.data[n.data.length-1]&&(u.endWithNull[a]=!0));u.endWithNull[a]&&(u.endWithNull[a]=!1,n.data.push(null))}"bool"==p.typeNumToId(parseInt(e.variableDef.type))?n.data.push([new Date(i),1==e.value.value?1:0]):"string"==p.typeNumToId(parseInt(e.variableDef.type))?(null==n.dictionary[e.value.value]&&(n.dictionary[e.value.value]=n.innermappingDictionary.length,n.innermappingDictionary.push(e.value.value),s=!0),n.data.push([new Date(i),n.dictionary[e.value.value]])):n.data.push([new Date(i),parseFloat(e.value.value.toFixed(6))]),0<n.data.length&&(n.status="ok"),1==n.data.length&&(s=!0)}}),l&&u.oscilloRefreshGraph(s),p.actualPanel.id==u.gadget.panelId?e(u.oscilloTimer,u.gadget.sampleRate):u.oscilloIsRunning=!1}).error(function(){p.actualPanel.id==u.gadget.panelId?e(u.oscilloTimer,u.gadget.sampleRate):u.oscilloIsRunning=!1})}else u.oscilloIsRunning=!1},u.oscilloRefreshGraph=function(e){e||void 0!==u.gadget.chartType&&null!=u.gadget.chartType&&"Bar"==u.gadget.chartType?u.resetGraph():u.refreshGraph(),i(u)}}]}}]),esgAngularDependencies.push("Gadget.ESGScrollPanel"),angular.module("Gadget.ESGScrollPanel",[]).factory("ESGscrollPanel",["$log","ESGXmlHelper","WebpanelGadget","WebpanelData",function(e,n,i,r){var t=function(a,e){if(this.innerGadgets=[],e){i.call(this,a);var t=n.getXPathResult(a.node,"hmi:children/hmi:*",a.nsResolver,a.xmlDoc);angular.forEach(t,function(e){var t=r.parseGadget(e,a.xmlDoc,"canvas",a.panelId);null!=t&&this.innerGadgets.push(t)},this),this.getTemplate=function(){return'<esg-canvas gadget="gadget" ratio="ratio"></esg-canvas>'}}else angular.forEach(a.childNodes,function(e){var t=r.parseGadget(e,a.xmlDoc,"scrollPanel",a.panelId);null!=t&&this.innerGadgets.push(t)},this),this.left=a.left,this.top=a.top,this.width=a.width,this.height=a.height,this.actions=[];this.getTemplate=function(){return'<esg-scroll-panel gadget="gadget" ratio="ratio"></esg-scroll-panel>'}};return angular.extend(t.prototype,i.prototype),t.prototype.getChildrens=function(){return this.innerGadgets},t}]).directive("esgScrollPanel",["$log","$compile","schemaElementStyle",function(e,r,t){return{transclude:!1,template:'<div esg-style="style" class="webpanel-gadget scroll-grid" handle-gadget-tooltip schema-element-resize></div>',replace:!0,restrict:"E",scope:{gadget:"=",ratio:"="},link:function(n,i,e,t){return angular.forEach(n.gadget.innerGadgets,function(e){var t=n.$new(),a=angular.element(e.getTemplate());t.gadget=e;r(a)(t,function(e,t){$(i[0]).append(e)})}),["$scope","iElement","iAttrs","contoller",function(e,t,a,n){}]},controller:["$scope",function(e){e.style=t.prepareStyle(e.gadget,{"white-space":"nowrap"})}]}}]),esgAngularDependencies.push("Gadget.ESGValueSlider"),angular.module("Gadget.ESGValueSlider",[]).factory("ESGValueSlider",["$log","ESGXmlHelper","WebpanelGadget","WebpanelData",function(e,t,a,n){var i=function(e){a.call(this,e),this.text=t.getAttributeNS(e.node,"","text"),this.orientation=t.getAttributeNS(e.node,"","orientation"),this.showTicks="true"==t.getAttributeNS(e.node,"","showTicks"),this.snapToTicks=!1,this.trackThickness=parseInt(t.getAttributeNS(e.node,"","trackThickness")),this.valueVisible="true"==t.getAttributeNS(e.node,"","valueVisible"),this.stringFormat=t.getAttributeNS(e.node,"","stringFormat"),this.min=parseInt(t.getAttributeNS(e.node,"","min")),this.max=parseInt(t.getAttributeNS(e.node,"","max")),this.step=parseInt(t.getAttributeNS(e.node,"","step")),this.varRef=t.getAttributeNS(e.node,"","varRef"),n.registerGadgetDp(this.varRef),this.getTemplate=function(){return'<esg-value-slider gadget="gadget" ratio="ratio"></esg-value-slider>'}};return angular.extend(i.prototype,a.prototype),i}]).directive("esgValueSlider",["$log","schemaElementStyle","WebpanelData",function(e,t,r){return{transclude:!1,template:'<div esg-style="style" class="webpanel-gadget int-value-slider" ng-class="{vertical: !isHorizontal}" handle-gadget-tooltip schema-element-resize><esg-slider2 slider-value="value" min="gadget.min" max="gadget.max" snap-to-ticks="gadget.snapToTicks" show-ticks="gadget.showTicks" orientation="gadget.orientation" is-horizontal="isHorizontal" gadget="gadget" ratio="ratio"></esg-slider2></div>',replace:!0,restrict:"E",scope:{gadget:"=",ratio:"="},link:function(e,t,a,n){return["$scope","iElement","iAttrs","contoller",function(e,t,a,n){}]},controller:["$scope",function(n){n.style=t.prepareStyle(n.gadget),n.isHorizontal="LeftToRight"==n.gadget.orientation||"RightToLeft"==n.gadget.orientation;var i=r.panels[n.gadget.panelId].gadgetsMap[n.gadget.varRef];if(null!=i){var e=r.getValueWatchQuery(i);n.gadgetValueObj=e.gadgetValueObj,n.$watch(e.query,function(e,t){var a=r.getValueHandleEvalValue(i,e);null!=a&&1!=n.gadget.isActive&&(n.value=a.value)})}n.textValue=n.gadget.text}]}}]).directive("esgSlider2",["$log","$compile","WebpanelData","ESGVisionConfig",function(e,t,o,i){return{transclude:!1,template:'<div class="slider-container"><div class="slider"><span class="bar"><span class="ticks"><span class="main"></span><span class="tick start"></span><span class="tick" ng-repeat="tick in ticks" style="{{tickPosition(tick)}}"></span><span class="tick end"></span></span><span class="pointer pointer-value" ng-style="valueStyles" ng-class="{active: gadget.isActive}" ng-show="gadget.isActive"><div>{{countedValue}}</div></span><span class="pointer" ng-style="pointerStyles" ng-class="{active: gadget.isActive}"></span><span class="pointer pointer-line" ng-style="pointerStylesLine" ng-class="{active: gadget.isActive}"></span></span></div></div>',replace:!0,restrict:"E",scope:{sliderValue:"=",min:"=",max:"=",showTicks:"=",snapToTicks:"=",orientation:"=",isHorizontal:"=",gadget:"=",translate:"&",ratio:"="},link:function(r,e,t){r.rootElement=e,r.sliderPoint=$(e).find(".pointer")[1],r.sliderPointWidth=r.sliderPoint.offsetWidth,r.element=$(e).find(".bar")[0],r.sliderElement=$(e).find(".slider")[0],r.newPosition=null,r.countedValue=null;var a=3,n=18;return r.$watch("ratio",function(e){r.isHorizontal?(r.pointerStylesLine.width=Math.round(a*e),r.pointerStylesLine.height=Math.round(n*e),r.pointerStylesLine.top="calc(50% - "+Math.round(r.pointerStylesLine.height/2)+"px)"):(r.pointerStylesLine.height=Math.round(a*e),r.pointerStylesLine.width=Math.round(n*e),r.pointerStylesLine.left="calc(50% - "+Math.round(r.pointerStylesLine.width/2)+"px)")}),$(r.rootElement).bind("mousedown",function(e){e.preventDefault(),e.stopPropagation()}),r.setOffset=function(){0==r.isHorizontal?r.elementOffset=r.element.getBoundingClientRect().top:r.elementOffset=r.element.getBoundingClientRect().left},r.setOffset(),r.$watch("element.scrollWidth",function(){r.setOffset(),r.pointerPosition(r.getValue(r.sliderValueInner))}),r.getSliderPosition=function(e){return 0==r.isHorizontal?e.clientY-r.elementOffset:e.clientX-r.elementOffset},r.setZindex=function(e){for(var t=r.rootElement[0].parentElement;0==t.classList.contains(i.SchemaRootClass);){e?$(t).addClass("active-element-path"):$(t).removeClass("active-element-path");t=t.parentElement}},r.start=function(e){return r.gadget.isActive=!0,$(document).bind("mousemove",r.move),$(document).bind("mouseup",r.end),$(document).bind("touchmove",r.move),r.$digest(),e.preventDefault(),e.stopPropagation(),r.setZindex(!0),!1},r.countNewValue=function(e){var t=0==r.isHorizontal?r.element.offsetHeight:r.element.offsetWidth,a=r.revert?1-e/t:e/t,n=(r.max-r.min)*a+r.min;return(n=Math.round(n))<r.min?n=r.min:n>r.max&&(n=r.max),r.countedValue=n},r.move=function(e){if(e.preventDefault(),e.stopPropagation(),r.gadget.isActive){void 0===e.clientX&&(e=e.originalEvent);var t=r.getSliderPosition(e);r.newPosition=t;var a=r.countNewValue(t);a>=r.min&&a<=r.max&&r.$apply(function(){r.sliderValueInner=new Big(a)})}},r.end=function(e){if(e.preventDefault(),e.stopPropagation(),r.gadget.isActive){var t;$(document).unbind("mousemove",r.move),$(document).unbind("mouseup",r.end),$(document).unbind("touchmove",r.move),t=void 0===e.clientX?(e=e.originalEvent,r.newPosition):r.getSliderPosition(e);var a=r.countNewValue(t);if(a>=r.min&&a<=r.max){var n=new Big(a);r.$apply(function(){r.sliderValueInner=n});var i=o.panels[o.actualPanelId].gadgetsMap[r.gadget.varRef];o.sendValue(r.gadget.varRef,n,i)}}r.gadget.isActive=!1,r.setZindex(!1),r.$digest()},$(r.sliderPoint).bind("mousedown",r.start),$(r.sliderElement).bind("click",function(e){r.gadget.isActive=!0,r.end(e)}),$(r.sliderPoint).bind("touchstart",r.start),$(r.sliderPoint).bind("touchend",r.end),["$scope","iElement","iAttrs","controller",function(e,t,a,n){}]},controller:["$scope",function(i){i.sliderValueInner=i.sliderValue,i.gadget.isActive=!1,i.positionProperty="left",0==i.isHorizontal&&(i.positionProperty="top"),i.revert="BottomToTop"==i.gadget.orientation||"RightToleft"==i.gadget.orientation,i.pointerStyles={},i.pointerStyles[i.positionProperty]=0,i.pointerStylesLine={},i.pointerStylesLine[i.positionProperty]=0,i.valueStyles={},i.min=parseInt(i.min),i.max=parseInt(i.max),i.ticks=[];for(var e=i.max-i.min<10?i.max-i.min-1:9,t=1;t<=e;t++){var a=t/(e+1)*100;i.ticks.push(a)}i.tickPosition=function(e){return i.isHorizontal?"left: "+e+"%":"top: "+e+"%"},i.pointerPosition=function(e){e<i.min?e=i.min:e>i.max&&(e=i.max);var t=0==i.isHorizontal?i.sliderPoint.offsetHeight:i.sliderPoint.offsetWidth,a=0==i.isHorizontal?i.element.offsetHeight:i.element.offsetWidth,n=(e-i.min)/(i.max-i.min)*100;i.revert&&(n=100-n),n-=t/2/a*100,i.pointerStylesLine[i.positionProperty]=i.pointerStyles[i.positionProperty]=n+"%",i.valueStyles[i.positionProperty]=i.pointerStyles[i.positionProperty]},i.getValue=function(e){var t=parseInt(e);if(null!=e&&"function"==typeof e.toString&&"function"==typeof e.toFixed){var a=e.toString();-1<a.indexOf("e-")&&(a=e.toFixed(0)),t=parseFloat(a)}return t},i.$watch("sliderValue",function(e,t){void 0!==e&&0==i.gadget.isActive&&(i.sliderValueInner=e)}),i.$watch("sliderValueInner",function(e,t){if(void 0!==e){var a=i.getValue(e);i.pointerPosition(a)}})}]}}]),esgAngularDependencies.push("Gadget.ESGIntValueSlider"),angular.module("Gadget.ESGIntValueSlider",[]).factory("ESGintValueSlider",["$log","ESGXmlHelper","WebpanelGadget","EsgColor","ESGVisionConfig","WebpanelData","ESGValueSlider",function(e,t,a,n,i,r,o){var l=function(e){o.call(this,e)};return angular.extend(l.prototype,o.prototype),l}]),esgAngularDependencies.push("Gadget.ESGSintValueSlider"),angular.module("Gadget.ESGSintValueSlider",[]).factory("ESGsintValueSlider",["$log","ESGXmlHelper","WebpanelGadget","EsgColor","ESGVisionConfig","WebpanelData","ESGValueSlider",function(e,t,a,n,i,r,o){var l=function(e){o.call(this,e)};return angular.extend(l.prototype,o.prototype),l}]),esgAngularDependencies.push("Gadget.ESGDintValueSlider"),angular.module("Gadget.ESGDintValueSlider",[]).factory("ESGdintValueSlider",["$log","ESGXmlHelper","WebpanelGadget","EsgColor","ESGVisionConfig","WebpanelData","ESGValueSlider",function(e,t,a,n,i,r,o){var l=function(e){o.call(this,e)};return angular.extend(l.prototype,o.prototype),l}]),esgAngularDependencies.push("Gadget.ESGLintValueSlider"),angular.module("Gadget.ESGLintValueSlider",[]).factory("ESGlintValueSlider",["$log","ESGXmlHelper","WebpanelGadget","EsgColor","ESGVisionConfig","WebpanelData","ESGValueSlider",function(e,t,a,n,i,r,o){var l=function(e){o.call(this,e)};return angular.extend(l.prototype,o.prototype),l}]),esgAngularDependencies.push("Gadget.ESGUsintValueSlider"),angular.module("Gadget.ESGUsintValueSlider",[]).factory("ESGusintValueSlider",["$log","ESGXmlHelper","WebpanelGadget","EsgColor","ESGVisionConfig","WebpanelData","ESGValueSlider",function(e,t,a,n,i,r,o){var l=function(e){o.call(this,e)};return angular.extend(l.prototype,o.prototype),l}]),esgAngularDependencies.push("Gadget.ESGUintValueSlider"),angular.module("Gadget.ESGUintValueSlider",[]).factory("ESGuintValueSlider",["$log","ESGXmlHelper","WebpanelGadget","EsgColor","ESGVisionConfig","WebpanelData","ESGValueSlider",function(e,t,a,n,i,r,o){var l=function(e){o.call(this,e)};return angular.extend(l.prototype,o.prototype),l}]),esgAngularDependencies.push("Gadget.ESGUdintValueSlider"),angular.module("Gadget.ESGUdintValueSlider",[]).factory("ESGudintValueSlider",["$log","ESGXmlHelper","WebpanelGadget","EsgColor","ESGVisionConfig","WebpanelData","ESGValueSlider",function(e,t,a,n,i,r,o){var l=function(e){o.call(this,e)};return angular.extend(l.prototype,o.prototype),l}]),esgAngularDependencies.push("Gadget.ESGUlintValueSlider"),angular.module("Gadget.ESGUlintValueSlider",[]).factory("ESGulintValueSlider",["$log","ESGXmlHelper","WebpanelGadget","EsgColor","ESGVisionConfig","WebpanelData","ESGValueSlider",function(e,t,a,n,i,r,o){var l=function(e){o.call(this,e)};return angular.extend(l.prototype,o.prototype),l}]),esgAngularDependencies.push("Gadget.ESGRealValueSlider"),angular.module("Gadget.ESGRealValueSlider",[]).factory("ESGrealValueSlider",["$log","ESGXmlHelper","WebpanelGadget","EsgColor","ESGVisionConfig","WebpanelData","ESGValueSlider",function(e,t,a,n,i,r,o){var l=function(e){o.call(this,e)};return angular.extend(l.prototype,o.prototype),l}]),esgAngularDependencies.push("Gadget.ESGLrealValueSlider"),angular.module("Gadget.ESGLrealValueSlider",[]).factory("ESGlrealValueSlider",["$log","ESGXmlHelper","WebpanelGadget","EsgColor","ESGVisionConfig","WebpanelData","ESGValueSlider",function(e,t,a,n,i,r,o){var l=function(e){o.call(this,e)};return angular.extend(l.prototype,o.prototype),l}]),esgAngularDependencies.push("Gadget.text.ESGStaticText"),angular.module("Gadget.text.ESGStaticText",[]).factory("ESGstaticText",["$log","ESGXmlHelper","WebpanelGadget",function(e,t,a){var n=function(e){this.text=t.getSingleSubElementValueNS(e.node,e.nsResolver("lcd"),"text"),this.getTemplate=function(){return'<esg-static-text gadget="gadget" ratio="ratio"></esg-static-text>'}};return angular.extend(n.prototype,a.prototype),n}]).directive("esgStaticText",["$log","schemaElementStyle",function(e,t){return{transclude:!1,template:'<tr class="webpanel-text-gadget text depth-{{gadget.depth}}" ng-if="gadget.isVisibleFce()"><td>{{gadget.text}}</td><td></td><td></td><td><a class="btn-ico clickable icon collapse" ng-click="$parent.$parent.handleGroupClick($event, false)" ng-if="gadget.hasChilds == true && gadget.expanded == true"><i class="icon-energo icon-energo-hide" ng-class="icoClass"></i></a><a class="btn-ico clickable icon uncollapse" ng-click="$parent.$parent.handleGroupClick($event, true)" ng-if="gadget.hasChilds == true && gadget.expanded == false"><i class="icon-energo icon-energo-show" ng-class="icoClass"></i></a></td></tr>',replace:!0,restrict:"E",scope:{gadget:"=",ratio:"="},link:function(a,e,t,n){return a.handleGroupClick=function(e,t){a.gadget.expanded=t,null!=e&&e.stopPropagation()},["$scope","iElement","iAttrs","contoller",function(e,t,a,n){}]},controller:["$scope",function(e){}]}}]),esgAngularDependencies.push("Gadget.text.ESGAnalogIndicator"),angular.module("Gadget.text.ESGAnalogIndicator",[]).factory("ESGanalogIndicator",["$log","ESGXmlHelper","WebpanelData",function(e,n,i){return function(e){this.varRef=n.getSingleSubElementValueNS(e.node,e.nsResolver("lcd"),"variable");var t=n.getSingleSubElementValueNS(e.node,e.nsResolver("lcd"),"text");this.text=null!=t?t:"";var a=n.getSingleSubElementValueNS(e.node,e.nsResolver("lcd"),"stringFormat");this.formatString=(""!=this.text?this.text:"")+(""!=this.text&&null!=a?" ":"")+(null!=a?a:""),this.evaluators=[{varRef:this.varRef,format:this.formatString}],i.registerGadgetDp(this.varRef),this.getTemplate=function(){return'<esg-analog-indicator gadget="gadget" ratio="ratio"></esg-analog-indicator>'}}}]).directive("esgAnalogIndicator",["$log","schemaElementStyle","WebpanelData",function(e,t,i){return{transclude:!1,template:'<tr class="webpanel-text-gadget analog-indicator depth-{{gadget.depth}}" ng-if="gadget.isVisibleFce()"><td><span class="value">{{$parent.formattedString.value}} <hadle-value-state-elm gadget-value-obj="$parent.gadgetValueObj"></hadle-value-state-elm></span></td><td></td><td></td><td><button esg-i18n="title:Add to graph" class="btn-ico add-to-graph" ng-click="$parent.addToGraph($event)" ng-class="{buttonActive: $parent.isSelected.value == true}"><i class="icon-energo-graph-view icon-energo"></i></button><a class="btn-ico clickable icon collapse" ng-click="$parent.$parent.handleGroupClick(false, $event)" ng-if="gadget.hasChilds == true && gadget.expanded == true"><i class="icon-energo icon-energo-hide" ng-class="icoClass"></i></a><a class="btn-ico clickable icon uncollapse" ng-click="$parent.$parent.handleGroupClick(true, $event)" ng-if="gadget.hasChilds == true && gadget.expanded == false"><i class="icon-energo icon-energo-show" ng-class="icoClass"></i></a></td></tr>',replace:!0,restrict:"E",scope:{gadget:"=",ratio:"="},link:function(n,e,t,a){return n.handleGroupClick=function(e,t){n.gadget.expanded=e,null!=t&&t.stopPropagation()},n.addToGraph=function(e){angular.forEach([n.gadget.varRef],function(e){i.selectVariable(e)}),e.stopPropagation()},n.isSelected={value:!1},n.WebpanelData=i,n.$watch("WebpanelData.selectedVariables",function(){n.highlightGadget()}),n.highlightGadget=function(e){var t=!0,a=!1;angular.forEach([n.gadget.varRef],function(e){0==(-1!=i.selectedVariables.indexOf(e))?t=!1:a=!0}),n.isSelected.value=1==t||1==a},["$scope","iElement","iAttrs","contoller",function(e,t,a,n){}]},controller:["$scope",function(a){a.formattedString={value:a.gadget.formatString};var e=i.panels[i.actualPanelId].gadgetsMap[a.gadget.varRef];null!=e&&(a.gadgetValueObj=e,a.$watch("gadgetValueObj.value",function(e,t){null!=e&&(a.formattedString.value=i.formatValue(e.value,a.gadget.formatString,a.gadgetValueObj.variableDef.type))}))}]}}]),esgAngularDependencies.push("Gadget.text.ESGAnalogSetter"),angular.module("Gadget.text.ESGAnalogSetter",[]).factory("ESGanalogSetter",["$log","ESGXmlHelper","WebpanelData",function(e,n,i){return function(e){this.varRef=n.getSingleSubElementValueNS(e.node,e.nsResolver("lcd"),"variable"),this.min=n.getSingleSubElementValueNS(e.node,e.nsResolver("lcd"),"min"),this.max=n.getSingleSubElementValueNS(e.node,e.nsResolver("lcd"),"max"),this.step=n.getSingleSubElementValueNS(e.node,e.nsResolver("lcd"),"step");var t=n.getSingleSubElementValueNS(e.node,e.nsResolver("lcd"),"text");this.text=null!=t?t:"";var a=n.getSingleSubElementValueNS(e.node,e.nsResolver("lcd"),"stringFormat");this.formatString=(""!=this.text?this.text:"")+(""!=this.text&&null!=a?" ":"")+(null!=a?a:""),i.registerGadgetDp(this.varRef),this.getTemplate=function(){return'<esg-analog-setter gadget="gadget" ratio="ratio"></esg-analog-setter>'}}}]).directive("esgAnalogSetter",["$log","$filter","EsgInitModal","WebpanelData","WebpanelVariable","RcWareVisionAPI",function(e,r,o,l,s,u){return{transclude:!1,template:'<tr class="webpanel-text-gadget analog-setter depth-{{gadget.depth}}" ng-class="{clickable: $parent.userSettingsActive}" ng-click="$parent.openEditor()" ng-if="gadget.isVisibleFce()"><td><span class="value">{{$parent.formattedString.value}} <hadle-value-state-elm gadget-value-obj="$parent.gadgetValueObj"></hadle-value-state-elm></span></td><td></td><td></td><td><button esg-i18n="title:Add to graph" class="btn-ico add-to-graph" ng-click="$parent.addToGraph($event)" ng-class="{buttonActive: $parent.isSelected.value == true}"><i class="icon-energo-graph-view icon-energo"></i></button><a class="btn-ico clickable icon collapse" ng-click="$parent.$parent.handleGroupClick(false, $event)" ng-if="gadget.hasChilds == true && gadget.expanded == true"><i class="icon-energo icon-energo-hide" ng-class="icoClass"></i></a><a class="btn-ico clickable icon uncollapse" ng-click="$parent.$parent.handleGroupClick(true, $event)" ng-if="gadget.hasChilds == true && gadget.expanded == false"><i class="icon-energo icon-energo-show" ng-class="icoClass"></i></a></td></tr>',replace:!0,restrict:"E",scope:{gadget:"=",ratio:"="},link:function(i,e,t,a){return i.handleGroupClick=function(e,t){i.gadget.expanded=e,null!=t&&t.stopPropagation()},i.openEditor=function(){if(0!=i.userSettingsActive){var n=l.panels[l.actualPanelId].gadgetsMap[i.gadget.varRef];o.open({valueRange:{min:{value:i.gadget.min},max:{value:i.gadget.max},step:i.gadget.step},name:i.gadget.text,title:r("i18n")("Analog setter"),value:n.value.value}).success(function(e){console.log(e);var t=new Big(e),a=new s({variableId:i.gadget.varRef,sourceType:l.typeNumToId(parseInt(n.variableDef.type))});a.setValueFromUserHash({ts:(new Date).getTime(),value:t}),u.SendCommand([{varRef:i.gadget.varRef,value:a.getHexEncodedValue(),gadget:n,newValue:a}])})}},i.addToGraph=function(e){angular.forEach([i.gadget.varRef],function(e){l.selectVariable(e)}),e.stopPropagation()},i.isSelected={value:!1},i.WebpanelData=l,i.$watch("WebpanelData.selectedVariables",function(){i.highlightGadget()}),i.highlightGadget=function(e){var t=!0,a=!1;angular.forEach([i.gadget.varRef],function(e){0==(-1!=l.selectedVariables.indexOf(e))?t=!1:a=!0}),i.isSelected.value=1==t||1==a},["$scope","iElement","iAttrs","contoller",function(e,t,a,n){}]},controller:["$scope",function(a){a.formattedString={value:a.gadget.formatString};var e=l.panels[l.actualPanelId].gadgetsMap[a.gadget.varRef];if(a.userSettingsActive=!1,null!=e){if(a.gadgetValueObj=e,a.userSettingsActive=l.writeVariablePermission(a.gadget.varRef),0==a.gadgetValueObj.variableDef.uId&&0==a.gadgetValueObj.variableDef.offset&&0==a.gadgetValueObj.variableDef.length)var n=!0;a.$watch("gadgetValueObj.value",function(e,t){null!=e&&(a.formattedString.value=l.formatValue(e.value,a.gadget.formatString,1==n?"rtc":a.gadgetValueObj.variableDef.type))})}}]}}]),esgAngularDependencies.push("Gadget.text.ESGTpgEnum"),angular.module("Gadget.text.ESGTpgEnum",[]).factory("ESGtpgEnum",["$log","ESGXmlHelper","WebpanelData","EsgColor",function(e,s,o,u){return function(e){this.panelId=e.panelId,this.tpgType=s.getAttributeNS(e.node,"","stType");var t=s.getSingleSubElementValueNS(e.node,e.nsResolver("lcd"),"text");this.text=null!=t?t:"";var a=s.getSingleSubElementValueNS(e.node,e.nsResolver("lcd"),"stringFormat");this.formatString=(""!=this.text?this.text:"")+(""!=this.text&&null!=a?" ":"")+(null!=a?a:""),this.schedulesVarRef=s.getSingleSubElementValueNS(e.node,e.nsResolver("lcd"),"valueVariable"),this.exceptionsVarRef=s.getSingleSubElementValueNS(e.node,e.nsResolver("lcd"),"exceptionsVariable"),this.defaultVarRef=s.getSingleSubElementValueNS(e.node,e.nsResolver("lcd"),"defaultVariable"),this.outputVariable=s.getSingleSubElementValueNS(e.node,e.nsResolver("lcd"),"outputVariable"),o.registerGadgetDp(this.outputVariable),null==this.exceptionsVarRef&&(this.exceptionsVarRef="");var n=this.outputVariable.replace("varRef://","").split("/"),i=o.connectionDefinition.connections[n[0]].variables[n[1]];null!=i&&0==i.type&&(this.tpgType="t17_bool_scheduler");var l=[new u("#FFFF3333"),new u("#FF66CC00"),new u("#FFFF8000"),new u("#FF80FF00"),new u("#FF00FFFF"),new u("#FFFF4080")];this.tpgStatesDefinition=[],this.tpgStatesMap={};var r=s.getXPathResult(e.node,"lcd:valueStateMappings/lcd:*",e.nsResolver,e.xmlDoc);angular.forEach(r,function(e,t){var a=s.getAttributeNS(e,"","value"),n=s.getAttributeNS(e,"","text"),i=s.getAttributeNS(e,"","color");if(""!=i)var r=new u(i);else r=l[t];if("t17_bool_scheduler"==this.tpgType)var o={value:"1"===a,label:n,color:r.toRGBA()};else o={value:new Big(a),label:n,color:r.toRGBA()};this.tpgStatesDefinition.push(o),this.tpgStatesMap[o.value]=o},this),this.getTemplate=function(){return'<esg-tpg-enum gadget="gadget" ratio="ratio"></esg-tpg-enum>'}}}]).directive("esgTpgEnum",["$log","$filter","$timeout","EsgInitModal","WebpanelData","WebpanelVariable","EsgTpgEditorModal","RcWareVisionAPI","WebpanelActualUser",function(e,t,h,a,f,m,v,x,n){return{transclude:!1,template:'<tr class="webpanel-text-gadget tpg-enum clickable depth-{{gadget.depth}}" ng-click="$parent.openEditor()" ng-if="gadget.isVisibleFce()"><td><span class="value">{{$parent.formattedString.value}} <hadle-value-state-elm gadget-value-obj="$parent.gadgetValueObj"></hadle-value-state-elm></span></td><td>{{textValue}}</td><td></td><td><a class="btn-ico clickable icon collapse" ng-click="$parent.$parent.handleGroupClick(false, $event)" ng-if="gadget.hasChilds == true && gadget.expanded == true"><i class="icon-energo icon-energo-select" ng-class="icoClass"></i></a><a class="btn-ico clickable icon uncollapse" ng-click="$parent.$parent.handleGroupClick(true, $event)" ng-if="gadget.hasChilds == true && gadget.expanded == false"><i class="icon-energo icon-energo-select" ng-class="icoClass"></i></a></td></tr>',replace:!0,restrict:"E",scope:{gadget:"=",ratio:"="},link:function(g,e,t,a){return g.handleGroupClick=function(e,t){g.gadget.expanded=e,null!=t&&t.stopPropagation()},g.openEditor=function(){"t17_bool_scheduler"==g.gadget.tpgType?g.openBoolEditor():g.openIntEditor()},g.actionActive=!1,g.openBoolEditor=function(){if(0==g.actionActive){g.actionActive=!0;try{var e=[],n=!1,t=g.gadget.defaultVarRef.replace("varRef://","").split("/"),a=f.connectionDefinition.connections[t[0]].variables[t[1]],i={connection:a.connection,name:a.name,offset:a.offset,length:a.length,type:a.type,uId:a.uId};e.push({variableDef:i});var r=g.gadget.schedulesVarRef.replace("varRef://","").split("/"),l={connection:(l=f.connectionDefinition.connections[r[0]].variables[r[1]]).connection,name:l.name,offset:l.offset,length:l.length,type:l.type,uId:l.uId};e.push({variableDef:l});var s=g.gadget.exceptionsVarRef.replace("varRef://","").split("/");if(null!=f.connectionDefinition.connections[s[0]]){n=!0;var u=f.connectionDefinition.connections[s[0]].variables[s[1]],o={connection:u.connection,name:u.name,offset:u.offset,length:u.length,type:u.type,uId:u.uId};e.push({variableDef:o})}}catch(e){return void(g.actionActive=!1)}var c=g.gadget,d=0,p=function(){x.GetTpgValue(e).success(function(e){g.actionActive=!1,function(e){var t=new m({variableId:c.defaultVarRef,sourceType:f.typeNumToId(parseInt(i.type))});t.setValueFromPlcHash({ts:e[0].t,value:e[0].v});var r=new m({variableId:c.schedulesVarRef,sourceType:"t17_boolean_scheduler.TpgValue"});r.setValueFromPlcHash({ts:e[1].t,value:e[1].v});var o=new m({variableId:c.schedulesVarRef,sourceType:"t17_boolean_scheduler.Exceptions"});null!=f.connectionDefinition.connections[s[0]]&&o.setValueFromPlcHash({ts:e[2].t,value:e[2].v});var a=f.writeVariablePermission(c.schedulesVarRef);v.open({items:r.value,exceptions:o.value,defaultValue:t.value,tpgType:"Bool",states:c.tpgStatesDefinition,tpgExceptionEnabled:n,userSettingsActive:a}).success(function(e){var t=f.prepareTpgValue("t17_boolean_scheduler",e.regular,e.exception);r.setValueFromUserHash({ts:(new Date).getTime(),value:t.regular});var a=r.getHexEncodedValue();o.setValueFromUserHash({ts:(new Date).getTime(),value:t.exceptions});var n=o.getHexEncodedValue(),i={variableDef:{uId:l.uId,offset:l.offset,length:l.length,connection:{name:l.connection.name}}};x.SendCommand([{varRef:"",value:a,gadget:i}]).success(function(){if(""!=c.exceptionsVarRef){var e={variableDef:{uId:u.uId,offset:u.offset,length:u.length,connection:{name:u.connection.name}}};h(function(){x.SendCommand([{varRef:"",value:n,gadget:e}])},300)}})})}(e)}).error(function(){++d<5?h(p,500):g.actionActive=!1})};p()}},g.openIntEditor=function(){var e=[],n=!1,t=g.gadget.defaultVarRef.replace("varRef://","").split("/"),a=f.connectionDefinition.connections[t[0]].variables[t[1]],i={connection:a.connection,name:a.name,offset:a.offset,length:a.length,type:a.type,uId:a.uId};e.push({variableDef:i});var r=g.gadget.schedulesVarRef.replace("varRef://","").split("/"),l={connection:(l=f.connectionDefinition.connections[r[0]].variables[r[1]]).connection,name:l.name,offset:l.offset,length:l.length,type:l.type,uId:l.uId};e.push({variableDef:l});var s=g.gadget.exceptionsVarRef.replace("varRef://","").split("/");if(null!=f.connectionDefinition.connections[s[0]]){n=!0;var u=f.connectionDefinition.connections[s[0]].variables[s[1]],o={connection:u.connection,name:u.name,offset:u.offset,length:u.length,type:u.type,uId:u.uId};e.push({variableDef:o})}var c=g.gadget,d=0,p=function(){x.GetTpgValue(e).success(function(e){!function(e){var t=new m({variableId:c.defaultVarRef,sourceType:f.typeNumToId(parseInt(i.type))});t.setValueFromPlcHash({ts:e[0].t,value:e[0].v});var r=new m({variableId:c.schedulesVarRef,sourceType:"t19_int_scheduler.TpgValue"});r.setValueFromPlcHash({ts:e[1].t,value:e[1].v});var o=new m({variableId:c.schedulesVarRef,sourceType:"t19_int_scheduler.Exceptions"});null!=f.connectionDefinition.connections[s[0]]&&o.setValueFromPlcHash({ts:e[2].t,value:e[2].v});var a=f.writeVariablePermission(c.schedulesVarRef);v.open({items:r.value,exceptions:o.value,defaultValue:t.value,tpgType:"Int",states:c.tpgStatesDefinition,tpgExceptionEnabled:n,userSettingsActive:a}).success(function(e){var t=f.prepareTpgValue("t19_int_scheduler",e.regular,e.exception);r.setValueFromUserHash({ts:(new Date).getTime(),value:t.regular});var a=r.getHexEncodedValue();o.setValueFromUserHash({ts:(new Date).getTime(),value:t.exceptions});var n=o.getHexEncodedValue(),i={variableDef:{uId:l.uId,offset:l.offset,length:l.length,connection:{name:l.connection.name}}};x.SendCommand([{varRef:"",value:a,gadget:i}]).success(function(){if(""!=c.exceptionsVarRef){var e={variableDef:{uId:u.uId,offset:u.offset,length:u.length,connection:{name:u.connection.name}}};h(function(){x.SendCommand([{varRef:"",value:n,gadget:e}])},300)}})})}(e)}).error(function(){++d<5&&h(p,500)})};p()},["$scope","iElement","iAttrs","contoller",function(e,t,a,n){}]},controller:["$scope",function(n){n.formattedString={value:n.gadget.formatString};var e=f.panels[f.actualPanelId].gadgetsMap[n.gadget.outputVariable];null!=e&&(n.gadgetValueObj=e,n.$watch("gadgetValueObj.value",function(e,t){if(null!=e){var a=n.gadget.tpgStatesMap[e.value];n.formattedString.value=null!=a?f.formatValue(a.label,n.gadget.formatString,19):n.gadget.formatString}}))}]}}]),esgAngularDependencies.push("Gadget.text.ESGTpgReal"),angular.module("Gadget.text.ESGTpgReal",[]).factory("ESGtpgReal",["$log","ESGXmlHelper","WebpanelData","EsgColor",function(e,o,l,t){return function(e){this.panelId=e.panelId,this.tpgType=o.getAttributeNS(e.node,"","stType");var t=o.getSingleSubElementValueNS(e.node,e.nsResolver("lcd"),"text");this.text=null!=t?t:"";var a=o.getSingleSubElementValueNS(e.node,e.nsResolver("lcd"),"stringFormat");this.formatString=(""!=this.text?this.text:"")+(""!=this.text&&null!=a?" ":"")+(null!=a?a:""),this.schedulesVarRef=o.getSingleSubElementValueNS(e.node,e.nsResolver("lcd"),"valueVariable"),this.exceptionsVarRef=o.getSingleSubElementValueNS(e.node,e.nsResolver("lcd"),"exceptionsVariable"),this.defaultVarRef=o.getSingleSubElementValueNS(e.node,e.nsResolver("lcd"),"defaultVariable"),this.outputVariable=o.getSingleSubElementValueNS(e.node,e.nsResolver("lcd"),"outputVariable"),l.registerGadgetDp(this.outputVariable),null==this.exceptionsVarRef&&(this.exceptionsVarRef="");var n=o.getSingleSubElementValueNS(e.node,e.nsResolver("lcd"),"min"),i=o.getSingleSubElementValueNS(e.node,e.nsResolver("lcd"),"max"),r=o.getSingleSubElementValueNS(e.node,e.nsResolver("lcd"),"step");this.tpgSettings={},this.tpgSettings.min=new Big(parseFloat(n)),this.tpgSettings.max=new Big(parseFloat(i)),this.tpgSettings.step=new Big(parseFloat(r)),this.getTemplate=function(){return'<esg-tpg-real gadget="gadget" ratio="ratio"></esg-tpg-real>'}}}]).directive("esgTpgReal",["$log","$filter","$timeout","EsgInitModal","WebpanelData","WebpanelVariable","EsgTpgEditorModal","RcWareVisionAPI","WebpanelActualUser",function(e,t,h,a,f,m,v,x,n){return{transclude:!1,template:'<tr class="webpanel-text-gadget tpg-real clickable depth-{{gadget.depth}}" ng-click="$parent.openEditor()" ng-if="gadget.isVisibleFce()"><td><span class="value">{{$parent.formattedString.value}} <hadle-value-state-elm gadget-value-obj="$parent.gadgetValueObj"></hadle-value-state-elm></span></td><td>{{textValue}}</td><td></td><td><a class="btn-ico clickable icon collapse" ng-click="$parent.$parent.handleGroupClick(false, $event)" ng-if="gadget.hasChilds == true && gadget.expanded == true"><i class="icon-energo icon-energo-select" ng-class="icoClass"></i></a><a class="btn-ico clickable icon uncollapse" ng-click="$parent.$parent.handleGroupClick(true, $event)" ng-if="gadget.hasChilds == true && gadget.expanded == false"><i class="icon-energo icon-energo-select" ng-class="icoClass"></i></a></td></tr>',replace:!0,restrict:"E",scope:{gadget:"=",ratio:"="},link:function(g,e,t,a){return g.handleGroupClick=function(e,t){g.gadget.expanded=e,null!=t&&t.stopPropagation()},g.actionActive=!1,g.openEditor=function(){if(0==g.actionActive){g.actionActive=!0;try{var e=[],n=!1,t=g.gadget.defaultVarRef.replace("varRef://","").split("/"),a=f.connectionDefinition.connections[t[0]].variables[t[1]],i={connection:a.connection,name:a.name,offset:a.offset,length:a.length,type:a.type,uId:a.uId};e.push({variableDef:i});var r=g.gadget.schedulesVarRef.replace("varRef://","").split("/"),l={connection:(l=f.connectionDefinition.connections[r[0]].variables[r[1]]).connection,name:l.name,offset:l.offset,length:l.length,type:l.type,uId:l.uId};e.push({variableDef:l});var s=g.gadget.exceptionsVarRef.replace("varRef://","").split("/");if(null!=f.connectionDefinition.connections[s[0]]){n=!0;var u=f.connectionDefinition.connections[s[0]].variables[s[1]],o={connection:u.connection,name:u.name,offset:u.offset,length:u.length,type:u.type,uId:u.uId};e.push({variableDef:o})}}catch(e){return void(g.actionActive=!1)}var c=g.gadget,d=0,p=function(){x.GetTpgValue(e).success(function(e){g.actionActive=!1,function(e){var t=new m({variableId:c.defaultVarRef,sourceType:f.typeNumToId(parseInt(i.type))});t.setValueFromPlcHash({ts:e[0].t,value:e[0].v});var r=new m({variableId:c.schedulesVarRef,sourceType:"t18_real_scheduler.TpgValue"});r.setValueFromPlcHash({ts:e[1].t,value:e[1].v});var o=new m({variableId:c.schedulesVarRef,sourceType:"t18_real_scheduler.Exceptions"});null!=f.connectionDefinition.connections[s[0]]&&null!=e[2]&&o.setValueFromPlcHash({ts:e[2].t,value:e[2].v});var a=f.writeVariablePermission(c.schedulesVarRef);v.open({items:r.value,exceptions:o.value,defaultValue:new Big(t.value.toFixed(6)),tpgType:"Double",states:c.tpgStatesDefinition,tpgSettings:c.tpgSettings,tpgExceptionEnabled:n,userSettingsActive:a}).success(function(e){var t=f.prepareTpgValue("t18_real_scheduler",e.regular,e.exception);r.setValueFromUserHash({ts:(new Date).getTime(),value:t.regular});var a=r.getHexEncodedValue();o.setValueFromUserHash({ts:(new Date).getTime(),value:t.exceptions});var n=o.getHexEncodedValue(),i={variableDef:{uId:l.uId,offset:l.offset,length:l.length,connection:{name:l.connection.name}}};x.SendCommand([{varRef:"",value:a,gadget:i}]).success(function(){if(""!=c.exceptionsVarRef){var e={variableDef:{uId:u.uId,offset:u.offset,length:u.length,connection:{name:u.connection.name}}};h(function(){x.SendCommand([{varRef:"",value:n,gadget:e}])},300)}})})}(e)}).error(function(){++d<5?h(p,500):g.actionActive=!1})};p()}},["$scope","iElement","iAttrs","contoller",function(e,t,a,n){}]},controller:["$scope",function(a){a.formattedString={value:a.gadget.formatString};var e=f.panels[f.actualPanelId].gadgetsMap[a.gadget.outputVariable];null!=e&&(a.gadgetValueObj=e,a.$watch("gadgetValueObj.value",function(e,t){null!=e&&(a.formattedString.value=f.formatValue(e.value,a.gadget.formatString,a.gadgetValueObj.variableDef.type))}))}]}}]),esgAngularDependencies.push("Gadget.text.ESGLogin"),angular.module("Gadget.text.ESGLogin",[]).factory("ESGlogin",["$log","ESGXmlHelper","WebpanelGadget",function(e,a,t){var n=function(e){this.text=a.getSingleSubElementValueNS(e.node,e.nsResolver("lcd"),"text"),this.pin=a.getSingleSubElementValueNS(e.node,e.nsResolver("lcd"),"pin");var t=a.getSingleSubElementValueNS(e.node,e.nsResolver("lcd"),"timeout");this.timeout=parseInt(t),this.unlocked=!1,this.getTemplate=function(){return'<esg-login gadget="gadget" ratio="ratio"></esg-login>'}};return angular.extend(n.prototype,t.prototype),n}]).directive("esgLogin",["$log","$timeout","schemaElementStyle","EsgInsertPin",function(e,a,t,n){return{transclude:!1,template:'<tr class="webpanel-text-gadget login depth-{{gadget.depth}}" ng-class="{clickable: gadget.unlocked == false}" ng-if="gadget.isVisibleFce()" ng-click="$parent.handleLoginClick()"><td>{{gadget.text}}</td><td></td><td><div class="clickable" ng-show="gadget.unlocked == false" ng-click="$parent.tryLogin($event)" esg-i18n="Unlock"></div><div class="clickable" ng-show="gadget.unlocked == true" ng-click="$parent.lock($event)" esg-i18n="Lock"></div></td><td><a class="btn-ico clickable icon collapse locked" ng-if="gadget.unlocked == false"><i class="icon-energo icon-energo-show" ng-class="icoClass"></i></a><a class="btn-ico clickable icon collapse" ng-click="$parent.$parent.handleGroupClick(false, $event)" ng-if="gadget.hasChilds == true && gadget.expanded == true && gadget.unlocked == true"><i class="icon-energo icon-energo-hide" ng-class="icoClass"></i></a><a class="btn-ico clickable icon uncollapse" ng-click="$parent.$parent.handleGroupClick(true, $event)" ng-if="gadget.hasChilds == true && gadget.expanded == false && gadget.unlocked == true"><i class="icon-energo icon-energo-show" ng-class="icoClass"></i></a></td></tr>',replace:!0,restrict:"E",scope:{gadget:"=",ratio:"="},link:function(a,e,t,n){return a.handleGroupClick=function(e,t){a.gadget.expanded=e,null!=t&&t.stopPropagation()},["$scope","iElement","iAttrs","contoller",function(e,t,a,n){}]},controller:["$scope",function(t){t.handleLoginClick=function(){0==t.gadget.unlocked&&t.tryLogin()},t.tryLogin=function(e){n.open({pin:t.gadget.pin,text:t.gadget.text}).success(function(){t.gadget.unlocked=!0,a(function(){t.gadget.unlocked=!1},60*t.gadget.timeout*1e3)}),null!=e&&e.stopPropagation()},t.lock=function(e){t.gadget.unlocked=!1,null!=e&&e.stopPropagation()}}]}}]).factory("EsgInsertPin",["$log","$timeout","$filter","$rootScope","ESGPromise","EsgModalWindow",function(e,t,i,r,o,l){var a={open:function(t){var n=o.defer(),e=n.promise,a={backdrop:!0,keyboard:!1,backdropClick:!1,templateUrl:"html/desktop/modalWindow/modalWindow.login.html",windowClass:"insertPinModalWindow",controller:["$scope","$modalInstance",function(a,e){a.text=t.text,a.pass={value:""},a.message={value:""},r.$on("RcWareKeyDown",function(e,t){switch(t.keyCode){case 13:a.confirm(),r.$root.$$phase||a.$digest()}}),a.$watch("pass.value",function(){a.message.value=""}),a.confirm=function(){a.pass.value==t.pin?(n.resolve(!0),e.close("close")):a.message.value=i("i18n")("Wrong PIN")},a.close=function(){n.reject(!1),e.close("close")}}]};return l.open(a).success(function(){}).error(function(){}),e}};return a}]),esgAngularDependencies.push("Gadget.text.ESGDigitalIndicator"),angular.module("Gadget.text.ESGDigitalIndicator",[]).factory("ESGdigitalIndicator",["$log","ESGXmlHelper","WebpanelData",function(e,o,l){return function(e){this.varRef=o.getSingleSubElementValueNS(e.node,e.nsResolver("lcd"),"variable");var t=o.getSingleSubElementValueNS(e.node,e.nsResolver("lcd"),"text");this.text=null!=t?t:"";var a=o.getSingleSubElementValueNS(e.node,e.nsResolver("lcd"),"stringFormat");this.formatString=(""!=this.text?this.text:"")+(""!=this.text&&null!=a?" ":"")+(null!=a?a:""),l.registerGadgetDp(this.varRef);var n=this.varRef.replace("varRef://","").split("/"),r=l.connectionDefinition.connections[n[0]].variables[n[1]];this.statesDefinition=[],this.statesMap={};var i=o.getXPathResult(e.node,"lcd:valueStateMappings/lcd:*",e.nsResolver,e.xmlDoc);angular.forEach(i,function(e,t){var a=o.getAttributeNS(e,"","value"),n=o.getAttributeNS(e,"","text");if(0==r.type)var i={value:"1"===a,label:n};else i={value:new Big(a),label:n};this.statesDefinition.push(i),this.statesMap[i.value]=i},this),this.getTemplate=function(){return'<esg-digital-indicator gadget="gadget" ratio="ratio"></esg-digital-indicator>'}}}]).directive("esgDigitalIndicator",["$log","schemaElementStyle","WebpanelData",function(e,t,i){return{transclude:!1,template:'<tr class="webpanel-text-gadget digital-indicator depth-{{gadget.depth}}" ng-if="gadget.isVisibleFce()"><td><span class="value">{{$parent.formattedString.value}} <hadle-value-state-elm gadget-value-obj="$parent.gadgetValueObj"></hadle-value-state-elm></span></td><td></td><td></td><td><button esg-i18n="title:Add to graph" class="btn-ico add-to-graph" ng-click="$parent.addToGraph($event)" ng-class="{buttonActive: $parent.isSelected.value == true}"><i class="icon-energo-graph-view icon-energo"></i></button><a class="btn-ico clickable icon collapse" ng-click="$parent.$parent.handleGroupClick(false, $event)" ng-if="gadget.hasChilds == true && gadget.expanded == true"><i class="icon-energo icon-energo-hide" ng-class="icoClass"></i></a><a class="btn-ico clickable icon uncollapse" ng-click="$parent.$parent.handleGroupClick(true, $event)" ng-if="gadget.hasChilds == true && gadget.expanded == false"><i class="icon-energo icon-energo-show" ng-class="icoClass"></i></a></td></tr>',replace:!0,restrict:"E",scope:{gadget:"=",ratio:"="},link:function(n,e,t,a){return n.handleGroupClick=function(e,t){n.gadget.expanded=e,null!=t&&t.stopPropagation()},n.addToGraph=function(e){angular.forEach([n.gadget.varRef],function(e){i.selectVariable(e)}),e.stopPropagation()},n.isSelected={value:!1},n.WebpanelData=i,n.$watch("WebpanelData.selectedVariables",function(){n.highlightGadget()}),n.highlightGadget=function(e){var t=!0,a=!1;angular.forEach([n.gadget.varRef],function(e){0==(-1!=i.selectedVariables.indexOf(e))?t=!1:a=!0}),n.isSelected.value=1==t||1==a},["$scope","iElement","iAttrs","contoller",function(e,t,a,n){}]},controller:["$scope",function(n){n.formattedString={value:n.gadget.formatString};var e=i.panels[i.actualPanelId].gadgetsMap[n.gadget.varRef];null!=e&&(n.gadgetValueObj=e,n.$watch("gadgetValueObj.value",function(e,t){if(null!=e){var a=n.gadget.statesMap[e.value];n.formattedString.value=null!=a?i.formatValue(a.label,n.gadget.formatString,19):n.gadget.formatString}}))}]}}]),esgAngularDependencies.push("Gadget.text.ESGDigitalSetter"),angular.module("Gadget.text.ESGDigitalSetter",[]).factory("ESGdigitalSetter",["$log","ESGXmlHelper","WebpanelData",function(e,o,l){return function(e){this.varRef=o.getSingleSubElementValueNS(e.node,e.nsResolver("lcd"),"variable");var t=o.getSingleSubElementValueNS(e.node,e.nsResolver("lcd"),"text");this.text=null!=t?t:"";var a=o.getSingleSubElementValueNS(e.node,e.nsResolver("lcd"),"stringFormat");this.formatString=(""!=this.text?this.text:"")+(""!=this.text&&null!=a?" ":"")+(null!=a?a:""),l.registerGadgetDp(this.varRef);var n=this.varRef.replace("varRef://","").split("/"),r=l.connectionDefinition.connections[n[0]].variables[n[1]];this.statesDefinition=[],this.statesMap={};var i=o.getXPathResult(e.node,"lcd:valueStateMappings/lcd:*",e.nsResolver,e.xmlDoc);angular.forEach(i,function(e,t){var a=o.getAttributeNS(e,"","value"),n=o.getAttributeNS(e,"","text");if(0==r.type)var i={value:"1"===a,label:n};else i={value:new Big(a),label:n};this.statesDefinition.push(i),this.statesMap[i.value]=i},this),this.getTemplate=function(){return'<esg-digital-setter gadget="gadget" ratio="ratio"></esg-digital-setter>'}}}]).directive("esgDigitalSetter",["$log","$filter","EsgDigitalSetterModal","WebpanelData","WebpanelVariable","RcWareVisionAPI",function(e,i,r,o,l,s){return{transclude:!1,template:'<tr class="webpanel-text-gadget digital-setter depth-{{gadget.depth}}" ng-class="{clickable: $parent.userSettingsActive}" ng-click="$parent.openEditor()" ng-if="gadget.isVisibleFce()"><td><span class="value">{{$parent.formattedString.value}} <hadle-value-state-elm gadget-value-obj="$parent.gadgetValueObj"></hadle-value-state-elm></span></td><td></td><td></td><td><button esg-i18n="title:Add to graph" class="btn-ico add-to-graph" ng-click="$parent.addToGraph($event)" ng-class="{buttonActive: $parent.isSelected.value == true}"><i class="icon-energo-graph-view icon-energo"></i></button><a class="btn-ico clickable icon collapse" ng-click="$parent.$parent.handleGroupClick(false, $event)" ng-if="gadget.hasChilds == true && gadget.expanded == true"><i class="icon-energo icon-energo-hide" ng-class="icoClass"></i></a><a class="btn-ico clickable icon uncollapse" ng-click="$parent.$parent.handleGroupClick(true, $event)" ng-if="gadget.hasChilds == true && gadget.expanded == false"><i class="icon-energo icon-energo-show" ng-class="icoClass"></i></a></td></tr>',replace:!0,restrict:"E",scope:{gadget:"=",ratio:"="},link:function(n,e,t,a){return n.handleGroupClick=function(e,t){n.gadget.expanded=e,null!=t&&t.stopPropagation()},n.openEditor=function(){if(0!=n.userSettingsActive){var a=o.panels[o.actualPanelId].gadgetsMap[n.gadget.varRef],e="";if(null!=n.gadgetValueObj.value){var t=n.gadget.statesMap[n.gadgetValueObj.value.value];e=null!=t?o.formatValue(t.label,n.gadget.formatString,19):n.gadget.formatString}r.open({statesDefinition:n.gadget.statesDefinition,name:n.gadget.text,title:i("i18n")("Digital setter"),value:e,actualState:t}).success(function(e){var t=new l({variableId:n.gadget.varRef,sourceType:o.typeNumToId(parseInt(a.variableDef.type))});t.setValueFromUserHash({ts:(new Date).getTime(),value:e.value}),s.SendCommand([{varRef:n.gadget.varRef,value:t.getHexEncodedValue(),gadget:a,newValue:t}])})}},n.addToGraph=function(e){angular.forEach([n.gadget.varRef],function(e){o.selectVariable(e)}),e.stopPropagation()},n.isSelected={value:!1},n.WebpanelData=o,n.$watch("WebpanelData.selectedVariables",function(){n.highlightGadget()}),n.highlightGadget=function(e){var t=!0,a=!1;angular.forEach([n.gadget.varRef],function(e){0==(-1!=o.selectedVariables.indexOf(e))?t=!1:a=!0}),n.isSelected.value=1==t||1==a},["$scope","iElement","iAttrs","contoller",function(e,t,a,n){}]},controller:["$scope",function(n){n.formattedString={value:n.gadget.formatString};var e=o.panels[o.actualPanelId].gadgetsMap[n.gadget.varRef];n.userSettingsActive=!1,null!=e&&(n.gadgetValueObj=e,n.userSettingsActive=o.writeVariablePermission(n.gadget.varRef),n.$watch("gadgetValueObj.value",function(e,t){if(null!=e){var a=n.gadget.statesMap[e.value];n.formattedString.value=null!=a?o.formatValue(a.label,n.gadget.formatString,19):n.gadget.formatString}}))}]}}]),esgAngularDependencies.push("Gadget.text.ESGDateTime"),angular.module("Gadget.text.ESGDateTime",[]).factory("ESGdateTime",["$log","ESGXmlHelper","WebpanelData",function(e,t,a){return function(e){this.varRef=t.getSingleSubElementValueNS(e.node,e.nsResolver("lcd"),"connectionReference"),this.editable="true"==t.getSingleSubElementValueNS(e.node,e.nsResolver("lcd"),"editable"),this.formatString="%d/%m/%Y %H:%M",a.registerGadgetDp(this.varRef),this.getTemplate=function(){return'<esg-date-time gadget="gadget" ratio="ratio"></esg-date-time>'}}}]).directive("esgDateTime",["$log","schemaElementStyle","WebpanelData","EsgDateTimeEditModal","WebpanelVariable","RcWareVisionAPI",function(e,t,r,o,l,s){return{transclude:!1,template:'<tr class="webpanel-text-gadget date-time depth-{{gadget.depth}}" ng-class="{clickable: gadget.editable && $parent.userSettingsActive}"  ng-click="$parent.openEditor()" ng-if="gadget.isVisibleFce()"><td><span class="value">{{$parent.formattedString.value}} <hadle-value-state-elm gadget-value-obj="$parent.gadgetValueObj"></hadle-value-state-elm></span></td><td></td><td></td><td><a class="btn-ico clickable icon collapse" ng-click="$parent.$parent.handleGroupClick(false, $event)" ng-if="gadget.hasChilds == true && gadget.expanded == true"><i class="icon-energo icon-energo-hide" ng-class="icoClass"></i></a><a class="btn-ico clickable icon uncollapse" ng-click="$parent.$parent.handleGroupClick(true, $event)" ng-if="gadget.hasChilds == true && gadget.expanded == false"><i class="icon-energo icon-energo-show" ng-class="icoClass"></i></a></td></tr>',replace:!0,restrict:"E",scope:{gadget:"=",ratio:"="},link:function(a,e,t,n){return a.handleGroupClick=function(e,t){a.gadget.expanded=e,null!=t&&t.stopPropagation()},a.openEditor=function(){if(a.gadget.editable){if(0==a.userSettingsActive)return;var n=r.panels[r.actualPanelId].gadgetsMap[a.gadget.varRef],i=a.gadget;o.open({gadgetValueObj:n}).success(function(e){if(0==n.variableDef.uId&&0==n.variableDef.offset&&0==n.variableDef.length){var t=new Big(e.getTime()).times(1e4).plus("621355968000000000").toFixed(0);s.SetRtc(parseInt(t))}else{var a=new l({variableId:i.varRef,sourceType:r.typeNumToId(parseInt(n.variableDef.type))});a.setValueFromUserHash({ts:(new Date).getTime(),value:e}),s.SendCommand([{varRef:i.varRef,value:a.getHexEncodedValue(),gadget:n,newValue:a}])}})}},["$scope","iElement","iAttrs","contoller",function(e,t,a,n){}]},controller:["$scope",function(a){a.formattedString={value:a.gadget.formatString};var e=r.panels[r.actualPanelId].gadgetsMap[a.gadget.varRef];if(a.userSettingsActive=!1,null!=e){if(a.gadgetValueObj=e,a.userSettingsActive=r.writeVariablePermission(a.gadget.varRef),0==a.gadgetValueObj.variableDef.uId&&0==a.gadgetValueObj.variableDef.offset&&0==a.gadgetValueObj.variableDef.length)var n=!0;a.$watch("gadgetValueObj.value",function(e,t){null!=e&&(a.formattedString.value=r.formatValue(e.value,a.gadget.formatString,1==n?"rtc":a.gadgetValueObj.variableDef.type))})}}]}}]),esgAngularDependencies.push("Gadget.text.ESGAlarmStatus"),angular.module("Gadget.text.ESGAlarmStatus",[]).factory("ESGalarmStatus",["$log","ESGXmlHelper","WebpanelData",function(e,n,i){return function(e){var t=n.getSingleSubElementValueNS(e.node,e.nsResolver("lcd"),"text");this.text=null!=t?t:"";var a=n.getSingleSubElementValueNS(e.node,e.nsResolver("lcd"),"stringFormat");this.formatString=(""!=this.text?this.text:"")+(""!=this.text&&null!=a?" ":"")+(null!=a?a:""),this.activeAlarmText=n.getSingleSubElementValueNS(e.node,e.nsResolver("lcd"),"activeAlarmText"),this.alarmMemoryText=n.getSingleSubElementValueNS(e.node,e.nsResolver("lcd"),"alarmMemoryText"),this.alarmAcknowledgedText=n.getSingleSubElementValueNS(e.node,e.nsResolver("lcd"),"alarmAcknowledgedText"),this.actionAlarmAcknowledge=n.getSingleSubElementValueNS(e.node,e.nsResolver("lcd"),"actionAlarmAcknowledge"),this.actionAlarmMemoryReset=n.getSingleSubElementValueNS(e.node,e.nsResolver("lcd"),"actionAlarmMemoryReset"),this.acknowledgeVariable=n.getSingleSubElementValueNS(e.node,e.nsResolver("lcd"),"acknowledgeVariable"),this.resetVariable=n.getSingleSubElementValueNS(e.node,e.nsResolver("lcd"),"resetVariable"),this.alarmStatusVariable=n.getSingleSubElementValueNS(e.node,e.nsResolver("lcd"),"alarmStatusVariable"),i.registerGadgetDp(this.acknowledgeVariable),i.registerGadgetDp(this.resetVariable),i.registerGadgetDp(this.alarmStatusVariable),this.getTemplate=function(){return'<esg-alarm-status gadget="gadget" ratio="ratio"></esg-alarm-status>'}}}]).directive("esgAlarmStatus",["$log","schemaElementStyle","WebpanelData","RcWareVisionAPI","EsgConfirmAction","WebpanelVariable","ESGPromise",function(e,t,l,s,n,u,i){return{transclude:!1,template:'<tr class="webpanel-text-gadget alarm-status depth-{{gadget.depth}}" ng-class="$parent.isClickableClass()" ng-click="$parent.onClick()" ng-if="gadget.isVisibleFce()"><td><span class="value">{{$parent.formattedString.value}}<hadle-value-state-elm gadget-value-obj="$parent.gadgetValueObj"></hadle-value-state-elm></span></td><td></td><td></td><td><button esg-i18n="title:Add to graph" class="btn-ico add-to-graph" ng-click="$parent.addToGraph($event)" ng-class="{buttonActive: $parent.isSelected.value == true}"><i class="icon-energo-graph-view icon-energo"></i></button><a class="btn-ico clickable icon collapse" ng-click="$parent.$parent.handleGroupClick(false, $event)" ng-if="gadget.hasChilds == true && gadget.expanded == true"><i class="icon-energo icon-energo-hide" ng-class="icoClass"></i></a><a class="btn-ico clickable icon uncollapse" ng-click="$parent.$parent.handleGroupClick(true, $event)" ng-if="gadget.hasChilds == true && gadget.expanded == false"><i class="icon-energo icon-energo-show" ng-class="icoClass"></i></a></td></tr>',replace:!0,restrict:"E",scope:{gadget:"=",ratio:"="},link:function(o,e,t,a){return o.handleGroupClick=function(e,t){o.gadget.expanded=e,null!=t&&t.stopPropagation()},o.isClickableClass=function(){if(null!=o.gadgetValueObj.value)switch(o.gadgetValueObj.value.value.toString()){case"1280":case"1024":case"1536":return"clickable"}return""},o.onClick=function(){if(null!=o.gadgetValueObj.value)switch(o.gadgetValueObj.value.value.toString()){case"1280":o.setAction(o.gadget.acknowledgeVariable,!0,"Opravdu chcete potvrdit alarm?");break;case"1024":case"1536":o.setAction(o.gadget.resetVariable,!0,"Opravdu chcete smazat alarm?")}},o.setAction=function(e,t,a){var n=l.panels[l.actualPanelId].gadgetsMap[e];if(null!=t){var i=t,r=new u({variableId:e,sourceType:l.typeNumToId(parseInt(n.variableDef.type))});r.setValueFromUserHash({ts:(new Date).getTime(),value:i});e=e;o.confirmAction(a).success(function(){s.SendCommand([{varRef:e,value:r.getHexEncodedValue(),gadget:n,newValue:r}])})}},o.confirmAction=function(e){var t=i.defer(),a=t.promise;return""!=e?n.open(e).success(function(e){e?t.resolve():t.reject()}):t.resolve(),a},o.addToGraph=function(e){angular.forEach([o.gadget.acknowledgeVariable,o.gadget.resetVariable,o.gadget.alarmStatusVariable],function(e){l.selectVariable(e)}),e.stopPropagation()},o.isSelected={value:!1},o.WebpanelData=l,o.$watch("WebpanelData.selectedVariables",function(){o.highlightGadget()}),o.highlightGadget=function(e){var t=!0,a=!1;angular.forEach([o.gadget.acknowledgeVariable,o.gadget.resetVariable,o.gadget.alarmStatusVariable],function(e){0==(-1!=l.selectedVariables.indexOf(e))?t=!1:a=!0}),o.isSelected.value=1==t||1==a},["$scope","iElement","iAttrs","contoller",function(e,t,a,n){}]},controller:["$scope",function(a){a.formattedString={value:a.gadget.formatString};var e=l.panels[l.actualPanelId].gadgetsMap[a.gadget.alarmStatusVariable];null!=e&&(a.gadgetValueObj=e,a.$watch("gadgetValueObj.value",function(e,t){if(null!=e)switch(a.formattedString.value=a.gadget.formatString,e.value.toString()){case"0":case"1":a.formattedString.value+="OK";break;case"1280":a.formattedString.value+=a.gadget.activeAlarmText;break;case"1792":a.formattedString.value+=a.gadget.alarmAcknowledgedText;break;case"1024":a.formattedString.value+=a.gadget.alarmMemoryText;break;case"1536":a.formattedString.value+="MemoryAcknowledged"}}))}]}}]),esgAngularDependencies.push("RcWareVisionColor"),angular.module("RcWareVisionColor",[]).factory("EsgColor",["$log",function(e){var t=function(e){if(null==e)return null;var t=e.match(/^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?/i);t?(this.a=parseInt(t[4],10),this.r=parseInt(t[1],10),this.g=parseInt(t[2],10),this.b=parseInt(t[3],10)):9==e.length?(this.a=parseInt(e.slice(1,3),16),this.r=parseInt(e.slice(3,5),16),this.g=parseInt(e.slice(5,7),16),this.b=parseInt(e.slice(7,9),16)):(this.a=256,this.r=parseInt(e.slice(1,3),16),this.g=parseInt(e.slice(3,5),16),this.b=parseInt(e.slice(5,7),16)),this.aInt=255&parseInt(this.a,16)};return t.prototype.toRGBA=function(){return"rgba("+this.r+", "+this.g+", "+this.b+", "+this.a+")"},t.prototype.toRGBString=function(){return("#"+("0"==this.r.toString(16)?"00":this.r.toString(16))+("0"==this.g.toString(16)?"00":this.g.toString(16))+("0"==this.b.toString(16)?"00":this.b.toString(16))).toUpperCase()},t.prototype.toARGBString=function(){return("#"+("0"==this.a.toString(16)?"00":this.a.toString(16))+("0"==this.r.toString(16)?"00":this.r.toString(16))+("0"==this.g.toString(16)?"00":this.g.toString(16))+("0"==this.b.toString(16)?"00":this.b.toString(16))).toUpperCase()},t.prototype.brightness=function(){return(299*this.r+587*this.g+114*this.b)/1e3},t.prototype.getHex=function(){function e(e){return e=parseInt(e,10),isNaN(e)?"00":(e=Math.max(0,Math.min(e,255)),"0123456789ABCDEF".charAt((e-e%16)/16)+"0123456789ABCDEF".charAt(e%16))}return"#"+e(this.r)+e(this.g)+e(this.b)},t.prototype.getInverseColor=function(){var e=this.getHex(),t=(e=(e=e.slice(1,e.length)).toUpperCase()).split(""),a="",n="FEDCBA9876".split(""),i=new Array;i.A="5",i.B="4",i.C="3",i.D="2",i.E="1",i.F="0";for(var r=0;r<6;r++)if(isNaN(t[r])){if(!i[t[r]])return alert("Hex colors must only include hex numbers 0-9, and A-F"),!1;a+=i[t[r]]}else a+=n[t[r]];return"#"+a},t}]),angular.module("resizeWindowService",[]).service("ApiWinResize",["$log","$rootScope","$timeout",function(e,t,i){var r={getWidth:function(){return $(window)[0].innerWidth},getHeight:function(){return $(window)[0].innerHeight}};r.size={height:r.getHeight(),width:r.getWidth(),ratioChangeActualDefaultHeight:0,ratio:0,defaultHeight:0,defaultWidth:0},r.fullScreen={pageFullScreen:!1,actualElementFullScreen:!1,listeners:!1};var o=["top","left","bottom","right","width","height","line-height","font-size","padding","margin-left","margin-top","padding-left","padding-right","border-radius"];return angular.element($(window)).bind("resize",function(){t.$root.$$phase?(r.size.height=r.getHeight(),r.size.width=r.getWidth(),r.size.ratio=r.getWidth()/r.getHeight()):t.$apply(function(){r.size.height=r.getHeight(),r.size.width=r.getWidth(),r.size.ratio=r.getWidth()/r.getHeight()})}),r.setDefault=function(e,t){r.size.defaultHeight=e,r.size.defaultWidth=t,r.size.ratioChangeActualDefaultHeight=r.size.height/r.size.defaultHeight,r.size.ratio=r.getWidth()/r.getHeight()},r.countNewSizeRoot=function(e){var t=r.size.height,a=r.size.height*(r.size.defaultWidth/r.size.defaultHeight);return a>r.size.width&&(t=r.size.width/(r.size.defaultWidth/r.size.defaultHeight),a=r.size.width),e.height=t,e.width=a,r.size.ratioChangeActualDefaultHeight=t/r.size.defaultHeight,e},r.recountStyles=function(e,n){var i=/^[0-9]+([,.][0-9]+)?$/;return void 0===n||angular.forEach(e,function(e,t){if(i.test(e)){var a=e*r.size.ratioChangeActualDefaultHeight;a!=n[t]&&(n[t]=a+"px")}}),n},r.registerStyleElements=function(a,e){var n={};return angular.forEach(o,function(e,t){void 0!==a&&void 0!==a[e]&&null!=a[e]&&(n[e]=a[e].toString().replace(/px/g,""))}),n},r.setFullScreen=function(e,t){function a(e,t){for(var a,n,i=["webkit","moz","ms","o",""],r=0;r<i.length&&!e[a];){if(a=t,""==i[r]&&(a=a.substr(0,1).toLowerCase()+a.substr(1)),"undefined"!=(n=typeof e[a=i[r]+a]))return i=[i[r]],"function"==n?e[a]():e[a];r++}}function n(e){i(function(){0==e&&"function"==typeof t&&t(),0==(r.fullScreen.pageFullScreen=e)&&(r.fullScreen.actualElementFullScreen=!1)},0)}0==r.fullScreen.listeners&&(r.fullScreen.listeners=!0,document.addEventListener("fullscreenchange",function(){0==document.fullscreen?n(!1):n(!0)},!1),document.addEventListener("mozfullscreenchange",function(){0==document.mozFullScreen?n(!1):n(!0)},!1),document.addEventListener("webkitfullscreenchange",function(){0==document.webkitIsFullScreen?n(!1):n(!0)},!1),document.addEventListener("MSFullscreenChange",function(){0!=r.fullScreen.pageFullScreen?n(!1):n(!0)},!1)),r.fullScreen.actualElementFullScreen=e,1==r.fullScreen.pageFullScreen?(a(document,"CancelFullScreen"),a(document,"ExitFullscreen")):(a(e,"RequestFullScreen"),void 0!==e.msRequestFullscreen&&e.msRequestFullscreen())},r.setElementFullScreen=function(e,t){void 0!==e&&null!=e||(e=document.documentElement),r.setFullScreen(e,t)},r.getScrollBarWidth=function(){var e=document.createElement("p");e.style.width="100%",e.style.height="200px";var t=document.createElement("div");t.style.position="absolute",t.style.top="0px",t.style.left="0px",t.style.visibility="hidden",t.style.width="200px",t.style.height="150px",t.style.overflow="hidden",t.appendChild(e),document.body.appendChild(t);var a=e.offsetWidth;t.style.overflow="scroll";var n=e.offsetWidth;return a==n&&(n=t.clientWidth),document.body.removeChild(t),a-n},r.isThereScrollBar=function(e){return"vertical"==e?$(document)[0].body.scrollHeight>$(document)[0].body.clientHeight:"horizontal"==e?$(document)[0].body.scrollWidth>$(document)[0].body.clientWidth:null},r}]),esgAngularDependencies.push("Action.Base"),angular.module("Action.Base",[]).factory("WebpanelAction",["$log","ESGXmlHelper","EsgConfirmAction","ESGPromise",function(e,t,a,n){var i=function(e){this.confirmationMessage=t.getAttributeNS(e.node,"","confirmationMessage")};return i.prototype.confirmAction=function(){var t=n.defer(),e=t.promise;return""!=this.confirmationMessage?a.open(this.confirmationMessage).success(function(e){e?t.resolve():t.reject()}):t.resolve(),e},i}]),esgAngularDependencies.push("Actions.lRealDecrementValueAction"),angular.module("Actions.lRealDecrementValueAction",[]).factory("lRealDecrementValueAction",["$log","ESGXmlHelper","WebpanelAction","RcWareVisionAPI","WebpanelData","WebpanelVariable",function(e,n,i,t,r,a){var o=function(e){i.call(this,e),this.event=n.getAttributeNS(e.node,"","event"),this.varRef=n.getAttributeNS(e.node,"","varRef"),r.registerGadgetDp(this.varRef);var t=n.getAttributeNS(e.node,"","step"),a=n.getAttributeNS(e.node,"","minValue");""!=t&&(this.step=parseFloat(t)),""!=a&&(this.minValue=parseFloat(a))};return angular.extend(o.prototype,i.prototype),o.prototype.onLeftDown=function(){var e=r.panels[r.actualPanelId].gadgetsMap[this.varRef],t=r.valueDecrement(this.minValue,this.step,e,this.varRef,a);null!=t&&r.sendValue(this.varRef,t,e,this)},o}]),esgAngularDependencies.push("Actions.tpgBoolSetValueAction"),angular.module("Actions.tpgBoolSetValueAction",[]).factory("tpgBoolSetValueAction",["$log","ESGXmlHelper","WebpanelAction","EsgColor","RcWareVisionAPI","EsgTpgEditorModal","WebpanelData","$timeout","WebpanelVariable","WebpanelActualUser",function(e,i,a,r,g,h,f,m,v,t){var n=function(e){a.call(this,e),this.panelId=e.panelId,this.event=i.getAttributeNS(e.node,"","event"),this.schedulesVarRef=i.getAttributeNS(e.node,"","schedulesVarRef"),this.exceptionsVarRef=i.getAttributeNS(e.node,"","exceptionsVarRef"),this.defaultVarRef=i.getAttributeNS(e.node,"","defaultVarRef"),this.title=i.getAttributeNS(e.node,"","title"),this.tpgStatesDefinition=[];var t=i.getXPathResult(e.node,"hmi:stateDefinitions/hmi:*",g.nsResolver,e.xmlDoc);angular.forEach(t,function(e){var t="true"==i.getAttributeNS(e,"","value"),a=i.getAttributeNS(e,"","name"),n=new r(i.getAttributeNS(e,"","color"));this.tpgStatesDefinition.push({value:t,label:a,color:n.toRGBA()})},this),this.actionActive=!1};return angular.extend(n.prototype,a.prototype),n.prototype.onLeftDown=function(){if(0==this.actionActive){this.actionActive=!0;try{var e=[],n=!1,t=this.defaultVarRef.replace("varRef://","").split("/"),a=f.connectionDefinition.connections[t[0]].variables[t[1]],i={connection:a.connection,name:a.name,offset:a.offset,length:a.length,type:a.type,uId:a.uId};e.push({variableDef:i});var r=this.schedulesVarRef.replace("varRef://","").split("/"),l={connection:(l=f.connectionDefinition.connections[r[0]].variables[r[1]]).connection,name:l.name,offset:l.offset,length:l.length,type:l.type,uId:l.uId};e.push({variableDef:l});var s=this.exceptionsVarRef.replace("varRef://","").split("/");if(null!=f.connectionDefinition.connections[s[0]]){n=!0;var u=f.connectionDefinition.connections[s[0]].variables[s[1]],o={connection:u.connection,name:u.name,offset:u.offset,length:u.length,type:u.type,uId:u.uId};e.push({variableDef:o})}}catch(e){return void(this.actionActive=!1)}var c=this,d=0,p=function(){g.GetTpgValue(e).success(function(e){c.actionActive=!1,function(e){var t=new v({variableId:c.defaultVarRef,sourceType:f.typeNumToId(parseInt(i.type))});t.setValueFromPlcHash({ts:e[0].t,value:e[0].v});var r=new v({variableId:c.schedulesVarRef,sourceType:"t17_boolean_scheduler.TpgValue"});r.setValueFromPlcHash({ts:e[1].t,value:e[1].v});var o=new v({variableId:c.schedulesVarRef,sourceType:"t17_boolean_scheduler.Exceptions"});null!=f.connectionDefinition.connections[s[0]]&&null!=e[2]&&o.setValueFromPlcHash({ts:e[2].t,value:e[2].v});var a=f.writeVariablePermission(c.schedulesVarRef);h.open({items:r.value,exceptions:o.value,defaultValue:t.value,tpgType:"Bool",states:c.tpgStatesDefinition,tpgExceptionEnabled:n,userSettingsActive:a}).success(function(i){c.confirmAction().success(function(){var e=f.prepareTpgValue("t17_boolean_scheduler",i.regular,i.exception);r.setValueFromUserHash({ts:(new Date).getTime(),value:e.regular});var t=r.getHexEncodedValue();o.setValueFromUserHash({ts:(new Date).getTime(),value:e.exceptions});var a=o.getHexEncodedValue(),n={variableDef:{uId:l.uId,offset:l.offset,length:l.length,connection:{name:l.connection.name}}};g.SendCommand([{varRef:"",value:t,gadget:n}]).success(function(){if(""!=c.exceptionsVarRef){var e={variableDef:{uId:u.uId,offset:u.offset,length:u.length,connection:{name:u.connection.name}}};m(function(){g.SendCommand([{varRef:"",value:a,gadget:e}])},300)}})})})}(e)}).error(function(){++d<5?m(p,500):c.actionActive=!1})};p()}},n}]),esgAngularDependencies.push("Actions.tpgIntSetValueAction"),angular.module("Actions.tpgIntSetValueAction",[]).factory("tpgIntSetValueAction",["$log","ESGXmlHelper","WebpanelAction","EsgColor","RcWareVisionAPI","EsgTpgEditorModal","WebpanelData","$timeout","WebpanelVariable","WebpanelActualUser",function(e,i,a,r,g,h,f,m,v,t){var n=function(e){a.call(this,e),this.panelId=e.panelId,this.event=i.getAttributeNS(e.node,"","event"),this.schedulesVarRef=i.getAttributeNS(e.node,"","schedulesVarRef"),this.exceptionsVarRef=i.getAttributeNS(e.node,"","exceptionsVarRef"),this.defaultVarRef=i.getAttributeNS(e.node,"","defaultVarRef"),this.title=i.getAttributeNS(e.node,"","title"),this.tpgStatesDefinition=[];var t=i.getXPathResult(e.node,"hmi:stateDefinitions/hmi:*",g.nsResolver,e.xmlDoc);angular.forEach(t,function(e){var t=i.getAttributeNS(e,"","value"),a=i.getAttributeNS(e,"","name"),n=new r(i.getAttributeNS(e,"","color"));this.tpgStatesDefinition.push({value:new Big(t),label:a,color:n.toRGBA()})},this),this.actionActive=!1};return angular.extend(n.prototype,a.prototype),n.prototype.onLeftDown=function(){if(0==this.actionActive){this.actionActive=!0;try{var e=[],n=!1,t=this.defaultVarRef.replace("varRef://","").split("/"),a=f.connectionDefinition.connections[t[0]].variables[t[1]],i={connection:a.connection,name:a.name,offset:a.offset,length:a.length,type:a.type,uId:a.uId};e.push({variableDef:i});var r=this.schedulesVarRef.replace("varRef://","").split("/"),l=f.connectionDefinition.connections[r[0]].variables[r[1]];l.connection,l.name,l.offset,l.length,l.type,l.uId;e.push({variableDef:l});var s=this.exceptionsVarRef.replace("varRef://","").split("/");if(null!=f.connectionDefinition.connections[s[0]])(u=f.connectionDefinition.connections[s[0]].variables[s[1]]).offset;s=this.exceptionsVarRef.replace("varRef://","").split("/");if(null!=f.connectionDefinition.connections[s[0]]){n=!0;var u,o={connection:(u=f.connectionDefinition.connections[s[0]].variables[s[1]]).connection,name:u.name,offset:u.offset,length:u.length,type:u.type,uId:u.uId};e.push({variableDef:o})}}catch(e){return void(this.actionActive=!1)}var c=this,d=0,p=function(){g.GetTpgValue(e).success(function(e){c.actionActive=!1,function(e){var t=new v({variableId:c.defaultVarRef,sourceType:f.typeNumToId(parseInt(i.type))});t.setValueFromPlcHash({ts:e[0].t,value:e[0].v});var r=new v({variableId:c.schedulesVarRef,sourceType:"t19_int_scheduler.TpgValue"});r.setValueFromPlcHash({ts:e[1].t,value:e[1].v});var o=new v({variableId:c.schedulesVarRef,sourceType:"t19_int_scheduler.Exceptions"});null!=f.connectionDefinition.connections[s[0]]&&null!=e[2]&&o.setValueFromPlcHash({ts:e[2].t,value:e[2].v});var a=f.writeVariablePermission(c.schedulesVarRef);h.open({items:r.value,exceptions:o.value,defaultValue:t.value,tpgType:"Int",states:c.tpgStatesDefinition,tpgExceptionEnabled:n,userSettingsActive:a}).success(function(i){c.confirmAction().success(function(){var e=f.prepareTpgValue("t19_int_scheduler",i.regular,i.exception);r.setValueFromUserHash({ts:(new Date).getTime(),value:e.regular});var t=r.getHexEncodedValue();o.setValueFromUserHash({ts:(new Date).getTime(),value:e.exceptions});var a=o.getHexEncodedValue(),n={variableDef:{uId:l.uId,offset:l.offset,length:l.length,connection:{name:l.connection.name}}};g.SendCommand([{varRef:"",value:t,gadget:n}]).success(function(){if(""!=c.exceptionsVarRef){var e={variableDef:{uId:u.uId,offset:u.offset,length:u.length,connection:{name:u.connection.name}}};m(function(){g.SendCommand([{varRef:"",value:a,gadget:e}])},300)}})})})}(e)}).error(function(){++d<5?m(p,500):c.actionActive=!1})};p()}},n}]),esgAngularDependencies.push("Actions.tpgRealSetValueAction"),angular.module("Actions.tpgRealSetValueAction",[]).factory("tpgRealSetValueAction",["$log","ESGXmlHelper","WebpanelAction","EsgColor","RcWareVisionAPI","EsgTpgEditorModal","WebpanelData","$timeout","WebpanelVariable","WebpanelActualUser",function(e,n,a,t,g,h,f,m,v,i){var r=function(e){a.call(this,e),this.panelId=e.panelId,this.event=n.getAttributeNS(e.node,"","event"),this.schedulesVarRef=n.getAttributeNS(e.node,"","schedulesVarRef"),this.exceptionsVarRef=n.getAttributeNS(e.node,"","exceptionsVarRef"),this.defaultVarRef=n.getAttributeNS(e.node,"","defaultVarRef"),this.title=n.getAttributeNS(e.node,"","title"),this.tpgStatesDefinition=[],this.tpgSettings={};var t=n.getXPathResult(e.node,"hmi:stateDefinitions/hmi:*",g.nsResolver,e.xmlDoc);angular.forEach(t,function(e){var t=n.getAttributeNS(e,"","value"),a=n.getAttributeNS(e,"","name");this.tpgSettings[a]=new Big(parseFloat(t))},this),this.actionActive=!1};return angular.extend(r.prototype,a.prototype),r.prototype.onLeftDown=function(){if(0==this.actionActive){this.actionActive=!0;try{var e=[],n=!1,t=this.defaultVarRef.replace("varRef://","").split("/"),a=f.connectionDefinition.connections[t[0]].variables[t[1]],i={connection:a.connection,name:a.name,offset:a.offset,length:a.length,type:a.type,uId:a.uId};e.push({variableDef:i});var r=this.schedulesVarRef.replace("varRef://","").split("/"),l={connection:(l=f.connectionDefinition.connections[r[0]].variables[r[1]]).connection,name:l.name,offset:l.offset,length:l.length,type:l.type,uId:l.uId};e.push({variableDef:l});var s=this.exceptionsVarRef.replace("varRef://","").split("/");if(null!=f.connectionDefinition.connections[s[0]]){n=!0;var u=f.connectionDefinition.connections[s[0]].variables[s[1]],o={connection:u.connection,name:u.name,offset:u.offset,length:u.length,type:u.type,uId:u.uId};e.push({variableDef:o})}}catch(e){return void(this.actionActive=!1)}var c=this,d=0,p=function(){g.GetTpgValue(e).success(function(e){c.actionActive=!1,function(e){var t=new v({variableId:c.defaultVarRef,sourceType:f.typeNumToId(parseInt(i.type))});t.setValueFromPlcHash({ts:e[0].t,value:e[0].v});var r=new v({variableId:c.schedulesVarRef,sourceType:"t18_real_scheduler.TpgValue"});r.setValueFromPlcHash({ts:e[1].t,value:e[1].v});var o=new v({variableId:c.schedulesVarRef,sourceType:"t18_real_scheduler.Exceptions"});null!=f.connectionDefinition.connections[s[0]]&&null!=e[2]&&o.setValueFromPlcHash({ts:e[2].t,value:e[2].v});var a=f.writeVariablePermission(c.schedulesVarRef);h.open({items:r.value,exceptions:o.value,defaultValue:new Big(t.value.toFixed(6)),tpgType:"Double",states:c.tpgStatesDefinition,tpgSettings:c.tpgSettings,tpgExceptionEnabled:n,userSettingsActive:a}).success(function(i){c.confirmAction().success(function(){var e=f.prepareTpgValue("t18_real_scheduler",i.regular,i.exception);r.setValueFromUserHash({ts:(new Date).getTime(),value:e.regular});var t=r.getHexEncodedValue();o.setValueFromUserHash({ts:(new Date).getTime(),value:e.exceptions});var a=o.getHexEncodedValue(),n={variableDef:{uId:l.uId,offset:l.offset,length:l.length,connection:{name:l.connection.name}}};g.SendCommand([{varRef:"",value:t,gadget:n}]).success(function(){if(""!=c.exceptionsVarRef){var e={variableDef:{uId:u.uId,offset:u.offset,length:u.length,connection:{name:u.connection.name}}};m(function(){g.SendCommand([{varRef:"",value:a,gadget:e}])},300)}})})})}(e)}).error(function(){++d<5?m(p,500):c.actionActive=!1})};p()}},r}]),esgAngularDependencies.push("Actions.lRealIncrementValueAction"),angular.module("Actions.lRealIncrementValueAction",[]).factory("lRealIncrementValueAction",["$log","ESGXmlHelper","WebpanelAction","RcWareVisionAPI","WebpanelData","WebpanelVariable",function(e,n,i,t,r,a){var o=function(e){i.call(this,e),this.event=n.getAttributeNS(e.node,"","event"),this.varRef=n.getAttributeNS(e.node,"","varRef"),r.registerGadgetDp(this.varRef);var t=n.getAttributeNS(e.node,"","step"),a=n.getAttributeNS(e.node,"","maxValue");""!=t&&(this.step=parseFloat(t)),""!=a&&(this.maxValue=parseFloat(a))};return angular.extend(o.prototype,i.prototype),o.prototype.onLeftDown=function(){var e=r.panels[r.actualPanelId].gadgetsMap[this.varRef],t=r.valueIncrement(this.maxValue,this.step,e,this.varRef,a);null!=t&&r.sendValue(this.varRef,t,e,this)},o}]),esgAngularDependencies.push("Actions.changePageAction"),angular.module("Actions.changePageAction",[]).factory("changePageAction",["$log","ESGXmlHelper","$location","$timeout","WebpanelData","WebpanelAction",function(e,t,a,n,i,r){return function(e){r.call(this,e),this.event=t.getAttributeNS(e.node,"","event"),this.pageId=t.getAttributeNS(e.node,"","pageId"),this.onLeftDown=function(){var e=this.pageId;n(function(){null!=i.getPanelById(e)&&a.path("/panel/"+e,!1)},0)}}}]),esgAngularDependencies.push("Actions.realDecrementValueAction"),angular.module("Actions.realDecrementValueAction",[]).factory("realDecrementValueAction",["$log","ESGXmlHelper","WebpanelAction","RcWareVisionAPI","WebpanelData","WebpanelVariable",function(e,n,i,t,r,a){var o=function(e){i.call(this,e),this.event=n.getAttributeNS(e.node,"","event"),this.varRef=n.getAttributeNS(e.node,"","varRef"),r.registerGadgetDp(this.varRef);var t=n.getAttributeNS(e.node,"","step"),a=n.getAttributeNS(e.node,"","minValue");""!=t&&(this.step=parseFloat(t)),""!=a&&(this.minValue=parseFloat(a))};return angular.extend(o.prototype,i.prototype),o.prototype.onLeftDown=function(){var e=r.panels[r.actualPanelId].gadgetsMap[this.varRef],t=r.valueDecrement(this.minValue,this.step,e,this.varRef,a);null!=t&&r.sendValue(this.varRef,t,e,this)},o}]),esgAngularDependencies.push("Actions.realIncrementValueAction"),angular.module("Actions.realIncrementValueAction",[]).factory("realIncrementValueAction",["$log","ESGXmlHelper","WebpanelAction","RcWareVisionAPI","WebpanelData","WebpanelVariable",function(e,n,i,t,r,a){var o=function(e){i.call(this,e),this.event=n.getAttributeNS(e.node,"","event"),this.varRef=n.getAttributeNS(e.node,"","varRef"),r.registerGadgetDp(this.varRef);var t=n.getAttributeNS(e.node,"","step"),a=n.getAttributeNS(e.node,"","maxValue");""!=t&&(this.step=parseFloat(t)),""!=a&&(this.maxValue=parseFloat(a))};return angular.extend(o.prototype,i.prototype),o.prototype.onLeftDown=function(){var e=r.panels[r.actualPanelId].gadgetsMap[this.varRef],t=r.valueIncrement(this.maxValue,this.step,e,this.varRef,a);null!=t&&r.sendValue(this.varRef,t,e,this)},o}]),esgAngularDependencies.push("Actions.uIntDecrementValueAction"),angular.module("Actions.uIntDecrementValueAction",[]).factory("uIntDecrementValueAction",["$log","ESGXmlHelper","WebpanelAction","RcWareVisionAPI","WebpanelData","WebpanelVariable",function(e,n,i,t,r,a){var o=function(e){i.call(this,e),this.event=n.getAttributeNS(e.node,"","event"),this.varRef=n.getAttributeNS(e.node,"","varRef"),r.registerGadgetDp(this.varRef);var t=n.getAttributeNS(e.node,"","step"),a=n.getAttributeNS(e.node,"","minValue");""!=t&&(this.step=parseInt(t)),""!=a&&(this.minValue=parseInt(a))};return angular.extend(o.prototype,i.prototype),o.prototype.onLeftDown=function(){var e=r.panels[r.actualPanelId].gadgetsMap[this.varRef],t=r.valueDecrement(this.minValue,this.step,e,this.varRef,a);null!=t&&r.sendValue(this.varRef,t,e,this)},o}]),esgAngularDependencies.push("Actions.uIntIncrementValueAction"),angular.module("Actions.uIntIncrementValueAction",[]).factory("uIntIncrementValueAction",["$log","ESGXmlHelper","WebpanelAction","RcWareVisionAPI","WebpanelData","WebpanelVariable",function(e,n,i,t,r,a){var o=function(e){i.call(this,e),this.event=n.getAttributeNS(e.node,"","event"),this.varRef=n.getAttributeNS(e.node,"","varRef"),r.registerGadgetDp(this.varRef);var t=n.getAttributeNS(e.node,"","step"),a=n.getAttributeNS(e.node,"","maxValue");""!=t&&(this.step=parseInt(t)),""!=a&&(this.maxValue=parseInt(a))};return angular.extend(o.prototype,i.prototype),o.prototype.onLeftDown=function(){var e=r.panels[r.actualPanelId].gadgetsMap[this.varRef],t=r.valueIncrement(this.maxValue,this.step,e,this.varRef,a);null!=t&&r.sendValue(this.varRef,t,e,this)},o}]),esgAngularDependencies.push("Actions.uSintDecrementValueAction"),angular.module("Actions.uSintDecrementValueAction",[]).factory("uSintDecrementValueAction",["$log","ESGXmlHelper","WebpanelAction","RcWareVisionAPI","WebpanelData","WebpanelVariable",function(e,n,i,t,r,a){var o=function(e){i.call(this,e),this.event=n.getAttributeNS(e.node,"","event"),this.varRef=n.getAttributeNS(e.node,"","varRef"),r.registerGadgetDp(this.varRef);var t=n.getAttributeNS(e.node,"","step"),a=n.getAttributeNS(e.node,"","minValue");""!=t&&(this.step=parseInt(t)),""!=a&&(this.minValue=parseInt(a))};return angular.extend(o.prototype,i.prototype),o.prototype.onLeftDown=function(){var e=r.panels[r.actualPanelId].gadgetsMap[this.varRef],t=r.valueDecrement(this.minValue,this.step,e,this.varRef,a);null!=t&&r.sendValue(this.varRef,t,e,this)},o}]),esgAngularDependencies.push("Actions.uSintIncrementValueAction"),angular.module("Actions.uSintIncrementValueAction",[]).factory("uSintIncrementValueAction",["$log","ESGXmlHelper","WebpanelAction","RcWareVisionAPI","WebpanelData","WebpanelVariable",function(e,n,i,t,r,a){var o=function(e){i.call(this,e),this.event=n.getAttributeNS(e.node,"","event"),this.varRef=n.getAttributeNS(e.node,"","varRef"),r.registerGadgetDp(this.varRef);var t=n.getAttributeNS(e.node,"","step"),a=n.getAttributeNS(e.node,"","maxValue");""!=t&&(this.step=parseInt(t)),""!=a&&(this.maxValue=parseInt(a))};return angular.extend(o.prototype,i.prototype),o.prototype.onLeftDown=function(){var e=r.panels[r.actualPanelId].gadgetsMap[this.varRef],t=r.valueIncrement(this.maxValue,this.step,e,this.varRef,a);null!=t&&r.sendValue(this.varRef,t,e,this)},o}]),esgAngularDependencies.push("Actions.uDintIncrementValueAction"),angular.module("Actions.uDintIncrementValueAction",[]).factory("uDintIncrementValueAction",["$log","ESGXmlHelper","WebpanelAction","RcWareVisionAPI","WebpanelData","WebpanelVariable",function(e,n,i,t,r,a){var o=function(e){i.call(this,e),this.event=n.getAttributeNS(e.node,"","event"),this.varRef=n.getAttributeNS(e.node,"","varRef"),r.registerGadgetDp(this.varRef);var t=n.getAttributeNS(e.node,"","step"),a=n.getAttributeNS(e.node,"","maxValue");""!=t&&(this.step=parseInt(t)),""!=a&&(this.maxValue=parseInt(a))};return angular.extend(o.prototype,i.prototype),o.prototype.onLeftDown=function(){var e=r.panels[r.actualPanelId].gadgetsMap[this.varRef],t=r.valueIncrement(this.maxValue,this.step,e,this.varRef,a);null!=t&&r.sendValue(this.varRef,t,e,this)},o}]),esgAngularDependencies.push("Actions.uDintDecrementValueAction"),angular.module("Actions.uDintDecrementValueAction",[]).factory("uDintDecrementValueAction",["$log","ESGXmlHelper","WebpanelAction","RcWareVisionAPI","WebpanelData","WebpanelVariable",function(e,n,i,t,r,a){var o=function(e){i.call(this,e),this.event=n.getAttributeNS(e.node,"","event"),this.varRef=n.getAttributeNS(e.node,"","varRef"),r.registerGadgetDp(this.varRef);var t=n.getAttributeNS(e.node,"","step"),a=n.getAttributeNS(e.node,"","minValue");""!=t&&(this.step=parseInt(t)),""!=a&&(this.minValue=parseInt(a))};return angular.extend(o.prototype,i.prototype),o.prototype.onLeftDown=function(){var e=r.panels[r.actualPanelId].gadgetsMap[this.varRef],t=r.valueDecrement(this.minValue,this.step,e,this.varRef,a);null!=t&&r.sendValue(this.varRef,t,e,this)},o}]),esgAngularDependencies.push("Actions.sIntIncrementValueAction"),angular.module("Actions.sIntIncrementValueAction",[]).factory("sIntIncrementValueAction",["$log","ESGXmlHelper","WebpanelAction","RcWareVisionAPI","WebpanelData","WebpanelVariable",function(e,n,i,t,r,a){var o=function(e){i.call(this,e),this.event=n.getAttributeNS(e.node,"","event"),this.varRef=n.getAttributeNS(e.node,"","varRef"),r.registerGadgetDp(this.varRef);var t=n.getAttributeNS(e.node,"","step"),a=n.getAttributeNS(e.node,"","maxValue");""!=t&&(this.step=parseInt(t)),""!=a&&(this.maxValue=parseInt(a))};return angular.extend(o.prototype,i.prototype),o.prototype.onLeftDown=function(){var e=r.panels[r.actualPanelId].gadgetsMap[this.varRef],t=r.valueIncrement(this.maxValue,this.step,e,this.varRef,a);null!=t&&r.sendValue(this.varRef,t,e,this)},o}]),esgAngularDependencies.push("Actions.sIntDecrementValueAction"),angular.module("Actions.sIntDecrementValueAction",[]).factory("sIntDecrementValueAction",["$log","ESGXmlHelper","WebpanelAction","RcWareVisionAPI","WebpanelData","WebpanelVariable",function(e,n,i,t,r,a){var o=function(e){i.call(this,e),this.event=n.getAttributeNS(e.node,"","event"),this.varRef=n.getAttributeNS(e.node,"","varRef"),r.registerGadgetDp(this.varRef);var t=n.getAttributeNS(e.node,"","step"),a=n.getAttributeNS(e.node,"","minValue");""!=t&&(this.step=parseInt(t)),""!=a&&(this.minValue=parseInt(a))};return angular.extend(o.prototype,i.prototype),o.prototype.onLeftDown=function(){var e=r.panels[r.actualPanelId].gadgetsMap[this.varRef],t=r.valueDecrement(this.minValue,this.step,e,this.varRef,a);null!=t&&r.sendValue(this.varRef,t,e,this)},o}]),esgAngularDependencies.push("Actions.lIntIncrementValueAction"),angular.module("Actions.lIntIncrementValueAction",[]).factory("lIntIncrementValueAction",["$log","ESGXmlHelper","WebpanelAction","RcWareVisionAPI","WebpanelData","WebpanelVariable",function(e,n,i,t,r,a){var o=function(e){i.call(this,e),this.event=n.getAttributeNS(e.node,"","event"),this.varRef=n.getAttributeNS(e.node,"","varRef"),r.registerGadgetDp(this.varRef);var t=n.getAttributeNS(e.node,"","step"),a=n.getAttributeNS(e.node,"","maxValue");""!=t&&(this.step=parseInt(t)),""!=a&&(this.maxValue=parseInt(a))};return angular.extend(o.prototype,i.prototype),o.prototype.onLeftDown=function(){var e=r.panels[r.actualPanelId].gadgetsMap[this.varRef],t=r.valueIncrement(this.maxValue,this.step,e,this.varRef,a);null!=t&&r.sendValue(this.varRef,t,e,this)},o}]),esgAngularDependencies.push("Actions.lIntDecrementValueAction"),angular.module("Actions.lIntDecrementValueAction",[]).factory("lIntDecrementValueAction",["$log","ESGXmlHelper","WebpanelAction","RcWareVisionAPI","WebpanelData","WebpanelVariable",function(e,n,i,o,l,s){var t=function(e){i.call(this,e),this.event=n.getAttributeNS(e.node,"","event"),this.varRef=n.getAttributeNS(e.node,"","varRef"),l.registerGadgetDp(this.varRef);var t=n.getAttributeNS(e.node,"","step"),a=n.getAttributeNS(e.node,"","minValue");""!=t&&(this.step=parseInt(t)),""!=a&&(this.minValue=parseInt(a))};return angular.extend(t.prototype,i.prototype),t.prototype.onLeftDown=function(){var e=l.panels[l.actualPanelId].gadgetsMap[this.varRef],t=new Big(e.value.value),a=this.step,n=this.minValue;if(0!=t.cmp(n)){(t=t.minus(a)).cmp(n)<0&&(t=new Big(n));var i=new s({variableId:this.varRef,sourceType:l.typeNumToId(parseInt(e.variableDef.type))});i.setValueFromUserHash({ts:(new Date).getTime(),value:t});var r=this.varRef;this.confirmAction().success(function(){o.SendCommand([{varRef:r,value:i.getHexEncodedValue(),gadget:e,newValue:i}])})}},t}]),esgAngularDependencies.push("Actions.intIncrementValueAction"),angular.module("Actions.intIncrementValueAction",[]).factory("intIncrementValueAction",["$log","ESGXmlHelper","WebpanelAction","RcWareVisionAPI","WebpanelData","WebpanelVariable",function(e,n,i,t,r,a){var o=function(e){i.call(this,e),this.event=n.getAttributeNS(e.node,"","event"),this.varRef=n.getAttributeNS(e.node,"","varRef"),r.registerGadgetDp(this.varRef);var t=n.getAttributeNS(e.node,"","step"),a=n.getAttributeNS(e.node,"","maxValue");""!=t&&(this.step=parseInt(t)),""!=a&&(this.maxValue=parseInt(a))};return angular.extend(o.prototype,i.prototype),o.prototype.onLeftDown=function(){var e=r.panels[r.actualPanelId].gadgetsMap[this.varRef],t=r.valueIncrement(this.maxValue,this.step,e,this.varRef,a);null!=t&&r.sendValue(this.varRef,t,e,this)},o}]),esgAngularDependencies.push("Actions.intDecrementValueAction"),angular.module("Actions.intDecrementValueAction",[]).factory("intDecrementValueAction",["$log","ESGXmlHelper","WebpanelAction","RcWareVisionAPI","WebpanelData","WebpanelVariable",function(e,n,i,t,r,a){var o=function(e){i.call(this,e),this.event=n.getAttributeNS(e.node,"","event"),this.varRef=n.getAttributeNS(e.node,"","varRef"),r.registerGadgetDp(this.varRef);var t=n.getAttributeNS(e.node,"","step"),a=n.getAttributeNS(e.node,"","minValue");""!=t&&(this.step=parseInt(t)),""!=a&&(this.minValue=parseInt(a))};return angular.extend(o.prototype,i.prototype),o.prototype.onLeftDown=function(){var e=r.panels[r.actualPanelId].gadgetsMap[this.varRef],t=r.valueDecrement(this.minValue,this.step,e,this.varRef,a);null!=t&&r.sendValue(this.varRef,t,e,this)},o}]),esgAngularDependencies.push("Actions.dIntIncrementValueAction"),angular.module("Actions.dIntIncrementValueAction",[]).factory("dIntIncrementValueAction",["$log","ESGXmlHelper","WebpanelAction","RcWareVisionAPI","WebpanelData","WebpanelVariable",function(e,n,i,t,r,a){var o=function(e){i.call(this,e),this.event=n.getAttributeNS(e.node,"","event"),this.varRef=n.getAttributeNS(e.node,"","varRef"),r.registerGadgetDp(this.varRef);var t=n.getAttributeNS(e.node,"","step"),a=n.getAttributeNS(e.node,"","maxValue");""!=t&&(this.step=parseInt(t)),""!=a&&(this.maxValue=parseInt(a))};return angular.extend(o.prototype,i.prototype),o.prototype.onLeftDown=function(){var e=r.panels[r.actualPanelId].gadgetsMap[this.varRef],t=r.valueIncrement(this.maxValue,this.step,e,this.varRef,a);null!=t&&r.sendValue(this.varRef,t,e,this)},o}]),esgAngularDependencies.push("Actions.dIntDecrementValueAction"),angular.module("Actions.dIntDecrementValueAction",[]).factory("dIntDecrementValueAction",["$log","ESGXmlHelper","WebpanelAction","RcWareVisionAPI","WebpanelData","WebpanelVariable",function(e,n,i,t,r,a){var o=function(e){i.call(this,e),this.event=n.getAttributeNS(e.node,"","event"),this.varRef=n.getAttributeNS(e.node,"","varRef"),r.registerGadgetDp(this.varRef);var t=n.getAttributeNS(e.node,"","step"),a=n.getAttributeNS(e.node,"","minValue");""!=t&&(this.step=parseInt(t)),""!=a&&(this.minValue=parseInt(a))};return angular.extend(o.prototype,i.prototype),o.prototype.onLeftDown=function(){var e=r.panels[r.actualPanelId].gadgetsMap[this.varRef],t=r.valueDecrement(this.minValue,this.step,e,this.varRef,a);null!=t&&r.sendValue(this.varRef,t,e,this)},o}]),esgAngularDependencies.push("Actions.uIntSetValueAction"),angular.module("Actions.uIntSetValueAction",[]).factory("uIntSetValueAction",["$log","ESGXmlHelper","WebpanelAction","RcWareVisionAPI","WebpanelData","WebpanelVariable",function(e,a,n,i,r,o){var t=function(e){n.call(this,e),this.event=a.getAttributeNS(e.node,"","event"),this.varRef=a.getAttributeNS(e.node,"","varRef"),r.registerGadgetDp(this.varRef);var t=a.getAttributeNS(e.node,"","value");""!=t&&(this.value=parseInt(t))};return angular.extend(t.prototype,n.prototype),t.prototype.onLeftDown=function(){var e=r.panels[r.actualPanelId].gadgetsMap[this.varRef];if(null!=this.value){var t=new Big(this.value),a=new o({variableId:this.varRef,sourceType:r.typeNumToId(parseInt(e.variableDef.type))});a.setValueFromUserHash({ts:(new Date).getTime(),value:t});var n=this.varRef;this.confirmAction().success(function(){i.SendCommand([{varRef:n,value:a.getHexEncodedValue(),gadget:e,newValue:a}])})}},t}]),esgAngularDependencies.push("Actions.uSintSetValueAction"),angular.module("Actions.uSintSetValueAction",[]).factory("uSintSetValueAction",["$log","ESGXmlHelper","WebpanelAction","RcWareVisionAPI","WebpanelData","WebpanelVariable",function(e,a,n,i,r,o){var t=function(e){n.call(this,e),this.event=a.getAttributeNS(e.node,"","event"),this.varRef=a.getAttributeNS(e.node,"","varRef"),r.registerGadgetDp(this.varRef);var t=a.getAttributeNS(e.node,"","value");""!=t&&(this.value=parseInt(t))};return angular.extend(t.prototype,n.prototype),t.prototype.onLeftDown=function(){var e=r.panels[r.actualPanelId].gadgetsMap[this.varRef];if(null!=this.value){var t=new Big(this.value),a=new o({variableId:this.varRef,sourceType:r.typeNumToId(parseInt(e.variableDef.type))});a.setValueFromUserHash({ts:(new Date).getTime(),value:t});var n=this.varRef;this.confirmAction().success(function(){i.SendCommand([{varRef:n,value:a.getHexEncodedValue(),gadget:e,newValue:a}])})}},t}]),esgAngularDependencies.push("Actions.uLintSetValueAction"),angular.module("Actions.uLintSetValueAction",[]).factory("uLintSetValueAction",["$log","ESGXmlHelper","WebpanelAction","RcWareVisionAPI","WebpanelData","WebpanelVariable",function(e,a,n,i,r,o){var t=function(e){n.call(this,e),this.event=a.getAttributeNS(e.node,"","event"),this.varRef=a.getAttributeNS(e.node,"","varRef"),r.registerGadgetDp(this.varRef);var t=a.getAttributeNS(e.node,"","value");""!=t&&(this.value=parseInt(t))};return angular.extend(t.prototype,n.prototype),t.prototype.onLeftDown=function(){var e=r.panels[r.actualPanelId].gadgetsMap[this.varRef];if(null!=this.value){var t=new Big(this.value),a=new o({variableId:this.varRef,sourceType:r.typeNumToId(parseInt(e.variableDef.type))});a.setValueFromUserHash({ts:(new Date).getTime(),value:t});var n=this.varRef;this.confirmAction().success(function(){i.SendCommand([{varRef:n,value:a.getHexEncodedValue(),gadget:e,newValue:a}])})}},t}]),esgAngularDependencies.push("Actions.uDintSetValueAction"),angular.module("Actions.uDintSetValueAction",[]).factory("uDintSetValueAction",["$log","ESGXmlHelper","WebpanelAction","RcWareVisionAPI","WebpanelData","WebpanelVariable",function(e,a,n,i,r,o){var t=function(e){n.call(this,e),this.event=a.getAttributeNS(e.node,"","event"),this.varRef=a.getAttributeNS(e.node,"","varRef"),r.registerGadgetDp(this.varRef);var t=a.getAttributeNS(e.node,"","value");""!=t&&(this.value=parseInt(t))};return angular.extend(t.prototype,n.prototype),t.prototype.onLeftDown=function(){var e=r.panels[r.actualPanelId].gadgetsMap[this.varRef];if(null!=this.value){var t=new Big(this.value),a=new o({variableId:this.varRef,sourceType:r.typeNumToId(parseInt(e.variableDef.type))});a.setValueFromUserHash({ts:(new Date).getTime(),value:t});var n=this.varRef;this.confirmAction().success(function(){i.SendCommand([{varRef:n,value:a.getHexEncodedValue(),gadget:e,newValue:a}])})}},t}]),esgAngularDependencies.push("Actions.sIntSetValueAction"),angular.module("Actions.sIntSetValueAction",[]).factory("sIntSetValueAction",["$log","ESGXmlHelper","WebpanelAction","RcWareVisionAPI","WebpanelData","WebpanelVariable",function(e,a,n,i,r,o){var t=function(e){n.call(this,e),this.event=a.getAttributeNS(e.node,"","event"),this.varRef=a.getAttributeNS(e.node,"","varRef"),r.registerGadgetDp(this.varRef);var t=a.getAttributeNS(e.node,"","value");""!=t&&(this.value=parseInt(t))};return angular.extend(t.prototype,n.prototype),t.prototype.onLeftDown=function(){var e=r.panels[r.actualPanelId].gadgetsMap[this.varRef];if(null!=this.value){var t=new Big(this.value),a=new o({variableId:this.varRef,sourceType:r.typeNumToId(parseInt(e.variableDef.type))});a.setValueFromUserHash({ts:(new Date).getTime(),value:t});var n=this.varRef;this.confirmAction().success(function(){i.SendCommand([{varRef:n,value:a.getHexEncodedValue(),gadget:e,newValue:a}])})}},t}]),esgAngularDependencies.push("Actions.dIntSetValueAction"),angular.module("Actions.dIntSetValueAction",[]).factory("dIntSetValueAction",["$log","ESGXmlHelper","WebpanelAction","RcWareVisionAPI","WebpanelData","WebpanelVariable",function(e,a,n,i,r,o){var t=function(e){n.call(this,e),this.event=a.getAttributeNS(e.node,"","event"),this.varRef=a.getAttributeNS(e.node,"","varRef"),r.registerGadgetDp(this.varRef);var t=a.getAttributeNS(e.node,"","value");""!=t&&(this.value=parseInt(t))};return angular.extend(t.prototype,n.prototype),t.prototype.onLeftDown=function(){var e=r.panels[r.actualPanelId].gadgetsMap[this.varRef];if(null!=this.value){var t=new Big(this.value),a=new o({variableId:this.varRef,sourceType:r.typeNumToId(parseInt(e.variableDef.type))});a.setValueFromUserHash({ts:(new Date).getTime(),value:t});var n=this.varRef;this.confirmAction().success(function(){i.SendCommand([{varRef:n,value:a.getHexEncodedValue(),gadget:e,newValue:a}])})}},t}]),esgAngularDependencies.push("Actions.realSetValueAction"),angular.module("Actions.realSetValueAction",[]).factory("realSetValueAction",["$log","ESGXmlHelper","WebpanelAction","RcWareVisionAPI","WebpanelData","WebpanelVariable",function(e,a,n,i,r,o){var t=function(e){n.call(this,e),this.event=a.getAttributeNS(e.node,"","event"),this.varRef=a.getAttributeNS(e.node,"","varRef"),r.registerGadgetDp(this.varRef);var t=a.getAttributeNS(e.node,"","value");""!=t&&(this.value=parseFloat(t))};return angular.extend(t.prototype,n.prototype),t.prototype.onLeftDown=function(){var e=r.panels[r.actualPanelId].gadgetsMap[this.varRef];if(null!=this.value){var t=new Big(this.value),a=new o({variableId:this.varRef,sourceType:r.typeNumToId(parseInt(e.variableDef.type))});a.setValueFromUserHash({ts:(new Date).getTime(),value:t});var n=this.varRef;this.confirmAction().success(function(){i.SendCommand([{varRef:n,value:a.getHexEncodedValue(),gadget:e,newValue:a}])})}},t}]),esgAngularDependencies.push("Actions.intSetValueAction"),angular.module("Actions.intSetValueAction",[]).factory("intSetValueAction",["$log","ESGXmlHelper","WebpanelAction","RcWareVisionAPI","WebpanelData","WebpanelVariable",function(e,a,n,i,r,o){var t=function(e){n.call(this,e),this.event=a.getAttributeNS(e.node,"","event"),this.varRef=a.getAttributeNS(e.node,"","varRef"),r.registerGadgetDp(this.varRef);var t=a.getAttributeNS(e.node,"","value");""!=t&&(this.value=parseInt(t))};return angular.extend(t.prototype,n.prototype),t.prototype.onLeftDown=function(){var e=r.panels[r.actualPanelId].gadgetsMap[this.varRef];if(null!=this.value){var t=new Big(this.value),a=new o({variableId:this.varRef,sourceType:r.typeNumToId(parseInt(e.variableDef.type))});a.setValueFromUserHash({ts:(new Date).getTime(),value:t});var n=this.varRef;this.confirmAction().success(function(){i.SendCommand([{varRef:n,value:a.getHexEncodedValue(),gadget:e,newValue:a}])})}},t}]),esgAngularDependencies.push("Actions.lRealSetValueAction"),angular.module("Actions.lRealSetValueAction",[]).factory("lRealSetValueAction",["$log","ESGXmlHelper","WebpanelAction","RcWareVisionAPI","WebpanelData","WebpanelVariable",function(e,a,n,i,r,o){var t=function(e){n.call(this,e),this.event=a.getAttributeNS(e.node,"","event"),this.varRef=a.getAttributeNS(e.node,"","varRef"),r.registerGadgetDp(this.varRef);var t=a.getAttributeNS(e.node,"","value");""!=t&&(this.value=parseFloat(t))};return angular.extend(t.prototype,n.prototype),t.prototype.onLeftDown=function(){var e=r.panels[r.actualPanelId].gadgetsMap[this.varRef];if(null!=this.value){var t=new Big(this.value),a=new o({variableId:this.varRef,sourceType:r.typeNumToId(parseInt(e.variableDef.type))});a.setValueFromUserHash({ts:(new Date).getTime(),value:t});var n=this.varRef;this.confirmAction().success(function(){i.SendCommand([{varRef:n,value:a.getHexEncodedValue(),gadget:e,newValue:a}])})}},t}]),esgAngularDependencies.push("Actions.boolSetValueAction"),angular.module("Actions.boolSetValueAction",[]).factory("boolSetValueAction",["$log","ESGXmlHelper","WebpanelAction","RcWareVisionAPI","WebpanelData","WebpanelVariable",function(e,a,n,i,r,o){var t=function(e){n.call(this,e),this.event=a.getAttributeNS(e.node,"","event"),this.varRef=a.getAttributeNS(e.node,"","varRef"),r.registerGadgetDp(this.varRef);var t=a.getAttributeNS(e.node,"","value");""!=t&&(this.value="true"==t||1==t)};return angular.extend(t.prototype,n.prototype),t.prototype.onLeftDown=function(){var e=r.panels[r.actualPanelId].gadgetsMap[this.varRef];if(null!=this.value){var t=this.value,a=new o({variableId:this.varRef,sourceType:r.typeNumToId(parseInt(e.variableDef.type))});a.setValueFromUserHash({ts:(new Date).getTime(),value:t});var n=this.varRef;this.confirmAction().success(function(){i.SendCommand([{varRef:n,value:a.getHexEncodedValue(),gadget:e,newValue:a}])})}},t}]),esgAngularDependencies.push("Actions.showPopupAction"),angular.module("Actions.showPopupAction",[]).factory("showPopupAction",["$log","ESGXmlHelper","$location","$timeout","$rootScope","$compile","WebpanelData","hidePopupAction","WebpanelAction","ESGscrollPanel",function(e,t,a,n,i,r,o,l,s,u){return function(a){s.call(this,a),this.event=t.getAttributeNS(a.node,"","event"),this.width=parseInt(t.getAttributeNS(a.node,"","width")),this.height=parseInt(t.getAttributeNS(a.node,"","height")),this.x=parseInt(t.getAttributeNS(a.node,"","x")),this.y=parseInt(t.getAttributeNS(a.node,"","y")),null!=a.additionalData&&a.additionalData.templateAddPosition;var e=t.getXPathResult(a.node,"hmi:*",a.nsResolver,a.xmlDoc);this.gadget=new u({childNodes:e,xmlDoc:a.xmlDoc,panelId:a.panelId,width:this.width,height:this.height,left:this.x,top:this.y},!1),this.data=a;this.getItemActions=function(e,t){if(null!=e.actions&&0<e.actions.length){var a=new l({showAction:this});e.actions.push(a)}null!=e.getChildrens&&angular.forEach(e.getChildrens(),function(e){this.getItemActions(e,t)},this)},this.setCloseActions=function(e,t){"digitalsettercombobox"==a.gadget.metadataArray.gadgetName&&this.getItemActions(e,t)},this.onLeftDown=function(e){null==this.addedElement?o.addPopUpGadgets(this):this.removePopup()},this.removePopup=function(){null!=this.addedElement&&(this.addedElement.remove(),this.addedElement=null,this.removeBinding())}}}]),esgAngularDependencies.push("Actions.hidePopupAction"),angular.module("Actions.hidePopupAction",[]).factory("hidePopupAction",["$log","ESGXmlHelper","$location","$timeout","$rootScope","$compile","WebpanelData",function(e,t,a,n,i,r,o){return function(e){this.showAction=e.showAction,this.event="onLeftDown",this.onLeftDown=function(){this.showAction.removePopup()}}}]),esgAngularDependencies.push("Actions.dateTimeSetValueAction"),angular.module("Actions.dateTimeSetValueAction",[]).factory("dateTimeSetValueAction",["$log","ESGXmlHelper","WebpanelAction","RcWareVisionAPI","EsgDateTimeEditModal","WebpanelData","$timeout","WebpanelVariable",function(e,t,a,r,o,l,n,s){var i=function(e){a.call(this,e),this.event=t.getAttributeNS(e.node,"","event"),this.varRef=t.getAttributeNS(e.node,"","varRef"),l.registerGadgetDp(this.varRef)};return angular.extend(i.prototype,a.prototype),i.prototype.onLeftDown=function(){var n=l.panels[l.actualPanelId].gadgetsMap[this.varRef],i=this;o.open({gadgetValueObj:n}).success(function(a){i.confirmAction().success(function(){if(0==n.variableDef.uId&&0==n.variableDef.offset&&0==n.variableDef.length){var e=new Big(a.getTime()).times(1e4).plus("621355968000000000").toFixed(0);r.SetRtc(parseInt(e))}else{var t=new s({variableId:i.varRef,sourceType:l.typeNumToId(parseInt(n.variableDef.type))});t.setValueFromUserHash({ts:(new Date).getTime(),value:a}),r.SendCommand([{varRef:i.varRef,value:t.getHexEncodedValue(),gadget:n,newValue:t}])}})})},i}]),esgAngularDependencies.push("Actions.uLintIncrementValueAction"),angular.module("Actions.uLintIncrementValueAction",[]).factory("uLintIncrementValueAction",["$log","ESGXmlHelper","WebpanelAction","RcWareVisionAPI","WebpanelData","WebpanelVariable",function(e,n,i,t,r,a){var o=function(e){i.call(this,e),this.event=n.getAttributeNS(e.node,"","event"),this.varRef=n.getAttributeNS(e.node,"","varRef"),r.registerGadgetDp(this.varRef);var t=n.getAttributeNS(e.node,"","step"),a=n.getAttributeNS(e.node,"","maxValue");""!=t&&(this.step=parseInt(t)),""!=a&&(this.maxValue=parseInt(a))};return angular.extend(o.prototype,i.prototype),o.prototype.onLeftDown=function(){var e=r.panels[r.actualPanelId].gadgetsMap[this.varRef],t=r.valueIncrement(this.maxValue,this.step,e,this.varRef,a);null!=t&&r.sendValue(this.varRef,t,e,this)},o}]),esgAngularDependencies.push("Actions.uLintDecrementValueAction"),angular.module("Actions.uLintDecrementValueAction",[]).factory("uLintDecrementValueAction",["$log","ESGXmlHelper","WebpanelAction","RcWareVisionAPI","WebpanelData","WebpanelVariable",function(e,n,i,t,r,a){var o=function(e){i.call(this,e),this.event=n.getAttributeNS(e.node,"","event"),this.varRef=n.getAttributeNS(e.node,"","varRef"),r.registerGadgetDp(this.varRef);var t=n.getAttributeNS(e.node,"","step"),a=n.getAttributeNS(e.node,"","minValue");""!=t&&(this.step=parseInt(t)),""!=a&&(this.minValue=parseInt(a))};return angular.extend(o.prototype,i.prototype),o.prototype.onLeftDown=function(){var e=r.panels[r.actualPanelId].gadgetsMap[this.varRef],t=r.valueDecrement(this.minValue,this.step,e,this.varRef,a);null!=t&&r.sendValue(this.varRef,t,e,this)},o}]),esgAngularDependencies.push("Actions.textInputSetValueAction"),angular.module("Actions.textInputSetValueAction",[]).factory("TextInputSetValueAction",["$log","ESGXmlHelper","WebpanelAction","RcWareVisionAPI","WebpanelData","WebpanelVariable","EsgInitModal",function(e,i,r,t,o,a,n){var l=function(e){r.call(this,e),this.event=i.getAttributeNS(e.node,"","event"),this.varRef=i.getAttributeNS(e.node,"","varRef"),this.title=i.getAttributeNS(e.node,"","title");var t=i.getAttributeNS(e.node,"","step"),a=i.getAttributeNS(e.node,"","minValue"),n=i.getAttributeNS(e.node,"","maxValue");""!=t&&(this.step=parseFloat(t)),""!=a&&(this.minValue=parseFloat(a)),""!=n&&(this.maxValue=parseFloat(n)),o.registerGadgetDp(this.varRef),this.valueType=null};return angular.extend(l.prototype,r.prototype),l.prototype.onLeftDown=function(){var t=o.panels[o.actualPanelId].gadgetsMap[this.varRef],a=this;n.open(o.getInitDefObject(t,a)).success(function(e){o.sendValue(a.varRef,e,t,a)})},l}]),esgAngularDependencies.push("Actions.textInputSintSetValueAction"),angular.module("Actions.textInputSintSetValueAction",[]).factory("textInputSintSetValueAction",["$log","ESGXmlHelper","TextInputSetValueAction",function(e,t,a){var n=function(e){a.call(this,e)};return angular.extend(n.prototype,a.prototype),n}]),esgAngularDependencies.push("Actions.textInputIntSetValueAction"),angular.module("Actions.textInputIntSetValueAction",[]).factory("textInputIntSetValueAction",["$log","ESGXmlHelper","TextInputSetValueAction",function(e,t,a){var n=function(e){a.call(this,e)};return angular.extend(n.prototype,a.prototype),n}]),esgAngularDependencies.push("Actions.textInputDintSetValueAction"),angular.module("Actions.textInputDintSetValueAction",[]).factory("textInputDintSetValueAction",["$log","ESGXmlHelper","TextInputSetValueAction",function(e,t,a){var n=function(e){a.call(this,e)};return angular.extend(n.prototype,a.prototype),n}]),esgAngularDependencies.push("Actions.textInputLintSetValueAction"),angular.module("Actions.textInputLintSetValueAction",[]).factory("textInputLintSetValueAction",["$log","ESGXmlHelper","TextInputSetValueAction",function(e,t,a){var n=function(e){a.call(this,e)};return angular.extend(n.prototype,a.prototype),n}]),esgAngularDependencies.push("Actions.textInputUsintSetValueAction"),angular.module("Actions.textInputUsintSetValueAction",[]).factory("textInputUsintSetValueAction",["$log","ESGXmlHelper","TextInputSetValueAction",function(e,t,a){var n=function(e){a.call(this,e)};return angular.extend(n.prototype,a.prototype),n}]),esgAngularDependencies.push("Actions.textInputUintSetValueAction"),angular.module("Actions.textInputUintSetValueAction",[]).factory("textInputUintSetValueAction",["$log","ESGXmlHelper","TextInputSetValueAction",function(e,t,a){var n=function(e){a.call(this,e)};return angular.extend(n.prototype,a.prototype),n}]),esgAngularDependencies.push("Actions.textInputUdintSetValueAction"),angular.module("Actions.textInputUdintSetValueAction",[]).factory("textInputUdintSetValueAction",["$log","ESGXmlHelper","TextInputSetValueAction",function(e,t,a){var n=function(e){a.call(this,e)};return angular.extend(n.prototype,a.prototype),n}]),esgAngularDependencies.push("Actions.textInputUlintSetValueAction"),angular.module("Actions.textInputUlintSetValueAction",[]).factory("textInputUlintSetValueAction",["$log","ESGXmlHelper","TextInputSetValueAction",function(e,t,a){var n=function(e){a.call(this,e)};return angular.extend(n.prototype,a.prototype),n}]),esgAngularDependencies.push("Actions.textInputRealSetValueAction"),angular.module("Actions.textInputRealSetValueAction",[]).factory("textInputRealSetValueAction",["$log","ESGXmlHelper","TextInputSetValueAction",function(e,t,a){var n=function(e){a.call(this,e)};return angular.extend(n.prototype,a.prototype),n}]),esgAngularDependencies.push("Actions.textInputLrealSetValueAction"),angular.module("Actions.textInputLrealSetValueAction",[]).factory("textInputLrealSetValueAction",["$log","ESGXmlHelper","TextInputSetValueAction",function(e,t,a){var n=function(e){a.call(this,e)};return angular.extend(n.prototype,a.prototype),n}]),esgAngularDependencies.push("Actions.textInputStringSetValueAction"),angular.module("Actions.textInputStringSetValueAction",[]).factory("textInputStringSetValueAction",["$log","ESGXmlHelper","TextInputSetValueAction",function(e,t,a){var n=function(e){a.call(this,e),this.valueType="text"};return angular.extend(n.prototype,a.prototype),n}]),esgAngularDependencies.push("Actions.inputDateSetValueAction"),angular.module("Actions.inputDateSetValueAction",[]).factory("inputDateSetValueAction",["$log","ESGXmlHelper","WebpanelAction","RcWareVisionAPI","EsgDateTimeEditModal","WebpanelData","$timeout","WebpanelVariable",function(e,t,a,r,o,l,n,s){var i=function(e){a.call(this,e),this.event=t.getAttributeNS(e.node,"","event"),this.varRef=t.getAttributeNS(e.node,"","varRef"),l.registerGadgetDp(this.varRef)};return angular.extend(i.prototype,a.prototype),i.prototype.onLeftDown=function(){var n=l.panels[l.actualPanelId].gadgetsMap[this.varRef],i=this;o.open({gadgetValueObj:n,showDate:!0,showTime:!1}).success(function(a){i.confirmAction().success(function(){if(0==n.variableDef.uId&&0==n.variableDef.offset&&0==n.variableDef.length){var e=new Big(a.getTime()).times(1e4).plus("621355968000000000").toFixed(0);r.SetRtc(parseInt(e))}else{var t=new s({variableId:i.varRef,sourceType:l.typeNumToId(parseInt(n.variableDef.type))});t.setValueFromUserHash({ts:(new Date).getTime(),value:a}),r.SendCommand([{varRef:i.varRef,value:t.getHexEncodedValue(),gadget:n,newValue:t}])}})})},i}]),esgAngularDependencies.push("Actions.inputLdateSetValueAction"),angular.module("Actions.inputLdateSetValueAction",[]).factory("inputLdateSetValueAction",["$log","ESGXmlHelper","WebpanelAction","RcWareVisionAPI","EsgDateTimeEditModal","WebpanelData","$timeout","WebpanelVariable",function(e,a,n,r,t,o,i,l){var s=function(e){n.call(this,e),this.event=a.getAttributeNS(e.node,"","event"),this.varRef=a.getAttributeNS(e.node,"","varRef");var t=this.varRef.replace("varRef://","").split("/");o.connectionDefinition.connections[t[0]].variables[t[1]];o.registerGadgetDp(this.varRef)};return angular.extend(s.prototype,n.prototype),s.prototype.onLeftDown=function(){var n=o.panels[o.actualPanelId].gadgetsMap[this.varRef],i=this;t.open({gadgetValueObj:n,showDate:!0,showTime:!1}).success(function(a){i.confirmAction().success(function(){if(0==n.variableDef.uId&&0==n.variableDef.offset&&0==n.variableDef.length){var e=new Big(a.getTime()).times(1e4).plus("621355968000000000").toFixed(0);r.SetRtc(parseInt(e))}else{var t=new l({variableId:i.varRef,sourceType:o.typeNumToId(parseInt(n.variableDef.type))});t.setValueFromUserHash({ts:(new Date).getTime(),value:a}),r.SendCommand([{varRef:i.varRef,value:t.getHexEncodedValue(),gadget:n,newValue:t}])}})})},s}]),esgAngularDependencies.push("Actions.inputTimeSetValueAction"),angular.module("Actions.inputTimeSetValueAction",[]).factory("inputTimeSetValueAction",["$log","ESGXmlHelper","WebpanelAction","RcWareVisionAPI","EsgDateTimeEditModal","WebpanelData","$timeout","WebpanelVariable",function(e,t,a,r,o,l,n,s){var i=function(e){a.call(this,e),this.event=t.getAttributeNS(e.node,"","event"),this.varRef=t.getAttributeNS(e.node,"","varRef"),l.registerGadgetDp(this.varRef)};return angular.extend(i.prototype,a.prototype),i.prototype.onLeftDown=function(){var n=l.panels[l.actualPanelId].gadgetsMap[this.varRef],i=this;o.open({gadgetValueObj:n,showDate:!1,showTime:!0}).success(function(a){i.confirmAction().success(function(){if(0==n.variableDef.uId&&0==n.variableDef.offset&&0==n.variableDef.length){var e=new Big(a.getTime()).times(1e4).plus("621355968000000000").toFixed(0);r.SetRtc(parseInt(e))}else{var t=new s({variableId:i.varRef,sourceType:l.typeNumToId(parseInt(n.variableDef.type))});t.setValueFromUserHash({ts:(new Date).getTime(),value:a}),r.SendCommand([{varRef:i.varRef,value:t.getHexEncodedValue(),gadget:n,newValue:t}])}})})},i}]),esgAngularDependencies.push("Actions.inputLtimeSetValueAction"),angular.module("Actions.inputLtimeSetValueAction",[]).factory("inputLtimeSetValueAction",["$log","ESGXmlHelper","WebpanelAction","RcWareVisionAPI","EsgDateTimeEditModal","WebpanelData","$timeout","WebpanelVariable",function(e,a,n,r,t,o,i,l){var s=function(e){n.call(this,e),this.event=a.getAttributeNS(e.node,"","event"),this.varRef=a.getAttributeNS(e.node,"","varRef");var t=this.varRef.replace("varRef://","").split("/");o.connectionDefinition.connections[t[0]].variables[t[1]];o.registerGadgetDp(this.varRef)};return angular.extend(s.prototype,n.prototype),s.prototype.onLeftDown=function(){var n=o.panels[o.actualPanelId].gadgetsMap[this.varRef],i=this;t.open({gadgetValueObj:n,showDate:!1,showTime:!0}).success(function(a){i.confirmAction().success(function(){if(0==n.variableDef.uId&&0==n.variableDef.offset&&0==n.variableDef.length){var e=new Big(a.getTime()).times(1e4).plus("621355968000000000").toFixed(0);r.SetRtc(parseInt(e))}else{var t=new l({variableId:i.varRef,sourceType:o.typeNumToId(parseInt(n.variableDef.type))});t.setValueFromUserHash({ts:(new Date).getTime(),value:a}),r.SendCommand([{varRef:i.varRef,value:t.getHexEncodedValue(),gadget:n,newValue:t}])}})})},s}]),esgAngularDependencies.push("Actions.inputDtSetValueAction"),angular.module("Actions.inputDtSetValueAction",[]).factory("inputDtSetValueAction",["$log","ESGXmlHelper","WebpanelAction","RcWareVisionAPI","EsgDateTimeEditModal","WebpanelData","$timeout","WebpanelVariable",function(e,t,a,r,o,l,n,s){var i=function(e){a.call(this,e),this.event=t.getAttributeNS(e.node,"","event"),this.varRef=t.getAttributeNS(e.node,"","varRef"),l.registerGadgetDp(this.varRef)};return angular.extend(i.prototype,a.prototype),i.prototype.onLeftDown=function(){var n=l.panels[l.actualPanelId].gadgetsMap[this.varRef],i=this;o.open({gadgetValueObj:n}).success(function(a){i.confirmAction().success(function(){if(0==n.variableDef.uId&&0==n.variableDef.offset&&0==n.variableDef.length){var e=new Big(a.getTime()).times(1e4).plus("621355968000000000").toFixed(0);r.SetRtc(parseInt(e))}else{var t=new s({variableId:i.varRef,sourceType:l.typeNumToId(parseInt(n.variableDef.type))});t.setValueFromUserHash({ts:(new Date).getTime(),value:a}),r.SendCommand([{varRef:i.varRef,value:t.getHexEncodedValue(),gadget:n,newValue:t}])}})})},i}]),esgAngularDependencies.push("Actions.inputLdtSetValueAction"),angular.module("Actions.inputLdtSetValueAction",[]).factory("inputLdtSetValueAction",["$log","ESGXmlHelper","WebpanelAction","RcWareVisionAPI","EsgDateTimeEditModal","WebpanelData","$timeout","WebpanelVariable",function(e,a,n,r,t,o,i,l){var s=function(e){n.call(this,e),this.event=a.getAttributeNS(e.node,"","event"),this.varRef=a.getAttributeNS(e.node,"","varRef");var t=this.varRef.replace("varRef://","").split("/");o.connectionDefinition.connections[t[0]].variables[t[1]];o.registerGadgetDp(this.varRef)};return angular.extend(s.prototype,n.prototype),s.prototype.onLeftDown=function(){var n=o.panels[o.actualPanelId].gadgetsMap[this.varRef],i=this;t.open({gadgetValueObj:n}).success(function(a){i.confirmAction().success(function(){if(0==n.variableDef.uId&&0==n.variableDef.offset&&0==n.variableDef.length){var e=new Big(a.getTime()).times(1e4).plus("621355968000000000").toFixed(0);r.SetRtc(parseInt(e))}else{var t=new l({variableId:i.varRef,sourceType:o.typeNumToId(parseInt(n.variableDef.type))});t.setValueFromUserHash({ts:(new Date).getTime(),value:a}),r.SendCommand([{varRef:i.varRef,value:t.getHexEncodedValue(),gadget:n,newValue:t}])}})})},s}]),esgAngularDependencies.push("Actions.inputTodSetValueAction"),angular.module("Actions.inputTodSetValueAction",[]).factory("inputTodSetValueAction",["$log","ESGXmlHelper","WebpanelAction","RcWareVisionAPI","EsgDateTimeEditModal","WebpanelData","$timeout","WebpanelVariable",function(e,t,a,r,o,l,n,s){var i=function(e){a.call(this,e),this.event=t.getAttributeNS(e.node,"","event"),this.varRef=t.getAttributeNS(e.node,"","varRef"),l.registerGadgetDp(this.varRef)};return angular.extend(i.prototype,a.prototype),i.prototype.onLeftDown=function(){var n=l.panels[l.actualPanelId].gadgetsMap[this.varRef],i=this;o.open({gadgetValueObj:n,showDate:!1,showTime:!0,valueType:"timespan"}).success(function(a){i.confirmAction().success(function(){if(0==n.variableDef.uId&&0==n.variableDef.offset&&0==n.variableDef.length){var e=new Big(a.getTime()).times(1e4).plus("621355968000000000").toFixed(0);r.SetRtc(parseInt(e))}else{var t=new s({variableId:i.varRef,sourceType:l.typeNumToId(parseInt(n.variableDef.type))});t.setValueFromUserHash({ts:(new Date).getTime(),value:a}),r.SendCommand([{varRef:i.varRef,value:t.getHexEncodedValue(),gadget:n,newValue:t}])}})})},i}]),esgAngularDependencies.push("Actions.inputLtodSetValueAction"),angular.module("Actions.inputLtodSetValueAction",[]).factory("inputLtodSetValueAction",["$log","ESGXmlHelper","WebpanelAction","RcWareVisionAPI","EsgDateTimeEditModal","WebpanelData","$timeout","WebpanelVariable",function(e,a,n,r,t,o,i,l){var s=function(e){n.call(this,e),this.event=a.getAttributeNS(e.node,"","event"),this.varRef=a.getAttributeNS(e.node,"","varRef");var t=this.varRef.replace("varRef://","").split("/");o.connectionDefinition.connections[t[0]].variables[t[1]];o.registerGadgetDp(this.varRef)};return angular.extend(s.prototype,n.prototype),s.prototype.onLeftDown=function(){var n=o.panels[o.actualPanelId].gadgetsMap[this.varRef],i=this;t.open({gadgetValueObj:n,showDate:!1,showTime:!0}).success(function(a){i.confirmAction().success(function(){if(0==n.variableDef.uId&&0==n.variableDef.offset&&0==n.variableDef.length){var e=new Big(a.getTime()).times(1e4).plus("621355968000000000").toFixed(0);r.SetRtc(parseInt(e))}else{var t=new l({variableId:i.varRef,sourceType:o.typeNumToId(parseInt(n.variableDef.type))});t.setValueFromUserHash({ts:(new Date).getTime(),value:a}),r.SendCommand([{varRef:i.varRef,value:t.getHexEncodedValue(),gadget:n,newValue:t}])}})})},s}]),esgAngularDependencies.push("Actions.setMaskAction"),angular.module("Actions.setMaskAction",[]).factory("setMaskAction",["$log","ESGXmlHelper","WebpanelAction","RcWareVisionAPI","WebpanelData","WebpanelVariable",function(e,t,a,l,s,u){var n=function(e){a.call(this,e),this.event=t.getAttributeNS(e.node,"","event"),this.varRef=t.getAttributeNS(e.node,"","varRef"),s.registerGadgetDp(this.varRef),this.andMask=t.getAttributeNS(e.node,"","andMask"),this.nopMask=t.getAttributeNS(e.node,"","nopMask"),this.varType=t.getAttributeNS(e.node,"","varType")};return angular.extend(n.prototype,a.prototype),n.prototype.onLeftDown=function(){var e=s.panels[s.actualPanelId].gadgetsMap[this.varRef],t=bigInt(e.value.value.toString()),a=bigInt(this.andMask),n=bigInt(this.nopMask),i=new Big(a.or(t.and(n))),r=new u({variableId:this.varRef,sourceType:s.typeNumToId(parseInt(e.variableDef.type))});r.setValueFromUserHash({ts:(new Date).getTime(),value:i});var o=this.varRef;this.confirmAction().success(function(){l.SendCommand([{varRef:o,value:r.getHexEncodedValue(),gadget:e,newValue:r}])})},n}]),esgAngularDependencies.push("Actions.alarmPointSetValueAction"),angular.module("Actions.alarmPointSetValueAction",[]).factory("alarmPointSetValueAction",["$log","ESGXmlHelper","WebpanelAction","RcWareVisionAPI","WebpanelData","WebpanelVariable",function(e,t,a,n,i,r){var o=function(e){a.call(this,e),this.event=t.getAttributeNS(e.node,"","event"),this.varRef=t.getAttributeNS(e.node,"","varRef"),i.registerGadgetDp(this.varRef),this.value=t.getAttributeNS(e.node,"","value")};return angular.extend(o.prototype,a.prototype),o.prototype.onLeftDown=function(){var e=i.panels[i.actualPanelId].gadgetsMap[this.varRef];i.sendAlarmValue(this.varRef,this.value,e,this)},o}]),esgAngularDependencies.push("Actions.openUrlAction"),angular.module("Actions.openUrlAction",[]).factory("openUrlAction",["$log","ESGXmlHelper","$location","$timeout","WebpanelData","WebpanelAction",function(e,t,a,n,i,r){return function(e){r.call(this,e),this.event=t.getAttributeNS(e.node,"","event"),this.url=t.getAttributeNS(e.node,"","url"),this.target=t.getAttributeNS(e.node,"","target"),this.onLeftDown=function(){var e=this.url;window.open(e,this.target)}}}]),esgAngularDependencies.push("Model.ConnectionProfile"),angular.module("Model.ConnectionProfile",[]).factory("ModelConnectionProfile",["$log","ESGXmlHelper","WebpanelData",function(e,i,t){return function(n){var e=i.getXPathResultSingleNode(n.node,"/hmi:connectionProfile",n.nsResolver,n.xmlDoc),t=i.getXPathResult(e,"hmi:connections/hmi:*",n.nsResolver,n.xmlDoc);this.connections={},angular.forEach(t,function(e){var a={variables:{}};a.name=i.getAttributeNS(e,"","name");var t=i.getXPathResult(e,"hmi:variables/hmi:*",n.nsResolver,n.xmlDoc);angular.forEach(t,function(e){var t={};t.name=i.getAttributeNS(e,"","name"),t.uId=i.getAttributeNS(e,"","uId"),t.length=parseInt(i.getAttributeNS(e,"","length")),t.offset=parseInt(i.getAttributeNS(e,"","offset")),t.type=i.getAttributeNS(e,"","type"),(t.connection=a).variables[t.name]=t}),this.connections[a.name]=a},this)}}]),esgAngularDependencies.push("Model.SwitchState"),angular.module("Model.SwitchState",[]).factory("SwitchState",["$log","ESGXmlHelper","WebpanelData","$injector",function(e,t,n,a){return function(a){this.state=t.getAttributeNS(a.node,"","state");var e=t.getXPathResult(a.node,"hmi:content/hmi:*",a.nsResolver,a.xmlDoc);this.content=[],angular.forEach(e,function(e){var t=n.parseGadget(e,a.xmlDoc,a.parentType,a.panelId);null!=t&&this.content.push(t)},this)}}]),esgAngularDependencies.push("Model.UserGroups"),angular.module("Model.UserGroups",[]).factory("ModelUserGroups",["$log","ESGXmlHelper","ModelHmiUser","WebpanelData",function(e,n,i,a){var t=function(a){var e=n.getXPathResultSingleNode(a.node,"/hmi:userGroups",a.nsResolver,a.xmlDoc),t=n.getXPathResult(e,"hmi:user",a.nsResolver,a.xmlDoc);this.users=[],this.usersMap={},this.defaultUser=null,angular.forEach(t,function(e){var t=new i({node:e,nsResolver:a.nsResolver,xmlDoc:a.xmlDoc});t.isDefault&&(this.defaultUser=t),this.users.push(t),this.usersMap[t.name]=t},this)};t.prototype.getUserByName=function(e){return this.usersMap[e]};return t.prototype.hashPassword=function(e,t){return a.hashPassword(e,t)},t}]).factory("ModelHmiUser",["$log","ESGXmlHelper",function(e,t){var a=function(e){this.name=e.name,this.password=e.password,this.isDefault=e.isDefault};return a.prototype.readPanelPermission=function(e){return-1!=this.rGroups.indexOf("All")||-1!=this.rwGroups.indexOf("All")||(-1!=this.rGroups.indexOf(e)||-1!=this.rwGroups.indexOf(e))},a.prototype.writePanelPermission=function(e){return-1!=this.rwGroups.indexOf("All")||-1!=this.rwGroups.indexOf(e)},a.prototype.writePanelPermission=function(e){return-1!=this.rwGroups.indexOf("All")||-1!=this.rwGroups.indexOf(e)},a}]),esgAngularDependencies.push("WebpanelVariableValue"),angular.module("WebpanelVariableValue",[]).factory("WebpanelVariable",["$log","WebpanelVariableType","EsgTimeSpan",function(e,t,a){var V=function(e){void 0!==e.variableId&&null!=e.variableId&&""!=e.variableId&&angular.extend(this,{variableId:null,value:null,sourceType:null,valueToString:"vvv",quality:null,ts:null,updateCounter:0},e)};V.prototype.typeNumToId=function(e){return t.typeNumToId(e)},V.parseIntFromHex=function(e){return parseInt(e,16)},V.encodeIntToHex=function(e,t){return void 0!==t&&null!=t||(t=4),(e+Math.pow(16,t)).toString(16).slice(-t).toUpperCase()},V.encodeBigIntToHex=function(e,t){void 0!==t&&null!=t||(t=4);for(var a="",n=new Big(e.toFixed(0));-1<n.cmp(1);)a=V.encodeIntToHex(parseInt(n.mod(256)),2)+a,n=n.div(256);for(;a.length<t;)a="0"+a;return a},V.parseIntFromHexWithSignMask=function(e,t){var a=V.parseIntFromHex(e);return a&t&&(a=-(a=t-(a&=~t))),a},V.encode32BitToIEEE754=function(e){var t,a,n,i,r,o=(c=+e)!=c||c==-1/0||c==1/0?c:0,l=0,s=new Array(281),u=(c=0!==o?0:c)<0,c=Math.abs(c),d=Math.floor(c),p=c-d;if(0!==o){if(c!=c)return 2143289344;if(c===1/0)return 2139095040;if(c===-1/0)return 4286578688}for(t=281;t;)s[--t]=0;for(t=129;d&&t;)s[--t]=d%2,d=Math.floor(d/2);for(t=128;0<p&&t;)(s[++t]=(1<=(p*=2))-0)&&--p;for(t=-1;++t<281&&!s[t];);if(s[(a=22+(t=-126<=(l=128-t)&&l<=127?t+1:128-(l=-127)))+1]){if(!(n=s[a]))for(i=a+2;!n&&i<281;)n=s[i++];for(i=a+1;n&&0<=--i;)(s[i]=!s[i]-0)&&(n=0)}for(t=t-2<0?-1:t-3;++t<281&&!s[t];);for(-126<=(l=128-t)&&l<=127?++t:l<-126&&(t=255,l=-127),(d||0!==o)&&(l=128,t=129,o==-1/0?u=1:o!=o&&(s[t]=1)),c=Math.abs(l+127),i=r=0;i<8;)r+=c%2<<i,c>>=1,i++;var g=0;for(c=t+23;t<c;t++)g=(g<<1)+s[t];return V.encodeIntToHex((u?2147483648:0)+(r<<23)+g|0,8)},V.encode64BitToIEEE754=function(e){var t,a,n;if(isNaN(e))a=2047,n=1,t=0;else if(e===1/0)a=2047,t=n=0;else if(e===-1/0)a=2047,n=0,t=1;else if(0===e&&1/e==-1/0)n=a=0,t=1;else if(0===e)t=n=a=0;else{e<0?(t=1,e=Math.abs(e)):t=0;var i=Math.floor(Math.log(e)/Math.log(2));n=-1022<i?(a=i+1023,4503599627370496*(e/Math.pow(2,i)-1)):(a=0,e/Math.pow(2,-1022)*4503599627370496)}return V.encodeIntToHex((1&t)<<7|a>>4&127,2)+V.encodeIntToHex((15&a)<<4|n/Math.pow(2,48)&15,2)+V.encodeIntToHex(n/Math.pow(2,40)&255,2)+V.encodeIntToHex(n/Math.pow(2,32)&255,2)+V.encodeIntToHex(n/Math.pow(2,24)&255,2)+V.encodeIntToHex(n/Math.pow(2,16)&255,2)+V.encodeIntToHex(n/Math.pow(2,8)&255,2)+V.encodeIntToHex(255&n,2)},V.encodeToHex=function(e,t){var a=0;switch(t){case"sint":case"usint":case"byte":a=8;break;case"int":case"uint":case"word":a=16;break;case"dint":case"udint":case"dword":a=32;break;case"lint":case"ulint":case"lword":a=64}switch(t){case"sint":case"int":case"dint":case"lint":var n=new Big("2").pow(a);if(!(e.cmp(n.div(2).minus(1))<1&&0<=e.cmp(n.div(2).times(-1))))throw __("Value is out of range.");return-1==e.cmp(0)?V.encodeBigIntToHex(e.plus(n),a/4):V.encodeBigIntToHex(e,a/4);case"usint":case"byte":case"uint":case"word":case"udint":case"dword":case"ulint":case"lword":n=new Big("2").pow(a);if(!(-1==e.cmp(n)&&0<=e.cmp(0)))throw __("Value is out of range.");return V.encodeBigIntToHex(e,a/4);case"real":return V.encode32BitToIEEE754(parseFloat(e.toString()));case"lreal":return V.encode64BitToIEEE754(parseFloat(e.toString()));case"string":for(var i="",r=0,o=e.length;r<o;r++)i+=V.encodeIntToHex(e.charCodeAt(r),4);return i;case"bool":return e?"01":"00";case"System.Boolean":return String(e);case"dt":case"tod":case"date":var l=new Big(e.getTime()),s=new Big(621355968e5);return l=l.plus(s),V.encodeBigIntToHex(l.times(1e4),16);case"time":l=new Big(e.getTime());return V.encodeBigIntToHex(l.times(1e4),16);case"ldt":case"ltod":case"ldate":case"ltime":l=new Big(e.getTime());return V.encodeBigIntToHex(l.times(1e6),16);case"t17_boolean_scheduler.TpgValue":var u="";return angular.forEach(e,function(e,t){u+=V.encodeToHex(new Big(e.timeMinutes),"uint"),u+=V.encodeToHex(e.value,"bool"),u+="00"}),u;case"t17_boolean_scheduler.Exceptions":var c="";return angular.forEach(e,function(e,t){255==e.timeYearFrom&&(e.timeYearFrom=2255),255==e.timeYearTo&&(e.timeYearTo=2255),c+=V.encodeToHex(new Big(e.timeYearFrom-2e3),"udint").substr(-2),c+=V.encodeToHex(new Big(e.timeMinutesFrom),"udint").substr(-6),c+=V.encodeToHex(new Big(e.timeYearTo-2e3),"udint").substr(-2),c+=V.encodeToHex(new Big(e.timeMinutesTo),"udint").substr(-6),c+=V.encodeToHex(e.value,"bool"),c+="000000"}),c;case"t18_real_scheduler.TpgValue":u="";return angular.forEach(e,function(e,t){u+=V.encodeToHex(new Big(e.timeMinutes),"uint"),u+="0000",null==e.value?u+="FFFF0000":"0.000000"==e.value.toFixed(6)?u+="00000000":u+=V.encodeToHex(e.value,"real")}),u;case"t18_real_scheduler.Exceptions":c="";return angular.forEach(e,function(e,t){255!=e.timeYearFrom?c+=V.encodeToHex(new Big(e.timeYearFrom-2e3),"udint").substr(-2):c+=V.encodeToHex(new Big(e.timeYearFrom),"udint").substr(-2),c+=V.encodeToHex(new Big(e.timeMinutesFrom),"udint").substr(-6),255!=e.timeYearTo?c+=V.encodeToHex(new Big(e.timeYearTo-2e3),"udint").substr(-2):c+=V.encodeToHex(new Big(e.timeYearTo),"udint").substr(-2),c+=V.encodeToHex(new Big(e.timeMinutesTo),"udint").substr(-6),null==e.value?c+="00000000":c+=V.encodeToHex(e.value,"real")}),c;case"t19_int_scheduler.TpgValue":u="";return angular.forEach(e,function(e,t){u+=V.encodeToHex(new Big(e.timeMinutes),"uint"),u+=V.encodeToHex(e.value,"uint")}),u;case"t19_int_scheduler.Exceptions":c="";return angular.forEach(e,function(e,t){255==e.timeYearFrom&&(e.timeYearFrom=2255),255==e.timeYearTo&&(e.timeYearTo=2255),c+=V.encodeToHex(new Big(e.timeYearFrom-2e3),"udint").substr(-2),c+=V.encodeToHex(new Big(e.timeMinutesFrom),"udint").substr(-6),c+=V.encodeToHex(new Big(e.timeYearTo-2e3),"udint").substr(-2),c+=V.encodeToHex(new Big(e.timeMinutesTo),"udint").substr(-6),c+=V.encodeToHex(e.value,"uint"),c+="0000"}),c}return String(e)},V.parseStringFromHex=function(e){for(var t="",a=0;a<e.length;a+=4){if("0000"==e.substr(a,4))return t;t+=String.fromCharCode(V.parseIntFromHex(e.substr(a,4)))}return t};V.isFloatNaN=function(e){var t=4286578688&e;return 2139095040==t||-8388608==t};V.isDoubleNaN=function(e){var t=2146435072&e;return 2146435072==t||2146435072==t},V.parseRealFromHex=function(e){if("7F800000"==e)return 1/0;if("FF800000"==e)return-1/0;var t=V.parseIntFromHex(e);if(V.isFloatNaN(t))return NaN;var a=1;return 0!=(2147483648&t)&&(a=-1),new Big(1*(8388607&t|8388608)/Math.pow(2,23)*Math.pow(2,(t>>23&255)-127)*a)},V.prototype.getHexEncodedValue=function(){return V.encodeToHex(this.value,this.sourceType)},V.prototype.setValueFromUserHash=function(e){this.value=e.value,this.ts=e.ts},V.prototype.setValueFromPlcHash=function(e){this.ts=parseInt(e.ts),this.updateCounter++,this.value=n(e,this.sourceType)};var n=function(e,t){var a=null;switch(t){case"bool":a=0!=V.parseIntFromHexWithSignMask(e.value,128);break;case"sint":a=new Big(V.parseIntFromHexWithSignMask(e.value,128));break;case"int":a=new Big(V.parseIntFromHexWithSignMask(e.value,32768));break;case"dint":a=new Big(V.parseIntFromHexWithSignMask(e.value,2147483648));break;case"lint":if(128&(s=V.parseIntFromHex(e.value.substring(0,2)))){var n=e.value;n=(s&=-129).toString(16)+e.value.substring(2);var i=Big.parseFromHex(n);a=(a=new Big("9223372036854775808").minus(i)).times(-1)}else a=Big.parseFromHex(e.value);break;case"usint":case"byte":case"uint":case"word":case"udint":case"dword":case"ulint":case"lword":a=Big.parseFromHex(e.value);break;case"real":a=V.parseRealFromHex(e.value);break;case"lreal":if("7FF0000000000000"==e.value)a=1/0;else if("FFF0000000000000"==e.value)a=-1/0;else{var r=V.parseIntFromHex(e.value.substr(0,8));if(V.isDoubleNaN(r))a=NaN;else{var o=V.parseIntFromHex(e.value.substr(8)),l=(r>>20&2047)-1023,s=1;0!=(2147483648&r)&&(s=-1),a=new Big((1*(1048575&r|1048576)/Math.pow(2,20)*Math.pow(2,l)+1*o/Math.pow(2,52)*Math.pow(2,l))*s)}}break;case"string":a=V.parseStringFromHex(e.value);break;case"ltime":s=V.parseIntFromHex(e.value.substring(0,2));var u=Big.parseFromHex(e.value);if(128&s){n=e.value;n=(s&=-129).toString(16)+e.value.substring(2);i=Big.parseFromHex(n);u=(u=new Big("9223372036854775808").minus(i)).times(-1)}u=u.div(1e6),a=new Date(parseInt(u.toString()));break;case"time":s=V.parseIntFromHex(e.value.substring(0,2)),u=Big.parseFromHex(e.value);if(128&s){n=e.value;n=(s&=-129).toString(16)+e.value.substring(2);i=Big.parseFromHex(n);u=(u=new Big("9223372036854775808").minus(i)).times(-1)}u=u.div(1e4),a=new Date(parseInt(u.toString()));break;case"date":i=(i=Big.parseFromHex(e.value)).div(1e4),a=new Date(parseInt(i.toString())-621355968e5);break;case"ldate":i=(i=Big.parseFromHex(e.value)).div(1e6),a=new Date(parseInt(i.toString()));break;case"tod":i=(i=Big.parseFromHex(e.value)).div(1e4),a=new Date(parseInt(i.toString())-621355968e5);break;case"ltod":i=(i=Big.parseFromHex(e.value)).div(1e6),a=new Date(parseInt(i.toString()));break;case"dt":i=(i=Big.parseFromHex(e.value)).div(1e4),a=new Date(parseInt(i.toString())-621355968e5);break;case"ldt":i=(i=Big.parseFromHex(e.value)).div(1e6),a=new Date(parseInt(i.toString()));break;case"t17_boolean_scheduler.TpgValue":case"t18_real_scheduler.TpgValue":case"t19_int_scheduler.TpgValue":var c=[],d=e.value,p=2;switch(t){case"t19_int_scheduler.TpgValue":p=8;break;case"t18_real_scheduler.TpgValue":p=16;break;case"t17_boolean_scheduler.TpgValue":p=8}for(var g=0;g<42;g++){var h=d.substr(p*g,p),f=V.parseIntFromHex(h.substr(0,4));a=null;switch(t){case"t19_int_scheduler.TpgValue":a=Big.parseFromHex(h.substr(4,4));break;case"t18_real_scheduler.TpgValue":a=V.parseRealFromHex(h.substr(8,8)),0==isNaN(a)&&(a=new Big(a.toFixed(6)));break;case"t17_boolean_scheduler.TpgValue":a=0!=parseInt(h.substr(4,2))}f<10080&&c.push(new TpgItemValue({timeMinutes:f,value:a}))}a={items:c,limit:d.length/p};break;case"t17_boolean_scheduler.Exceptions":case"t18_real_scheduler.Exceptions":case"t19_int_scheduler.Exceptions":var m=[],v=e.value,x=480;switch(t){case"t19_int_scheduler.Exceptions":x=480;break;case"t18_real_scheduler.Exceptions":x=784;break;case"t17_boolean_schedule.Exceptions":x=448}for(g=0;g<10;g++){h=v.substr(24*g,24);var b=V.parseIntFromHex(h.substr(0,2))+2e3,S=V.parseIntFromHex(h.substr(2,6)),y=V.parseIntFromHex(h.substr(8,2))+2e3,w=V.parseIntFromHex(h.substr(10,6));2255==b&&(b=255),2255==y&&(y=255);a=null;switch(t){case"t19_int_scheduler.Exceptions":a=Big.parseFromHex(h.substr(16,4));break;case"t18_real_scheduler.Exceptions":a=V.parseRealFromHex(h.substr(16,8)),a=new Big(a.toFixed(6));break;case"t17_boolean_scheduler.Exceptions":a=0!=parseInt(h.substr(16,2))}2e3==b&&0==S||m.push(new TpgExceptionValue({timeYearFrom:b,timeMinutesFrom:S,timeYearTo:y,timeMinutesTo:w,value:a}))}a={items:m,limit:v.length/24};break;case"t19_int_scheduler":case"t18_real_scheduler":case"t17_boolean_scheduler":var D={items:[],exceptions:[]},A=(d=e.value,20);x=480,p=2;switch(t){case"t19_int_scheduler":p=8;break;case"t18_real_scheduler":p=16,A=24,x=784;break;case"t17_boolean_scheduler":p=8,x=448}for(g=0;g<42;g++){h=d.substr(A+p*g,p),f=V.parseIntFromHex(h.substr(0,4)),a=null;switch(t){case"t19_int_scheduler":a=Big.parseFromHex(h.substr(4,4));break;case"t18_real_scheduler":a=V.parseRealFromHex(h.substr(8,8)),a=new Big(a.toFixed(6));break;case"t17_boolean_scheduler":a=0!=parseInt(h.substr(4,2))}f<10080&&D.items.push(new TpgItemValue({timeMinutes:f,value:a}))}for(v=d.substr(x,240),g=0;g<10;g++){h=v.substr(24*g,24),b=V.parseIntFromHex(h.substr(0,2))+2e3,S=V.parseIntFromHex(h.substr(2,6)),y=V.parseIntFromHex(h.substr(8,2))+2e3,w=V.parseIntFromHex(h.substr(10,6));2255==b&&(b=255),2255==y&&(y=255);a=null;switch(t){case"t19_int_scheduler":a=Big.parseFromHex(h.substr(16,4));break;case"t18_real_scheduler":a=V.parseRealFromHex(h.substr(16,8));break;case"t17_boolean_scheduler":a=0!=parseInt(h.substr(16,2))}2e3==b&&0==S||D.exceptions.push(new TpgExceptionValue({timeYearFrom:b,timeMinutesFrom:S,timeYearTo:y,timeMinutesTo:w,value:a}))}a=D;break;case"System.DateTime":a=new Date(parseInt(e.value));break;case"System.Double":a=parseFloat(e.value);break;case"System.String":a=e.value;break;case"System.Int64":a=parseInt(e.value);break;case"System.Boolean":switch(e.value){case"0":case"false":a=!1;break;default:a=!0}break;case"ESG.EvaluationEngine.FBD.Variables.AlarmState":a=parseFloat(e.value)}return a};return V}]),esgAngularDependencies.push("RcWareVisionTaskBar.Directives"),angular.module("RcWareVisionTaskBar.Directives",[]).directive("rcWareVisionProjectProgressBarWrapper",["$log","ApiWinResize","EsgTaskBar",function(e,t,i){return{transclude:!1,templateUrl:"html/templates/modules/taskBar/taskBar.progressBarWrapperTemplate.html",replace:!1,restrict:"E",scope:{project:"=",selectedDataPoints:"="},link:function(e,t,a,n){return e.EsgTaskBar=i,["$scope","iElement","iAttrs","contoller",function(e,t,a,n){}]},controller:["$scope",function(e){}]}}]).directive("progressBarElement",["$log","$timeout",function(e,t){return{transclude:!1,templateUrl:"html/templates/modules/taskBar/taskBar.progressBarElementTemplate.html",replace:!0,restrict:"E",scope:{barData:"="},link:function(t,a,e,n){return t.terminateTask=function(){t.barData.terminateAction()},t.showTaskTermination=function(){return t.barData.shouldBeTerminated&&100!=t.barData.value},t.progress={},t.progress.display=t.barData.getProgressRound(),t.$watch("barData.error",function(e){1==e&&($(a[0].children[1]).text("error"),$(a[0].children[1]).addClass("bar-error"),t.barData.shouldBeTerminated=!1)}),t.$watch("barData.terminate",function(e){1==e&&($(a[0].children[1]).text("closing task"),$(a[0].children[1]).addClass("bar-error"))}),t.$watch("barData.progress",function(e){void 0!==e&&100==e&&(t.barData.shouldBeTerminated=!1)}),["$scope","iElement","iAttrs","contoller",function(e,t,a,n){}]},controller:["$scope",function(e){}]}}]).directive("rcWareVisionProjectProgressBarShortWrapper",["$log","ApiWinResize","EsgTaskBar",function(e,t,i){return{transclude:!1,templateUrl:"html/templates/modules/taskBar/taskBar.progressBarShortWrapperTemplate.html",replace:!1,restrict:"E",scope:{},link:function(a,e,t,n){return a.EsgTaskBar=i,a.$watch("EsgTaskBar.progressBars.length",function(e,t){a.activeBar=null!=e&&0<e?a.EsgTaskBar.progressBars[0]:null}),["$scope","iElement","iAttrs","contoller",function(e,t,a,n){}]},controller:["$scope",function(e){e.activeBar=null}]}}]).directive("progressBarShortElement",["$log","$timeout",function(e,t){return{transclude:!1,templateUrl:"html/templates/modules/taskBar/taskBar.progressBarShortElementTemplate.html",replace:!0,restrict:"E",scope:{barData:"="},link:function(a,e,t,n){return a.$watch("barData.progress",function(e,t){null!=e&&1!=a.barData.disablePercent?a.myStyle={width:e+"%"}:a.myStyle={width:"100%"}}),["$scope","iElement","iAttrs","contoller",function(e,t,a,n){}]},controller:["$scope",function(a){a.$watch("barData.title",function(e,t){null!=a.barData&&(1!=a.barData.disablePercent?a.myStyle={width:"0%"}:a.myStyle={width:"100%"})})}]}}]),esgAngularDependencies.push("RcWareVisionTaskBar.Services"),angular.module("RcWareVisionTaskBar.Services",[]).service("EsgTaskBar",["$log","$timeout",function(e,n){var i={progressBars:[],removeBar:function(e){var t=i.progressBars.indexOf(e);0<=t&&0<i.progressBars[t].subBars.length&&i.progressBars[t].subBars.splice(),0<=t?i.progressBars.splice(t,1):null!=e&&null!=e.parent&&e.parent.subBars.splice(e.parent.subBars.indexOf(e),1)},registerTaskBar:function(e,t,a){return void 0===t&&(t=!1),i.progressBars.push(new r({title:e,progress:0,subBars:[],parent:null,shouldBeTerminated:t})),i.progressBars[i.progressBars.length-1]}},r=function(e){this.title=e.title,this.progress=e.progress,this.error=!1,this.created=new Date,this.parent=e.parent,this.update=function(){},this.subBars=[],this.terminate=!1,this.shouldBeTerminated=e.shouldBeTerminated,this.parentPart=e.parentPart,this.disablePercent=!1};return(i.RcWareVisionProgressBar=r).prototype.terminateAction=function(){this.terminate=!0,this.shouldBeTerminated=!1,angular.forEach(this.subBars,function(e){e.terminate=!0,e.shouldBeTerminated=!1})},r.prototype.setError=function(e){this.error=!0;var t=this;if(void 0!==e)n(function(){if(i.removeBar(t),null!=t.parent){var e=t.parentPart;void 0===e&&(e=1/t.parent.subBars.length),t.parent.progress+=100*e}},e);else if(null!=this.parent){var a=this.parentPart;void 0===a&&(a=1/this.parent.subBars.length),this.parent.progress+=100*a}},r.prototype.setProgress=function(e,t){var a=0;if(t?(this.progress+=e,a=e):(a=e-this.progress,this.progress=e),null!=this.parent){var n=this.parentPart;void 0===n&&(n=1/this.parent.subBars.length),this.parent.progress+=a*n}},r.prototype.getProgress=function(){return this.progress},r.prototype.getProgressRound=function(){return Math.floor(this.progress)},r.prototype.registerSubTask=function(e,t,a){if(void 0===t)t=!1;return this.subBars.push(new r({title:e,progress:0,subBars:[],parent:this,shouldBeTerminated:t,parentPart:a})),this.subBars[this.subBars.length-1]},i}]),esgAngularDependencies.push("RcWareVisionSlider"),angular.module("RcWareVisionSlider",[]).directive("esgSlider",["$log","$compile",function(e,t){return{transclude:!1,templateUrl:"html/templates/sliderTemplate.html",replace:!0,restrict:"E",scope:{sliderValue:"=",min:"=",max:"=",step:"=",translate:"&"},link:function(i,e,t){return i.sliderPoint=$(e).find(".pointer")[0],i.sliderPointWidth=i.sliderPoint.offsetWidth,i.element=$(e).find(".bar")[0],i.sliderElement=$(e).find(".slider")[0],i.elementLeft=i.element.getBoundingClientRect().left,i.newPosition=null,i.start=function(e){return i.isActive=!0,i.$digest(),e.preventDefault(),!1},i.roundValue=function(e){var t=i.max-i.min;if(t<3){var a=Math.abs(Math.log10(t)),n=Math.pow(10,Math.ceil(a));return Math.round(e*n)/n}return Math.round(e)},i.move=function(e){if(i.isActive){void 0===e.clientX&&(e=e.originalEvent);var t=e.pageX-i.elementLeft;i.newPosition=t;var a=(i.max-i.min)*(t/i.element.offsetWidth)+i.min,n=i.roundValue(a);n>=i.min&&n<=i.max&&i.$apply(function(){i.sliderValue=new Big(n)})}},i.end=function(e){if(i.isActive){var t;t=void 0===e.clientX?(e=e.originalEvent,i.newPosition):e.pageX-i.elementLeft-i.sliderPointWidth/2;var a=i.roundValue((i.max-i.min)*(t/i.element.offsetWidth)+i.min);a>=i.min&&a<=i.max&&i.$apply(function(){i.sliderValue=new Big(a)})}i.isActive=!1,i.$digest()},$(i.sliderPoint).bind("mousedown",i.start),$(document).bind("mousemove",i.move),$(document).bind("mouseup",i.end),$(i.sliderElement).bind("click",function(e){i.isActive=!0,i.end(e)}),$(i.sliderPoint).bind("touchstart",i.start),$(document).bind("touchmove",i.move),$(i.sliderPoint).bind("touchend",i.end),["$scope","iElement","iAttrs","controller",function(e,t,a,n){}]},controller:["$scope",function(i){i.isActive=!1,i.pointerStyles={"margin-left":0},i.min=parseFloat(i.min),i.max=parseFloat(i.max),i.pointerPosition=function(e){if(e>=i.min&&e<=i.max){var t=(e-i.min)/(i.max-i.min)*100;t-=i.sliderPointWidth/2/i.element.offsetWidth*100,i.pointerStyles["margin-left"]=t+"%"}},i.$watch("sliderValue",function(e,t){if(void 0!==e){var a=parseFloat(e);if("function"==typeof e.toString&&"function"==typeof e.toFixed){var n=e.toString();-1<n.indexOf("e-")&&(n=e.toFixed(0)),a=parseFloat(n)}i.pointerPosition(a)}})}]}}]),angular.module("AngularJSTabbedGraph",["I18nService"]).directive("tabbedGraph",["$log","$compile","$filter","$window","$timeout","I18nService","ESGGraphHelper","ESGCountBarGraphData","ESGCountModuloCarpetGraphData","ESGVisionConfig",function(h,e,S,t,c,y,E,n,o,r){return{transclude:!1,template:'<div class="graph-container" ng-style="wrapperStyle" style="position: relative;">                       <div class="chart" ng-style="graphStyle"></div>                       <div class="charttip" ng-show="showToolTip" ng-style="toolStyle.window">                         <div ng-if="xaxisMode == \'time\'"><span esg-i18n="Date"></span>: {{content.name}}<br /><span esg-i18n="Value"></span>: {{content.value}}<br /><span esg-i18n="Data point"></span>: {{content.dp}}</div>                         <div ng-if="xaxisMode != \'time\'"><span esg-i18n="x"></span>: {{content.name}}<br /><span esg-i18n="y"></span>: {{content.value}}</div>                       </div> \t\t\t\t\t\t\t\t\t\t\t<tool-tip-container graph-data="graphData"\tpos="latestPosition" plot="plot" settings="additionalSettings" graph-options="drawedGraphOptions" redraw-executed="redrawExecuted"></tool-tip-container> \t\t\t\t\t\t\t\t\t\t</div>',replace:!0,restrict:"EA",scope:{graphData:"=",graphWidth:"=",graphHeight:"=",graphOptions:"=",graphStyle:"=",enableTooltip:"=graphEnableTooltip",graphStringDictionary:"=",graphTooltipStyle:"=graphTooltipStyle",graphCommands:"=graphCommands",additionalSettings:"="},compile:function(e,t){return function(V,e,t){V.redrawExecuted=!1,V.graphElement=e,V.toolTipContainerElement=V.graphElement.find(".tool-tip-container"),V.wrapperStyle={position:"absolute;"};var T=null,I=e.find(".chart"),x=e.find(".charttip"),i=null,r=null;function g(e,t){if(void 0===e&&(e=V.graphData),!V.userIsSelecting&&(void 0===t&&(t=!0),$.extend(!0,V.toolStyle,V.defaultToolStyle,V.graphTooltipStyle),V.checkIfCarpetSerieSelected(),V.checkIfModuloCarpetSerieSelected(),angular.forEach(e,function(e){angular.isDefined(E.hiddenSeries[e.idx])?(e.lines.show=!1,e.points.show=!1):(e.lines.show=V.optionsGraphLines(),e.points.show=V.optionsGraphPoints())}),V.graphOptions.grid.plothoverGetItem=!0,0!==I.height()&&0!==I.width())){if(void 0!==e&&0==e.length){var a=M();angular.isDefined(V.defaultGraphOptions.xaxis.min)&&(V.defaultGraphOptions.xaxis.min=a.min),angular.isDefined(V.defaultGraphOptions.xaxis.max)&&(V.defaultGraphOptions.xaxis.max=a.max);var n=new Image;n.src=V.defaultGraphOptions.bgimage;var i=[[[n,-Math.floor(n.width/2),-Math.floor(n.height/2),-Math.floor(n.width/2)+n.width,-Math.floor(n.height/2)+n.height]]],r={series:{images:{show:!0}},xaxis:{min:-Math.floor(I.width()/2),max:Math.ceil(I.width()/2),ticks:Math.round(I.width()/80),tickFormatter:function(){return""}},yaxis:{min:-Math.floor(I.height()/2),max:Math.ceil(I.height()/2),ticks:Math.round(I.height()/80),tickFormatter:function(){return""}},grid:{borderColor:"#D9D9D9",borderWidth:1}};$.plot.image.loadDataImages(i,r,function(){T=$.plot(I,[],r)}),I.show()}else if(void 0!==e){var o=null,l={};if(l.xaxis=M(),V.handleVisibilityOfButtons(),!V.drawModuloGraphType(l)&&!V.drawBarGraphType(l)&&!V.drawModuloCarpetGraphType(l)){V.graphOptions.message={show:!1,caution:"",verbose:""};for(var s={series:null,time:0},u={series:null,time:0},c=0;c<e.length;c++)1<=e[c].data.length&&(null!=e[c].data[e[c].data.length-1]&&"function"==typeof e[c].data[e[c].data.length-1][0].getTime&&e[c].data[e[c].data.length-1][0].getTime()>s.time&&(s.time=e[c].data[e[c].data.length-1][0].getTime(),s.series=c),1<e[c].data.length?null!=e[c].data[e[c].data.length-2]&&"function"==typeof e[c].data[e[c].data.length-1][0].getTime&&e[c].data[e[c].data.length-2][0].getTime()>u.time&&(u.time=e[c].data[e[c].data.length-2][0].getTime(),u.series=c):(u.time=0,u.series=s.series));var d=e[s.series];if(angular.isDefined(V.additionalSettings)&&V.additionalSettings.graphShowAggreagation){var p=V.countMinMaxSerieData([d],!0,!V.optionsGraphBars());V.graphOptions.aggreagation={max:{value:p.maxValue,color:"#009900"},min:{value:p.minValue,color:"#993300"},average:{value:V.countSeriesAverage(e),color:"#999900"}}}else angular.isDefined(V.graphOptions)&&(V.graphOptions.aggreagation={});if(void 0!==V.additionalSettings&&void 0!==V.additionalSettings.fixViewRange&&1!=V.additionalSettings.zoomPaneIsUsed&&(0<V.additionalSettings.fixViewRange?V.defaultGraphOptions.xaxis.min=V.defaultGraphOptions.xaxis.max-V.additionalSettings.fixViewRange:V.defaultGraphOptions.xaxis.max=V.defaultGraphOptions.xaxis.min-V.additionalSettings.fixViewRange,o=V.countMinMaxSerieData(V.getActualSeriesByType(),V.defaultGraphOptions.yaxis.globalRange,!V.optionsGraphBars(),!0),angular.isDefined(V.defaultGraphOptions.yaxis.min)&&(V.defaultGraphOptions.yaxis.min=o.minValue),angular.isDefined(V.defaultGraphOptions.yaxis.max)&&(V.defaultGraphOptions.yaxis.max=o.maxValue)),null!=V.additionalSettings&&null!=V.additionalSettings.projectGraphTimeRange&&"fromTo"!=V.additionalSettings.projectGraphTimeRange.interval&&null!=V.additionalSettings.graphOscilloscopeRegime&&(V.additionalSettings.graphOscilloscopeRegime||V.additionalSettings.graphWeekOscilloscopeRegime)&&null!=d&&1<=d.data.length){var g=d.data[d.data.length-1],h=V.oscilloRegimeLastPoint;null==h&&(null==(h=d.data[d.data.length-2])&&(h=d.data[d.data.length-3]),void 0===h&&(h=[new Date(0)],V.defaultGraphOptions.xaxis.min=0,V.defaultGraphOptions.xaxis.max=6e5));var f=g[0].getTime()-h[0].getTime(),m=h[0].getTime(),v=m<g[0].getTime(),x=V.defaultGraphOptions.xaxis.min<m,b=m<V.defaultGraphOptions.xaxis.max||V.additionalSettings.graphWeekOscilloscopeRegime&&m<=V.defaultGraphOptions.xaxis.max+f;if(v&&x&&b&&(V.defaultGraphOptions.xaxis.min+=f,V.defaultGraphOptions.xaxis.max+=f,o=V.countMinMaxSerieData(V.getActualSeriesByType(),V.defaultGraphOptions.yaxis.globalRange,!V.optionsGraphBars(),!0),angular.isDefined(V.defaultGraphOptions.yaxis.min)&&(V.defaultGraphOptions.yaxis.min=o.minValue),angular.isDefined(V.defaultGraphOptions.yaxis.max)&&(V.defaultGraphOptions.yaxis.max=o.maxValue),void 0!==V.additionalSettings&&V.additionalSettings.multipleAxis&&V.setMinMaxMultipleAxis()),!V.additionalSettings.zoomPaneIsUsed&&!V.optionsGraphCarpet()){var S=(V.defaultGraphOptions.xaxis.max-V.defaultGraphOptions.xaxis.min)/15,y=V.findAllSeriesDataMinMax().max+S;V.defaultGraphOptions.xaxis.min+=y-V.defaultGraphOptions.xaxis.max,V.defaultGraphOptions.xaxis.max=y}V.oscilloRegimeLastPoint=g,d.lastItemTimestamp=g[0].getTime()}if(void 0!==V.additionalSettings&&V.additionalSettings.multipleAxis?V.setMinMaxMultipleAxis():null!=V.additionalSettings&&0!=V.additionalSettings.selectDataDelete||(null==o&&(o=V.countMinMaxSerieData(V.getActualSeriesByType())),V.defaultGraphOptions.yaxis.min=o.minValue,V.defaultGraphOptions.yaxis.max=o.maxValue),V.drawedGraphOptions=V.prepareGraphOptions(!0,l,V.defaultGraphOptions,V.graphOptions),V.xaxisMode=V.drawedGraphOptions.xaxis.mode,null!=V.graphOptions.crosshair&&1==V.graphOptions.crosshair.enableFreeze&&null!=V.plot&&null!=V.drawedGraphOptions.crosshair&&(V.drawedGraphOptions.crosshair.lock=!1,V.plot.unlockCrosshair()),t||V.optionsGraphCarpet()||void 0!==V.additionalSettings&&void 0!==V.additionalSettings.projectGraphPlotType&&"diffline"==V.additionalSettings.projectGraphPlotType.value)V.plot=T=$.plot(I,e,V.drawedGraphOptions),null!=V.additionalSettings.selectedData&&null!=V.additionalSettings.selectedData.ranges&&V.plot.setSelection({xaxis:V.additionalSettings.selectedData.ranges.xaxis,yaxis:V.additionalSettings.selectedData.ranges.yaxis});else{var w=V.plot.getData();angular.forEach(w,function(e){e.xaxis.min=V.drawedGraphOptions.xaxis.min,e.xaxis.max=V.drawedGraphOptions.xaxis.max,e.yaxis.min=V.drawedGraphOptions.yaxis.min,e.yaxis.max=V.drawedGraphOptions.yaxis.max}),T=V.plot,V.plot.parseOptions(V.drawedGraphOptions);var D=V.plot.getXAxes();D[0].min=V.drawedGraphOptions.xaxis.min,D[0].max=V.drawedGraphOptions.xaxis.max,D[0].options.min=V.drawedGraphOptions.xaxis.min,D[0].options.max=V.drawedGraphOptions.xaxis.max;var A=V.plot.getYAxes();A[0].min=V.drawedGraphOptions.yaxis.min,A[0].max=V.drawedGraphOptions.yaxis.max,A[0].options.min=V.drawedGraphOptions.yaxis.min,A[0].options.max=V.drawedGraphOptions.yaxis.max,V.plot.setupGrid(),V.plot.draw()}angular.isDefined(V.additionalSettings)&&angular.isDefined(V.additionalSettings.selectDataDelete)&&1==V.additionalSettings.selectDataDelete&&0==V.userIsSelecting&&(V.additionalSettings.selectedData.from=null,V.additionalSettings.selectedData.to=null,V.additionalSettings.selectedData.ranges=null),I.show(),V.redrawExecuted=!V.redrawExecuted}V.legendElement=$(V.graphElement).find(".legend"),V.setVisibilityOfLegend(),void 0!==V.graphCommands&&void 0!==V.graphCommands.graphWasRedrawed&&(V.graphCommands.graphWasRedrawed=!V.graphCommands.graphWasRedrawed)}I.get(0).chart=T}}V.lastScrollPos=0,V.defaultGraphOptions={bgimage:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAPYAAADFCAIAAADonpicAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAAOvAAADrwBlbxySQAAAAd0SU1FB9sEGwoZIRxLDIIAAA9oSURBVHja7Z39UxrHH8eXJwFREfAJNDFo1MaYNo01NjrGtOO0P7STmebv7Ew7nXamo+kkSsIkoVUTgw9gRCMEFOSpggfHHd8fdua+VxUVOJCT9+snTvAO9l4sn9397K4in88TAK4uShQBgOIAQHEAoDgAUBwAKA4AFAcAigMoDgAUBwCKAwDFAYDiAEBxAKA4gOIAQHEAoDgAUBwAKA4AFAcAigMAxQEUBwCKAwDFAYDiAEBxAEpAXaHzOhwOnudRvuCida1SOTU1JSfFeZ6fnp7GnQMXZH5+HoEKAFAcACgOoDgAUBwAKA4AFAcAigMAxQGA4gCKAwDFAYDiAEBxAKA4AFAcACgOABQHUBwAKA5AzaNGEcideDzu8XhSqdTQ0JDNZkOBQPErBcdxc3NzmUyGEBIKhZ48eaLValEsVyRQ4TguGAxW/7rRaDSdTlf5oul0OhqNnvx7MBikftMC8fv90l43GAxyHAfFLwee530+X/WvGwqFUqlUlS+aSqVCodCphSA+ZBhG2uv6fD65L/mE5qaMCYVCL1++JITodDq1Wk0IWVpa2tzcRMkgFpc3kUhkfX398PAwFotxHNfX1/fgwYN8Pr+2tra0tPTq1Sv64zYwMHDjxg0UFxSXX3jmcDiESIn6rVAoFArF7du3OY579+7d3t4eISQcDlutVrQ+EajIjP39fXFLwGAwKBQK4VAsNM/zp4bvUBzUNB0dHTqdTjjs7e0VP3v9+vX/31qlsqurCyUGxeV2w5RKOr5jMBju37/f2toqflav1z969Ki9vZ0Qks/nsf41FJclnz59IoQ8fPhwcHDw5LM9PT3ff/99X19fPp9fXV1FcUFxmbG3t8cwjMFgsFgsZ7xsZGSEEOLxeI6OjqA4kBMfP348GYKfpKWlpa+vj+M4VORQXGbs7OxcRHFU5FD8KkcpqMih+BWPUlCRi6n10U2O4wplurEsm8/ns9lsld8Sz/Msy1b5uizL8jxPoxSr1XrBq+t0ut7e3p2dnffv33/xxRclXJeWcD6fP/VZlUqlUqmgeFns7+8XSifM5/Msy/79999Vfku5XC4ej29vb1f5e5VOpxmGUavVPp/v4imW1E6Px8MwTAk6siy7vLwsHkAVY7fbrVYrFC8Lq9VaqBBZlnW5XBMTE1V+S6urq+3t7XR4pWqEw2GaVDg4OHjv3r2i/tfpdG5tbTU2No6OjhZ7XafTOTY2ptFoEIuDikPnYVw8EEdEDsVlg9/vf/XqFc/zSqXSZDIV++913rUCxWsdnuddLlcikaCP6eg9KnIofnVIpVLi7NnS8mPruSKH4rVOc3NzZ2encHjz5s3SzlO3FTkUlwFGo5HWxNPT08eyZ0uoyFdWVuQ+qR6KXzXooOa1a9euXbtWznmEivznn39eX1+H4qAmoHkpSqWy/FmYsViMPmBZ9u3bt3VSl0NxeVThJccnYsSLDbEsW/3VYKA4OAWalyKelFky/f39wmOLxdLS0gLFwSkcywzLZDKFspSkilJ0Op24U6VkWlpaHj9+3NDQQAj56quv6uR+YR2V4uReWFgIBAIqlerLL7/s7e198+bN7u6uwWAYGxvr6empUJRSwqD9GZa3trbu7++zLIvmJjjO9vZ2IBCgri8vL8/Ozu7u7hJCUqnUyspKjUcpAs3NzYSQeDwOxcFxksmk8DiXy/3777/CYTwel3xFB2mjlGOKV39xXSguA+x2u/C4q6trfHxcOLTZbEqlxIUpeZRCoQNJNOkFsTj4DzQFSqVSDQ8Pj4yMqFQqs9m8vr7u8/lodCthXnUqlapElEIIaWxsJISIf4JQiwNCCGFZ1u12E0I6OjpsNhudQWOxWCYnJ202WyaT8Xq9Ul1reXn5l19+oYuFm81maT8I7WJPp9N1MvRT67V4Op0uNEKRy+V4ng+Hw9V5J7u7u5lMxmAwmEymY7/yNpvt06dPbrfbYrGUH67kcjlxPqDb7e7u7k4kEgzDSPVhGxoastms3++nNfoZ8DwfiUTo4uUnMRgM554Bip/DGfeV5/mqKc6yLE3q6O7uzmQyyWTy2ARhs9kcjUZXVlbK31CK4zhxyzUWizU0NDAMk8lkpPqwOp0um80GAoFzB015nj84OCj0vVWpVFC8XMxmc6Ffajp3c3h4uApvY3V1led5i8Vy//79U+dudnR0/Pnnn7FYbHp6usyInGEYt9udy+UIIWq1+uuvv9br9eFwOBwOS/VhE4lEMplsbW0994ROp3NoaEjWczfR3Dyfvb09GoXfuXOn0Gva2tpouOL1essRMZ/Pv3z5MpfLtbe39/f3X79+nQ5GSktd9RtC8XN+pufm5mh40NLScvb45eeff04j8oGBgZKrPbfbHQwGtVrt1NRU5WKAuuo3RI/KOU1MIfxNJpNnz5ehFXk5XSt7e3vLy8uEkMnJyYrGuHXVbwjFz0LY0vLUw1MrcloTl5ABwjDMixcvCCEjIyOV3gS5rvoNofhZ2O12IRTu7u4+t/+h5IqchuBHR0ft7e30e1JRVCqVXq/neb4eUsah+Jmlo1TSem5ycvLRo0cX+ZfSKnJxCC55IsAZLc7Dw0MoXtcEAgGO44xGo91uL7SuX/kVedVC8JOK10O+IRQ/i4uvV19yRV7NEPyk4vXQbwjFC8JxnN/vL0Hxi1fkVQ7BxdRPvyEUPz9KoTZUoiKvfgguUD/9hlBc4ijlWEXudDr39/dPfc3BwUH1Q3CB+uk3hOISRykCdOfi3d3d2dlZj8dz7FmWZel64VUOwQXqp98QiksfpVDEWn/48OHYs69fv04mk9UPwU+2OK98vyEUlz5KoTQ1NQmPj3U4er3e7e3tSwnBTyp+5fsNoXhFohRCyJ07d6hDhJBIJLK4uEgfx2Ixuj/RpYTgJxW/8v2GyDQkJ6Pk1dXVMqMUQkhnZ+fjx4/39/c5jpufn19dXc1ms2q12u/3cxx3WSG4mDrpN4Ti/4Hn+d9++41mFJa/xpVCoaDrQ3zzzTfPnj3b3Nykf7dYLJcYggvUSb9hzSmeTqe3t7eFWQXRaLTQvgg8zx+b5lg+iURCyJhNJpMul8tgMJx8TbHTKPP5vJDuQgjJZrPFrn1MJ7ZJ+2Hp+0mn02ecNpfLbWxsFGowdHV1ST57+oorznHc7Ozs4eGhQqG4desWIUSn0xXa/o/ufynt5oA6nU7c+2G1Wk8uecwwTEtLS7ExTHNzs7AwrMlkKvZt06loku+EuLGxwTCMXq8XN47FRKNRi8VSaHqyTqdDLV4cdK1Ah8OxuLhoNps7OzsbGxsLtclYlvX5fNLe9fb2drfbTcPTgYGBU6f5hMNho9FY7HXHxsZev34dj8eNRuPdu3dLWBU2m81KrrjBYGAYRqvVFjqz1+tta2vD3E0p6e3tDYfD6+vrCwsLP/zwQ5X7HDiOo/3E3333XUdHh7Rfnh9//DGZTNbUksdGo/Hg4CAQCHR2dtb+Vt+lUYudhqOjo1arNZPJPH/+nE5ErxrCiI+0fgvUlN/xeHxra4uGK3SoFYpXCYVCMTk52dTUFI1GXS5XNS9d/oiPjFhbWxMef/z4sZxhTo7jnE7nwcEBFC+i2Tc9Pa1SqT58+CC+E5WOUsof8ZERwsiUULOUXG4Oh2Nra8vhcEi+PO+VVZx2O0xMTBBCFhcXI5FINaOUckZ8ZER/fz/NFaMjAM+fPz93/nUhv/1+v0ajudx8BPkpTmvTzz77LJ/PP3v2rArjzHUVpRBC9Hr9zMzMTz/99OTJE5PJFIvFnj59WpTlYr9nZmYsFgsCldKbngsLCxVtetZblCJgMBgMBsPMzEyxlsvCbxkoLjQ9I5EIzV5ClFIJtFptUZbLxW8ii0xDoem5ublZuT1/6y1KKcdyGflN5JJMKzQ9//nnn0o0Pes2SinBcnn5TWSULy40Pefn5yVvetZ5lFLI8tnZ2VAotLa2ls1mOY7z+Xx//fXX06dPZeQ3kVcy7ejoaCKRCAaDDodjZmZGwjPTKlzyXXVkbfnc3BydEPTu3btYLKbVaoVkYBn5TeQ160doeobDYQlHPVmWpdtnQnGx5eLsoN3dXcFvQoharZaL30R2E9vETU+pto/yer0sy9psNpPJBLkFxBI3NTWJlyylA0ZQvOJNz6WlpWMb7pRWhdMdIGphGk5NMTg4eO3aNUKI0WicnJx8+PAhnYlnsViqs/lMPcbi4qYnTbgNhULpdLqchFuv15vJZGw2W1tbG7QWo9frp6enX7x4MT4+TvPFv/3222w2W4mNWVCLn970tFqtuVyunNQfVOHn+/HfnBPZ+S2DWjwYDPp8vlOf0mg0arU6HA7/8ccfpbV+EolEJpPR6XQej+fkglWFyOVy0WhUwo1kLwLdgdHpdFa5/LPZ7Js3bwolIdrtdqvVCsXLoqOjo5C+LMvmcrm9vb1EIjE0NHTjxo2izpzL5X7//XdCyNTUVFENTY/HYzabqxzYRCKRaDQ6ODhY5fJ3uVx3794tNLFNFhOFal1xlUpVqBwVCoVOp5uYmHA4HC6Xq1jtNjc3s9mszWaj60AU9dut0Wiq/JOt0WiUSmX14wSFQtHQ0IC5mzXR9Jyfn9dqtT09Pbdv3z77luzs7Kyvr9NVIhCFX3muwlJBo6Ojfr//8PDw6OgoHo83Nzf39/cXevHR0ZHD4RAOZbFMAqjHHhUxDMOI5x16PJ4z+suPLfETDAYhARSvdfR6vTiePjg4+PXXX9++fXuq6OJeMJVKdfaGyACBSq0wPj7udrsDgUBfX18qldrZ2VlZWdnY2BgaGrp165bQSguFQjRKMZvNGo1meHhYr9dDAiguA1paWh48eCAcjoyMvH//XhB9YGAgmUxGo1GGYTiOGx4evnfvHu49FJcxJpNpampKEJ0OYVJu3rwJvxGLXynRj+16XIOrIAAoXhY9PT3iBZSRFI5A5QoyNTXl9XpjsZjdbpdXrjOA4heira0NubIIVABALV5r306l0m63V/+6XV1d1R/2NxgMl5LWZ7fb5d5Al7HiKpXqUpKVL2V3mzN2y6gotZ8OjkAFIBYHAIoDAMUBgOIAQHEAoDgAUBwAKA6gOABQHAAoDgAUBwCKAwDFAYDiAIoDAMUBgOIAQHEAoDgAUBwAKA5A5dZRUalU8/PzKF9wQQpt7SnBmfP5PMoXIFABAIoDAMUBgOIAQHEAoDgAUBxAcQCgOABQHAAoDgAUBwCKAwDFARQHAIoDAMUBgOIAQHEAoDgAUBwAKA6gOABQHAAoDgAUBwCKAwDFAfgP/wP819DtjseNCQAAAABJRU5ErkJggg==",canvas:!0,series:{lines:{show:!0,lineWidth:2,ignoreNullValues:!1},points:{show:!1,radius:.8},images:{show:!1,anchor:"center",alpha:1},shadowSize:0,stack:!1},xaxis:{mode:V.xaxisMode,timezone:"browser",timeformat:"%d.%m.%Y<br />%H:%M:%S",zoomRange:[6e4,null],font:{color:"rgb(84, 84, 84)",variant:"normal",style:"normal",family:"'Trebuchet MS'",weight:"400",lineHeight:20,size:12}},yaxis:{autoscaleMargin:.02,globalRange:!1,font:{color:"rgb(84, 84, 84)",variant:"normal",style:"normal",family:"'Trebuchet MS'",weight:"400",lineHeight:20,size:12}},selection:{mode:"x",color:"#7D7DC7"},grid:{show:!0,hoverable:!0,clickable:!0,plothoverGetItem:!0,mouseActiveRadius:2,autoHighlight:!0,backgroundColor:"#FFFFFF",borderColor:"#EFEDED",borderWidth:1,markingsLineWidth:2.5,markingsWeekendColor:"#E0E0E0",markingsMidnightColor:"#D1CFCF",markings:function(e){var t=[];if("time"!=e.xaxis.options.mode)return t;if(0<e.xaxis.min){var a=new Date(e.xaxis.min),n=a;n.setHours(0,0,0,0);var i=a.getDay();switch(i){case 6:n=n.getTime();break;case 0:n=n.setDate(n.getDate()-1);break;default:n=n.setDate(n.getDate()+(6-i))}var r=Math.abs(new Date(n).getTimezoneOffset()),o=(s=new Date(n)).setDate(s.getDate()+2);if(Math.abs(new Date(o).getTimezoneOffset()),V.optionsGraphBars()&&"day"==V.additionalSettings.actualBarInterval.value&&(n-=432e5,o-=432e5),e.xaxis.max-e.xaxis.min<15552e6&&(!V.optionsGraphBars()||"week"!=V.additionalSettings.actualBarInterval.value&&"month"!=V.additionalSettings.actualBarInterval.value&&"quarter"!=V.additionalSettings.actualBarInterval.value&&"year"!=V.additionalSettings.actualBarInterval.value))do{t.push({xaxis:{from:n<e.xaxis.min?e.xaxis.min:n,to:o>e.xaxis.max?e.xaxis.max:o},color:V.drawedGraphOptions.grid.markingsWeekendColor});var l=new Date(n);n=l.setDate(l.getDate()+7);var s,u=Math.abs(new Date(n).getTimezoneOffset());if(r<u){var c=new Date(n);c.setMinutes(u-r),n=c.getTime(),u=Math.abs(new Date(n).getTimezoneOffset())}o=(s=new Date(n)).setDate(s.getDate()+2)}while(n<e.xaxis.max);if(void 0!==e.xaxis.tickSize&&"month"!=e.xaxis.tickSize[1]&&"quarter"!=e.xaxis.tickSize[1]&&"year"!=e.xaxis.tickSize[1]){if("day"==e.xaxis.tickSize[1]&&1<e.xaxis.tickSize[0])return t;for(var d,p=0;p<e.xaxis.ticks.length;p++){var g=e.xaxis.ticks[p].v,h=new Date(g);void 0!==d&&h.getTimezoneOffset(),0==h.getHours()&&0==h.getMinutes()&&0==h.getSeconds()&&t.push({xaxis:{from:g-0,to:g-0},color:V.drawedGraphOptions.grid.markingsMidnightColor,lineWidth:1}),d=h.getTimezoneOffset()}}}return t}},colors:["#2D2D87","#FF0000","#FF8000","#80FF00","#00FFFF","#FF4080","#0080FF","#A440FF","#FF00FF","#FF4080"],legend:{show:!0,clickable:!0,position:"nw",backgroundOpacity:.8,labelFormatter:function(e,t){var a="";(V.optionsGraphLines()&&!t.lines.show||V.optionsGraphCarpet()&&!t.carpet.showThisSerie||V.optionsGraphModuloCarpet()&&!t.moduloCarpet.showThisSerie||V.optionsGraphBars()&&!t.bars.show)&&(a=' style="text-decoration: line-through;" ');var n="",i="";void 0!==V.graphOptions.legend&&!1===V.graphOptions.legend.clickable||(n="<a "+a+' href="#'+t.idx+'" style="'+(void 0===t.idx?"cursor: context-menu;":"")+'">',i="</a>");var r=""+n+(void 0!==V.additionalSettings&&1==V.additionalSettings.graphShowFullLegend?t.fullLabel:e);if(r+=void 0!==t.dpUnit&&""!=t.dpUnit&&null!=t.dpUnit?" ("+t.dpUnit+")":"",r+=void 0!==t.transformParams?" "+t.transformParams:"",r+=i,r+='<span class="nameSuffix" style="display: none;">'+(void 0!==t.nameSuffix?t.nameSuffix:"")+"</span>","function"==typeof V.additionalSettings.labelFormatterStatus?r+=V.additionalSettings.labelFormatterStatus(t):(r+=0==t.data.length&&1!=t.seriesError?" - <span>"+S("i18n")("no data")+"</span>":"",r+=1==t.seriesError?' - <span class="error">error</span>':""),V.additionalSettings.tooltipsHidden&&null!=V.plot){var o=V.latestPosition,l=!1,s=V.plot.getAxes();(o.x<s.xaxis.min||o.x>s.xaxis.max)&&(l=!0),r+='<span class="series-value" style="font-weight: bold;display: inline-flex;">'+(void 0!==t.dp&&void 0!==t.dp.valueProperties.StdVis_V1&&null!=t.dp.valueProperties.StdVis_V1.value.value.Output?E.interpolateString(t,o,l,null,s,t.dp.valueProperties.StdVis_V1.value.value.Output.dec,V.graphOptions.series.lines.ignoreNullValues):E.interpolateString(t,o,l,null,s,2,V.graphOptions.series.lines.ignoreNullValues))+"</span>"}else r+='<span class="series-value" style="font-weight: bold;display: inline-flex;"></span>';return r+='<span class="scroll-fix" style="font-weight: bold;display: inline-flex;height:1px;"></span>'},getLastScrollPos:function(){return V.lastScrollPos},setLastScrollPos:function(e){V.lastScrollPos=e},backgroundColor:"white"},globalStringDictionary:{recountedDictionary:{}},zoom:{interactive:!1},pan:{interactive:!1},filter:S},V.showToolTip=!1,V.toolShow=!1,V.defaultToolStyle={window:{"z-index":"1010",position:"absolute","background-color":"white",border:"1px solid #DDDDDD","box-shadow":"0 3px 10px rgba(0, 0, 0, 0.15)",padding:"15px",display:"inline-table"}},V.content={name:"",value:""},V.toolStyle={},void 0===V.additionalSettings&&(V.additionalSettings={}),V.$watch("graphHeight",function(e,t){e!=t&&(V.lastScrollPos=0)}),V.$watch("graphData.length",function(e,t){e!=t&&(V.lastScrollPos=0),0<e&&V.checkIfCarpetSerieSelected(),V.recountDictionaryMapping()}),V.recountDictionaryMapping=function(){if(null!=V.graphData)for(var a=0;a<V.graphData.length;a++){var n={},i=[],r={};if(i=[],null!=V.graphData[a].dictionaryOrder){var o=Object.keys(V.graphData[a].dictionaryOrder).length,l=0;angular.forEach(V.graphData[a].dictionary,function(e,t){null==V.graphData[a].dictionaryOrder[t]&&(V.graphData[a].dictionaryOrder[t]=o+l,l++)}),r=V.graphData[a].dictionaryOrder}else r=V.graphData[a].dictionary;if(angular.forEach(r,function(e,t){-1==i.indexOf(t)&&(i[e]=t,n[t]=r[t])}),0!=i.length){if(0!=V.graphData[a].stringDictionaryExplicitly)for(i.sort(),l=0;l<i.length-1;l++)if(null!=V.graphStringDictionary[i[l]])for(var e=l+1;e<i.length;e++)if(null!=V.graphStringDictionary[i[e]]&&V.graphStringDictionary[i[e]]<V.graphStringDictionary[i[l]]){var t=i[e];i[e]=i[l],i[l]=t}V.graphData[a].mappingDictionary=n}}},V.countSeriesAverage=function(e){var n=[];return angular.forEach(e,function(e,t){var a=0;angular.forEach(e.data,function(e){null!=e&&(a+=e[1])}),n.push(a/e.data.length)}),n[0]};var a=null;function M(){var e={min:0,max:0};if(V.optionsGraphCarpet()&&0<V.graphData.length)for(var t=0;t<V.graphData.length;t++)if(null!=E.hiddenSeries[V.graphData[t].idx]){var a=new Date(V.graphData[0].data[0][0]);a.setHours(0,0,0,0),e.min=a.getTime();var n=new Date(V.graphData[0].data[V.graphData[0].data.length-1][0]);n.setHours(23,59,59,999),e.max=n.getTime();break}return e}I.bind("mousedown",function(e,t){if(null!=V.graphOptions.crosshair&&1==V.graphOptions.crosshair.enableFreeze){if(V.drawedGraphOptions.crosshair.lock=!1,V.plot.unlockCrosshair(),1==V.userIsSelecting)return;a=c(function(){1!=V.userIsSelecting&&(V.drawedGraphOptions.crosshair.lock=!0,V.plot.lockCrosshair())},800)}}),I.bind("mouseup",function(e,t){null!=a&&c.cancel(a)}),I.bind("mouseleave",function(e,t){null!=a&&c.cancel(a)}),V.handleVisibilityOfButtons=function(){var e,t,a,n;if(V.optionsGraphModuloCarpet())c(function(){V.additionalSettings.activeMoveButtons.zoomOut=!1,V.additionalSettings.activeMoveButtons.zoomIn=!1,V.additionalSettings.activeMoveButtons.panLeft=!1,V.additionalSettings.activeMoveButtons.panRight=!1},0);else if(void 0!==V.additionalSettings&&void 0!==V.additionalSettings.activeMoveButtons){(void 0===V.defaultGraphOptions.xaxis.max&&void 0===V.defaultGraphOptions.xaxis.min||null==V.defaultGraphOptions.xaxis.max&&null==V.defaultGraphOptions.xaxis.min)&&V.setXaxisMinMax(),e=t=V.findAllSeriesDataMinMax(),a=n=V.defaultGraphOptions.xaxis.max-V.defaultGraphOptions.xaxis.min;var i=!0;V.optionsGraphBars()?a>=1.1*(V.roundViewDate(V.additionalSettings.actualBarInterval.value,new Date(t.max),"ceil").getTime()-t.min)&&(i=!1):V.optionsGraphModulo()?V.defaultGraphOptions.xaxis.max>=e.max&&V.defaultGraphOptions.xaxis.min<=e.min&&(i=!1):a>=1.1*(t.max-t.min)&&(i=!1);var r=!0;V.defaultGraphOptions.xaxis.max-V.defaultGraphOptions.xaxis.min<=V.minZoomLine&&(r=!1),angular.isDefined(V.graphOptions)&&angular.isDefined(V.graphOptions.series.carpet)&&V.graphOptions.series.carpet.show&&0<V.graphData.length?V.getIntervalNumber("day",V.defaultGraphOptions.xaxis.min,V.defaultGraphOptions.xaxis.max)<=2&&(r=!1):V.optionsGraphBars()&&V.getIntervalNumber(V.additionalSettings.actualBarInterval.value,V.defaultGraphOptions.xaxis.min,V.defaultGraphOptions.xaxis.max)<=2&&(r=!1);var o=!0;e.min>V.defaultGraphOptions.xaxis.max-.33*n-n/2&&(o=!1),void 0!==V.graphOptions.series.modulo&&1==V.graphOptions.series.modulo.show&&V.defaultGraphOptions.xaxis.min<=e.min&&(o=!1);var l=!0;e.max<V.defaultGraphOptions.xaxis.min+.33*n+n/2&&(l=!1),void 0!==V.graphOptions.series.modulo&&1==V.graphOptions.series.modulo.show&&V.defaultGraphOptions.xaxis.max>=e.max&&(l=!1),c(function(){V.additionalSettings.activeMoveButtons.zoomOut=i,V.additionalSettings.activeMoveButtons.zoomIn=r,V.additionalSettings.activeMoveButtons.panLeft=o,V.additionalSettings.activeMoveButtons.panRight=l},0)}},V.$watch("graphData.length",function(e){0<e&&V.checkIfCarpetSerieSelected()}),V.$watch("moduloCarpetSeries.length",function(e){0<e&&V.checkIfModuloCarpetSerieSelected()}),V.checkIfCarpetSerieSelected=function(){if(void 0!==V.graphData&&0<V.graphData.length){var a=!1,n=null;angular.forEach(V.graphData,function(e,t){void 0===V.graphData[t].carpet&&(V.graphData[t].carpet={}),void 0===V.graphData[t].carpet.showThisSerie?V.graphData[t].carpet.showThisSerie=!1:1==V.graphData[t].carpet.showThisSerie&&(a?V.graphData[t].carpet.showThisSerie:(i=e.idx,a=!0)),e.idx==i&&(n=e)}),a||(null!=i&&null!=n?n.carpet.showThisSerie=!0:V.graphData[0].carpet.showThisSerie=!0,i=V.graphData[0].idx)}},V.checkIfModuloCarpetSerieSelected=function(){if(void 0!==V.moduloCarpetSeries&&0<V.moduloCarpetSeries.length){var a=!1,n=null;angular.forEach(V.moduloCarpetSeries,function(e,t){void 0===V.moduloCarpetSeries[t].moduloCarpet&&(V.moduloCarpetSeries[t].moduloCarpet={}),void 0===V.moduloCarpetSeries[t].moduloCarpet.showThisSerie?V.moduloCarpetSeries[t].moduloCarpet.showThisSerie=!1:1==V.moduloCarpetSeries[t].moduloCarpet.showThisSerie&&(a?V.moduloCarpetSeries[t].moduloCarpet.showThisSerie:(r=e.idx,a=!0)),e.idx==r&&(n=e)}),a||(r=null!=r&&null!=n?(n.moduloCarpet.showThisSerie=!0,n.idx):(V.moduloCarpetSeries[0].moduloCarpet.showThisSerie=!0,V.moduloCarpetSeries[0].idx))}},$(I).on("click",".legend a",function(a){var e;return V.optionsGraphModuloCarpet()?angular.forEach(V.moduloCarpetSeries,function(e,t){angular.isDefined(e.idx)&&(e.idx==$(a.target).attr("href").substring(1)?e.moduloCarpet.showThisSerie=!0:e.moduloCarpet.showThisSerie=!1)}):angular.forEach(V.graphData,function(e,t){angular.isDefined(V.graphOptions.series.carpet)&&1==V.graphOptions.series.carpet.show?angular.isDefined(e.idx)&&(e.idx==$(a.target).attr("href").substring(1)?(e.carpet.showThisSerie=!0,i=e.idx):e.carpet.showThisSerie=!1):angular.isDefined(e.idx)&&e.idx==$(a.target).attr("href").substring(1)&&(angular.isDefined(E.hiddenSeries[e.idx])?delete E.hiddenSeries[e.idx]:E.hiddenSeries[e.idx]=!0)}),e=V.countMinMaxSerieData(V.getActualSeriesByType()),void 0!==V.graphOptions.yaxis&&void 0!==V.graphOptions.yaxis.globalRange&&V.graphOptions.yaxis.globalRange,V.defaultGraphOptions.yaxis.min=e.minValue,V.defaultGraphOptions.yaxis.max=e.maxValue,V.additionalSettings.multipleAxis&&(V.createMultipleAxisSettings(),V.setMinMaxMultipleAxis()),V.optionsGraphBars()&&V.countBarGraphData(),V.handleStringValues(),g(),!1}),V.minZoomLine=5e3,angular.isDefined(V.additionalSettings)&&angular.isDefined(V.additionalSettings.selectDataDelete)&&V.$watch("additionalSettings.selectDataDelete",function(e,t){void 0!==e&&void 0!==t&&0==e&&1==t&&(V.additionalSettings.selectedData.from=null,V.additionalSettings.selectedData.to=null,V.additionalSettings.selectedData.ranges=null,angular.forEach(V.graphData,function(e){e.dataMin=null,e.dataMax=null})),g()}),I.bind("plotselecting",function(e,t){null!=V.graphOptions.crosshair&&1==V.graphOptions.crosshair.enableFreeze&&1==V.drawedGraphOptions.crosshair.lock&&V.userIsSelecting&&(V.drawedGraphOptions.crosshair.lock=!1,V.plot.unlockCrosshair()),angular.isDefined(V.additionalSettings)&&angular.isDefined(V.additionalSettings.selectDataDelete)&&1==V.additionalSettings.selectDataDelete&&0==V.userIsSelecting&&c(function(){V.additionalSettings.selectedData.from=null,V.additionalSettings.selectedData.to=null,V.additionalSettings.selectedData.ranges=null}),V.userIsSelecting||null==t||(V.userIsSelecting=!0)}),I.bind("plotselected",function(e,t){var a;if(V.toolShow=!1,V.$digest(),V.userIsSelecting=!1,angular.isDefined(V.additionalSettings)&&angular.isDefined(V.additionalSettings.selectDataDelete)&&1==V.additionalSettings.selectDataDelete)c(function(){V.additionalSettings.selectedData.from=new Date(t.xaxis.from),V.additionalSettings.selectedData.to=new Date(t.xaxis.to),V.additionalSettings.selectedData.fromY=t.yaxis.from,V.additionalSettings.selectedData.toY=t.yaxis.to,V.additionalSettings.selectedData.ranges=t},0);else if(angular.isDefined(V.defaultGraphOptions.xaxis)&&angular.isDefined(t.xaxis)){angular.isDefined(V.additionalSettings)&&(V.additionalSettings.zoomPaneIsUsed=!0);var n=void 0!==V.graphOptions.minZoomLine?V.graphOptions.minZoomLine:V.minZoomLine;if(V.optionsGraphCarpet()){var i=new Date(t.xaxis.from);i.setHours(0,0,0,0),t.xaxis.from=i.getTime();var r=new Date(t.xaxis.to);r.setHours(23,59,59,999),t.xaxis.to=r.getTime()}else if(V.optionsGraphBars()){var o=V.findAllSeriesDataMinMax(V.barSeries);null==t.xaxis.from&&null==t.xaxis.to&&(h.log("set allSerieRangeMinMax"),t.xaxis.from=o.min,t.xaxis.to=o.max);var l=V.roundViewDate(V.additionalSettings.actualBarInterval.value,new Date(t.xaxis.from),"middle").getTime(),s=V.roundViewDate(V.additionalSettings.actualBarInterval.value,new Date(t.xaxis.to),"middle").getTime();t.xaxis.from<l&&(l=V.roundViewDate(V.additionalSettings.actualBarInterval.value,new Date(t.xaxis.from),"middle",-1).getTime()),t.xaxis.to>s&&(s=V.roundViewDate(V.additionalSettings.actualBarInterval.value,new Date(t.xaxis.to),"middle",1).getTime()),t.xaxis.from=l,t.xaxis.to=s,V.roundViewDate(V.additionalSettings.actualBarInterval.value,new Date(o.min),"middle",-1).getTime()>t.xaxis.from&&(t.xaxis.from=V.roundViewDate(V.additionalSettings.actualBarInterval.value,new Date(o.min),"middle").getTime()),V.roundViewDate(V.additionalSettings.actualBarInterval.value,new Date(o.max),"middle").getTime()<t.xaxis.to&&(t.xaxis.to=V.roundViewDate(V.additionalSettings.actualBarInterval.value,new Date(o.max),"middle").getTime()),t.xaxis.from==t.xaxis.to&&(t.xaxis.from=V.dateMoveInterval(new Date(t.xaxis.from),-1,V.additionalSettings.actualBarInterval.value).getTime())}else t.xaxis.to-t.xaxis.from<n&&(t.xaxis.to=t.xaxis.from+n);if((void 0!==V.graphData[0]&&void 0===V.defaultGraphOptions.xaxis.max&&void 0===V.defaultGraphOptions.xaxis.min||isNaN(V.defaultGraphOptions.xaxis.min)&&isNaN(V.defaultGraphOptions.xaxis.max)||null==V.defaultGraphOptions.xaxis.min&&null==V.defaultGraphOptions.xaxis.max)&&V.setXaxisMinMax(),V.defaultGraphOptions.xaxis.max-V.defaultGraphOptions.xaxis.min>n){var u=V.findAllSeriesDataMinMax();u.max!=t.xaxis.to||V.optionsGraphCarpet()||(t.xaxis.to+=(t.xaxis.to-t.xaxis.from)/15),u.min!=t.xaxis.from||V.optionsGraphCarpet()||(t.xaxis.from-=(t.xaxis.to-t.xaxis.from)/15),V.defaultGraphOptions.xaxis.min=t.xaxis.from,V.defaultGraphOptions.xaxis.max=t.xaxis.to,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,a=V.countMinMaxSerieData(V.getActualSeriesByType()),angular.isDefined(V.graphOptions)&&void 0!==V.graphOptions.yaxis&&void 0!==V.graphOptions.yaxis.globalRange&&V.graphOptions.yaxis.globalRange?(V.defaultGraphOptions.yaxis.min=null,V.defaultGraphOptions.yaxis.max=null):(V.defaultGraphOptions.yaxis.min=a.minValue,V.defaultGraphOptions.yaxis.max=a.maxValue),(void 0===t.yaxis||null==t.yaxis.from&&null==t.yaxis.to)&&(V.defaultGraphOptions.yaxis.min=a.minValue,V.defaultGraphOptions.yaxis.max=a.maxValue),angular.isDefined(V.additionalSettings)&&V.additionalSettings.multipleAxis&&V.setMinMaxMultipleAxis()}g(V.graphData,!1),V.plot.clearSelection()}}),I.bind("plotFinalSeriesChange",function(e,t,a,n,i){V.graphData[t].data[a][0]=n,V.graphData[t].data[a][1]=i}),V.actualTooltipPosition={},V.hovePreviousPos=null,V.getSerieByIdx=function(t){var a=null;return angular.forEach(V.graphData,function(e){e.idx==t&&(a=e)}),a},I.bind("plothover",function(e,t,a){if(E.showToolTip(V.additionalSettings,V.graphOptions),void 0===V.hovePreviousPos||null==V.hovePreviousPos||t.pageX!=V.hovePreviousPos.pageX||t.pageY!=V.hovePreviousPos.pageY||null!=a)if(V.actualTooltipPosition=V.hovePreviousPos=t,a&&V.enableTooltip&&void 0!==a.datapoint&&void 0!==V.graphOptions){if(void 0!==a.series.startSerie)V.content.name=S("dateFormatCSharp")(a.datapoint[0]+parseInt(a.series.startSerie),"ddd dd/MM/yyyy HH:mm:ss");else if(V.optionsGraphBars()){var n=null;switch(n=V.roundViewDate(V.additionalSettings.actualBarInterval.value,new Date(a.datapoint[0]),"middle").getTime()>a.datapoint[0]?V.roundViewDate(V.additionalSettings.actualBarInterval.value,new Date(a.datapoint[0]),"floor"):V.roundViewDate(V.additionalSettings.actualBarInterval.value,new Date(a.datapoint[0]),"floor",1),V.additionalSettings.actualBarInterval.value){case"quarterhour":V.content.name=S("dateFormatCSharp")(n,"ddd dd/MM/yyyy HH:mm");break;case"hour":V.content.name=S("dateFormatCSharp")(n,"ddd dd/MM/yyyy HH|:00 - HH|:59");break;case"day":V.content.name=S("dateFormatCSharp")(n,"ddd dd/MM/yyyy");break;case"week":1==new Date(n).getDay()||new Date(n).getDay();var i=S("dateFormatCSharp")(V.roundViewDate(V.additionalSettings.actualBarInterval.value,new Date(n-0),"floor"),"ddd dd/MM/yyyy"),r=S("dateFormatCSharp")(V.roundViewDate(V.additionalSettings.actualBarInterval.value,new Date(n-0),"ceil").getTime(),"ddd dd/MM/yyyy");V.content.name=i+" - "+r;break;case"month":var o=S("dateFormatCSharp")(V.roundViewDate(V.additionalSettings.actualBarInterval.value,new Date(n),"floor"),"yyyy MMMMM");V.content.name=o;break;case"quarter":var l=S("dateFormatCSharp")(V.roundViewDate(V.additionalSettings.actualBarInterval.value,new Date(n),"ceil"),"yyyy qQ");V.content.name=l}}else if(V.optionsGraphModuloCarpet())if(n=null,1==V.additionalSettings.moduloCarpetInterval.xAxisUnit.days)n=V.roundViewDate("day",new Date(a.datapoint[0]),"floor"),V.drawedGraphOptions.yaxis.max%12==0&&(V.content.name=S("dateFormatCSharp")(n,"MMMMM ddd"));else if(24==V.additionalSettings.moduloCarpetInterval.xAxisMax)n=V.roundViewDate("hour",new Date(a.datapoint[0]),"floor"),V.drawedGraphOptions.yaxis.max%7==0?V.content.name=S("dateFormatCSharp")(n,"ddd HH|:00 - HH|:59"):V.drawedGraphOptions.yaxis.max%12==0&&(V.content.name=S("dateFormatCSharp")(n,"MMMMM HH|:00 - HH|:59"));else{var s=Math.floor(a.datapoint[0].getMinutes()/15);n=a.datapoint[0].setMinutes(15*s);var u=a.datapoint[0].setMinutes(15*(s+1));V.drawedGraphOptions.yaxis.max%7==0?V.content.name=S("dateFormatCSharp")(n,"ddd HH:mm - ")+S("dateFormatCSharp")(u,"HH:mm"):V.drawedGraphOptions.yaxis.max%12==0&&(V.content.name=S("dateFormatCSharp")(n,"MMMMM HH:mm - ")+S("dateFormatCSharp")(u,"HH:mm"))}else if("time"==V.drawedGraphOptions.xaxis.mode)V.content.name=S("dateFormatCSharp")(a.datapoint[0],"ddd dd/MM/yyyy HH:mm:ss");else{var c=2;void 0!==a.series.round&&(c=a.series.round),V.content.name=a.datapoint[0].toFixed(c)+(void 0!==V.drawedGraphOptions.xaxis.units?V.drawedGraphOptions.xaxis.units:"")}V.content.value="";var d=0;void 0!==V.graphOptions.series.bars&&V.graphOptions.series.bars.show&&V.graphOptions.series.stack?void 0!==a.datapoint[1]&&void 0!==a.datapoint[2]&&(d=a.datapoint[1]-a.datapoint[2]):d=a.datapoint[1];var p=".";void(c=0)!==a.dataIndex&&void 0!==a.series.data[a.dataIndex]&&null!=a.series.data[a.dataIndex]&&void 0!==a.series.data[a.dataIndex][5]?V.content.value+="Y = "+a.series.data[a.dataIndex][5]:void 0!==a.series.round?(V.content.value=d.toFixed(a.series.round),c=a.series.round):void 0!==a.series.dp&&void 0!==a.series.dp.valueProperties.StdVis_V1&&null!=a.series.dp.valueProperties.StdVis_V1.value.value.Output?(V.content.value+=d.toFixed(a.series.dp.valueProperties.StdVis_V1.value.value.Output.dec),c=a.series.dp.valueProperties.StdVis_V1.value.value.Output.dec):"function"==typeof d.toFixed?(V.content.value+=d.toFixed(2),c=2):V.content.value+=d;for(var g=0;g<c;g++)p+="#";if(0==c&&(p=""),"no data"!=V.content.value&&(V.content.value=S("numberFormatCSharp")(V.content.value,"##,#"+p)),V.content.value+=void 0!==a.series.dpUnit&&""!=a.series.dpUnit&&null!=a.series.dpUnit&&"no data"!=d?" "+a.series.dpUnit:"",angular.isDefined(a.series.lines.steps)&&a.series.lines.steps){var h="",f=V.getSerieByIdx(a.series.idx);if(null!=f)for(var m in f.dictionary)f.dictionary[m]==d&&(h=m);V.content.value=""!=h?h:d+(void 0!==a.series.dpUnit&&""!=a.series.dpUnit&&null!=a.series.dpUnit?" "+a.series.dpUnit:"")}V.content.dp="",void 0===a.series.label&&void 0===a.series.moduloLabel?angular.forEach(V.graphData,function(e,t){e.idx==a.series.idx&&(V.content.dp=e.label)}):1==V.additionalSettings.graphShowFullLegend?V.content.dp=a.series.fullLabel:void 0!==a.series.moduloLabel?V.content.dp=a.series.moduloLabel:V.content.dp=a.series.label;var v=I.offset();t.pageY+x.outerHeight(!0)+15>I.height()+v.top?V.toolStyle.window.top=t.pageY-x.outerHeight(!0)-v.top+"px":V.toolStyle.window.top=t.pageY-v.top+15+"px",t.pageX+x.outerWidth(!0)+15>I.width()+v.left-I[0].offsetLeft?V.toolStyle.window.left=t.pageX-x.outerWidth(!0)-v.left+I[0].offsetLeft+"px":V.toolStyle.window.left=t.pageX-v.left+I[0].offsetLeft+15+"px",V.toolShow=!0,V.$digest()}else null==a&&(V.toolShow=!1,V.$digest())}),V.$watch("toolShow",function(e,t){1==e?setTimeout(function(){if(1==V.toolShow){V.showToolTip=!0,V.$digest();var e=I.offset();V.actualTooltipPosition.pageY+x.outerHeight(!0)+15>I.height()+e.top?V.toolStyle.window.top=V.actualTooltipPosition.pageY-x.outerHeight(!0)-e.top+"px":V.toolStyle.window.top=V.actualTooltipPosition.pageY-e.top+15+"px",V.actualTooltipPosition.pageX+x.outerWidth(!0)+15>I.width()+e.left-I[0].offsetLeft?V.toolStyle.window.left=V.actualTooltipPosition.pageX-x.outerWidth(!0)-e.left+I[0].offsetLeft+"px":V.toolStyle.window.left=V.actualTooltipPosition.pageX-e.left+I[0].offsetLeft+15+"px",V.toolShow=!0,V.$digest()}},700):V.showToolTip=!1}),I.bind("handletouch",function(e,t){if((null!=t.fromTo.xaxis.from||null!=t.fromTo.xaxis.to)&&!V.optionsGraphModuloCarpet()){var a=t.fromTo.xaxis.to-t.fromTo.xaxis.from,n=V.findAllSeriesDataMinMax(),i=n.max-n.min;if(void 0!==V.graphOptions.series.modulo&&1==V.graphOptions.series.modulo.show)i<a&&(t.fromTo.xaxis.to=n.max,t.fromTo.xaxis.from=n.min),n.min>t.fromTo.xaxis.from&&(t.fromTo.xaxis.to+=n.min-t.fromTo.xaxis.from,t.fromTo.xaxis.from=n.min),n.max<t.fromTo.xaxis.to&&(t.fromTo.xaxis.from-=t.fromTo.xaxis.to-n.max,t.fromTo.xaxis.to=n.max);else{if(angular.isDefined(V.additionalSettings)&&(V.additionalSettings.zoomPaneIsUsed=!0),2*i<a)t.fromTo.xaxis.from=n.min-i/4,t.fromTo.xaxis.to=n.max+i/4;else if(1.4*i<a){var r=a-1.4*i;t.fromTo.xaxis.from=t.fromTo.xaxis.from+r/2,t.fromTo.xaxis.to=t.fromTo.xaxis.to-r/2}n.min>t.fromTo.xaxis.from+a/2&&(t.fromTo.xaxis.from=n.min-a/2,t.fromTo.xaxis.to=t.fromTo.xaxis.from+a),n.max<t.fromTo.xaxis.to-a/2&&(t.fromTo.xaxis.to=n.max+a/2,t.fromTo.xaxis.from=t.fromTo.xaxis.to-a),1==t.touchPan&&0==t.applyScale&&V.optionsGraphBars()}if(a<5e3){var o=t.fromTo.xaxis.to+a/2;t.fromTo.xaxis.to=o+2500,t.fromTo.xaxis.from=o-2500}V.setProperDataRange(t.fromTo.xaxis.from,t.fromTo.xaxis.to);var l=V.countMinMaxSerieData(V.getActualSeriesByType());angular.isDefined(V.graphOptions)&&void 0!==V.graphOptions.yaxis&&void 0!==V.graphOptions.yaxis.globalRange&&V.graphOptions.yaxis.globalRange?(V.defaultGraphOptions.yaxis.min=null,V.defaultGraphOptions.yaxis.max=null):(V.defaultGraphOptions.yaxis.min=l.minValue,V.defaultGraphOptions.yaxis.max=l.maxValue),(void 0===t.yaxis||null==t.yaxis.from&&null==t.yaxis.to)&&(V.defaultGraphOptions.yaxis.min=l.minValue,V.defaultGraphOptions.yaxis.max=l.maxValue),V.additionalSettings.multipleAxis&&V.setMinMaxMultipleAxis(),V.userIsSelecting=!1,g(V.graphData,!1)}}),I.bind("dblclick",function(e){var t;if(!V.optionsGraphModuloCarpet()){V.userIsSelecting=!1,V.toolShow=!1;var a=V.findAllSeriesDataMinMax();V.setProperDataRange(a.min,a.max),t=V.countMinMaxSerieData(V.getActualSeriesByType()),angular.isDefined(V.defaultGraphOptions.yaxis.max)&&(V.defaultGraphOptions.yaxis.min=t.minValue),angular.isDefined(V.defaultGraphOptions.yaxis.min)&&(V.defaultGraphOptions.yaxis.max=t.maxValue),angular.isDefined(V.additionalSettings)&&(V.additionalSettings.zoomPaneIsUsed=!1,V.additionalSettings.multipleAxis&&V.setMinMaxMultipleAxis()),angular.isDefined(V.additionalSettings)&&V.additionalSettings.graphOscilloscopeRegime?(V.graphCommands.setOscilloView=!V.graphCommands.setOscilloView,g()):g(V.graphData,!1)}}),V.$watch("graphCommands.reset",function(e,t){var a;if(e!=t){if(E.hiddenSeries={},V.optionsGraphBars()){for(var n=V.countBarGraphData(!0),i=0;i<V.barSeries.length;i++)if(V.barSeries[i].data.length==n.barSeries[i].data.length&&V.barSeries[i].data[V.barSeries[i].data.length-1][1]==n.barSeries[i].data[V.barSeries[i].data.length-1][1])return;V.barSeries=n.barSeries,V.cacheBarSerieData.range=n.cacheBarSerieDataRange,V.cacheBarSerieData.data=n.barSeries,V.cacheBarSerieData.interval=n.cacheBarSerieDataInterval}if(V.optionsGraphModuloCarpet()){for(n=V.countModuloCarpetGraphData(!0),i=0;i<V.moduloCarpetSeries.length;i++)if(V.moduloCarpetSeries[i].data.length==n.moduloCarpetSeries[i].data.length&&V.moduloCarpetSeries[i].data[V.moduloCarpetSeries[i].data.length-1][1]==n.moduloCarpetSeries[i].data[V.moduloCarpetSeries[i].data.length-1][1])return;V.moduloCarpetSeries=n.moduloCarpetSeries,V.cacheModuloCarpetSerieData.range=n.cacheModuloCarpetSerieDataRange,V.cacheModuloCarpetSerieData.data=n.moduloCarpetSeries,V.cacheModuloCarpetSerieData.interval=n.cacheModuloCarpetSerieDataInterval}V.recountDictionaryMapping(),V.handleStringValues();var r=V.findAllSeriesDataMinMax();V.setProperDataRange(r.min,r.max),a=V.countMinMaxSerieData(V.getActualSeriesByType(),V.defaultGraphOptions.yaxis.globalRange,!V.optionsGraphBars(),!0),angular.isDefined(V.defaultGraphOptions.yaxis.min)&&(V.defaultGraphOptions.yaxis.min=a.minValue),angular.isDefined(V.defaultGraphOptions.yaxis.max)&&(V.defaultGraphOptions.yaxis.max=a.maxValue),V.additionalSettings.multipleAxis&&V.setMinMaxMultipleAxis(),g()}}),V.$watch("graphCommands.resetGraphRecountBarData",function(e,t){if(void 0!==e){if(null==V.additionalSettings.actualBarInterval)return;V.countBarGraphData(),g()}}),V.$watch("graphCommands.reloadOscillo",function(e,t){E.hiddenSeries={};var a=V.findAllSeriesDataMinMax();e!=t&&(V.setProperDataRange(a.min,a.max),zoomValues=V.countMinMaxSerieData(V.getActualSeriesByType()),angular.isDefined(V.defaultGraphOptions.yaxis.min)&&(V.defaultGraphOptions.yaxis.min=zoomValues.minValue),angular.isDefined(V.defaultGraphOptions.yaxis.max)&&(V.defaultGraphOptions.yaxis.max=zoomValues.maxValue),V.additionalSettings.multipleAxis&&V.setMinMaxMultipleAxis(),g())}),V.setMinMaxMultipleAxis=function(){var l=V.graphData;if(V.optionsGraphLines()){var s=!1;angular.forEach(l,function(e){e.lines.steps&&void 0===E.hiddenSeries[e.idx]&&(s=!0)}),angular.forEach(V.graphOptions.yaxes,function(e,t){var a=[],n=V.axisMapIndexMap[t];if(void 0!==V.graphOptions.yaxes[t]){if(angular.forEach(l,function(e){e.yaxisIndexEsg!=n&&1!=V.numberOfAllYaxis||a.push(e)}),1==a.length){if(0<t)if(null==a[0].color){for(var i=0,r=0;r<l.length&&l[r]!=a[0];r++)null==l[r].color&&i++;V.graphOptions.yaxes[t].color=V.defaultGraphOptions.colors[i%V.defaultGraphOptions.colors.length]}else V.graphOptions.yaxes[t].color=a[0].color;V.graphOptions.yaxes[t].axisUnits=a[0].dpUnit}if(0<a.length&&void 0!==a[0].yaxisObj)V.graphOptions.yaxes[t].min=a[0].yaxisObj.min,V.graphOptions.yaxes[t].max=a[0].yaxisObj.max,s&&0!=t&&(V.graphOptions.yaxes[t].min-=(V.graphOptions.yaxes[t].max-V.graphOptions.yaxes[t].min)/3),1==V.graphOptions.yaxes.length&&(V.defaultGraphOptions.yaxis.min=a[0].yaxisObj.min,V.defaultGraphOptions.yaxis.max=a[0].yaxisObj.max);else{var o=V.countMinMaxSerieData(a,!0,!1);V.graphOptions.yaxes[t].min=o.minValue,V.graphOptions.yaxes[t].max=o.maxValue,s&&1!=n&&(V.graphOptions.yaxes[t].min-=(V.graphOptions.yaxes[t].max-V.graphOptions.yaxes[t].min)/3),1==n&&(V.defaultGraphOptions.yaxis.min=V.graphOptions.yaxes[t].min,V.defaultGraphOptions.yaxis.max=V.graphOptions.yaxes[t].max)}}})}},V.$watch("graphCommands.panLeft",function(e,t){if(e!=t){var a;V.additionalSettings.zoomPaneIsUsed=!0,(void 0!==V.graphData[0]&&void 0===V.defaultGraphOptions.xaxis.max&&void 0===V.defaultGraphOptions.xaxis.min||isNaN(V.defaultGraphOptions.xaxis.min)&&isNaN(V.defaultGraphOptions.xaxis.max)||null==V.defaultGraphOptions.xaxis.min&&null==V.defaultGraphOptions.xaxis.max)&&V.setXaxisMinMax();var n=V.defaultGraphOptions.xaxis.max-V.defaultGraphOptions.xaxis.min;isNaN(n)&&(n=2592e5);var i=V.findAllSeriesDataMinMax();i.min>V.defaultGraphOptions.xaxis.max-.33*n-n/2||(V.defaultGraphOptions.xaxis.min-=.33*n,V.defaultGraphOptions.xaxis.max-=.33*n,V.optionsGraphCarpet()&&0<V.graphData.length?(V.defaultGraphOptions.xaxis.min=V.roundViewDate("day",new Date(V.defaultGraphOptions.xaxis.min),"floor").getTime(),V.defaultGraphOptions.xaxis.max=V.roundViewDate("day",new Date(V.defaultGraphOptions.xaxis.max),"floor").getTime()):V.optionsGraphBars()?(V.defaultGraphOptions.xaxis.min=V.roundViewDate(V.additionalSettings.actualBarInterval.value,new Date(V.defaultGraphOptions.xaxis.min),"middle").getTime(),V.defaultGraphOptions.xaxis.max=V.roundViewDate(V.additionalSettings.actualBarInterval.value,new Date(V.defaultGraphOptions.xaxis.max),"middle").getTime(),1==V.getIntervalNumber(V.additionalSettings.actualBarInterval.value,V.defaultGraphOptions.xaxis.min,V.defaultGraphOptions.xaxis.max)&&(V.defaultGraphOptions.xaxis.min=V.roundViewDate(V.additionalSettings.actualBarInterval.value,new Date(V.defaultGraphOptions.xaxis.min),"middle",-1).getTime(),V.defaultGraphOptions.xaxis.max=V.roundViewDate(V.additionalSettings.actualBarInterval.value,new Date(V.defaultGraphOptions.xaxis.max),"middle",-1).getTime())):void 0!==V.graphOptions.series.modulo&&1==V.graphOptions.series.modulo.show&&V.defaultGraphOptions.xaxis.min<i.min&&(V.defaultGraphOptions.xaxis.max+=i.min-V.defaultGraphOptions.xaxis.min,V.defaultGraphOptions.xaxis.min=i.min),a=V.countMinMaxSerieData(V.getActualSeriesByType()),void 0!==V.graphOptions.yaxis&&void 0!==V.graphOptions.yaxis.globalRange&&V.graphOptions.yaxis.globalRange,V.defaultGraphOptions.yaxis.min=a.minValue,V.defaultGraphOptions.yaxis.max=a.maxValue,V.additionalSettings.multipleAxis&&V.setMinMaxMultipleAxis(),g(V.graphData,!1))}}),V.$watch("graphCommands.panRight",function(e,t){if(e!=t){var a;V.additionalSettings.zoomPaneIsUsed=!0,(void 0===V.defaultGraphOptions.xaxis.max&&void 0===V.defaultGraphOptions.xaxis.min||isNaN(V.defaultGraphOptions.xaxis.min)&&isNaN(V.defaultGraphOptions.xaxis.max)||null==V.defaultGraphOptions.xaxis.min&&null==V.defaultGraphOptions.xaxis.max)&&V.setXaxisMinMax();var n=V.findAllSeriesDataMinMax(),i=V.defaultGraphOptions.xaxis.max-V.defaultGraphOptions.xaxis.min;if(!(n.max<V.defaultGraphOptions.xaxis.min+.33*i+i/2)){if(V.defaultGraphOptions.xaxis.min+=.33*i,V.defaultGraphOptions.xaxis.max+=.33*i,angular.isDefined(V.graphOptions)&&angular.isDefined(V.graphOptions.series.carpet)&&V.graphOptions.series.carpet.show&&0<V.graphData.length){var r=0;V.defaultGraphOptions.xaxis.max-V.defaultGraphOptions.xaxis.min!=1728e5&&(r=1),V.defaultGraphOptions.xaxis.max-V.defaultGraphOptions.xaxis.min==1728e5&&(r=1),V.defaultGraphOptions.xaxis.min=V.roundViewDate("day",new Date(V.defaultGraphOptions.xaxis.min),"floor",r).getTime(),V.defaultGraphOptions.xaxis.max=V.roundViewDate("day",new Date(V.defaultGraphOptions.xaxis.max),"floor",r).getTime()}else V.optionsGraphBars()?(V.defaultGraphOptions.xaxis.min=V.roundViewDate(V.additionalSettings.actualBarInterval.value,new Date(V.defaultGraphOptions.xaxis.min),"middle").getTime(),V.defaultGraphOptions.xaxis.max=V.roundViewDate(V.additionalSettings.actualBarInterval.value,new Date(V.defaultGraphOptions.xaxis.max),"middle").getTime(),1==V.getIntervalNumber(V.additionalSettings.actualBarInterval.value,V.defaultGraphOptions.xaxis.min,V.defaultGraphOptions.xaxis.max)&&(V.defaultGraphOptions.xaxis.min=V.roundViewDate(V.additionalSettings.actualBarInterval.value,new Date(V.defaultGraphOptions.xaxis.min),"middle",1).getTime(),V.defaultGraphOptions.xaxis.max=V.roundViewDate(V.additionalSettings.actualBarInterval.value,new Date(V.defaultGraphOptions.xaxis.max),"middle",1).getTime())):V.optionsGraphModulo()&&V.defaultGraphOptions.xaxis.max>n.max&&(V.defaultGraphOptions.xaxis.min-=V.defaultGraphOptions.xaxis.max-n.max,V.defaultGraphOptions.xaxis.max=n.max);a=V.countMinMaxSerieData(V.getActualSeriesByType()),void 0!==V.graphOptions.yaxis&&void 0!==V.graphOptions.yaxis.globalRange&&V.graphOptions.yaxis.globalRange,V.defaultGraphOptions.yaxis.min=a.minValue,V.defaultGraphOptions.yaxis.max=a.maxValue,V.additionalSettings.multipleAxis&&V.setMinMaxMultipleAxis(),g(V.graphData,!1)}}}),V.$watch("graphCommands.redraw",function(e,t){e!=t&&setTimeout(g,0)}),V.setXaxisMinMax=function(){var e=V.findAllSeriesDataMinMax();V.optionsGraphBars()?(V.defaultGraphOptions.xaxis.min=V.roundViewDate(V.additionalSettings.actualBarInterval.value,new Date(e.min),"middle").getTime(),V.defaultGraphOptions.xaxis.max=V.roundViewDate(V.additionalSettings.actualBarInterval.value,new Date(e.max),"middle").getTime()):(V.defaultGraphOptions.xaxis.min=e.min,V.defaultGraphOptions.xaxis.max=e.max)},V.$watch("graphCommands.changeZoomIn",function(e,t){if(void 0!==e&&e!=t){(void 0===V.defaultGraphOptions.xaxis.max&&void 0===V.defaultGraphOptions.xaxis.min||null==V.defaultGraphOptions.xaxis.max&&null==V.defaultGraphOptions.xaxis.min)&&V.setXaxisMinMax(),V.additionalSettings.zoomPaneIsUsed=!0;var a=void 0!==V.graphOptions.minZoomLine?V.graphOptions.minZoomLine:V.minZoomLine;if(V.defaultGraphOptions.xaxis.max-V.defaultGraphOptions.xaxis.min<=a)return;V.findAllSeriesDataMinMax();var n=V.defaultGraphOptions.xaxis.max-V.defaultGraphOptions.xaxis.min;if(angular.isDefined(V.graphOptions)&&angular.isDefined(V.graphOptions.series.carpet)&&V.graphOptions.series.carpet.show&&0<V.graphData.length){var i=V.getIntervalNumber("day",V.defaultGraphOptions.xaxis.min,V.defaultGraphOptions.xaxis.max),r=Math.ceil(.1*i);2<i&&(V.defaultGraphOptions.xaxis.min=V.roundViewDate("day",new Date(V.defaultGraphOptions.xaxis.min),"floor",r).getTime(),V.defaultGraphOptions.xaxis.max=V.roundViewDate("day",new Date(V.defaultGraphOptions.xaxis.max),"floor",-r).getTime())}else if(V.optionsGraphBars())i=V.getIntervalNumber(V.additionalSettings.actualBarInterval.value,V.defaultGraphOptions.xaxis.min,V.defaultGraphOptions.xaxis.max),r=Math.ceil(.1*i),2<i&&(V.defaultGraphOptions.xaxis.min=V.roundViewDate(V.additionalSettings.actualBarInterval.value,new Date(V.defaultGraphOptions.xaxis.min),"middle",r).getTime(),V.defaultGraphOptions.xaxis.max=V.roundViewDate(V.additionalSettings.actualBarInterval.value,new Date(V.defaultGraphOptions.xaxis.max),"middle",-r).getTime());else if(V.defaultGraphOptions.xaxis.min+=.2*n,V.defaultGraphOptions.xaxis.max-=.2*n,V.defaultGraphOptions.xaxis.max-V.defaultGraphOptions.xaxis.min<a){var o=(V.defaultGraphOptions.xaxis.max+V.defaultGraphOptions.xaxis.min)/2;V.defaultGraphOptions.xaxis.min=o-a/2,V.defaultGraphOptions.xaxis.max=o+a/2}var l=V.countMinMaxSerieData(V.getActualSeriesByType());void 0!==V.graphOptions.yaxis&&void 0!==V.graphOptions.yaxis.globalRange&&V.graphOptions.yaxis.globalRange,V.defaultGraphOptions.yaxis.min=l.minValue,V.defaultGraphOptions.yaxis.max=l.maxValue,V.additionalSettings.multipleAxis&&V.setMinMaxMultipleAxis(),g(V.graphData,!1)}}),V.dateMoveInterval=function(e,t,a){if("object"==typeof t)e.setMinutes(e.getMinutes()+t.minutes),e.setDate(e.getDate()+t.day),e.setMonth(e.getMonth()+t.month),e.setFullYear(e.getFullYear()+t.year);else switch(a){case"quarterhour":e.setMinutes(e.getMinutes()+15*t);break;case"hour":e.setHours(e.getHours()+t);break;case"day":e.setDate(e.getDate()+t);break;case"week":e.setDate(e.getDate()+7*t);break;case"month":e.setMonth(e.getMonth()+t);break;case"quarter":e.setMonth(e.getMonth()+3*t);break;case"year":e.setFullYear(e.getFullYear()+t)}return e},V.getIntervalNumber=function(e,t,a){var n=a-t;switch(e){case"quarterhour":var i=Math.ceil(n/9e5);break;case"hour":i=Math.ceil(n/36e5);break;case"day":i=Math.ceil(n/864e5);break;case"week":i=Math.floor(n/6048e5);break;case"month":var r=1+new Date(a).getMonth()-new Date(t).getMonth();i=r+=12*(new Date(a).getYear()-new Date(t).getYear());break;case"quarter":r=1+new Date(a).getMonth()-new Date(t).getMonth(),i=(r+=12*(new Date(a).getYear()-new Date(t).getYear()))/3;break;case"year":i=1+new Date(a).getYear()-new Date(t).getYear()}return i},V.roundViewDate=function(e,t,a,n){if(void 0===a&&(a="floor"),V.dataInterval[e],void 0!==n){if("week"!=e)var i=e;else i="day",n*=7;t=V.dateMoveInterval(t,n,i)}if("quarterhour"==e){var r=t.getMinutes(),o=Math.ceil(r/15);return"middle"==a?t.setHours(t.getHours(),15*o+7,30,0):"ceil"==a?t.setHours(t.getHours(),15*o+15,59,999):t.setHours(t.getHours(),15*o,0,0),t}if("hour"==e)return"middle"==a?t.setHours(t.getHours(),30,0,0):"ceil"==a?t.setHours(t.getHours(),59,59,999):t.setHours(t.getHours(),0,0,0),t;if("middle"==a?t.setHours(12,0,0,0):"ceil"==a?t.setHours(23,59,59,999):t.setHours(0,0,0,0),"week"==e&&("middle"==a?t.setDate(t.getDate()+(4-t.getDay())):"ceil"==a?t.setDate(t.getDate()+(7-t.getDay())):t.setDate(t.getDate()+(1-t.getDay()))),"month"!=e&&"year"!=e||("middle"==a?t.setDate(Math.floor(new Date(t.getFullYear(),t.getMonth()+1,0).getDate()/2)):"ceil"==a?t.setDate(Math.floor(new Date(t.getFullYear(),t.getMonth()+1,0).getDate())):t.setDate(1)),"quarter"==e){var l=t.getMonth()+1;switch(l%3){case 1:l++;break;case 0:l--}"middle"==a?(t.setDate(Math.floor(new Date(t.getFullYear(),l,0).getDate()/2)),t.setMonth(l-1)):"ceil"==a?(t.setDate(Math.floor(new Date(t.getFullYear(),l+1,0).getDate())),t.setMonth(l)):(t.setDate(1),t.setMonth(l-2))}return"year"==e&&("middle"==a?t.setMonth(5):"ceil"==a?t.setMonth(11):t.setMonth(0)),t},V.setProperDataRange=function(e,t){V.optionsGraphCarpet()?(V.defaultGraphOptions.xaxis.min=V.roundViewDate("day",new Date(e),"floor").getTime(),V.defaultGraphOptions.xaxis.max=V.roundViewDate("day",new Date(t),"ceil").getTime()):V.optionsGraphBars()?(V.defaultGraphOptions.xaxis.min=V.roundViewDate(V.additionalSettings.actualBarInterval.value,new Date(e),"middle",-1).getTime(),V.defaultGraphOptions.xaxis.max=V.roundViewDate(V.additionalSettings.actualBarInterval.value,new Date(t),"middle").getTime()):(V.defaultGraphOptions.xaxis.min=e,V.defaultGraphOptions.xaxis.max=t)},V.osciloViewFreeSpace=function(){},V.$watch("graphCommands.setOscilloView",function(e,t){if(!(V.optionsGraphCarpet()||V.optionsGraphBars()||null!=V.additionalSettings&&null!=V.additionalSettings.projectGraphTimeRange&&"fromTo"==V.additionalSettings.projectGraphTimeRange.interval)){V.handleStringValues();var a=(V.defaultGraphOptions.xaxis.max-V.defaultGraphOptions.xaxis.min)/15,n=V.findAllSeriesDataMinMax().max+a;V.defaultGraphOptions.xaxis.min+=n-V.defaultGraphOptions.xaxis.max,V.defaultGraphOptions.xaxis.max=n,g()}}),V.$watch("graphCommands.changeZoomOut",function(e,t){if(void 0!==e&&e!=t){(void 0===V.defaultGraphOptions.xaxis.max&&void 0===V.defaultGraphOptions.xaxis.min||null==V.defaultGraphOptions.xaxis.max&&null==V.defaultGraphOptions.xaxis.min)&&V.setXaxisMinMax(),V.additionalSettings.zoomPaneIsUsed=!0;var a=V.defaultGraphOptions.xaxis.max-V.defaultGraphOptions.xaxis.min,n=V.findAllSeriesDataMinMax();if(V.optionsGraphBars()){if(a>=1.1*(V.roundViewDate(V.additionalSettings.actualBarInterval.value,new Date(n.max),"ceil").getTime()-n.min))return}else if(a>=1.1*(n.max-n.min))return;if(angular.isDefined(V.graphOptions)&&angular.isDefined(V.graphOptions.series.carpet)&&V.graphOptions.series.carpet.show&&0<V.graphData.length){var i=V.getIntervalNumber("day",V.defaultGraphOptions.xaxis.min,V.defaultGraphOptions.xaxis.max),r=Math.ceil(.1*i);V.defaultGraphOptions.xaxis.min=V.roundViewDate("day",new Date(V.defaultGraphOptions.xaxis.min),"floor",-r).getTime(),V.defaultGraphOptions.xaxis.max=V.roundViewDate("day",new Date(V.defaultGraphOptions.xaxis.max),"floor",r).getTime()}else if(V.optionsGraphBars())i=V.getIntervalNumber(V.additionalSettings.actualBarInterval.value,V.defaultGraphOptions.xaxis.min,V.defaultGraphOptions.xaxis.max),(r=Math.ceil(.1*i))<1&&(r=1),V.defaultGraphOptions.xaxis.min=V.roundViewDate(V.additionalSettings.actualBarInterval.value,new Date(V.defaultGraphOptions.xaxis.min),"middle",-r).getTime(),V.defaultGraphOptions.xaxis.max=V.roundViewDate(V.additionalSettings.actualBarInterval.value,new Date(V.defaultGraphOptions.xaxis.max),"middle",r).getTime();else if(V.defaultGraphOptions.xaxis.min-=.2*a,V.defaultGraphOptions.xaxis.max+=.2*a,V.optionsGraphModulo()){var o=V.findAllSeriesDataMinMax();V.defaultGraphOptions.xaxis.max>o.max&&(V.defaultGraphOptions.xaxis.max=o.max),V.defaultGraphOptions.xaxis.min<o.min&&(V.defaultGraphOptions.xaxis.min=o.min)}var l=V.countMinMaxSerieData(V.getActualSeriesByType(),!0,!1);void 0!==V.graphOptions.yaxis&&void 0!==V.graphOptions.yaxis.globalRange&&V.graphOptions.yaxis.globalRange,V.defaultGraphOptions.yaxis.min=l.minValue,V.defaultGraphOptions.yaxis.max=l.maxValue,V.additionalSettings.multipleAxis&&V.setMinMaxMultipleAxis(),g(V.graphData,!1)}}),V.$watch("graphData",function(e,t){var a,n;void 0!==V.additionalSettings&&(V.additionalSettings.zoomPaneIsUsed=!1),null!=e&&0==e.length&&(V.oscilloRegimeLastPoint=null);var i={};V.optionsGraphModulo()&&(V.setModuloGraph=!0,V.moduloDataRange.min=null,V.moduloDataRange.max=null),angular.isDefined(V.additionalSettings)&&(V.additionalSettings.linearTransformation=!1),angular.forEach(e,function(e){angular.isDefined(e.idx)||(e.idx="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)})),i[e.idx]=E.hiddenSeries[e.idx]}),0!=e.length&&(E.hiddenSeries=i),V.optionsGraphBars()&&V.countBarGraphData(),a=V.findAllSeriesDataMinMax(),V.setProperDataRange(a.min,a.max),V.handleStringValues(),V.optionsGraphModuloCarpet()?V.countModuloCarpetGraphData():(n=V.countMinMaxSerieData(V.getActualSeriesByType()),V.defaultGraphOptions.yaxis.min=n.minValue,V.defaultGraphOptions.yaxis.max=n.maxValue),V.additionalSettings.multipleAxis&&V.createMultipleAxisSettings(),g(e,!0)}),V.$watch("graphCommands.removeSeriesDataFromCache",function(e,t){if(e!=t&&void 0!==V.additionalSettings.newSeriesActual){var a={};angular.forEach(V.additionalSettings.newSeriesActual,function(e){void 0!==E.hiddenSeries[e]&&(a[e]=E.hiddenSeries[e])}),E.hiddenSeries=a}}),V.$watch("additionalSettings.linearTransformation",function(e,t){void 0!==e&&null!=V.graphData&&2<=V.graphData.length&&(1==e?V.linearDataTransformation():V.returnUntransformedData())}),V.$watch("additionalSettings.graphOscilloscopeRegime",function(e,t){0==e&&1==t&&angular.forEach(V.graphData,function(e){e.dataMax=null,e.dataMin=null})}),V.$watch("additionalSettings.graphShowFullLegend",function(l,e){void 0!==l&&l!=e&&(angular.forEach(V.graphData,function(e,t){var a="",n="";n=1==l?(a=e.fullLabel,e.label):(a=e.label,e.fullLabel);for(var i=0;0!=V.legends.eq(i).length;i++){var r=V.legends.eq(i)[0].children[0];if("#"+e.idx==$(r).attr("href")){var o=r.textContent;o=o.replace(n,a),r.innerText=o}}}),g(V.graphData,!1))}),V.$watch("additionalSettings.graphShowLegend",function(e,t){void 0!==e&&e!=t&&V.setVisibilityOfLegend()}),V.setVisibilityOfLegend=function(){angular.isDefined(V.additionalSettings)&&void 0!==V.additionalSettings.graphShowLegend&&void 0!==V.legendElement&&(1==V.additionalSettings.graphShowLegend?V.legendElement.css("display","inherit"):V.legendElement.css("display","none"))},V.linearDataTransformation=function(){function e(e){var t,a,n,i,r=0,o=0,l=0,s=0,u=0;for(t=0;t<e.length;t++)a=e[t][0],n=e[t][1],u+=i=e[t][2],r+=i*a,l+=i*(a*a),o+=i*n,s+=i*(a*n);return[(u*s-r*o)/(u*l-r*r),(o*l-r*s)/(u*l-r*r)]}V.legends=$(".chart .legendLabel");for(var t=V.graphData[0],a=1;a<V.graphData.length;a++){var n=V.graphData[a];if(!n.lines.steps){for(var i,r=[],o=[],l=[],s=0,u=0;s<t.data.length-5;s++){if(null==t.data[s]&&s++,null==n.data[u]&&u++,t.data[s][0].getTime()==n.data[u][0].getTime());else if(0<u){for(var c=u;t.data[s][0].getTime()>n.data[c][0].getTime();)c++,null==n.data[c]&&c++;if(null!=n.data[c-1]&&null!=n.data[c]){var d=E.interpolate(n.data[c-1],n.data[c],t.data[s][0].getTime());r.push([t.data[s][0].getTime(),d]),o.push([t.data[s][0].getTime(),t.data[s][1]])}}for(;t.data[s][0].getTime()>n.data[u][0].getTime();)null!=t.data[s-1]&&null!=t.data[s]&&(d=E.interpolate(t.data[s-1],t.data[s],n.data[u][0].getTime()),o.push([n.data[u][0].getTime(),d]),r.push([n.data[u][0].getTime(),n.data[u][1]])),u++,null==n.data[u]&&u++;t.data[s][0].getTime()==n.data[u][0].getTime()&&null!=n.data[u]&&null!=t.data[u]&&(o.push([n.data[u][0].getTime(),t.data[s][1]]),r.push([n.data[u][0].getTime(),n.data[u][1]]))}for(r=r.sort(function(e,t){return e[0]-t[0]}),o=o.sort(function(e,t){return e[0]-t[0]}),c=0;c<r.length;c++)void 0!==r[c]&&void 0!==o[c]&&(null!=r[c]&&null!=o[c]?l.push([r[c][1],o[c][1],1]):h.log(c+"- "+r[c]+" "+o[c]));var p=e(l);for(u=0;u<n.data.length;u++)null!=n.data[u]&&(n.data[u][5]=n.data[u][1],n.data[u][1]=n.data[u][1]*p[0]+p[1]);n.transformParams="[ Y * "+Math.round(10*p[0])/10+" "+(0<p[1]?"+":"-")+" "+Math.round(10*Math.abs(p[1]))/10+" ]",V.legends[a].children[0].innerText+=" "+n.transformParams}}i=V.countMinMaxSerieData(V.getActualSeriesByType()),void 0!==V.graphOptions.yaxis&&void 0!==V.graphOptions.yaxis.globalRange&&V.graphOptions.yaxis.globalRange,V.defaultGraphOptions.yaxis.min=i.minValue,V.defaultGraphOptions.yaxis.max=i.maxValue,g()},V.returnUntransformedData=function(){for(var a=1;a<V.graphData.length;a++)angular.forEach(V.graphData[a].data,function(e,t){null!=e&&void 0!==V.graphData[a].data[t][5]&&(V.graphData[a].data[t][1]=V.graphData[a].data[t][5],V.graphData[a].data[t].splice(5,1))}),V.graphData[a].transformParams="";var e=V.countMinMaxSerieData(V.getActualSeriesByType());void 0!==V.graphOptions.yaxis&&void 0!==V.graphOptions.yaxis.globalRange&&V.graphOptions.yaxis.globalRange,V.defaultGraphOptions.yaxis.min=e.minValue,V.defaultGraphOptions.yaxis.max=e.maxValue,g()},V.$watch("additionalSettings.barDataCountType",function(e,t){void 0!==e&&void 0!==t&&V.optionsGraphBars()&&(V.countBarGraphData(),g())}),V.$watch("additionalSettings.graphBarNorm",function(e,t){void 0!==e&&void 0!==t&&V.optionsGraphBars()&&(V.countBarGraphData(),g())}),V.countBarGraphData=function(e){var t=n.count(V.additionalSettings.actualBarInterval,V.graphData,V.additionalSettings.barDataType,V.additionalSettings.barDataCountType,V.additionalSettings.graphSettingsForOneSerie);if(1==e)return{barSeries:t,cacheBarSerieDataRange:V.additionalSettings.actualBarInterval.value,cacheBarSerieDataData:t,cacheBarSerieDataInterval:V.additionalSettings.projectGraphTimeRange.interval};V.barSeries=t,V.cacheBarSerieData.range=V.additionalSettings.actualBarInterval.value,V.cacheBarSerieData.data=t,V.cacheBarSerieData.interval=V.additionalSettings.projectGraphTimeRange.interval},V.$watch("additionalSettings.moduloCarpetDataCountType.value",function(e,t){null!=e&&null!=t&&V.optionsGraphModuloCarpet()&&(V.countModuloCarpetGraphData(),g())}),V.$watch("additionalSettings.moduloCarpetInterval.value",function(e,t){null!=e&&null!=t&&V.optionsGraphModuloCarpet()&&(V.countModuloCarpetGraphData(),g())}),V.countModuloCarpetGraphData=function(e){var t=o.count(V.graphData,V.additionalSettings.moduloCarpetInterval,V.additionalSettings.moduloCarpetDataCountType);if(1==e)return{moduloCarpetSeries:t,cacheModuloCarpetSerieDataRange:V.additionalSettings.moduloCarpetInterval.value,cacheModuloCarpetSerieDataData:t,cacheModuloCarpetSerieDataInterval:V.additionalSettings.projectGraphTimeRange.interval};V.moduloCarpetSeries=t,V.cacheModuloCarpetSerieData.range=V.additionalSettings.moduloCarpetInterval.value,V.cacheModuloCarpetSerieData.data=t,V.cacheModuloCarpetSerieData.interval=V.additionalSettings.projectGraphTimeRange.interval},V.$watch("graphOptions",function(e){g()}),V.$watch("graphWidth",function(e,t){angular.isDefined(e)?t==e&&I.width()==e||(I.width(e),I.height(V.graphHeight),angular.isDefined(V.graphStyle)||(V.graphStyle={width:0,height:0}),V.wrapperStyle.width=V.graphStyle.width=e+"px",V.wrapperStyle.height=V.graphStyle.height=V.graphHeight+"px",c(function(){g(V.graphData,!0)},0)):(I.width(100),g(V.graphData,!0))}),V.$watch("graphHeight",function(e,t){angular.isDefined(e)?t==e&&I.height()==e||(I.height(e),I.width(V.graphWidth),angular.isDefined(V.graphStyle)||(V.graphStyle={width:0,height:0}),V.wrapperStyle.width=V.graphStyle.width=V.graphWidth+"px",V.wrapperStyle.height=V.graphStyle.height=e+"px",c(function(){g(V.graphData,!0)},0)):(I.height(100),g(V.graphData,!0))}),V.findAllSeriesDataMinMax=function(e){void 0===e&&(e=V.optionsGraphModulo()&&void 0!==V.moduloSeries&&0<V.moduloSeries.length?V.moduloSeries:V.optionsGraphBars()&&void 0!==V.barSeries&&0<V.barSeries.length?V.barSeries:V.optionsGraphModuloCarpet()&&void 0!==V.moduloCarpetSeries&&0<V.moduloCarpetSeries.length?V.moduloCarpetSeries:V.graphData);var n={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};return angular.forEach(e,function(e){if(void 0!==e.data[0]&&null!=e.data[0]){if(null!=e.data[0][0])var t=e.data[0][0];else t=e.data[1][0];if("function"==typeof t.getTime?n.min>t.getTime()&&(n.min=t.getTime()):n.min>t&&(n.min=t),null!=e.data[e.data.length-1])var a=e.data[e.data.length-1][0];else a=e.data[e.data.length-2][0];"function"==typeof a.getTime?n.max<a.getTime()&&(n.max=a.getTime()):n.max<a&&(n.max=a)}}),V.optionsGraphBars()&&n.min==n.max&&(n.min=V.roundViewDate(V.additionalSettings.actualBarInterval.value,new Date(n.min),"floor").getTime(),n.max=V.roundViewDate(V.additionalSettings.actualBarInterval.value,new Date(n.max),"middle").getTime()),n},V.cachePreviousTypeModulo=!1,V.moduloDataRange={min:null,max:null},V.$watch("graphCommands.changeGraphType",function(e,t){var a;if(void 0!==e){if(V.additionalSettings.linearTransformation=!1,void 0!==V.graphOptions.series.bars&&0!=V.graphOptions.series.bars.show||!V.revertBarXaxisOptions||(V.graphOptions.xaxis={},V.revertBarXaxisOptions=!1,V.defaultGraphOptions.xaxis.min=V.roundViewDate(V.additionalSettings.actualBarInterval.value,new Date(V.defaultGraphOptions.xaxis.min),"floor",1).getTime(),V.defaultGraphOptions.xaxis.max=V.roundViewDate(V.additionalSettings.actualBarInterval.value,new Date(V.defaultGraphOptions.xaxis.max),"floor",1).getTime()),void 0!==V.graphOptions.series.modulo&&1==V.graphOptions.series.modulo.show){V.setModuloGraph=!0,V.cachePreviousTypeModulo=!0,(void 0!==V.graphData[0]&&void 0===V.defaultGraphOptions.xaxis.max&&void 0===V.defaultGraphOptions.xaxis.min||isNaN(V.defaultGraphOptions.xaxis.min)&&isNaN(V.defaultGraphOptions.xaxis.max)||null==V.defaultGraphOptions.xaxis.min&&null==V.defaultGraphOptions.xaxis.max)&&V.setXaxisMinMax();var n=V.findAllSeriesDataMinMax(V.graphData);switch(V.moduloDataRange.min=n.min,V.moduloDataRange.max=n.max,V.additionalSettings.actualInterval.label){case"day":V.defaultGraphOptions.xaxis.min=0,V.defaultGraphOptions.xaxis.max=864e5;break;case"week":V.defaultGraphOptions.xaxis.min=0,V.defaultGraphOptions.xaxis.max=6048e5}}else 1==V.defaultGraphOptions.yaxis.globalRange&&(V.defaultGraphOptions.xaxis.min=null,V.defaultGraphOptions.xaxis.max=null),V.defaultGraphOptions.yaxis.globalRange=!1,V.cachePreviousTypeModulo&&null!=V.moduloDataRange.min&&null!=V.moduloDataRange.max?(V.defaultGraphOptions.xaxis.min=V.moduloDataRange.min,V.defaultGraphOptions.xaxis.max=V.moduloDataRange.max,V.cachePreviousTypeModulo=!1):V.cachePreviousTypeModulo&&V.setXaxisMinMax();if((void 0!==V.graphData[0]&&void 0===V.defaultGraphOptions.xaxis.max&&void 0===V.defaultGraphOptions.xaxis.min||isNaN(V.defaultGraphOptions.xaxis.min)&&isNaN(V.defaultGraphOptions.xaxis.max)||null==V.defaultGraphOptions.xaxis.min&&null==V.defaultGraphOptions.xaxis.max)&&V.setXaxisMinMax(),angular.isDefined(V.graphOptions)&&angular.isDefined(V.graphOptions.series.carpet)&&V.graphOptions.series.carpet.show&&0<V.graphData.length){V.defaultGraphOptions.xaxis.min=V.roundViewDate("day",new Date(V.defaultGraphOptions.xaxis.min),"floor").getTime();var i=new Date(V.defaultGraphOptions.xaxis.max);0!=i.getHours()&&0!=i.getMinutes()&&0!=i.getSeconds()&&(V.defaultGraphOptions.xaxis.max=V.roundViewDate("day",i,"ceil").getTime())}else if(V.optionsGraphModuloCarpet())V.countModuloCarpetGraphData();else if(V.optionsGraphBars()){V.countBarGraphData();var r=V.findAllSeriesDataMinMax(V.barSeries);n=V.findAllSeriesDataMinMax(),void 0!==V.additionalSettings.actualBarInterval&&(V.roundViewDate(V.additionalSettings.actualBarInterval.value,new Date(r.min),"middle").getTime()>V.defaultGraphOptions.xaxis.min&&(V.defaultGraphOptions.xaxis.min=r.min),V.roundViewDate(V.additionalSettings.actualBarInterval.value,new Date(r.max),"middle").getTime()<V.defaultGraphOptions.xaxis.max&&(V.defaultGraphOptions.xaxis.max=r.max),V.defaultGraphOptions.xaxis.min=V.roundViewDate(V.additionalSettings.actualBarInterval.value,new Date(V.defaultGraphOptions.xaxis.min),"middle",-1).getTime(),V.defaultGraphOptions.xaxis.max=V.roundViewDate(V.additionalSettings.actualBarInterval.value,new Date(V.defaultGraphOptions.xaxis.max),"middle").getTime())}else{var o=V.findAllSeriesDataMinMax();o.max<new Date(V.defaultGraphOptions.xaxis.max).getTime()&&(V.defaultGraphOptions.xaxis.max=o.max)}a=V.countMinMaxSerieData(V.getActualSeriesByType()),void 0!==V.graphOptions.yaxis&&void 0!==V.graphOptions.yaxis.globalRange&&V.graphOptions.yaxis.globalRange?(V.defaultGraphOptions.yaxis.min=a.minValue,V.defaultGraphOptions.yaxis.max=a.maxValue):V.optionsGraphModuloCarpet()||(V.defaultGraphOptions.yaxis.min=a.minValue,V.defaultGraphOptions.yaxis.max=a.maxValue)}g()}),V.$watch("graphCommands.showLoadingScreen",function(e,t){}),V.legends=$(I).find(".legendLabel");var u=null;return V.latestPosition=null,V.updateLegend=function(){var e=!V.additionalSettings.tooltipsHidden;if(V.legends=$(I).find(".legendLabel"),u=null,0!=V.legends.length&&!V.optionsGraphModulo()&&void 0!==V.plot&&void 0!==V.latestPosition&&null!=V.latestPosition){var t=V.latestPosition,a=!1,n=V.plot.getAxes();(t.x<n.xaxis.min||t.x>n.xaxis.max)&&(a=!0);var i,r=V.plot.getData();for(i=0;i<r.length;++i){2==V.legends[i].children.length&&$(V.legends[i]).append(angular.element('<span class="series-value" style="font-weight: bold;"></span>'));var o=V.legends[i].children[2],l=r[i];if((angular.isDefined(E.hiddenSeries[r[i].idx])||void 0===V.graphOptions||void 0===V.graphOptions.crosshair||void 0===V.graphOptions.crosshair.mode||null==V.graphOptions.crosshair.mode)&&void 0!==o&&0<l.data.length)$(o).html("");else if(0<l.data.length)if(0==e){var s="";s=void 0!==l.dp&&void 0!==l.dp.valueProperties.StdVis_V1&&void 0!==l.dp.valueProperties.StdVis_V1.value.value.Output?E.interpolateString(l,t,a,null,n,l.dp.valueProperties.StdVis_V1.value.value.Output.dec,V.graphOptions.series.lines.ignoreNullValues):E.interpolateString(l,t,a,null,n,2,V.graphOptions.series.lines.ignoreNullValues),$(o).html(s)}else $(o).html("")}}},V.$watch("graphCommands.trimData",function(e,t){if(e!=t){V.additionalSettings.intervalFromTo.from=new Date(V.defaultGraphOptions.xaxis.min),V.additionalSettings.intervalFromTo.to=new Date(V.defaultGraphOptions.xaxis.max),V.optionsGraphBars()&&(V.additionalSettings.intervalFromTo.from=V.roundViewDate(V.additionalSettings.actualBarInterval.value,new Date(V.additionalSettings.intervalFromTo.from),"floor",1),V.additionalSettings.intervalFromTo.to=V.roundViewDate(V.additionalSettings.actualBarInterval.value,new Date(V.additionalSettings.intervalFromTo.to),"ceil")),V.additionalSettings.projectGraphTimeRange={interval:"fromTo",option:"from/to"};var l=[];angular.forEach(V.graphData,function(a){var n=[],i=!1;if(void 0!==a.lines.steps&&1==a.lines.steps)var r=!0;else r=!1;var o=null;angular.forEach(a.data,function(e,t){null!=e&&(i=(V.additionalSettings.intervalFromTo.from.getTime()<=e[0].getTime()&&e[0].getTime()<=V.additionalSettings.intervalFromTo.to.getTime()||0==n.length&&V.additionalSettings.intervalFromTo.to.getTime()<=e[0].getTime())&&(r&&0==n.length&&void 0!==a.data[t-1]&&null!=a.data[t-1]&&n.push([V.additionalSettings.intervalFromTo.from,a.data[t-1][1]]),V.additionalSettings.intervalFromTo.from.getTime()<=e[0].getTime()&&e[0].getTime()<=V.additionalSettings.intervalFromTo.to.getTime())),i&&(V.optionsGraphBars()&&0==n.length&&void 0!==a.data[t-1]&&a.data[t-1],null!=a.data[t-1]&&null!=a.data[t-1]&&""!=a.data[t-1][2]&&0==n.length&&null!=a.data[t-1][2]&&a.data[t-1][2].getTime()!=V.additionalSettings.intervalFromTo.from.getTime()&&n.push([new Date(V.additionalSettings.intervalFromTo.from),e[1],a.data[t-1][2]]),n.push(e),o=t)}),(r||V.optionsGraphBars())&&void 0!==a.data[o+1]&&null!=a.data[o+1]&&n.push([V.additionalSettings.intervalFromTo.to,a.data[o+1][1]]),null==n[n.length-1]?n.splice(n.length-1,1):null!=n[n.length-1]&&""!=n[n.length-1][2]&&null!=a.data[n.length-1]&&null!=a.data[n.length-1][2]&&(null!=n[n.length-1][2]&&n[n.length-1][2].getTime()>V.additionalSettings.intervalFromTo.to.getTime()||n[n.length-1][0].getTime()>V.additionalSettings.intervalFromTo.to.getTime())&&n.push([new Date(V.additionalSettings.intervalFromTo.to),n[n.length-1][1],n[n.length-1][2]]),a.data=n,a.dataMin=null,a.dataMax=null,l.push(a)}),V.graphData=S("orderBy")(l,["+lines.steps","+serieOrder"])}}),$(I).bind("plothover",function(e,t,a){V.latestPosition=t,null==u&&(c(V.updateLegend,50),u=!0)}),V.$watch("defaultGraphOptions.xaxis.max",function(e,t){angular.isDefined(V.additionalSettings)&&(V.additionalSettings.selectedDataTo=e)}),V.$watch("defaultGraphOptions.xaxis.min",function(e,t){angular.isDefined(V.additionalSettings)&&(V.additionalSettings.selectedDataFrom=e)}),V.$watch("redrawExecuted",function(e,t){null==u&&(c(V.updateLegend,0),u=!0)}),V.$watch("additionalSettings.actualInterval",function(e,t){if(void 0!==e&&void 0!==t&&e.label!=t.label){switch(e.label){case"day":V.defaultGraphOptions.xaxis.min=0,V.defaultGraphOptions.xaxis.max=864e5;break;case"week":V.defaultGraphOptions.xaxis.min=0,V.defaultGraphOptions.xaxis.max=6048e5}V.setModuloGraph=!0,g()}}),V.$watch("additionalSettings.actualBarInterval",function(e,t){if(void 0!==e&&void 0!==t&&e.label!=t.label){var a=V.findAllSeriesDataMinMax(),n=new Date,i=V.roundViewDate(t.value,new Date(n),"middle",1),r=V.roundViewDate(e.value,new Date(n),"middle",1);if(i.getTime()>r.getTime()){var o=V.roundViewDate(t.value,new Date(V.defaultGraphOptions.xaxis.min),"floor",1),l=V.roundViewDate(t.value,new Date(V.defaultGraphOptions.xaxis.max),"ceil");V.defaultGraphOptions.xaxis.min=V.roundViewDate(V.additionalSettings.actualBarInterval.value,o,"middle",-1).getTime(),V.defaultGraphOptions.xaxis.max=V.roundViewDate(V.additionalSettings.actualBarInterval.value,l,"middle").getTime()}else o=V.roundViewDate(t.value,new Date(V.defaultGraphOptions.xaxis.min),"floor",-1),l=V.roundViewDate(t.value,new Date(V.defaultGraphOptions.xaxis.max),"ceil",-1),V.defaultGraphOptions.xaxis.min=V.roundViewDate(V.additionalSettings.actualBarInterval.value,o,"middle").getTime(),V.defaultGraphOptions.xaxis.max=V.roundViewDate(V.additionalSettings.actualBarInterval.value,l,"middle").getTime(),V.roundViewDate(V.additionalSettings.actualBarInterval.value,new Date(a.max),"middle").getTime()<=V.roundViewDate(V.additionalSettings.actualBarInterval.value,new Date(V.defaultGraphOptions.xaxis.max),"middle").getTime()&&(V.defaultGraphOptions.xaxis.max=V.roundViewDate(V.additionalSettings.actualBarInterval.value,new Date(a.max),"middle",-1).getTime());V.defaultGraphOptions.xaxis.min==V.defaultGraphOptions.xaxis.max&&(V.defaultGraphOptions.xaxis.min=V.roundViewDate(V.additionalSettings.actualBarInterval.value,new Date(V.defaultGraphOptions.xaxis.min),"middle",-1).getTime(),V.defaultGraphOptions.xaxis.max=V.roundViewDate(V.additionalSettings.actualBarInterval.value,new Date(V.defaultGraphOptions.xaxis.max),"middle").getTime()),V.countBarGraphData(),g()}}),V.axisMapIndexMap=[],V.numberOfAllYaxis=0,V.createMultipleAxisSettings=function(){V.axisMapIndexMap={},V.yaxisIndexEsgMap={},V.defaultGraphOptions.yaxis.min=null,V.defaultGraphOptions.yaxis.max=null;var a=V.graphOptions.yaxis;V.graphOptions.yaxes=[];var n=0;angular.forEach(S("orderBy")(V.graphData,"serieOrder"),function(e,t){E.serieIsHidden(e.idx)||1==e.lines.steps||(void 0===V.yaxisIndexEsgMap[e.yaxisIndexEsg]&&(V.axisMapIndexMap[n]=e.yaxisIndexEsg,V.yaxisIndexEsgMap[e.yaxisIndexEsg]=n,V.graphOptions.yaxes[n]={min:null,max:null},n++),$.extend(V.graphOptions.yaxes[V.graphOptions.yaxis.length-1],a)),V.numberOfAllYaxis<e.yaxisIndexEsg&&(V.numberOfAllYaxis=e.yaxisIndexEsg)}),angular.forEach(S("orderBy")(V.graphData,"serieOrder"),function(e,t){E.serieIsHidden(e.idx)||null==V.yaxisIndexEsgMap[e.yaxisIndexEsg]?e.yaxis=1:e.yaxis=V.yaxisIndexEsgMap[e.yaxisIndexEsg]+1,e.lines.steps})},V.$watch("additionalSettings.multipleAxis",function(e,t){var a;void 0!==e&&(e?V.createMultipleAxisSettings():angular.isDefined(V.graphOptions)&&(a=V.countMinMaxSerieData(V.getActualSeriesByType()),V.graphOptions.yaxes=[],void 0!==V.graphOptions.yaxis&&void 0!==V.graphOptions.yaxis.globalRange&&V.graphOptions.yaxis.globalRange?(V.defaultGraphOptions.yaxis.min=null,V.defaultGraphOptions.yaxis.max=null):(V.defaultGraphOptions.yaxis.min=a.minValue,V.defaultGraphOptions.yaxis.max=a.maxValue)),g())}),V.handleStringValues=function(){var a=[],n=[];angular.forEach(V.graphData,function(e){angular.isDefined(E.hiddenSeries[e.idx])?e.isVisible=!1:(e.isVisible=!0,$.isEmptyObject(e.dictionary)?n.push(e):a.push(e))}),0<(a=S("orderBy")(a,"-serieOrder")).length&&angular.forEach(a,function(e,t){e.digitalOrder=t,e.digitalSeriesCount=a.length,e.nonDigitalSeriesCount=n.length})},V.setModuloGraph=!1,V.revertBarXaxisOptions=!1,V.cacheBarSerieData={range:null,data:null,interval:null},V.cacheModuloCarpetSerieData={range:null,data:null,interval:null},V.cacheModuloSerieData={range:null,data:null,interval:null},V.unitTranspositionTable={kW:{to:"kwH",transposition:36e5,barDataCountType:"actual"}},V.drawBarGraphType=function(e){var t,a;if(V.optionsGraphBars()){V.additionalSettings.actualBarInterval.value;var n=0;V.barSeries=[],angular.forEach(V.graphData,function(t,e){var a=null;void 0!==t.bars&&1==t.bars.show||0==V.additionalSettings.graphSettingsForOneSerie?angular.forEach(V.cacheBarSerieData.data,function(e){t.idx==e.idx&&void 0!==(a=e).bars&&1==e.bars.show&&n++}):(a=t).lines.show=!0,null!=a?(V.barSeries.push(a),!angular.isDefined(E.hiddenSeries[t.idx])&&(void 0===t.bars||t.bars.show)):(t.lines.show=!0,t.lines.points=!0,V.barSeries.push(t))}),t=V.countMinMaxSerieData(V.barSeries),V.additionalSettings.graphBarNorm?0==Math.min(t.minValue,0)?(V.defaultGraphOptions.yaxis.min=Math.min(t.minValue,0),V.defaultGraphOptions.yaxis.max=1.03*t.maxValue):0==Math.max(t.maxValue,0)?(V.defaultGraphOptions.yaxis.min=1.03*t.minValue,V.defaultGraphOptions.yaxis.max=Math.max(t.maxValue,0)):(V.defaultGraphOptions.yaxis.min=1.03*t.minValue,V.defaultGraphOptions.yaxis.max=1.03*t.maxValue):(void 0!==V.graphOptions.yaxis&&void 0!==V.graphOptions.yaxis.globalRange&&V.graphOptions.yaxis.globalRange,V.defaultGraphOptions.yaxis.min=t.minValue,V.defaultGraphOptions.yaxis.max=t.maxValue),1<n&&1!=V.graphOptions.series.stack?(V.graphOptions.series.bars.order=n,V.graphOptions.series.bars.align="left"):(V.graphOptions.series.bars.order=null,V.graphOptions.series.bars.align="center");var i=V.findAllSeriesDataMinMax(V.barSeries),r=i.max-i.min;if("quarterhour"==V.additionalSettings.actualBarInterval.value)var o=Math.ceil(r/9e5);if("hour"==V.additionalSettings.actualBarInterval.value&&(o=Math.ceil(r/36e5)),"day"==V.additionalSettings.actualBarInterval.value&&(o=Math.ceil(r/864e5)),"week"==V.additionalSettings.actualBarInterval.value&&(o=Math.ceil(r/6048e5)),"month"==V.additionalSettings.actualBarInterval.value){var l=1+new Date(i.max).getMonth()-new Date(i.min).getMonth();o=l+=12*(new Date(i.max).getYear()-new Date(i.min).getYear())}"quarter"==V.additionalSettings.actualBarInterval.value&&(l=1+new Date(i.max).getMonth()-new Date(i.min).getMonth(),l+=12*(new Date(i.max).getYear()-new Date(i.min).getYear()),o=Math.ceil(l/3)),"year"==V.additionalSettings.actualBarInterval.value&&(V.findAllSeriesDataMinMax(),o=1+new Date(i.max).getYear()-new Date(i.min).getYear()),0==r&&(r=0);var s=r/(o+1)*.75,u=s/n;V.graphOptions.series.stack&&(u=s),V.graphOptions.series.bars.groupsNumber=o,V.graphOptions.series.bars.range=r,V.graphOptions.series.bars.countVisibleSeries=n,V.graphOptions.series.bars.width=V.graphWidth;var c=(V.graphOptions.series.bars.barWidth=u)*(V.graphWidth/(V.defaultGraphOptions.xaxis.max-V.defaultGraphOptions.xaxis.min));switch(V.graphOptions.message=c<1?{show:!0,caution:S("i18n")("Graph can not be displayed properly."),verbose:S("i18n")("Columns of this bar graph are narrower than 1 pixel, which leads to worse quality of displayed graph. We highly recommend to change graph range or type of bar.")}:{show:!1},V.additionalSettings.actualBarInterval.value){case"quarterhour":V.graphOptions.xaxis={};break;case"hour":V.graphOptions.xaxis={minTickSize:[1,"hour"]};break;case"day":V.graphOptions.xaxis={timeformat:"%Y-%m-%d",tickSize:[1,V.additionalSettings.actualBarInterval.value]};break;case"week":break;case"month":V.graphOptions.xaxis={timeformat:"%Y-%m",tickSize:[1,V.additionalSettings.actualBarInterval.value]};break;case"quarter":V.graphOptions.xaxis={timeformat:"%qQ<br />%Y",tickSize:[1,V.additionalSettings.actualBarInterval.value]};break;case"year":V.graphOptions.xaxis={timeformat:"%Y",tickSize:[1,V.additionalSettings.actualBarInterval.value]}}return V.revertBarXaxisOptions=!0,null==V.defaultGraphOptions.xaxis.max&&null==V.defaultGraphOptions.xaxis.min?(V.defaultGraphOptions.xaxis.min=V.roundViewDate(V.additionalSettings.actualBarInterval.value,new Date(i.min),"middle",-1).getTime(),V.defaultGraphOptions.xaxis.max=V.roundViewDate(V.additionalSettings.actualBarInterval.value,new Date(i.max),"middle").getTime()):(V.roundViewDate(V.additionalSettings.actualBarInterval.value,new Date(i.min),"middle").getTime(),V.defaultGraphOptions.xaxis.min,V.roundViewDate(V.additionalSettings.actualBarInterval.value,new Date(i.max),"middle").getTime(),V.defaultGraphOptions.xaxis.max),"week"==V.additionalSettings.actualBarInterval.value&&null!=V.defaultGraphOptions.xaxis.max&&(12==new Date(V.defaultGraphOptions.xaxis.min).getHours()&&(V.defaultGraphOptions.xaxis.min-=72e5),12==new Date(V.defaultGraphOptions.xaxis.max).getHours()&&(V.defaultGraphOptions.xaxis.max+=72e5)),1==V.additionalSettings.graphOscilloscopeRegime&&(1!=V.additionalSettings.zoomPaneIsUsed||V.defaultGraphOptions.xaxis.lastPointVisible)&&i.max>V.defaultGraphOptions.xaxis.max&&(V.defaultGraphOptions.xaxis.max=i.max+Math.ceil(2/3*s),V.defaultGraphOptions.xaxis.max=i.max+Math.ceil(2/3*s)),V.defaultGraphOptions.xaxis.lastPointVisible=i.max<V.defaultGraphOptions.xaxis.max,V.additionalSettings.graphShowAggreagation?(a=V.countMinMaxSerieData(V.barSeries,!1,!0),V.graphOptions.aggreagation={max:a.maxValue,min:a.minValue}):V.graphOptions.aggreagation={},V.drawedGraphOptions=V.prepareGraphOptions(!0,e,V.defaultGraphOptions,V.graphOptions),V.plot=T=$.plot(I,V.barSeries,V.drawedGraphOptions),I.show(),!0}return!1},V.drawModuloGraphType=function(e){function c(e){var t=null;switch(x){case"day":(t=new Date(e)).setHours(0,0,0,0),t=t.getTime();break;case"week":(t=new Date(e)).setHours(0,0,0,0);var a=t.getDay();t=t.getTime(),1!=a&&(t-=0!=a?n*(a-1):6*n);break;case"year":(t=new Date(e)).setHours(0,0,0,0),t.setMonth(0),t.setDate(1)}return t}function d(e){if("#"==e[0]&&(e=e.substr(1)),3==e.length){var t=e;e="",t=/^([a-f0-9])([a-f0-9])([a-f0-9])$/i.exec(t).slice(1);for(var a=0;a<3;a++)e+=t[a]+t[a]}var n=/^([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})$/i.exec(e).slice(1);return{red:parseInt(n[0],16),green:parseInt(n[1],16),blue:parseInt(n[2],16)}}function p(e,t){if(null==e)return!0;switch(x){case"day":if(e.getTime()<t+n)return!0;break;case"week":if(e.getTime()<t+7*n)return!0;break;case"year":if(e.getYear()==t.getYear())return!0}return!1}function g(){switch(x){case"day":return new Date(n);case"week":return new Date(7*n);case"year":var e=new Date(v);return e.setFullYear(v.getYear()+1),e}}var t;if(V.optionsGraphModulo()&&0<V.graphData.length){var h=[],f=null,m=[],v=null,n=864e5,x=V.additionalSettings.actualInterval.value;if(V.setModuloGraph){V.drawedGraphOptions=V.prepareGraphOptions(!0,e,V.defaultGraphOptions,V.graphOptions),V.moduloSeries=[];var b=0;angular.forEach(V.graphData,function(e){if(void 0!==e.data[0]){v=c(e.data[0][0]);var t=b%(V.drawedGraphOptions.colors.length-1),a=d(V.drawedGraphOptions.colors[t]),n="rgba("+a.red+","+a.green+","+a.blue+",0.5)",i=0,r=!0;m=[];for(var o=0;o<e.data.length;o++){var l=e.data[o];if(null!=l&&null!=V.moduloDataRange.min&&null!=V.moduloDataRange.max){if(l[0]<V.moduloDataRange.min)continue;if(l[0]>V.moduloDataRange.max)break}if(null==l||p(l[0],v)){if(null==l){if(0==m.length)return;var s=null}else s=[l[0]-v,l[1]];if(m.push(s),null!=l&&void 0!==l[2]&&!p(new Date(l[2]),v)){var u=new Date(l[2]);isNaN(u.getTime())||(m.push([g(),l[1],l[2]]),void 0!==e.data[o+1]&&(l=[new Date(c(l[2])),l[1],l[2]]))}}if(null!=l&&!p(l[0],v)||e.data.length-1==i){if(null==l)return;null==m[m.length-1]&&m.splice(m.length-1,1),f={label:e.labelDp,moduloLabel:e.label,fullLabel:e.fullLabel,nameSuffix:e.nameSuffix,color:n,data:m,lines:{show:e.lines.show,steps:e.lines.steps},points:{show:!1},dpUnit:e.dpUnit,dictionary:e.dictionary,startSerie:new Date(v).getTime(),range:x,labelsX:y.getDateTimeFormat("shortday"),dateFunction:S("dateFormatCSharp")},r&&(f.label=e.label,r=!1),h.push(f),m=[],v=c(l[0]),s=null==l?null:[l[0]-v,l[1]],0<m.length&&m.push(s)}i++}b++}}),h.length<=5&&angular.forEach(h,function(e,t){var a=d(V.drawedGraphOptions.colors[t]),n="rgba("+a.red+","+a.green+","+a.blue+",0.5)";h[t].color=n});var a=V.findAllSeriesDataMinMax(h);switch(x){case"day":case"week":case"year":V.defaultGraphOptions.xaxis.min=a.min,V.defaultGraphOptions.xaxis.max=a.max}V.moduloSeries=h,V.setModuloGraph=!1}return t=V.countMinMaxSerieData(V.moduloSeries),void 0!==V.graphOptions.yaxis&&void 0!==V.graphOptions.yaxis.globalRange&&V.graphOptions.yaxis.globalRange,V.defaultGraphOptions.yaxis.min=t.minValue,V.defaultGraphOptions.yaxis.max=t.maxValue,V.handleVisibilityOfButtons(),V.graphOptions.message={show:!1,caution:"",verbose:""},V.drawedGraphOptions=V.prepareGraphOptions(!0,e,V.defaultGraphOptions,V.graphOptions),V.plot=T=$.plot(I,V.moduloSeries,V.drawedGraphOptions),I.show(),!0}return!1},V.drawModuloCarpetGraphType=function(e){return!!(V.optionsGraphModuloCarpet()&&null!=V.moduloCarpetSeries&&0<V.moduloCarpetSeries.length)&&(V.additionalSettings.moduloCarpetInterval.value,V.graphOptions.message={show:!1,caution:"",verbose:""},V.drawedGraphOptions=V.prepareGraphOptions(!0,e,V.defaultGraphOptions,V.graphOptions),o.setAxes(V.additionalSettings.moduloCarpetInterval,V.drawedGraphOptions,V.moduloCarpetSeries[0].moduloCarpet.years.length),e.selection.mode=null,e.labelsFunction=y.getDateTimeFormat,V.plot=T=$.plot(I,V.moduloCarpetSeries,V.drawedGraphOptions),I.show(),!0)},V.dataInterval={quarterhour:{minutes:15,day:0,month:0,year:0},hour:{minutes:60,day:0,month:0,year:0},day:{minutes:0,day:1,month:0,year:0},week:{minutes:0,day:7,month:0,year:0},month:{minutes:0,day:0,month:1,year:0},quarter:{minutes:0,day:0,month:3,year:0},year:{minutes:0,day:0,month:0,year:1}},["$scope","iElement","iAttrs","controller",function(e,t,a,n){}]}},controller:["$scope",function(u){u.xaxisMode="time",u.prepareGraphOptions=function(e,t,a,n){var i=$.extend(e,t,a,n);return"function"==typeof r.graphOverrideOptionsFce&&r.graphOverrideOptionsFce(i),i},u.optionsGraphLines=function(){return angular.isDefined(u.graphOptions)&&angular.isDefined(u.graphOptions.series)&&angular.isDefined(u.graphOptions.series.lines.show)?u.graphOptions.series.lines.show:u.defaultGraphOptions.series.lines.show},u.optionsGraphCarpet=function(){var e=!1;return angular.isDefined(u.graphOptions)&&angular.isDefined(u.graphOptions.series)&&angular.isDefined(u.graphOptions.series.carpet)&&angular.isDefined(u.graphOptions.series.carpet.show)&&(e=u.graphOptions.series.carpet.show),e},u.optionsGraphModuloCarpet=function(){var e=!1;return angular.isDefined(u.graphOptions)&&angular.isDefined(u.graphOptions.series)&&angular.isDefined(u.graphOptions.series.moduloCarpet)&&angular.isDefined(u.graphOptions.series.moduloCarpet.show)&&(e=u.graphOptions.series.moduloCarpet.show),e},u.optionsGraphBars=function(){var e=!1;return angular.isDefined(u.graphOptions)&&angular.isDefined(u.graphOptions.series)&&angular.isDefined(u.graphOptions.series.bars)&&angular.isDefined(u.graphOptions.series.bars.show)&&(e=u.graphOptions.series.bars.show),e},u.optionsGraphModulo=function(){var e=!1;return angular.isDefined(u.graphOptions)&&angular.isDefined(u.graphOptions.series)&&angular.isDefined(u.graphOptions.series.modulo)&&angular.isDefined(u.graphOptions.series.modulo.show)&&(e=u.graphOptions.series.modulo.show),e},u.optionsGraphPoints=function(){return angular.isDefined(u.graphOptions)&&angular.isDefined(u.graphOptions.series)&&angular.isDefined(u.graphOptions.series.points.show)?u.graphOptions.series.points.show:u.defaultGraphOptions.series.points.show},u.optionsOscilloRegime=function(){return!(void 0===u.additionalSettings||void 0===u.additionalSettings.graphOscilloscopeRegime||!u.additionalSettings.graphOscilloscopeRegime&&!u.additionalSettings.graphWeekOscilloscopeRegime)},u.getActualSeriesByType=function(){var e;return u.optionsGraphModulo()?e=u.moduloSeries:u.optionsGraphBars()?void 0!==u.barSeries&&(e=u.barSeries):u.optionsGraphModuloCarpet()?void 0!==u.moduloCarpetSeries&&(e=u.moduloCarpetSeries):e=u.graphData,e},u.countMinMaxSerieData=function(e,t,a,n){var i=!1;null!=u.graphOptions.xaxis&&null!=u.graphOptions.xaxis.mode?i="time"==u.graphOptions.xaxis.mode:null!=u.drawedGraphOptions&&null!=u.drawedGraphOptions.xaxis&&null!=u.drawedGraphOptions.xaxis.mode?i="time"==u.drawedGraphOptions.xaxis.mode:null!=u.defaultGraphOptions&&null!=u.defaultGraphOptions.xaxis&&null!=u.defaultGraphOptions.xaxis.mode&&(i="time"==u.defaultGraphOptions.xaxis.mode);var r=u.defaultGraphOptions.yaxis.globalRange;1!=a&&0!=u.additionalSettings.zoomPaneIsUsed||(r=!0);var o={minValue:null,maxValue:null};if(void 0===e)return o;if(0<e.length&&void 0!==e[0].yaxisObj&&null!=e[0].yaxisObj.min&&null!=e[0].yaxisObj.max)return{minValue:e[0].yaxisObj.min,maxValue:e[0].yaxisObj.max};if(o=u.optionsGraphModulo()||n||u.optionsOscilloRegime()?E.countMinMaxSerieData(e,r,!u.optionsGraphBars(),u.defaultGraphOptions.xaxis.min,u.defaultGraphOptions.xaxis.max,u.defaultGraphOptions.yaxis.autoscaleMargin,u.additionalSettings.zoomPaneIsUsed,!0,!1,i):1==u.graphOptions.series.stack&&1!=u.graphOptions.series.stackOver?E.countMinMaxSerieData(e,r,!u.optionsGraphBars(),u.defaultGraphOptions.xaxis.min,u.defaultGraphOptions.xaxis.max,u.defaultGraphOptions.yaxis.autoscaleMargin,u.additionalSettings.zoomPaneIsUsed,!1,!0,i):E.countMinMaxSerieData(e,r,!u.optionsGraphBars(),u.defaultGraphOptions.xaxis.min,u.defaultGraphOptions.xaxis.max,u.defaultGraphOptions.yaxis.autoscaleMargin,u.additionalSettings.zoomPaneIsUsed,!1,!1,i),null!=u.graphOptions&&null!=u.graphOptions.yaxis&&null!=u.graphOptions.yaxis.minRange){var l=o.maxValue-o.minValue;if(l<u.graphOptions.yaxis.minRange){var s=u.graphOptions.yaxis.minRange-l;o.maxValue+=s/2,o.minValue-=s/2}}return o}}]}}]).directive("toolTipContainer",["$log","$filter","ESGGraphHelper","$compile",function(e,d,p,l){return{transclude:!1,template:'<div class="tool-tip-container" ng-show="showToolTip(settings, graphOptions) && graphData.length > 0 "> \t\t\t\t\t\t\t\t\t\t<tool-tip-bottom position="TBposition" pos-to-date="posToDate" plot="plot" tb-inside="tbInside" settings="settings" graph-options="graphOptions" edge-met="edgeMet"></tool-tip-bottom> \t\t\t\t\t\t\t\t\t</div>',replace:!0,restrict:"E",scope:{graphData:"=",pos:"=",plot:"=",settings:"=",graphOptions:"=",redrawExecuted:"="},link:function(r,o,e){return r.$watch("plot",function(e,t){null!=e&&r.$watch("graphData",function(t,e){angular.forEach(t,function(e){if(void 0===e.toolTipFloat||-1==r.toolTips.indexOf(e.toolTipFloat.scope.tooltip)){var t={};t.series=e,t.outOfCanvas=!1,r.toolTips.push(t),r.colors=r.plot.getData();var a=angular.element('<tool-tip-element tooltip="tooltip" plot="plot" tt-out-of-range="outOfRange" settings="settings" edge-met="edgeMet" colors="colors" redraw-executed="redrawExecuted"></tool-tip-element>'),n=r.$new();n.tooltip=t;var i=l(a)(n);o.append(i),e.toolTipFloat={scope:n,container:i}}}),void 0!==r.toolTips[0]&&(r.tooltipSize=r.toolTips[0].series.toolTipFloat.container[0].children[0].clientHeight,0==r.tooltipSize&&(r.tooltipSize=17));var a=null!=e?jQuery.grep(e,function(e){return jQuery.inArray(e,t)<0}):[];angular.forEach(a,function(e){if(null!=e.toolTipFloat){for(var t=0;t<r.toolTips.length;t++){var a=r.toolTips[t];if(a.series.idx==e.idx){var n=r.toolTips.indexOf(a);r.toolTips.splice(n,1);break}}e.toolTipFloat.scope.$destroy(),e.toolTipFloat.container.remove(),delete e.toolTipFloat}r.colors=r.plot.getData()}),r.toolTips=d("orderBy")(r.toolTips,["series.lines.steps","series.serieOrder"])})}),r.$watch("pos",function(e,t){null!=r.graphOptions&&null!=r.graphOptions.crosshair&&1!=r.graphOptions.crosshair.lock&&r.resolveNewPosition(e)}),r.$watch("redrawExecuted",function(e,t){e!=t&&r.resolveNewPosition(r.pos)}),r.$watch("edgeMet.value",function(e,t){e!=t&&0==e&&r.resolveNewPosition(r.pos)}),r.$watch("outOfRange.value",function(e,t){e!=t&&r.resolveNewPosition(r.pos)}),r.$watch("canvas.clientHeight",function(e,t){e!=t&&void 0!==e&&void 0!==r.plot&&r.resolveNewPosition(r.pos,e)}),["$scope","iElement","iAttrs","controller",function(e,t,a,n){}]},controller:["$scope",function(c){c.toolTips=[],c.outOfRange={value:!1,idx:null,width:0},c.tbInside=0,c.edgeMet={},c.edgeMet.value=!0,c.actualValue={formattedValue:"",y:""},c.showToolTip=p.showToolTip,c.resolveNewPosition=function(l,e){if(c.showToolTip(c.settings,c.graphOptions)&&void 0!==l&&null!=l){var t=c.plot.offset(),s=Math.max(0,Math.min(l.pageX-t.left,c.plot.width())),a=Math.max(0,Math.min(l.pageY-t.top,c.plot.height())),u=c.plot.c2p({left:s,top:a});angular.forEach(c.toolTips,function(e){if(p.serieIsHidden(e.series.idx))null!=e.position&&(e.position.top=-20);else{if(c.actualValue=p.interpolateNull(e.series,{x:u.x1},c.graphOptions.series.lines.ignoreNullValues),1==e.series.lines.steps){var t=c.plot.getOptions().globalStringDictionary.recountedDictionary[e.series.idx];null!=t&&null!=t[c.actualValue.y]&&(c.actualValue.y=c.plot.getOptions().globalStringDictionary.recountedDictionary[e.series.idx][c.actualValue.y])}if(null!=c.plot.getOptions().globalStringDictionary.recountedDictionary[e.series.idx]&&null!=c.plot.getOptions().globalStringDictionary.recountedDictionary[e.series.idx][c.actualValue.y]&&(c.actualValue.yOriginal=c.actualValue.y,c.actualValue.y=c.plot.getOptions().globalStringDictionary.recountedDictionary[e.series.idx][c.actualValue.y]),angular.isDefined(e.series.lines.steps)&&e.series.lines.steps){var a=null,n=c.plot.getOptions().globalStringDictionary.recountedDictionary[e.series.idx];if(void 0!==n)for(var i in n)n[i]==c.actualValue.y&&(a=i);if(null!=a)for(var i in e.series.dictionary)e.series.dictionary[i]==a&&(c.actualValue.formattedValue=i)}c.label=p.compareNearestPointXWise(c.graphOptions,c.plot,c.actualValue,u.x1,e.series),1!=e.series.lines.steps&&isNaN(c.label.formattedValue)&&(c.label.y=null);var r={x:l.x};c.posToDate=l.x;var o="y";void 0!==e.series.yaxis&&(o+=e.series.yaxis),r[o]=c.actualValue.y,e.position=c.plot.p2c(r),e.position.left=Math.max(0,s),void 0===e.position.top&&(1==c.settings.showTooltipsNoData&&1!=e.series.seriesError?e.position.top=0:e.position.top=-20),void 0!==c.label.yTrans?(e.value=c.label.yTrans,e.valueBeforeTrans=c.label.formattedValue):(e.value=c.label.formattedValue,delete e.valueBeforeTrans)}}),c.TBposition={value:Math.max(0,s)};for(var n=d("orderBy")(c.toolTips,["position.top","series.lines.steps","series.serieOrder"]),i=0;i<n.length-1;i++)null==n[i].position||null==n[i+1].position||n[i].position.top<0||n[i+1].position.top<0||n[i+1].position.top-n[i].position.top<c.tooltipSize&&(n[i+1].position.top=n[i].position.top+c.tooltipSize);void 0!==e?c.resolveNewCanvasHeight(e,n):(c.canvas=c.plot.getCanvas(),c.resolveNewCanvasHeight(c.canvas.clientHeight,n))}},c.resolveNewCanvasHeight=function(e,t){if(void 0!==c.tooltipSize){var a=e-c.plot.getPlotOffset().bottom,n=t.length;if(angular.forEach(t,function(e){(null==e.position||e.position.top<0)&&(n-=1)}),a<c.tooltipSize)angular.forEach(t,function(e){e.outOfCanvas=!0});else if(void 0!==c.tooltipSize&&0<c.tooltipSize)for(var i=n-Math.floor(a/c.tooltipSize),r=t.length-1;0<=r;r--)0<i&&0<t[r].position.top?(t[r].outOfCanvas=!0,i-=1):t[r].outOfCanvas=!1;var o=0,l=a;for(r=t.length-1;0<=r;r--)if(null!=t[r].position&&!t[r].outOfCanvas){if(t[r].position.top<0)break;if(!(0<(o=t[r].position.top+c.tooltipSize-l)))break;t[r].position.top-=o,l=t[r].position.top}}}}]}}]).directive("toolTipElement",["$log","$filter","ESGGraphHelper","$document",function(e,l,t,a){return{transclude:!1,template:'<div> \t\t\t\t\t\t\t\t\t<div class="toolTip" ng-show="!edgeMet.value && (!settings.tooltipsHidden) && (oldPosition != -20) && (!tooltip.outOfCanvas)"> \t\t\t\t\t\t\t\t\t\t<div> \t\t\t\t\t\t\t\t\t\t\t<div class="label"> \t\t\t\t\t\t\t\t\t\t\t</div> \t\t\t\t\t\t\t\t\t\t\t<div class="color-box"> \t\t\t\t\t\t\t\t\t\t\t</div> \t\t\t\t\t\t\t\t\t\t\t<div class="value"> \t\t\t\t\t\t\t\t\t\t\t</div> \t\t\t\t\t\t\t\t\t\t</div> \t\t\t\t\t\t\t\t\t</div> \t\t\t\t\t\t\t\t</div>',replace:!0,restrict:"E",scope:{tooltip:"=",plot:"=",ttOutOfRange:"=",settings:"=",edgeMet:"=",colors:"=",redrawExecuted:"="},link:function(a,e,t){return a.elem=e[0].children[0],a.elementValue=angular.element(a.elem).find("div.value"),a.elementLabel=angular.element(a.elem).find("div.label"),a.$watch("settings.legendSettings.value",function(e,t){a.legend=e,a.htmlText(),a.resolveNewPosition(a.tooltip.position,a.ttOutOfRange.value)}),a.$watch("settings.tooltipsHidden",function(e,t){e!=t&&0==e&&a.resolveNewPosition(a.tooltip.position,a.ttOutOfRange.value)}),a.$watch("ttOutOfRange.value",function(e,t){a.elementValue.toggleClass("value"),a.elementValue.toggleClass("label"),a.elementLabel.toggleClass("value"),a.elementLabel.toggleClass("label"),a.resolveNewPosition(a.tooltip.position,e)}),a.$watch("redrawExecuted",function(e,t){e!=t&&a.resolveNewPosition(a.tooltip.position,a.ttOutOfRange.value)}),a.$watch("colors",function(e,t){void 0!==e&&angular.forEach(e,function(e){e.idx==a.tooltip.series.idx&&(a.tooltip.series.color=e.color)})}),["$scope","iElement","iAttrs","controller",function(e,t,a,n){}]},controller:["$scope",function(o){o.oldPosition=null,o.toolTipStyles={},o.legend=1,angular.forEach(o.colors,function(e){e.idx==o.tooltip.series.idx&&(o.tooltip.series.color=e.color)}),o.serieIsHidden=t.serieIsHidden,o.htmlText=function(){var e;if(null==o.tooltip.value)e=l("i18n")("no data");else{if("string"==typeof o.tooltip.value)e=o.tooltip.value;else{var t=0,a=".";if(void 0!==o.tooltip.series.dataMax&&void 0!==o.tooltip.series.dataMin)var n=o.tooltip.series.dataMax-o.tooltip.series.dataMin;n%1!=0&&n<1?(t=Math.ceil(Math.exp(n)),null!=o.settings.defaultRound&&t<o.settings.defaultRound&&(t=o.settings.defaultRound)):t=void 0!==o.tooltip.series.dp?null!=o.tooltip.series.dp.valueProperties.StdVis_V1&&null!=o.tooltip.series.dp.valueProperties.StdVis_V1.value&&null!=o.tooltip.series.dp.valueProperties.StdVis_V1.value.value.Output?o.tooltip.series.dp.valueProperties.StdVis_V1.value.value.Output.dec:2:null!=o.settings.defaultRound?o.settings.defaultRound:2,e=o.tooltip.value.toFixed(t);for(var i=0;i<t;i++)a+=i<2?"0":"#";0==t&&(a=""),e=l("numberFormatCSharp")(o.tooltip.value,"##,#"+a)}void 0!==o.tooltip.series.dpUnit&&null!=o.tooltip.series.dpUnit&&(e+=" "+o.tooltip.series.dpUnit),void 0!==o.tooltip.valueBeforeTrans&&(e+="; Y = ",void 0!==o.tooltip.series.dp?e+=null!=o.tooltip.series.dp.valueProperties.StdVis_V1&&null!=o.tooltip.series.dp.valueProperties.StdVis_V1.value&&null!=o.tooltip.series.dp.valueProperties.StdVis_V1.value.value.Output?o.tooltip.valueBeforeTrans.toFixed(o.tooltip.series.dp.valueProperties.StdVis_V1.value.value.Output.dec):o.tooltip.valueBeforeTrans.toFixed(2):e+=o.tooltip.valueBeforeTrans.toFixed(2))}var r=2==o.legend?o.tooltip.series.fullLabel:o.tooltip.series.label;angular.element(o.elem).find("div.value").html(e),angular.element(o.elem).find("div.color-box").css("background",o.tooltip.series.color),angular.element(o.elem).find("div.label").html(r)},o.resolveNewPosition=function(e,t){if(null!=e){var a=o.plot.getPlotOffset(),n=o.plot.getAxes();o.axes=o.plot.p2c({x:n.xaxis.max,y:n.yaxis.max}),o.htmlText();var i=o.elem.clientWidth;if(t){var r=e.left-(i-a.left);o.toolTipStyles.left=r+"px",o.toolTipStyles.top=e.top+"px",o.toolTipStyles.paddingLeft="0px",o.toolTipStyles.paddingRight="8px"}else r=e.left+a.left,o.toolTipStyles.left=r+"px",o.toolTipStyles.top=e.top+"px",o.toolTipStyles.paddingRight="0px",o.toolTipStyles.paddingLeft="8px";angular.element(o.elem).css(o.toolTipStyles),o.resolveBorders(r,i,a.left,t)}else o.edgeMet.value=!0},o.resolveBorders=function(e,t,a,n){n?o.tooltip.series.idx==o.ttOutOfRange.idx?e+2*o.ttOutOfRange.width<o.axes.left+a&&(o.ttOutOfRange.idx=null,o.ttOutOfRange.width=0,o.ttOutOfRange.value=!1):t>o.ttOutOfRange.width&&(o.ttOutOfRange.idx=o.tooltip.series.idx,o.ttOutOfRange.width=t):e+t>=o.axes.left+a&&(o.ttOutOfRange.idx=o.tooltip.series.idx,o.ttOutOfRange.width=t,o.ttOutOfRange.value=!0),e<=a||o.tooltip.position.left>=o.axes.left?o.edgeMet.value=!0:o.edgeMet.value=!1},o.$watch("tooltip.position",function(e,t){o.oldPosition=t,o.resolveNewPosition(e,o.ttOutOfRange.value)})}]}}]).directive("toolTipBottom",["$log","$filter","ESGGraphHelper","$document",function(e,l,t,a){return{transclude:!1,template:'<div ng-class="{toolTipeLock: graphOptions.crosshair.lock}"> \t\t\t\t\t\t\t\t\t\t<div class="toolTipBottom" ng-style="toolTipBottomStyles" ng-show="!edgeMet.value && !isNaN(posToDate)"> \t\t\t\t\t\t\t\t\t\t\t<div> \t\t\t\t\t\t\t\t\t\t\t</div> \t\t\t\t\t\t\t\t\t\t</div> \t\t\t\t\t\t\t\t\t</div>',replace:!0,restrict:"E",scope:{position:"=",posToDate:"=",plot:"=",tbInside:"=",settings:"=",edgeMet:"=",graphOptions:"="},link:function(a,e,t){return a.elem=e[0].children[0],a.$watch("edgeMet.value",function(e,t){e!=t&&0==e&&a.resolveNewPosition(a.pos)}),["$scope","iElement","iAttrs","controller",function(e,t,a,n){}]},controller:["$scope",function(o){o.isNaN=isNaN,o.resolveNewPosition=function(e){if(void 0!==e){var t=o.plot.getAxes();o.axes=o.plot.p2c({x:t.xaxis.min,y:t.yaxis.min}),o.axesMax=o.plot.p2c({x:t.xaxis.max,y:t.yaxis.max});var a=o.plot.getPlotOffset();if(void 0!==e&&o.resolveBorders(e),1==o.tbInside)var n=e+a.left-o.elem.clientWidth;else n=2==o.tbInside?e+a.left:e+a.left-o.elem.clientWidth/2;var i=o.plot.getCanvas().clientHeight-a.bottom;o.toolTipBottomStyles={left:n+"px",top:i+"px"};var r="";"time"==o.graphOptions.xaxis.mode?r+=l("dateFormatCSharp")(new Date(o.posToDate),"ddd")+"&nbsp"+l("dateFormatCSharp")(new Date(o.posToDate),"dd/MM/yyyy")+"<br>"+l("dateFormatCSharp")(new Date(o.posToDate),"HH:mm:ss"):"function"==typeof o.graphOptions.xaxis.tickFormatter?r+=o.graphOptions.xaxis.tickFormatter(o.posToDate,t.xaxis):r+=Math.round(o.posToDate),angular.element(o.elem).find("div").html(r)}},o.resolveBorders=function(e){o.plot.getPlotOffset(),1==o.tbInside?e+o.elem.clientWidth/2<o.axesMax.left&&(o.tbInside=0):2==o.tbInside?e>o.elem.clientWidth/2&&(o.tbInside=0):e<=o.elem.clientWidth/2?o.tbInside=2:e+o.elem.clientWidth/2>=o.axesMax.left&&(o.tbInside=1)},o.$watch("position",function(e,t){null!=e&&o.resolveNewPosition(e.value)})}]}}]).service("ESGGraphHelper",["$log",function(p){var A={previousNearestPointXWise:{},dataInterval:{quarterhour:{minutes:15,day:0,month:0,year:0},hour:{minutes:60,day:0,month:0,year:0},day:{minutes:0,day:1,month:0,year:0},week:{minutes:0,day:7,month:0,year:0},month:{minutes:0,day:0,month:1,year:0},quarter:{minutes:0,day:0,month:3,year:0},year:{minutes:0,day:0,month:0,year:1}},unitTranspositionTable:{kW:{to:"kwH",transposition:36e5,barDataCountType:"actual"}},hiddenSeries:{},roundViewDate:function(e,t,a,n){if(void 0===a&&(a="floor"),A.dataInterval[e],void 0!==n){if("week"!=e)var i=e;else i="day",n*=7;t=A.dateMoveInterval(t,n,i)}if("quarterhour"==e){var r=t.getMinutes(),o=Math.floor(r/15);return"middle"==a?t.setHours(t.getHours(),15*o+7,30,0):"ceil"==a?t.setHours(t.getHours(),15*o+15,59,999):t.setHours(t.getHours(),15*o,0,0),t}if("hour"==e)return"middle"==a?t.setHours(t.getHours(),30,0,0):"ceil"==a?t.setHours(t.getHours(),59,59,999):t.setHours(t.getHours(),0,0,0),t;if("middle"==a?t.setHours(12,0,0,0):"ceil"==a?t.setHours(23,59,59,999):t.setHours(0,0,0,0),"week"==e&&("middle"==a?t.setDate(t.getDate()+(4-t.getDay())):"ceil"==a?t.setDate(t.getDate()+(7-t.getDay())):t.setDate(t.getDate()+(1-t.getDay()))),"month"!=e&&"year"!=e||("middle"==a?t.setDate(Math.floor(new Date(t.getFullYear(),t.getMonth()+1,0).getDate()/2)):"ceil"==a?t.setDate(Math.floor(new Date(t.getFullYear(),t.getMonth()+1,0).getDate())):t.setDate(1)),"quarter"==e){var l=t.getMonth()+1;switch(l%3){case 1:l++;break;case 0:l--}"middle"==a?(t.setDate(Math.floor(new Date(t.getFullYear(),l,0).getDate()/2)),t.setMonth(l-1)):"ceil"==a?(t.setDate(Math.floor(new Date(t.getFullYear(),l+1,0).getDate())),t.setMonth(l)):(t.setDate(1),t.setMonth(l-2))}return"year"==e&&("middle"==a?(t.setMonth(5),t.setDate(1),t.setHours(0,0,0,0)):"ceil"==a?t.setMonth(11):t.setMonth(0)),t},dateMoveInterval:function(e,t,a){if("object"==typeof t)e.setMinutes(e.getMinutes()+t.minutes),e.setDate(e.getDate()+t.day),e.setMonth(e.getMonth()+t.month),e.setFullYear(e.getFullYear()+t.year);else switch(a){case"quarterhour":e.setMinutes(e.getMinutes()+15*t);break;case"hour":e.setHours(e.getHours()+t);break;case"day":e.setDate(e.getDate()+t);break;case"week":e.setDate(e.getDate()+7*t);break;case"month":e.setMonth(e.getMonth()+t);break;case"quarter":e.setMonth(e.getMonth()+3*t);break;case"year":e.setFullYear(e.getFullYear()+t)}return e},serieIsHidden:function(e){return 1==A.hiddenSeries[e]},showToolTip:function(e,t){var a=!0;return void 0!==t&&void 0!==t.crosshair&&void 0!==t.crosshair.mode&&null!=t.crosshair.mode||(a=!1),a},getTimestamp:function(e){return"function"==typeof e.getTime?e.getTime():e},interpolate:function(e,t,a){return(t[1]-e[1])*((a-e[0].getTime())/(t[0].getTime()-e[0].getTime()))+e[1]},countMinMaxSerieData:function(e,g,h,f,m,t,v,x,b,S){var y={minValue:Number.POSITIVE_INFINITY,maxValue:Number.NEGATIVE_INFINITY,zoom:!1};function w(e,t,a){return e>t.maxValue&&(t.maxValue=e,t.zoom=!0),e<t.minValue&&(t.minValue=e,t.zoom=!0),t}1==b&&(y={minValue:0,maxValue:0,zoom:!1}),void 0===g?g=!1:void 0!==f&&void 0!==m||(g=!0),void 0===x&&(x=!1),void 0===b&&(b=!1);var D=0;if(angular.forEach(e,function(e){if(!angular.isDefined(A.hiddenSeries[e.idx])){if(void 0!==e.digitalOrder)return void D++;var t={minValue:Number.POSITIVE_INFINITY,maxValue:Number.NEGATIVE_INFINITY,zoom:!1};if(null==e.dataMin||null==e.dataMax||e.dataMin==Number.POSITIVE_INFINITY||e.dataMax==Number.NEGATIVE_INFINITY||1!=g||0!=v||0!=x||""!=e.transformParams&&void 0!==e.transformParams&&null!=e.transformParams){var a=!1,n=!1;if(v||1==x){var i=A.bisectionMethod(0,e.data.length-1,{x:f},e.data);0<i&&i--}else i=0;for(var r=e.data.length,o=i;o<=r&&!n;o++){var l,s=e.data[o];null!=s&&null!=s[0]&&null!=s[1]&&(l=S?new Date(s[0]).getTime():s[0],1==g||f<=l&&l<=m||void 0===m&&void 0===f||null==m&&null==f?(!a&&0<o&&null!=e.data[o-1]&&h&&(t=w(e.data[o-1][1],t),a=!0),t=w(s[1],t)):h&&(m<l&&!n&&0<=o&&null!=e.data[o]&&(t=w(e.data[o][1],t),n=!0),m<l&&!a&&0<o&&null!=e.data[o-1]&&(t=w(e.data[o-1][1],t),a=!0)))}(0==v&&1==g||0==v&&null==e.dataMin&&null==e.dataMax)&&t.minValue!=Number.POSITIVE_INFINITY&&t.maxValue!=Number.NEGATIVE_INFINITY&&(e.dataMin=t.minValue,e.dataMax=t.maxValue)}else t.minValue=e.dataMin,t.maxValue=e.dataMax;t.minValue!=Number.POSITIVE_INFINITY&&t.maxValue!=Number.NEGATIVE_INFINITY&&(y=0==b?(y=w(t.minValue,y),w(t.maxValue,y)):(d=t.minValue,p=y,d<0&&(p.minValue+=d,p.zoom=!0),y=p,u=t.maxValue,(c=y).maxValue+=u,c.zoom=!0,c))}var u,c,d,p}),0<D){var a=y.maxValue-y.minValue;y.minValue-=a/3}return void 0!==t&&(y.maxValue-y.minValue==0?(y.minValue=Math.round(y.minValue)-1,y.maxValue=Math.round(y.maxValue)+1):(y.minValue=y.minValue-Math.abs((y.maxValue-y.minValue)*t*3),y.maxValue=y.maxValue+(y.maxValue-y.minValue)*t*3),(isNaN(y.minValue)||isNaN(y.maxValue))&&(y.minValue=null,y.maxValue=null)),y},bisectionMethod:function(e,t,a,n){for(var i,r=Math.ceil((e+t)/2);null===n[r];)r++;if(t-e<10){for(var o=e;o<=t;o++)if(null!=n[o]&&A.getTimestamp(n[o][0])>a.x){i=o;break}}else i=A.getTimestamp(n[r][0])>a.x?A.bisectionMethod(e,r,a,n):A.bisectionMethod(r,t,a,n);return i},interpolateValues:function(e,t,a){var n;n=null!=e.data[0]&&null!=e.data[e.data.length-1]?A.bisectionMethod(0,e.data.length-1,t,e.data):(0==e.data.length||p.log("(series.data[0] == null) || (series.data[series.data.length - 1] == null)"),e.data.length);var i,r,o,l=e.data[n-1],s=e.data[n];i=null;var u=!1;if(angular.isDefined(e.lines.steps)&&e.lines.steps&&(u=!0),a&&null==l&&(0==u?l=e.data[n-2]:null!=e.data[n-2]&&(l=e.data[n-2],e.data[n-2][1]!=s[1]&&(s=[e.data[n][0],e.data[n-2][1],e.data[n][2]]))),null==l)null!=e.data[n-2]&&(l=e.data[n-2],o=A.getTimestamp(l[0])+(s[0]-l[0])*(t.x-l[0])/(s[0]-l[0]));else if(null==s)null!=e.data[n+1]&&(s=e.data[n+1],o=A.getTimestamp(l[0])+(s[0]-l[0])*(t.x-l[0])/(s[0]-l[0]));else{var c=l[1],d=s[1];i=u?c:(void 0!==l[5]&&void 0!==s[5]&&(r=l[5]+(s[5]-l[5])*(t.x-l[0])/(s[0]-l[0])),c+(d-c)*(t.x-l[0])/(s[0]-l[0])),o=A.getTimestamp(l[0])+(s[0]-l[0])*(t.x-l[0])/(s[0]-l[0])}return{x:o,y:i,yTrans:r,p1:l,p2:s,index:n}},interpolateNull:function(e,t,a){var n=A.interpolateValues(e,t,a),i=null;if(angular.isDefined(e.lines.steps)&&e.lines.steps)for(var r in e.dictionary)e.dictionary[r]==n.y&&(i=r);return null==i&&(i=n.y),{y:n.y,formattedValue:i,yTrans:n.yTrans,p1:n.p1,p2:n.p2,index:n.index}},interpolateString:function(e,t,a,n,i,r,o){var l;if(null!=n&&n.textContent,0==e.data.length)l=": no data";else{var s=A.interpolateValues(e,t,o),u=s.x,c=s.y;if(a)l="";else{if(void 0===u)if(t.x>i.xaxis.datamax){var d=e.data[e.data.length-1];(p=[])[0]=i.xaxis.max,u=A.getTimestamp(d[0])+(p[0]-d[0])*(t.x-d[0])/(p[0]-d[0])}else{var p=e.data[0];(d=[])[0]=i.xaxis.min,u=d[0]+(p[0]-d[0])*(t.x-d[0])/(p[0]-d[0])}if(null==c||isNaN(c))l=": no data";else{var g="";if(angular.isDefined(e.lines.steps)&&e.lines.steps)for(var h in e.dictionary)e.dictionary[h]==c&&(g=h);l=""!=g?": "+g:": "+(void 0!==e.transformParams&&""!=e.transformParams?"Y = ":"")+c.toFixed(r)+(void 0!==e.dpUnit&&""!=e.dpUnit&&null!=e.dpUnit?" "+e.dpUnit:"")}}}return null==n?l:(n.innerText=l,n)},compareNearestPointXWise:function(e,t,a,n,i){var r=t.width()-t.getPlotOffset().left-t.getPlotOffset().right,o=(e.xaxis.max-e.xaxis.min)/r*5,l={},s={};null!=a.p2&&o>Math.abs(a.p2[0]-n)?(Math.abs(a.p2[0]-n),l=a.p2):null!=a.p1&&o>Math.abs(a.p1[0]-n)?(Math.abs(a.p1[0]-n),l=a.p1):(null!=A.previousNearestPointXWise[i.idx]&&(t.unhighlight(A.previousNearestPointXWise[i.idx].series,A.previousNearestPointXWise[i.idx].point),A.previousNearestPointXWise[i.idx]=null),s=a);var u=null;if(void 0!==l[5]&&(s.yTrans=l[5]),angular.isDefined(i.lines.steps)&&i.lines.steps){var c=t.getOptions().globalStringDictionary.recountedDictionary[i.idx];if(void 0!==c)for(var d in c)c[d]==a.y&&(u=d);if(null!=u){for(var d in i.dictionary)if(i.dictionary[d]==u){u=d;break}}else for(var d in i.dictionary)if(i.dictionary[d]==a.y){u=d;break}var p=t.getOptions().globalStringDictionary.recountedDictionary[i.idx];null!=p&&p[s.y]}return void 0!==l[1]&&(null!=t.getOptions().globalStringDictionary.recountedDictionary[i.idx]&&void 0!==t.getOptions().globalStringDictionary.recountedDictionary[i.idx][s.y]?s.y=t.getOptions().globalStringDictionary.recountedDictionary[i.idx][s.y]:s.y=l[1],null!=A.previousNearestPointXWise[i.idx]&&(t.unhighlight(A.previousNearestPointXWise[i.idx].series,A.previousNearestPointXWise[i.idx].point),A.previousNearestPointXWise[i.idx]=null),A.previousNearestPointXWise[i.idx]={series:i.idx,point:l},t.highlight(i.idx,l)),null==u&&(u=s.y),s.formattedValue=u,s}};return A}]).service("ESGCountBarGraphData",["$log","ESGGraphHelper","$filter",function(e,D,A){var V={count:function(v,e,x,b,S){var y=v.value,w=[];return angular.forEach(e,function(e,t){if(0!=e.data.length){var a=[];if(null!=e.data[0])var n=D.roundViewDate(y,new Date(e.data[0][0]),"floor");else n=D.roundViewDate(y,new Date(e.data[1][0]),"floor");if(null!=e.data[e.data.length-1])var i=D.roundViewDate(y,new Date(e.data[e.data.length-1][0]),"floor",1).getTime();else i=D.roundViewDate(y,new Date(e.data[e.data.length-2][0]),"floor",1).getTime();n.getTime();var r=D.roundViewDate(y,new Date(n),"floor");r.getTime()<n.getTime()&&(r=D.dateMoveInterval(r,1,y));var o=D.dataInterval[y];0==o.year&&o.month;var l,s=V.dateMoveInterval(r,o),u=(s.getTime(),r.getTime(),0);u="fixValueInInterval"!=b.value&&"minInInterval"!=b.value&&"maxInInterval"!=b.value?0:null;var c={value:null,timestamp:null},d=null,p=D.dateMoveInterval(new Date(0),D.dataInterval[y]).getTime()/2,g=0;for(c={value:null,timestamp:null};s.getTime()<=i;){for(u=null,l=0;null==e.data[g]||e.data[g][0].getTime()<s.getTime();){if(null==e.data[g]&&"difference"==b.value&&null!=e.data[g+1]&&e.data[g+1][0].getTime()<s.getTime()&&g++,null==e.data[g])c.value=null,c.timestamp=null;else{if(null!=c.timestamp&&c.timestamp<r.getTime()){var h=D.interpolate([new Date(c.timestamp),c.value],e.data[g],r.getTime());c.value=h,c.timestamp=r.getTime()}u=("difference"==b.value||"differenceIncreasing"==b.value)&&null==c.timestamp&&void 0!==e.data[g-2]&&e.data[g-2][0].getTime()>r.getTime()?V.getBarValue(u,e.data[g],b,x,{value:e.data[g-2][1],timestamp:e.data[g-2][0]},d,r,p):V.getBarValue(u,e.data[g],b,x,c,d,r,p),l++,c.value=e.data[g][1],c.timestamp=e.data[g][0].getTime()}if(d=e.data[g],++g>=e.data.length)break}if(null==u&&null!=d&&void 0!==d[2]&&""!=d[2]&&"function"==typeof d[2].getTime&&d[2].getTime()>s.getTime())u=V.getBarValueGoodThrough(u,b,x,d,r,s),l++;else if(("difference"==b.value&&"differenceIncreasing"==b.value||"sum"==b.value)&&null!=c.timestamp&&null!=e.data[g]){var f=D.interpolate([new Date(c.timestamp),c.value],e.data[g],s.getTime());u=V.getBarValue(u,[s,f],b,x,c,d,r,p)}switch(b.value){case"average":a.push([new Date(r),u/l]);break;case"sum":case"difference":case"differenceIncreasing":case"fixValueInInterval":case"minInInterval":case"maxInInterval":a.push([new Date(r),u])}r=V.dateMoveInterval(r,o),s=V.dateMoveInterval(r,o)}if(void 0===e.bars&&1==S)(m=e).bars={show:!1,fill:!1};else{var m={label:e.label,idx:e.idx,color:e.color,data:a,lines:{show:!1,steps:e.lines.steps},points:{show:!1},bars:{show:!D.serieIsHidden(e.idx),fill:1},round:void 0!==e.round?e.round:2,range:y,dictionary:e.dictionary,dateFunction:A("dateFormatCSharp"),roundXaxis:D.roundViewDate,dataInterval:v.value,fullLabel:e.fullLabel};null!=e.customLabels&&(m.range="custom",m.dateFunction=e.dateFunction,m.customLabels=e.customLabels),void 0!==e.bars&&0==e.bars.show&&(m.points.show=!0,m.points.radius=1,m.points.lineWidth=2,m.bars.show=!1,m.bars.fill=!1),void 0!==e.points.symbol&&(m.points.symbol=e.points.symbol),void 0!==e.points.mode&&(m.points.mode=e.points.mode)}void 0!==D.unitTranspositionTable[e.dpUnit]&&"increase"==x.value&&"actual"==b.value?m.dpUnit=D.unitTranspositionTable[e.dpUnit].to:void 0!==D.unitTranspositionTable[e.dpUnit]&&(m.dpUnit=e.dpUnit+"*h"),("fixValueInInterval"==b.value||"minInInterval"==b.value||"maxInInterval"==b.value||"average"==b.value||"increase"==b.value&&"actual"!=b.value||"difference"==b.value||"differenceIncreasing"==b.value)&&(m.dpUnit=e.dpUnit),w.push(m)}}),w},getBarValue:function(e,t,a,n,i,r,o,l){switch(a.value){case"difference":null==i.timestamp||isNaN(i.value)||isNaN(t[1])||(e+=t[1]-i.value);break;case"differenceIncreasing":if(null!=i.timestamp){var s=t[1]-i.value;0<s&&(e+=s)}break;case"sum":i.timestamp+l<o.getTime()&&(i.value=t[1],i.timestamp=t[0].getTime()),"sum"==n.value?e+=t[1]:e+=(t[1]+i.value)/2*((t[0].getTime()-i.timestamp)/36e5);break;case"average":case"averageold":e+=t[1];break;case"fixValueInInterval":null==e&&(e=t[1]);break;case"minInInterval":(e>t[1]||null==e)&&(e=t[1]);break;case"maxInInterval":(e<t[1]||null==e)&&(e=t[1])}return e},getBarValueGoodThrough:function(e,t,a,n,i,r){switch(t.value){case"difference":case"differenceIncreasing":e=0;break;case"sum":e="sum"==a.value?n[1]:n[1]*((r.getTime()-i.getTime())/36e5);break;case"average":case"fixValueInInterval":case"minInInterval":case"maxInInterval":e=n[1]}return e},dateMoveInterval:function(e,t){if("object"==typeof t)if(0==t.year&&0==t.month&&0==t.day)i=new Date(e.getTime()+60*t.minutes*1e3);else{var a=e.getFullYear()+t.year,n=e.getMonth()+t.month,i=e.getDate()+t.day,r=e.getMinutes()+t.minutes;i=new Date(a,n,i,e.getHours(),r,0,0)}else i=new Date(e.getTime()+t);return i}};return V}]).service("ESGCountModuloCarpetGraphData",["$log","ESGGraphHelper","$filter",function(e,h,t){var f={setAxes:function(e,t,a){e.xAxisUnit.getTimeSpanSeconds(),t.xaxis.min=0,1==e.xAxisUnit.hours||15==e.xAxisUnit.minutes?t.xaxis.max=e.xAxisMax*e.xAxisUnit.getTimeSpanSeconds()*1e3:1==e.xAxisUnit.days&&(t.xaxis.max=e.xAxisMax),t.yaxis.min=0,t.yaxis.max=e.yAxisMax*a},getTimeValues:function(e,t){var a=0,n=0,i=0;12==e.yAxisMax?(a=t.getMonth(),n=t.getDate(),i=t.getFullYear()):7==e.yAxisMax&&(a=0!=t.getDay()?t.getDay()-1:6,n=t.getDate(),i=t.getMonth());var r=0;return 1==e.xAxisUnit.hours?r=t.getHours():15==e.xAxisUnit.minutes?r=4*t.getHours()+Math.floor(t.getMinutes()/15):1==e.xAxisUnit.days&&(r=0!=t.getDay()?t.getDay()-1:6),{x:r,y:a,yDate:n,z:i,yr:t.getFullYear()}},prepareDataForCounting:function(e,t){for(var a=function(e,t,a){var n=new Date(a,t,e);return n&&n.getMonth()==t&&n.getDate()==Number(e)},n={0:{}},i=0,r=0;r<e.data.length;r++)if(null!=e.data[r]){var o=f.getTimeValues(t,e.data[r][0]);t.yearIsAggregated||o.yr!=i&&(n[o.yr]={},i=o.yr),null==n[i][o.y]&&(n[i][o.y]={}),null==n[i][o.y][o.x]&&(n[i][o.y][o.x]={values:[]}),n[i][o.y][o.x].values.push(e.data[r][1]);var l={};for(null==e.data[r][2]||""==e.data[r][2]?r!=e.data.length-1&&null!=e.data[r+1]&&(l=f.getTimeValues(t,e.data[r+1][0])):l=f.getTimeValues(t,e.data[r][2]);l.x>o.x||l.yDate>o.yDate||l.z>o.z||l.yr>o.yr;)o.x++,o.x>t.xAxisMax-1&&(o.x=0,o.yDate++,7==t.yAxisMax&&o.y++,7!=t.yAxisMax||a(o.yDate,o.z,o.yr)?12!=t.yAxisMax||a(o.yDate,o.y,o.yr)||(o.yDate=1,o.y++):o.yDate=1,o.y>t.yAxisMax-1&&(o.z++,o.y=0,12==t.yAxisMax?(t.yearIsAggregated||i++,o.yr++):7==t.yAxisMax&&11<o.z&&(t.yearIsAggregated||i++,o.yr++,o.z=0))),null==n[i]&&(n[i]={}),null==n[i][o.y]&&(n[i][o.y]={}),null==n[i][o.y][o.x]&&(n[i][o.y][o.x]={values:[]}),n[i][o.y][o.x].values.push(e.data[r][1])}return n},countAverageValue:function(e){angular.forEach(e,function(e,t){angular.forEach(e,function(e,t){angular.forEach(e,function(t,e){t.result=0,angular.forEach(t.values,function(e){t.result+=e}),t.result=t.result/t.values.length})})}),angular.forEach(e,function(e,t){angular.forEach(e,function(e,t){angular.forEach(e,function(a,e){a.result=0,a.values.sort();var t=a.values[0];a.valuesDistribution={},a.valuesDistribution[t]=0,angular.forEach(a.values,function(e){isNaN(e)||(e!=t&&(a.valuesDistribution[e]=0,t=e),a.result+=e,a.valuesDistribution[e]+=1)}),angular.forEach(a.valuesDistribution,function(e,t){a.valuesDistribution[t]=100/a.values.length*e}),a.result=a.result/a.values.length})})})},countMinValue:function(e){angular.forEach(e,function(e,t){angular.forEach(e,function(e,t){angular.forEach(e,function(t,e){t.result=t.values[0],angular.forEach(t.values,function(e){e<t.result&&(t.result=e)})})})})},countMaxValue:function(e){angular.forEach(e,function(e,t){angular.forEach(e,function(e,t){angular.forEach(e,function(t,e){t.result=t.values[0],angular.forEach(t.values,function(e){e>t.result&&(t.result=e)})})})})},count:function(e,c,d){var p=d.value,g=[];return angular.forEach(e,function(i,e){if(0!=i.data.length){if(null!=i.data[0])var t=h.roundViewDate(c.value,new Date(i.data[0][0]),"floor");else t=h.roundViewDate(c.value,new Date(i.data[1][0]),"floor");if(null!=i.data[i.data.length-1])h.roundViewDate(c.value,new Date(i.data[i.data.length-1][0]),"floor").getTime();else h.roundViewDate(c.value,new Date(i.data[i.data.length-2][0]),"floor").getTime();t.getTime();for(var a=[],r=[],n=0;n<c.yAxisMax;n++)a[n]={};var o=f.prepareDataForCounting(i,c);switch(p){case"average":f.countAverageValue(o);break;case"minInInterval":f.countMinValue(o);break;case"maxInInterval":f.countMaxValue(o)}1<Object.keys(o).length&&delete o[0];var l=[],s=0==c.xAxisUnit.days?1e3*c.xAxisUnit.getTimeSpanSeconds():1;angular.forEach(o,function(e,t){for(var a=0;a<c.yAxisMax;a++){null==o[t][a]&&(o[t][a]={});for(var n=0;n<c.xAxisMax;n++)null==o[t][a][n]?r.push([parseInt(t),a,n*s,null]):i.lines.steps&&"average"==p?r.push([parseInt(t),a,n*s,o[t][a][n].result,o[t][a][n].valuesDistribution]):r.push([parseInt(t),a,n*s,o[t][a][n].result])}l.push(parseInt(t))});var u=i;void 0!==i.moduloCarpet?u.moduloCarpet.show=!1:u={lines:i.lines,dictionary:i.dictionary,fullLabel:i.fullLabel,label:i.label,idx:i.idx,data:r,moduloCarpet:{show:!0,moduloCarpetInterval:c,years:l,dataCountType:p}},void 0!==i.moduloCarpet&&0==i.moduloCarpet.show&&(u.moduloCarpet.show=!1),"minInInterval"!=d.value&&"maxInInterval"!=d.value&&"average"!=d.value||(u.dpUnit=i.dpUnit),g.push(u)}}),g}};return f}]),function(r){r.color={},r.color.make=function(e,t,a,n){var i={};return i.r=e||0,i.g=t||0,i.b=a||0,i.a=null!=n?n:1,i.add=function(e,t){for(var a=0;a<e.length;++a)i[e.charAt(a)]+=t;return i.normalize()},i.scale=function(e,t){for(var a=0;a<e.length;++a)i[e.charAt(a)]*=t;return i.normalize()},i.toString=function(){return 1<=i.a?"rgb("+[i.r,i.g,i.b].join(",")+")":"rgba("+[i.r,i.g,i.b,i.a].join(",")+")"},i.normalize=function(){function e(e,t,a){return t<e?e:a<t?a:t}return i.r=e(0,parseInt(i.r),255),i.g=e(0,parseInt(i.g),255),i.b=e(0,parseInt(i.b),255),i.a=e(0,i.a,1),i},i.clone=function(){return r.color.make(i.r,i.b,i.g,i.a)},i.normalize()},r.color.extract=function(e,t){var a;do{if(""!=(a=e.css(t).toLowerCase())&&"transparent"!=a)break;e=e.parent()}while(!r.nodeName(e.get(0),"body"));return"rgba(0, 0, 0, 0)"==a&&(a="transparent"),r.color.parse(a)},r.color.parse=function(e){var t,a=r.color.make;if(t=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(e))return a(parseInt(t[1],10),parseInt(t[2],10),parseInt(t[3],10));if(t=/rgba\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]+(?:\.[0-9]+)?)\s*\)/.exec(e))return a(parseInt(t[1],10),parseInt(t[2],10),parseInt(t[3],10),parseFloat(t[4]));if(t=/rgb\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*\)/.exec(e))return a(2.55*parseFloat(t[1]),2.55*parseFloat(t[2]),2.55*parseFloat(t[3]));if(t=/rgba\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\s*\)/.exec(e))return a(2.55*parseFloat(t[1]),2.55*parseFloat(t[2]),2.55*parseFloat(t[3]),parseFloat(t[4]));if(t=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(e))return a(parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16));if(t=/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/.exec(e))return a(parseInt(t[1]+t[1],16),parseInt(t[2]+t[2],16),parseInt(t[3]+t[3],16));var n=r.trim(e).toLowerCase();return"transparent"==n?a(255,255,255,0):a((t=i[n]||[0,0,0])[0],t[1],t[2])};var i={aqua:[0,255,255],azure:[240,255,255],beige:[245,245,220],black:[0,0,0],blue:[0,0,255],brown:[165,42,42],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgrey:[169,169,169],darkgreen:[0,100,0],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkviolet:[148,0,211],fuchsia:[255,0,255],gold:[255,215,0],green:[0,128,0],indigo:[75,0,130],khaki:[240,230,140],lightblue:[173,216,230],lightcyan:[224,255,255],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightyellow:[255,255,224],lime:[0,255,0],magenta:[255,0,255],maroon:[128,0,0],navy:[0,0,128],olive:[128,128,0],orange:[255,165,0],pink:[255,192,203],purple:[128,0,128],violet:[128,0,128],red:[255,0,0],silver:[192,192,192],white:[255,255,255],yellow:[255,255,0]}}(jQuery),function(q){var g=Object.prototype.hasOwnProperty;function Z(e,t){var a=t.children("."+e)[0];if(null==a&&((a=document.createElement("canvas")).className=e,q(a).css({direction:"ltr",position:"absolute",left:0,top:0}).appendTo(t),!a.getContext)){if(!window.G_vmlCanvasManager)throw new Error("Canvas is not available. If you're using IE with a fall-back such as Excanvas, then there's either a mistake in your conditional include, or the page has no DOCTYPE and is rendering in Quirks Mode.");a=window.G_vmlCanvasManager.initElement(a)}this.element=a;var n=this.context=a.getContext("2d"),i=window.devicePixelRatio||1,r=n.webkitBackingStorePixelRatio||n.mozBackingStorePixelRatio||n.msBackingStorePixelRatio||n.oBackingStorePixelRatio||n.backingStorePixelRatio||1;this.pixelRatio=i/r,this.resize(t.width(),t.height()),this.textContainer=null,this.text={},this._textCache={}}function n(b,e,t,n){var V=[],T={colors:["#edc240","#afd8f8","#cb4b4b","#4da74d","#9440ed"],legend:{show:!0,noColumns:1,labelFormatter:null,labelBoxBorderColor:"#ccc",container:null,position:"ne",margin:5,backgroundColor:null,backgroundOpacity:.85,sorted:null},message:{noColumns:1,labelFormatter:null,borderColor:"#ccc",container:null,position:"nw",margin:5,backgroundColor:null,backgroundOpacity:0},xaxis:{show:null,position:"bottom",mode:null,font:null,color:null,tickColor:null,transform:null,inverseTransform:null,min:null,max:null,autoscaleMargin:null,ticks:null,tickFormatter:null,labelWidth:null,labelHeight:null,reserveSpace:null,tickLength:null,alignTicksWithAxis:null,tickDecimals:null,tickSize:null,minTickSize:null},yaxis:{autoscaleMargin:.02,position:"left"},xaxes:[],yaxes:[],series:{points:{show:!1,radius:3,lineWidth:2,fill:!0,fillColor:"#ffffff",symbol:"circle"},lines:{lineWidth:2,fill:!1,fillColor:null,steps:!1},bars:{show:!1,lineWidth:2,barWidth:1,fill:!0,fillColor:null,align:"left",horizontal:!1,zero:!0},shadowSize:3,highlightColor:null},grid:{show:!0,aboveData:!1,color:"#545454",backgroundColor:null,borderColor:null,tickColor:null,margin:0,labelMargin:5,axisMargin:8,borderWidth:2,minBorderMargin:null,markings:null,markingsColor:"#f4f4f4",markingsLineWidth:2,clickable:!1,hoverable:!1,autoHighlight:!0,mouseActiveRadius:10,plothoverGetItem:!0},interaction:{redrawOverlayInterval:1e3/60},hooks:{}},g=null,a=null,c=null,v=null,u=null,f=[],m=[],S={left:0,right:0,top:0,bottom:0},x=0,D=0,A={processOptions:[],processRawData:[],processDatapoints:[],processOffset:[],drawBackground:[],drawSeries:[],draw:[],bindEvents:[],drawOverlay:[],shutdown:[]},y=this;function I(e,t){t=[y].concat(t);for(var a=0;a<e.length;++a)e[a].apply(this,t)}function i(e){q.extend(!0,T,e),e&&e.colors&&(T.colors=e.colors),null==T.xaxis.color&&(T.xaxis.color=q.color.parse(T.grid.color).scale("a",.22).toString()),null==T.yaxis.color&&(T.yaxis.color=q.color.parse(T.grid.color).scale("a",.22).toString()),null==T.xaxis.tickColor&&(T.xaxis.tickColor=T.grid.tickColor||T.xaxis.color),null==T.yaxis.tickColor&&(T.yaxis.tickColor=T.grid.tickColor||T.yaxis.color),null==T.grid.borderColor&&(T.grid.borderColor=T.grid.color),null==T.grid.tickColor&&(T.grid.tickColor=q.color.parse(T.grid.color).scale("a",.22).toString());var t,a,n,i={style:b.css("font-style"),size:Math.round(.8*(+b.css("font-size").replace("px","")||13)),variant:b.css("font-variant"),weight:b.css("font-weight"),family:b.css("font-family")};for(i.lineHeight=1.15*i.size,n=T.xaxes.length||1,t=0;t<n;++t)(a=T.xaxes[t])&&!a.tickColor&&(a.tickColor=a.color),a=q.extend(!0,{},T.xaxis,a),(T.xaxes[t]=a).font&&(a.font=q.extend({},i,a.font),a.font.color||(a.font.color=a.color));for(n=T.yaxes.length||1,t=0;t<n;++t)(a=T.yaxes[t])&&!a.tickColor&&(a.tickColor=a.color),a=q.extend(!0,{},T.yaxis,a),(T.yaxes[t]=a).font&&(a.font=q.extend({},i,a.font),a.font.color||(a.font.color=a.color));for(T.xaxis.noTicks&&null==T.xaxis.ticks&&(T.xaxis.ticks=T.xaxis.noTicks),T.yaxis.noTicks&&null==T.yaxis.ticks&&(T.yaxis.ticks=T.yaxis.noTicks),T.x2axis&&(T.xaxes[1]=q.extend(!0,{},T.xaxis,T.x2axis),T.xaxes[1].position="top"),T.y2axis&&(T.yaxes[1]=q.extend(!0,{},T.yaxis,T.y2axis),T.yaxes[1].position="right"),T.grid.coloredAreas&&(T.grid.markings=T.grid.coloredAreas),T.grid.coloredAreasColor&&(T.grid.markingsColor=T.grid.coloredAreasColor),T.lines&&q.extend(!0,T.series.lines,T.lines),T.points&&q.extend(!0,T.series.points,T.points),T.bars&&q.extend(!0,T.series.bars,T.bars),null!=T.shadowSize&&(T.series.shadowSize=T.shadowSize),null!=T.highlightColor&&(T.series.highlightColor=T.highlightColor),t=0;t<T.xaxes.length;++t)E(f,t+1).options=T.xaxes[t];for(t=0;t<T.yaxes.length;++t)E(m,t+1).options=T.yaxes[t];for(var r in A)T.hooks[r]&&T.hooks[r].length&&(A[r]=A[r].concat(T.hooks[r]));I(A.processOptions,[T])}function r(e){V=function(e){for(var t=[],a=0;a<e.length;++a){var n=q.extend(!0,{},T.series);null!=e[a].data?(n.data=e[a].data,delete e[a].data,q.extend(!0,n,e[a]),e[a].data=n.data):n.data=e[a],t.push(n)}return t}(e),function(){var e,t=V.length,a=-1,n=[];for(e=0;e<V.length;++e){var i=V[e].color;null!=i&&(n.push(i),t--,"number"==typeof i&&a<i&&(a=i))}t<=a&&(t=a+1);var r,o=[],l=T.colors,s=l.length,u=0,c=0;for(e=0;e<t;e++){if(r=q.color.parse(l[(e+c)%s]||"#666"),n.length<s&&-1!=n.indexOf(r.toString()))for(;-1!=n.indexOf(r.toString());)c++,r=q.color.parse(l[(e+c)%s]||"#666");e%s==0&&e&&(u=0<=u?u<.5?-u-.2:0:-u),o[e]=r.scale("rgb",1+u)}var d,p=0;for(e=0;e<V.length;++e){if(null==(d=V[e]).color?(d.color=o[p].toString(),++p):"number"==typeof d.color&&(d.color=o[d.color].toString()),null==d.lines.show){var g,h=!0;for(g in d)if(d[g]&&d[g].show){h=!1;break}h&&(d.lines.show=!0)}null==d.lines.zero&&(d.lines.zero=!!d.lines.fill),d.xaxis=E(f,w(d,"x")),d.yaxis=E(m,w(d,"y"))}}(),function(){var e,t,a,n,i,r,o,l,s,u,c,d,p=Number.POSITIVE_INFINITY,g=Number.NEGATIVE_INFINITY,h=Number.MAX_VALUE;function f(e,t,a){t<e.datamin&&t!=-h&&(e.datamin=t),a>e.datamax&&a!=h&&(e.datamax=a)}for(q.each(M(),function(e,t){t.datamin=p,t.datamax=g,t.used=!1}),e=0;e<V.length;++e)(i=V[e]).datapoints={points:[]},I(A.processRawData,[i,i.data,i.datapoints]);for(e=0;e<V.length;++e){if(i=V[e],c=i.data,!(d=i.datapoints.format)){if((d=[]).push({x:!0,number:!0,required:!0}),d.push({y:!0,number:!0,required:!0}),i.bars.show||i.lines.show&&i.lines.fill){var m=!!(i.bars.show&&i.bars.zero||i.lines.show&&i.lines.zero);d.push({y:!0,number:!0,required:!1,defaultValue:0,autoscale:m}),i.bars.horizontal&&(delete d[d.length-1].y,d[d.length-1].x=!0)}i.datapoints.format=d}if(null==i.datapoints.pointsize){i.datapoints.pointsize=d.length,o=i.datapoints.pointsize,r=i.datapoints.points;var v=i.lines.show&&i.lines.steps;for(i.xaxis.used=i.yaxis.used=!0,t=a=0;t<c.length;++t,a+=o){var x=null==(u=c[t]);if(!x)for(n=0;n<o;++n)l=u[n],(s=d[n])&&(s.number&&null!=l&&(l=+l,isNaN(l)?l=null:l==1/0?l=h:l==-1/0&&(l=-h)),null==l&&(s.required&&(x=!0),null!=s.defaultValue&&(l=s.defaultValue))),r[a+n]=l;if(x)for(n=0;n<o;++n)null!=(l=r[a+n])&&(s=d[n]).autoscale&&(s.x&&f(i.xaxis,l,l),s.y&&f(i.yaxis,l,l)),r[a+n]=null;else if(v&&0<a&&null!=r[a-o]&&r[a-o]!=r[a]&&r[a-o+1]!=r[a+1]){for(n=0;n<o;++n)r[a+o+n]=r[a+n];r[a+1]=r[a-o+1],a+=o}}}}for(e=0;e<V.length;++e)i=V[e],I(A.processDatapoints,[i,i.datapoints]);for(e=0;e<V.length;++e){i=V[e],r=i.datapoints.points,o=i.datapoints.pointsize,d=i.datapoints.format;var b=p,S=p,y=g,w=g;for(t=0;t<r.length;t+=o)if(null!=r[t])for(n=0;n<o;++n)l=r[t+n],(s=d[n])&&!1!==s.autoscale&&l!=h&&l!=-h&&(s.x&&(l<b&&(b=l),y<l&&(y=l)),s.y&&(l<S&&(S=l),w<l&&(w=l)));if(i.bars.show){var D;switch(i.bars.align){case"left":D=0;break;case"right":D=-i.bars.barWidth;break;case"center":D=-i.bars.barWidth/2;break;default:throw new Error("Invalid bar alignment: "+i.bars.align)}i.bars.horizontal?(S+=D,w+=D+i.bars.barWidth):(b+=D,y+=D+i.bars.barWidth)}f(i.xaxis,b,y),f(i.yaxis,S,w)}q.each(M(),function(e,t){t.datamin==p&&(t.datamin=null),t.datamax==g&&(t.datamax=null)})}()}function w(e,t){var a=e[t+"axis"];return"object"==typeof a&&(a=a.n),"number"!=typeof a&&(a=1),a}function M(){return q.grep(f.concat(m),function(e){return e})}function d(e){var t,a,n={};for(t=0;t<f.length;++t)(a=f[t])&&a.used&&(n["x"+a.n]=a.c2p(e.left));for(t=0;t<m.length;++t)(a=m[t])&&a.used&&(n["y"+a.n]=a.c2p(e.top));return void 0!==n.x1&&(n.x=n.x1),void 0!==n.y1&&(n.y=n.y1),n}function E(e,t){return e[t-1]||(e[t-1]={n:t,direction:e==f?"x":"y",options:q.extend(!0,{},e==f?T.xaxis:T.yaxis)}),e[t-1]}function o(e){var t,a=e.labelWidth,n=e.labelHeight,i=e.options.position,r=e.options.tickLength,o=T.grid.axisMargin,l=T.grid.labelMargin,s="x"==e.direction?f:m,u=q.grep(s,function(e){return e&&e.options.position==i&&e.reserveSpace});if(q.inArray(e,u)==u.length-1&&(o=0),null==r){var c=q.grep(s,function(e){return e&&e.reserveSpace});r=(t=0==q.inArray(e,c))?"full":5}isNaN(+r)||(l+=+r),"x"==e.direction?(n+=l,"bottom"==i?(S.bottom+=n+o,e.box={top:g.height-S.bottom,height:n}):(e.box={top:S.top+o,height:n},S.top+=n+o)):(a+=l,"left"==i?(e.box={left:S.left+o,width:a},S.left+=a+o):(S.right+=a+o,e.box={left:g.width-S.right,width:a})),e.position=i,e.tickLength=r,e.box.padding=l,e.innermost=t}function l(){var e,t=M(),a=T.grid.show;for(var n in S){var i=T.grid.margin||0;S[n]="number"==typeof i?i:i[n]||0}for(var n in I(A.processOffset,[S]),S)"object"==typeof T.grid.borderWidth?S[n]+=a?T.grid.borderWidth[n]:0:S[n]+=a?T.grid.borderWidth:0;if(q.each(t,function(e,t){t.show=t.options.show,null==t.show&&(t.show=t.used),t.reserveSpace=t.show||t.options.reserveSpace,function(e){var t=e.options,a=+(null!=t.min?t.min:e.datamin),n=+(null!=t.max?t.max:e.datamax),i=n-a;if(0==i){var r=0==n?1:.01;null==t.min&&(a-=r),null!=t.max&&null==t.min||(n+=r)}else{var o=t.autoscaleMargin;null!=o&&(null==t.min&&(a-=i*o),null==t.max&&0<(n+=i*o)&&null!=e.datamax&&e.datamax<=0&&(n=0))}e.min=a,e.max=n}(t)}),a){var r=q.grep(t,function(e){return e.reserveSpace});for(q.each(r,function(e,t){var a,n;!function(e){var t,a=e.options;t="number"==typeof a.ticks&&0<a.ticks?a.ticks:.3*Math.sqrt("x"==e.direction?g.width:g.height);var n=(e.max-e.min)/t,i=-Math.floor(Math.log(n)/Math.LN10),r=a.tickDecimals;null!=r&&r<i&&(i=r);var o,l=Math.pow(10,-i),s=n/l;s<1.5?o=1:s<3?(o=2,2.25<s&&(null==r||i+1<=r)&&(o=2.5,++i)):o=s<7.5?5:10;o*=l,null!=a.minTickSize&&o<a.minTickSize&&(o=a.minTickSize);if(e.delta=n,e.tickDecimals=Math.max(0,null!=r?r:i),e.tickSize=a.tickSize||o,"time"==a.mode&&!e.tickGenerator)throw new Error("Time mode requires the flot.time plugin.");e.tickGenerator||(e.tickGenerator=function(e){for(var t,a,n,i=[],r=(a=e.min,(n=e.tickSize)*Math.floor(a/n)),o=0,l=Number.NaN;t=l,l=r+o*e.tickSize,i.push(l),++o,l<e.max&&l!=t;);return i},e.tickFormatter=function(e,t){var a=t.tickDecimals?Math.pow(10,t.tickDecimals):1,n=""+Math.round(e*a)/a;if(null!=t.tickDecimals){var i=n.indexOf("."),r=-1==i?0:n.length-i-1;if(r<t.tickDecimals)return(r?n:n+".")+(""+a).substr(1,t.tickDecimals-r)}return n});q.isFunction(a.tickFormatter)&&(e.tickFormatter=function(e,t){return""+a.tickFormatter(e,t)});if(null!=a.alignTicksWithAxis){var u=("x"==e.direction?f:m)[a.alignTicksWithAxis-1];if(u&&u.used&&u!=e){var c=e.tickGenerator(e);if(0<c.length&&(null==a.min&&(e.min=Math.min(e.min,c[0])),null==a.max&&1<c.length&&(e.max=Math.max(e.max,c[c.length-1]))),e.tickGenerator=function(e){var t,a,n=[];for(a=0;a<u.ticks.length;++a)t=(u.ticks[a].v-u.min)/(u.max-u.min),t=e.min+t*(e.max-e.min),n.push(t);return n},!e.mode&&null==a.tickDecimals){var d=Math.max(0,1-Math.floor(Math.log(e.delta)/Math.LN10)),p=e.tickGenerator(e);1<p.length&&/\..*0$/.test((p[1]-p[0]).toFixed(d))||(e.tickDecimals=d)}}}}(t),function(e){var t,a,n=e.options.ticks,i=[];null==n||"number"==typeof n&&0<n?i=e.tickGenerator(e):n&&(i=q.isFunction(n)?n(e):n);for(e.ticks=[],t=0;t<i.length;++t){var r=null,o=i[t];"object"==typeof o?(a=+o[0],1<o.length&&(r=o[1])):a=+o,null==r&&(r=e.tickFormatter(a,e)),isNaN(a)||e.ticks.push({v:a,label:r})}}(t),n=(a=t).ticks,a.options.autoscaleMargin&&0<n.length&&(null==a.options.min&&(a.min=Math.min(a.min,n[0].v)),null==a.options.max&&1<n.length&&(a.max=Math.max(a.max,n[n.length-1].v))),function(e){for(var t=e.options,a=e.ticks||[],n=t.labelWidth||0,i=t.labelHeight||0,r=n||"x"==e.direction?Math.floor(g.width/(a.length||1)):null,o=e.direction+"Axis "+e.direction+e.n+"Axis",l="flot-"+e.direction+"-axis flot-"+e.direction+e.n+"-axis "+o,s=t.font||"flot-tick-label tickLabel",u=0;u<a.length;++u){var c=a[u];if(c.label){var d=g.getTextInfo(l,c.label,s,null,r);n=Math.max(n,d.width),i=Math.max(i,d.height)}}e.labelWidth=t.labelWidth||n,e.labelHeight=t.labelHeight||i}(t)}),e=r.length-1;0<=e;--e)o(r[e]);!function(){var e,t=T.grid.minBorderMargin,n={x:0,y:0};if(null==t)for(e=t=0;e<V.length;++e)t=Math.max(t,2*(V[e].points.radius+V[e].points.lineWidth/2));n.x=n.y=Math.ceil(t),q.each(M(),function(e,t){var a=t.direction;t.reserveSpace&&(n[a]=Math.ceil(Math.max(n[a],("x"==a?t.labelWidth:t.labelHeight)/2)))}),S.left=Math.max(n.x,S.left),"object"==typeof T.grid.borderWidthMax&&void 0!==T.grid.borderWidthMax.right?S.right=T.grid.borderWidthMax.right:S.right=Math.max(n.x,S.right),S.top=Math.max(n.y,S.top),S.bottom=Math.max(n.y,S.bottom)}(),q.each(r,function(e,t){var a;"x"==(a=t).direction?(a.box.left=S.left-a.labelWidth/2,a.box.width=g.width-S.left-S.right+a.labelWidth):(a.box.top=S.top-a.labelHeight/2,a.box.height=g.height-S.bottom-S.top+a.labelHeight)})}x=g.width-S.left-S.right,D=g.height-S.bottom-S.top,q.each(t,function(e,t){!function(e){function t(e){return e}var a,n,i=e.options.transform||t,r=e.options.inverseTransform;n="x"==e.direction?(a=e.scale=x/Math.abs(i(e.max)-i(e.min)),Math.min(i(e.max),i(e.min))):(a=-(a=e.scale=D/Math.abs(i(e.max)-i(e.min))),Math.max(i(e.max),i(e.min))),e.p2c=i==t?function(e){return(e-n)*a}:function(e){return(i(e)-n)*a},e.c2p=r?function(e){return r(n+e/a)}:function(e){return n+e/a}}(t)}),a&&q.each(M(),function(e,t){if(t.show&&0!=t.ticks.length){var a,n,i,r,o,l=t.box,s=t.direction+"Axis "+t.direction+t.n+"Axis",u="flot-"+t.direction+"-axis flot-"+t.direction+t.n+"-axis "+s,c=t.options.font||"flot-tick-label tickLabel";g.removeText(u);for(var d=null,p=0;p<t.ticks.length;++p)!(a=t.ticks[p]).label||a.v<t.min||a.v>t.max||("x"==t.direction?(r="center",n=S.left+t.p2c(a.v),"bottom"==t.position?i=l.top+l.padding:(i=l.top+l.height-l.padding,o="bottom")):(o="middle",i=S.top+t.p2c(a.v),"left"==t.position?(n=l.left+l.width-l.padding,r="right"):n=l.left+l.padding),"x"==t.direction?null!=d?d<n&&n+t.labelWidth<l.width+l.left&&(g.addText(u,n,i,a.label,c,null,null,r,o),d=n+t.labelWidth+l.padding):(g.addText(u,n,i,a.label,c,null,null,r,o),d=n+t.labelWidth+l.padding):g.addText(u,n,i,a.label,c,null,null,r,o))}}),function(){if(b.find(".legend").remove(),!T.legend.show)return;for(var e,t,a=[],n=[],i=!1,r=T.legend.labelFormatter,o=0;o<V.length;++o)(e=V[o]).label&&(t=r?r(e.label,e):e.label)&&n.push({label:t,color:e.color});if(T.legend.sorted)if(q.isFunction(T.legend.sorted))n.sort(T.legend.sorted);else if("reverse"==T.legend.sorted)n.reverse();else{var l="descending"!=T.legend.sorted;n.sort(function(e,t){return e.label==t.label?0:e.label<t.label!=l?1:-1})}for(var o=0;o<n.length;++o){var s=n[o];o%T.legend.noColumns==0&&(i&&a.push("</div>"),a.push('<div class="tr">'),i=!0),a.push('<div class="legendColorBox"><div style="border:1px solid '+T.legend.labelBoxBorderColor+';padding:1px"><div style="width:4px;height:0;border:5px solid '+s.color+';overflow:hidden"></div></div></div><div class="legendLabel">'+s.label+"</div>")}i&&a.push("</div>");if(0==a.length)return;var u='<div style="font-size:smaller;color:'+T.grid.color+'"><div class="tbody"><div>'+a.join("")+"</div></div></div>";if(null!=T.legend.container)q(T.legend.container).html(u);else{var c="",d=T.legend.position,p=T.legend.margin;null==p[0]&&(p=[p,p]),"n"==d.charAt(0)?c+="top:"+(p[1]+S.top)+"px;":"s"==d.charAt(0)&&(c+="bottom:"+(p[1]+S.bottom)+"px;"),"e"==d.charAt(1)?c+="right:"+(p[0]+S.right)+"px;":"w"==d.charAt(1)&&(c+="left:"+(p[0]+S.left)+"px;");var g=q('<div class="legend">'+u.replace('style="','style="position:absolute;'+c+";")+"</div>").appendTo(b);if(0!=T.legend.backgroundOpacity){var h=T.legend.backgroundColor;null==h&&((h=(h=T.grid.backgroundColor)&&"string"==typeof h?q.color.parse(h):q.color.extract(g,"background-color")).a=1,h=h.toString());var f=g.children(),m=f.width(),v=q(g).find(".tbody");v[0].children.length*v[0].children[0].clientHeight>b[0].clientHeight-S.bottom-2*S.top&&(v[0].style.height=b[0].clientHeight-S.bottom-2*S.top+"px",m+=40),q('<div style="position:absolute;width:'+m+"px;height:"+f.height()+"px;"+c+"background-color:"+h+';"> </div>').prependTo(g).css("opacity",T.legend.backgroundOpacity);var x=T.legend.getLastScrollPos();0!=x&&(v[0].scrollTop=x),q(v[0]).scroll(function(e){return T.legend.setLastScrollPos(e.currentTarget.scrollTop),!0})}}}(),null!=T.message&&T.message.show&&function(){if(b.find(".message").remove(),!T.message.show)return;T.message.labelFormatter;var e='<div style="font-size:smaller;color:'+T.grid.color+'"><div class="tbody"><div style="border:1px solid '+T.message.borderColor+';"><div class="graphMessageCaution">'+T.message.caution+'</div><div class="graphMessageVerbose">'+T.message.verbose+"</div></div></div></div>";if(null!=T.message.container)q(T.message.container).html(e);else if(e=q('<div class="graph-message">'+e+"</div>").appendTo(b),0!=T.message.backgroundOpacity){var t=T.message.backgroundColor;null==t&&((t=(t=T.grid.backgroundColor)&&"string"==typeof t?q.color.parse(t):q.color.extract(e,"background-color")).a=1,t=t.toString());var a=e.children(),n=a.width(),i=q(e).find(".tbody");i[0].children.length*i[0].children[0].clientHeight>b[0].clientHeight-S.bottom-2*S.top&&(i[0].style.height=b[0].clientHeight-S.bottom-2*S.top+"px",n+=40),q('<div style="position:absolute;width:'+n+"px;height:"+a.height()+"px;"+pos+"background-color:"+t+';"> </div>').prependTo(e).css("opacity",T.message.backgroundOpacity);var r=T.message.getLastScrollPos();0!=r&&(i[0].scrollTop=r),q(i[0]).scroll(function(e){return T.message.setLastScrollPos(e.currentTarget.scrollTop),!0})}}()}function s(){g.clear(),I(A.drawBackground,[v]);var e=T.grid;e.show&&e.backgroundColor&&(v.save(),v.translate(0,0),v.fillStyle=_(T.grid.backgroundColor,D,0,"rgba(255, 255, 255, 0)"),v.fillRect(0,0,x+S.left+S.right,D+S.top+S.bottom),v.restore()),e.show&&!e.aboveData&&p();for(var t=0;t<V.length;++t)I(A.drawSeries,[v,V[t]]),h(V[t],v);I(A.draw,[v]),e.show&&e.aboveData&&p(),g.render(),H()}function G(e,t){for(var a,n,i,r,o=M(),l=0;l<o.length;++l)if((a=o[l]).direction==t&&(e[r=t+a.n+"axis"]||1!=a.n||(r=t+"axis"),e[r])){n=e[r].from,i=e[r].to;break}if(e[r]||(a="x"==t?f[0]:m[0],n=e[t+"1"],i=e[t+"2"]),null!=n&&null!=i&&i<n){var s=n;n=i,i=s}return{from:n,to:i,axis:a}}function p(){var e,t,a,n;v.save(),v.translate(S.left,S.top);var i=T.grid.markings;if(i)for(q.isFunction(i)&&((t=y.getAxes()).xmin=t.xaxis.min,t.xmax=t.xaxis.max,t.ymin=t.yaxis.min,t.ymax=t.yaxis.max,i=i(t)),e=0;e<i.length;++e){var r=i[e],o=G(r,"x"),l=G(r,"y");null==o.from&&(o.from=o.axis.min),null==o.to&&(o.to=o.axis.max),null==l.from&&(l.from=l.axis.min),null==l.to&&(l.to=l.axis.max),o.to<o.axis.min||o.from>o.axis.max||l.to<l.axis.min||l.from>l.axis.max||(o.from=Math.max(o.from,o.axis.min),o.to=Math.min(o.to,o.axis.max),l.from=Math.max(l.from,l.axis.min),l.to=Math.min(l.to,l.axis.max),o.from==o.to&&l.from==l.to||(o.from=o.axis.p2c(o.from),o.to=o.axis.p2c(o.to),l.from=l.axis.p2c(l.from),l.to=l.axis.p2c(l.to),o.from==o.to||l.from==l.to?(v.beginPath(),v.strokeStyle=r.color||T.grid.markingsColor,v.lineWidth=r.lineWidth||T.grid.markingsLineWidth,v.moveTo(o.from,l.from),v.lineTo(o.to,l.to),v.stroke()):(v.fillStyle=r.color||T.grid.markingsColor,v.fillRect(o.from,l.to,o.to-o.from,l.from-l.to))))}t=M(),a=T.grid.borderWidth;for(var s=0;s<t.length;++s){var u,c,d,p,g=t[s],h=g.box,f=g.tickLength;if(g.show&&0!=g.ticks.length){for(v.lineWidth=1,"x"==g.direction?(u=0,c="full"==f?"top"==g.position?0:D:h.top-S.top+("top"==g.position?h.height:0)):(c=0,u="full"==f?"left"==g.position?0:x:h.left-S.left+("left"==g.position?h.width:0)),g.innermost||(v.strokeStyle=g.options.color,v.beginPath(),d=p=0,"x"==g.direction?d=x+1:p=D+1,1==v.lineWidth&&("x"==g.direction?c=Math.floor(c)+.5:u=Math.floor(u)+.5),v.moveTo(u,c),v.lineTo(u+d,c+p),v.stroke()),v.strokeStyle=g.options.tickColor,v.beginPath(),e=0;e<g.ticks.length;++e){var m=g.ticks[e].v;d=p=0,isNaN(m)||m<g.min||m>g.max||"full"==f&&("object"==typeof a&&0<a[g.position]||0<a)&&(m==g.min||m==g.max)||("x"==g.direction?(u=g.p2c(m),p="full"==f?-D:f,"top"==g.position&&(p=-p)):(c=g.p2c(m),d="full"==f?-x:f,"left"==g.position&&(d=-d)),1==v.lineWidth&&("x"==g.direction?u=Math.floor(u)+.5:c=Math.floor(c)+.5),v.moveTo(u,c),v.lineTo(u+d,c+p))}v.stroke()}}a&&(n=T.grid.borderColor,"object"==typeof a||"object"==typeof n?("object"!=typeof a&&(a={top:a,right:a,bottom:a,left:a}),"object"!=typeof n&&(n={top:n,right:n,bottom:n,left:n}),0<a.top&&(v.strokeStyle=n.top,v.lineWidth=a.top,v.beginPath(),v.moveTo(0-a.left,0-a.top/2),v.lineTo(x,0-a.top/2),v.stroke()),0<a.right&&(v.strokeStyle=n.right,v.lineWidth=a.right,v.beginPath(),v.moveTo(x+a.right/2,0-a.top),v.lineTo(x+a.right/2,D),v.stroke()),0<a.bottom&&(v.strokeStyle=n.bottom,v.lineWidth=a.bottom,v.beginPath(),v.moveTo(x+a.right,D+a.bottom/2),v.lineTo(0,D+a.bottom/2),v.stroke()),0<a.left&&(v.strokeStyle=n.left,v.lineWidth=a.left,v.beginPath(),v.moveTo(0-a.left/2,D+a.bottom),v.lineTo(0-a.left/2,0),v.stroke())):(v.lineWidth=a,v.strokeStyle=T.grid.borderColor,v.strokeRect(-a/2,-a/2,x+a,D+a))),v.restore()}function h(e,t){e.lines.show&&function(y,w){function e(e,t,a,n,i){var r=e.points,o=e.pointsize,l=null,s=null,u=null,c=null,d=0;w.beginPath();var p=n.max-n.min,g=n.datamax-n.datamin,h=0,f=r.length;new Date;p<g/2&&(h=F(0,r.length,{x:n.min},r,o)-o,f=F(0,r.length,{x:n.max},r,o),isNaN(h)&&(h=0),void 0===f?f=r.length:f+=o);for(var m=h;m<f;m+=o){if(1==y.lines.steps&&void 0!==T.globalStringDictionary.recountedDictionary[y.idx]){var v=r[m-o],x=T.globalStringDictionary.recountedDictionary[y.idx][r[m-o+1]],b=r[m],S=T.globalStringDictionary.recountedDictionary[y.idx][r[m+1]];null==x&&(x=r[m-o+1]),null==S&&(S=r[m+1])}else var v=r[m-o],x=r[m-o+1],b=r[m],S=r[m+1];if(1==T.series.lines.ignoreNullValues){if(null==v)continue;null==b&&(m+=o,1==y.lines.steps&&void 0!==T.globalStringDictionary.recountedDictionary[y.idx]?x==T.globalStringDictionary.recountedDictionary[y.idx][r[m+1]]?(b=r[m],S=T.globalStringDictionary.recountedDictionary[y.idx][r[m+1]]):(b=r[m],S=x,r.splice(m,0,b,r[m-2*o+1]),f+=o):(b=r[m],S=r[m+1]))}else if(null==v||null==b)continue;if(x<=S&&x<i.min){if(S<i.min)continue;v=(i.min-x)/(S-x)*(b-v)+v,x=i.min}else if(S<=x&&S<i.min){if(x<i.min)continue;b=(i.min-x)/(S-x)*(b-v)+v,S=i.min}if(S<=x&&x>i.max){if(S>i.max)continue;v=(i.max-x)/(S-x)*(b-v)+v,x=i.max}else if(x<=S&&S>i.max){if(x>i.max)continue;b=(i.max-x)/(S-x)*(b-v)+v,S=i.max}if(v<=b&&v<n.min){if(b<n.min)continue;x=(n.min-v)/(b-v)*(S-x)+x,v=n.min}else if(b<=v&&b<n.min){if(v<n.min)continue;S=(n.min-v)/(b-v)*(S-x)+x,b=n.min}if(b<=v&&v>n.max){if(b>n.max)continue;x=(n.max-v)/(b-v)*(S-x)+x,v=n.max}else if(v<=b&&b>n.max){if(v>n.max)continue;S=(n.max-v)/(b-v)*(S-x)+x,b=n.max}l=n.p2c(v)+t,s=i.p2c(x)+a,(null==u||null==c||.5<=Math.abs(l-u)||Math.abs(l-u)<.5&&0<Math.abs(s-c))&&(w.moveTo(l,s),u=l,c=s,d++),l=n.p2c(b)+t,s=i.p2c(S)+a,(null==u||null==c||.5<=Math.abs(l-u)||Math.abs(l-u)<.5&&0<Math.abs(s-c))&&(w.lineTo(l,s),u=l,c=s,d++),b,S,1e3<d&&(w.stroke(),d=0,m-=o,c=u=null,w.beginPath(),0)}w.stroke(),console}w.save(),w.translate(S.left,S.top),w.lineJoin="round";var t=y.lines.lineWidth,a=y.shadowSize;if(0<t&&0<a){w.lineWidth=a,w.strokeStyle="rgba(0,0,0,0.1)";var n=Math.PI/18;e(y.datapoints,Math.sin(n)*(t/2+a/2),Math.cos(n)*(t/2+a/2),y.xaxis,y.yaxis),w.lineWidth=a/2,e(y.datapoints,Math.sin(n)*(t/2+a/4),Math.cos(n)*(t/2+a/4),y.xaxis,y.yaxis)}w.lineWidth=t,w.strokeStyle=y.color;var i=R(y.lines,y.color,0,D);i&&(w.fillStyle=i,function(e,t,a){var n=e.points,i=e.pointsize,r=Math.min(Math.max(0,a.min),a.max),o=0,l=!1,s=1,u=0,c=0;for(;!(0<i&&o>n.length+i);){var d=n[(o+=i)-i],p=n[o-i+s],g=n[o],h=n[o+s];if(l){if(0<i&&null!=d&&null==g){c=o,i=-i,s=2;continue}if(i<0&&o==u+i){w.fill(),l=!1,s=1,o=u=c+(i=-i);continue}}if(null!=d&&null!=g){if(d<=g&&d<t.min){if(g<t.min)continue;p=(t.min-d)/(g-d)*(h-p)+p,d=t.min}else if(g<=d&&g<t.min){if(d<t.min)continue;h=(t.min-d)/(g-d)*(h-p)+p,g=t.min}if(g<=d&&d>t.max){if(g>t.max)continue;p=(t.max-d)/(g-d)*(h-p)+p,d=t.max}else if(d<=g&&g>t.max){if(d>t.max)continue;h=(t.max-d)/(g-d)*(h-p)+p,g=t.max}if(l||(w.beginPath(),w.moveTo(t.p2c(d),a.p2c(r)),l=!0),p>=a.max&&h>=a.max)w.lineTo(t.p2c(d),a.p2c(a.max)),w.lineTo(t.p2c(g),a.p2c(a.max));else if(p<=a.min&&h<=a.min)w.lineTo(t.p2c(d),a.p2c(a.min)),w.lineTo(t.p2c(g),a.p2c(a.min));else{var f=d,m=g;p<=h&&p<a.min&&h>=a.min?(d=(a.min-p)/(h-p)*(g-d)+d,p=a.min):h<=p&&h<a.min&&p>=a.min&&(g=(a.min-p)/(h-p)*(g-d)+d,h=a.min),h<=p&&p>a.max&&h<=a.max?(d=(a.max-p)/(h-p)*(g-d)+d,p=a.max):p<=h&&h>a.max&&p<=a.max&&(g=(a.max-p)/(h-p)*(g-d)+d,h=a.max),d!=f&&w.lineTo(t.p2c(f),a.p2c(p)),w.lineTo(t.p2c(d),a.p2c(p)),w.lineTo(t.p2c(g),a.p2c(h)),g!=m&&(w.lineTo(t.p2c(g),a.p2c(h)),w.lineTo(t.p2c(m),a.p2c(h)))}}}}(y.datapoints,y.xaxis,y.yaxis));0<t&&e(y.datapoints,0,0,y.xaxis,y.yaxis);w.restore()}(e,t),e.bars.show&&function(c,d){var e;switch(d.save(),d.translate(S.left,S.top),d.lineWidth=c.bars.lineWidth,d.strokeStyle=c.color,c.bars.align){case"left":e=0;break;case"right":e=-c.bars.barWidth;break;case"center":e=-c.bars.barWidth/2;break;default:throw new Error("Invalid bar alignment: "+c.bars.align)}var t=c.bars.fill?function(e,t){return R(c.bars,c.color,e,t)}:null;(function(e,t,a,n,i,r,o){for(var l=e.points,s=e.pointsize,u=0;u<l.length;u+=s)null!=l[u]&&k(l[u],l[u+1],l[u+2],t,a,n,i,r,o,d,c.bars.horizontal,c.bars.lineWidth)})(c.datapoints,e,e+c.bars.barWidth,0,t,c.xaxis,c.yaxis),d.restore()}(e,t),e.points.show&&function(h,f){function e(e,t,a,n,i,r,o,l){for(var s=e.points,u=e.pointsize,c=0;c<s.length;c+=u){var d=s[c],p=s[c+1];if(1==h.lines.steps){var g=T.globalStringDictionary.recountedDictionary[h.idx];null!=g&&null!=g[p]&&(p=T.globalStringDictionary.recountedDictionary[h.idx][p])}null==d||d<r.min||d>r.max||p<o.min||p>o.max||(f.beginPath(),d=r.p2c(d),p=o.p2c(p)+n,"circle"==l?f.arc(d,p,t,0,i?Math.PI:2*Math.PI,!1):l(f,d,p,t,i,h,s,T),f.closePath(),a&&(f.fillStyle=a,f.fill()),f.stroke())}}f.save(),f.translate(S.left,S.top);var t=h.points.lineWidth,a=h.shadowSize,n=h.points.radius,i=h.points.symbol;0==t&&(t=1e-4);if(0<t&&0<a){var r=a/2;f.lineWidth=r,f.strokeStyle="rgba(0,0,0,0.1)",e(h.datapoints,n,null,r+r/2,!0,h.xaxis,h.yaxis,i),f.strokeStyle="rgba(0,0,0,0.2)",e(h.datapoints,n,null,r/2,!0,h.xaxis,h.yaxis,i)}f.lineWidth=t,f.strokeStyle=h.color,e(h.datapoints,n,R(h.points,h.color),0,!1,h.xaxis,h.yaxis,i),f.restore()}(e,t)}function F(e,t,a,n,i){for(var r,o=Math.ceil((e+t)/i/2)*i;null===n[o];)o++;if(t-e<10*i||o==t){for(var l=e;l<=t;l+=i)if(null!=n[l]&&n[l]>a.x){r=l;break}}else r=n[o]>a.x?F(e,o,a,n,i):F(o,t,a,n,i);return r}function k(e,t,a,n,i,r,o,l,s,u,c,d){var p,g,h,f,m,v,x,b,S;c?(b=v=x=!0,m=!1,f=t+n,h=t+i,(g=e)<(p=a)&&(S=g,g=p,p=S,v=!(m=!0))):(m=v=x=!0,b=!1,p=e+n,g=e+i,(f=t)<(h=a)&&(S=f,f=h,h=S,x=!(b=!0))),g<l.min||p>l.max||f<s.min||h>s.max||(p<l.min&&(p=l.min,m=!1),g>l.max&&(g=l.max,v=!1),h<s.min&&(h=s.min,b=!1),f>s.max&&(f=s.max,x=!1),p=l.p2c(p),h=s.p2c(h),g=l.p2c(g),f=s.p2c(f),o&&(u.beginPath(),u.moveTo(p,h),u.lineTo(p,f),u.lineTo(g,f),u.lineTo(g,h),u.fillStyle=o(h,f),u.fill()),0<d&&(m||v||x||b)&&(u.beginPath(),u.moveTo(p,h+r),m?u.lineTo(p,f+r):u.moveTo(p,f+r),x?u.lineTo(g,f+r):u.moveTo(g,f+r),v?u.lineTo(g,h+r):u.moveTo(g,h+r),b?u.lineTo(p,h+r):u.moveTo(p,h+r),u.stroke()))}function R(e,t,a,n){var i=e.fill;if(!i)return null;if(e.fillColor)return _(e.fillColor,a,n,t);var r=q.color.parse(t);return r.a="number"==typeof i?i:.4,r.normalize(),r.toString()}y.setData=r,y.setupGrid=l,y.findNearbyItem=C,y.draw=s,y.parseOptions=i,y.drawSeries=h,y.getPlaceholder=function(){return b},y.getCanvas=function(){return g.element},y.getPlotOffset=function(){return S},y.width=function(){return x},y.height=function(){return D},y.offset=function(){var e=c.offset();return e.left+=S.left,e.top+=S.top,e},y.getData=function(){return V},y.getAxes=function(){var a={};return q.each(f.concat(m),function(e,t){t&&(a[t.direction+(1!=t.n?t.n:"")+"axis"]=t)}),a},y.getXAxes=function(){return f},y.getYAxes=function(){return m},y.c2p=d,y.p2c=function(e){var t,a,n,i={};for(t=0;t<f.length;++t)if((a=f[t])&&a.used&&(n="x"+a.n,null==e[n]&&1==a.n&&(n="x"),null!=e[n])){i.left=a.p2c(e[n]);break}for(t=0;t<m.length;++t)if((a=m[t])&&a.used&&(n="y"+a.n,null==e[n]&&1==a.n&&(n="y"),null!=e[n])){i.top=a.p2c(e[n]);break}return i},y.getOptions=function(){return T},y.highlight=U,y.unhighlight=z,y.triggerRedrawOverlay=H,y.drawOverlay=L,y.pointOffset=function(e){return{left:parseInt(f[w(e,"x")-1].p2c(+e.x)+S.left,10),top:parseInt(m[w(e,"y")-1].p2c(+e.y)+S.top,10)}},y.shutdown=function(){O&&clearTimeout(O);c.unbind("mousemove",$),c.unbind("mouseleave",W),c.unbind("click",N),I(A.shutdown,[c])},y.resize=function(){var e=b.width(),t=b.height();g.resize(e,t),a.resize(e,t)},y.hooks=A,function(){for(var e={Canvas:Z},t=0;t<n.length;++t){var a=n[t];a.init(y,e),a.options&&q.extend(!0,T,a.options)}}(),i(t),function(){b.css("padding",0).children(":not(.flot-base,.flot-overlay)").remove(),"static"==b.css("position")&&b.css("position","relative");g=new Z("flot-base",b),a=new Z("flot-overlay",b),v=g.context,u=a.context,c=q(a.element).unbind();var e=b.data("plot");e&&(e.shutdown(),a.clear());b.data("plot",y)}(),r(e),l(),s(),function(){T.grid.hoverable&&(c.mousemove($),c.bind("mouseleave",W));T.grid.clickable&&c.click(N);I(A.bindEvents,[c])}();var P=[],O=null;function C(e,t,a){var n,i,r,o=T.grid.mouseActiveRadius,l=o*o+1,s=null;for(n=V.length-1;0<=n;--n)if(a(V[n])){var u=V[n],c=u.xaxis,d=u.yaxis,p=u.datapoints.points,g=c.c2p(e),h=d.c2p(t),f=o/c.scale,m=o/d.scale;if(r=u.datapoints.pointsize,c.options.inverseTransform&&(f=Number.MAX_VALUE),d.options.inverseTransform&&(m=Number.MAX_VALUE),u.lines.show||u.points.show)for(i=0;i<p.length;i+=r){var v=p[i],x=p[i+1];if(null!=v&&(1==u.lines.steps&&null!=T.globalStringDictionary.recountedDictionary[u.idx]&&null!=T.globalStringDictionary.recountedDictionary[u.idx][x]&&(x=T.globalStringDictionary.recountedDictionary[u.idx][x]),!(f<v-g||v-g<-f||m<x-h||x-h<-m))){var b=Math.abs(c.p2c(v)-e),S=Math.abs(d.p2c(x)-t),y=b*b+S*S;y<l&&(l=y,s=[n,i/r])}}if(u.bars.show&&!s){var w="left"==u.bars.align?0:-u.bars.barWidth/2,D=w+u.bars.barWidth;for(i=0;i<p.length;i+=r){v=p[i],x=p[i+1];var A=p[i+2];null!=v&&(1==u.lines.steps&&void 0!==T.globalStringDictionary.recountedDictionary[u.idx]&&void 0!==T.globalStringDictionary.recountedDictionary[u.idx][x]&&(x=T.globalStringDictionary.recountedDictionary[u.idx][x]),(V[n].bars.horizontal?g<=Math.max(A,v)&&g>=Math.min(A,v)&&x+w<=h&&h<=x+D:v+w<=g&&g<=v+D&&h>=Math.min(A,x)&&h<=Math.max(A,x))&&(s=[n,i/r]))}}}return s?(n=s[0],i=s[1],r=V[n].datapoints.pointsize,{datapoint:V[n].datapoints.points.slice(i*r,(i+1)*r),dataIndex:i,series:V[n],seriesIndex:n}):null}function $(e){T.grid.hoverable&&B("plothover",e,function(e){return 0!=e.hoverable})}function W(e){T.grid.hoverable&&B("plothover",e,function(e){return!1})}function N(e){B("plotclick",e,function(e){return 0!=e.clickable})}function B(e,t,a){var n=c.offset(),i=t.pageX-n.left-S.left,r=t.pageY-n.top-S.top,o=d({left:i,top:r});if(o.pageX=t.pageX,o.pageY=t.pageY,0==T.grid.plothoverGetItem)b.trigger(e,[o,null]);else{var l=C(i,r,a);if(l&&(l.pageX=parseInt(l.series.xaxis.p2c(l.datapoint[0])+n.left+S.left,10),l.pageY=parseInt(l.series.yaxis.p2c(l.datapoint[1])+n.top+S.top,10)),T.grid.autoHighlight){for(var s=0;s<P.length;++s){var u=P[s];u.auto!=e||l&&u.series==l.series&&u.point[0]==l.datapoint[0]&&u.point[1]==l.datapoint[1]||z(u.series,u.point)}l&&U(l.series,l.datapoint,e)}b.trigger(e,[o,l])}}function H(){var e=T.interaction.redrawOverlayInterval;-1!=e?O||(O=setTimeout(L,e)):L()}function L(){var e,t;for(O=null,u.save(),a.clear(),u.translate(S.left,S.top),e=0;e<P.length;++e)(t=P[e]).series.bars.show?Y(t.series,t.point):X(t.series,t.point);u.restore(),I(A.drawOverlay,[u])}function U(e,t,a){if(null!=e&&null!=t){if("string"==typeof e)for(var n=0;n<V.length;n++)V[n].idx==e&&(e=V[n]);-1==(n=j(e,t))?(P.push({series:e,point:t,auto:a}),H()):a||(P[n].auto=!1)}}function z(e,t){if(null==e&&null==t)return P=[],void H();if("string"==typeof e)for(var a=0;a<V.length;a++)V[a].idx==e&&(e=V[a]);"number"==typeof t&&(t=e.data.slice(t,t+1)),-1!=(a=j(e,t))&&(P.splice(a,1),H())}function j(e,t){for(var a=0;a<P.length;++a){var n=P[a];if(n.series==e&&n.point[0]==t[0]&&n.point[1]==t[1])return a}return-1}function X(e,t){if(null!=t){var a=t[0],n=t[1],i=e.xaxis,r=e.yaxis,o="string"==typeof e.highlightColor?e.highlightColor:q.color.parse(e.color).scale("a",.5).toString();if(1==e.lines.steps&&null!=T.globalStringDictionary.recountedDictionary[e.idx]&&null!=T.globalStringDictionary.recountedDictionary[e.idx][n]&&(n=T.globalStringDictionary.recountedDictionary[e.idx][n]),!(a<i.min||a>i.max||n<r.min||n>r.max)){var l=e.points.radius+e.points.lineWidth/2;u.lineWidth=l,u.strokeStyle=o;var s=1.5*l;a=i.p2c(a),n=r.p2c(n),u.beginPath(),"circle"==e.points.symbol?u.arc(a,n,s,0,2*Math.PI,!1):e.points.symbol(u,a,n,s,!1,e,t,T,!0),u.closePath(),u.stroke()}}}function Y(e,t){var a="string"==typeof e.highlightColor?e.highlightColor:q.color.parse(e.color).scale("a",.5).toString(),n=a,i="left"==e.bars.align?0:-e.bars.barWidth/2;u.lineWidth=e.bars.lineWidth,u.strokeStyle=a,k(t[0],t[1],t[2]||0,i,i+e.bars.barWidth,0,function(){return n},e.xaxis,e.yaxis,u,e.bars.horizontal,e.bars.lineWidth)}function _(e,t,a,n){if("string"==typeof e)return e;for(var i=v.createLinearGradient(0,a,0,t),r=0,o=e.colors.length;r<o;++r){var l=e.colors[r];if("string"!=typeof l){var s=q.color.parse(n);null!=l.brightness&&(s=s.scale("rgb",l.brightness)),null!=l.opacity&&(s.a*=l.opacity),l=s.toString()}i.addColorStop(r/(o-1),l)}return i}}Z.prototype.resize=function(e,t){if(!(e<=0||t<=0)){var a=this.element,n=this.context,i=this.pixelRatio;this.width!=e&&(a.width=e*i,a.style.width=e+"px",this.width=e),this.height!=t&&(a.height=t*i,a.style.height=t+"px",this.height=t),n.restore(),n.save(),n.scale(i,i)}},Z.prototype.clear=function(){this.context.clearRect(0,0,this.width,this.height)},Z.prototype.render=function(){var e=this._textCache;for(var t in e)if(g.call(e,t)){var a=this.getTextLayer(t),n=e[t];for(var i in a.hide(),n)if(g.call(n,i)){var r=n[i];for(var o in r)if(g.call(r,o)){for(var l,s=r[o].positions,u=0;l=s[u];u++)l.active?l.rendered||(a.append(l.element),l.rendered=!0):(s.splice(u--,1),l.rendered&&l.element.detach());0==s.length&&delete r[o]}}a.show()}},Z.prototype.getTextLayer=function(e){var t=this.text[e];return null==t&&(null==this.textContainer&&(this.textContainer=q("<div class='flot-text'></div>").css({position:"absolute",top:0,left:0,bottom:0,right:0,"font-size":"smaller",color:"#545454"}).insertAfter(this.element)),t=this.text[e]=q("<div></div>").addClass(e).css({position:"absolute",top:0,left:0,bottom:0,right:0}).appendTo(this.textContainer)),t},Z.prototype.getTextInfo=function(e,t,a,n,i){var r,o,l,s;if(t=""+t,r="object"==typeof a?a.style+" "+a.variant+" "+a.weight+" "+a.size+"px/"+a.lineHeight+"px "+a.family:a,null==(o=this._textCache[e])&&(o=this._textCache[e]={}),null==(l=o[r])&&(l=o[r]={}),null==(s=l[t])){var u=q("<div></div>").html(t).css({position:"absolute","max-width":i,top:-9999}).appendTo(this.getTextLayer(e));"object"==typeof a?u.css({font:r,color:a.color}):"string"==typeof a&&u.addClass(a),s=l[t]={width:u.outerWidth(!0),height:u.outerHeight(!0),element:u,positions:[]},u.detach()}return s},Z.prototype.addText=function(e,t,a,n,i,r,o,l,s){var u=this.getTextInfo(e,n,i,r,o),c=u.positions;"center"==l?t-=u.width/2:"right"==l&&(t-=u.width),"middle"==s?a-=u.height/2:"bottom"==s&&(a-=u.height);for(var d,p=0;d=c[p];p++)if(d.x==t&&d.y==a)return void(d.active=!0);d={active:!0,rendered:!1,element:c.length?u.element.clone():u.element,x:t,y:a},c.push(d),d.element.css({top:Math.round(a),left:Math.round(t),"text-align":l})},Z.prototype.removeText=function(e,t,a,n,i,r){if(null==n){var o=this._textCache[e];if(null!=o)for(var l in o)if(g.call(o,l)){var s=o[l];for(var u in s)if(g.call(s,u))for(var c=s[u].positions,d=0;p=c[d];d++)p.active=!1}}else{var p;for(c=this.getTextInfo(e,n,i,r).positions,d=0;p=c[d];d++)p.x==t&&p.y==a&&(p.active=!1)}},q.plot=function(e,t,a){return new n(q(e),t,a,q.plot.plugins)},q.plot.version="0.8.1",q.plot.plugins=[],q.fn.plot=function(e,t){return this.each(function(){q.plot(this,e,t)})}}(jQuery),function(a){function S(e,t){return t*Math.floor(e/t)}function s(e,t,a,n){if("function"==typeof e.strftime)return e.strftime(t);var i,r=function(e,t){return t=""+(null==t?"0":t),1==(e=""+e).length?t+e:e},o=[],l=!1,s=e.getHours(),u=s<12;null==a&&(a=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]),null==n&&(n=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]),i=12<s?s-12:0==s?12:s;for(var c=0;c<t.length;++c){var d=t.charAt(c);if(l){switch(d){case"a":d=""+n[e.getDay()];break;case"b":d=""+a[e.getMonth()];break;case"d":d=r(e.getDate());break;case"e":d=r(e.getDate()," ");break;case"h":case"H":d=r(s);break;case"I":d=r(i);break;case"l":d=r(i," ");break;case"m":d=r(e.getMonth()+1);break;case"M":d=r(e.getMinutes());break;case"q":d=""+(Math.floor(e.getMonth()/3)+1);break;case"S":d=r(e.getSeconds());break;case"y":d=r(e.getFullYear()%100);break;case"Y":d=""+e.getFullYear();break;case"p":d=u?"am":"pm";break;case"P":d=u?"AM":"PM";break;case"w":d=""+e.getDay()}o.push(d),l=!1}else"%"==d?l=!0:o.push(d)}return o.join("")}function n(e){function t(e,t,a,n){e[t]=function(){return a[n].apply(a,arguments)}}var a={date:e};null!=e.strftime&&t(a,"strftime",e,"strftime"),t(a,"getTime",e,"getTime"),t(a,"setTime",e,"setTime");for(var n=["Date","Day","FullYear","Hours","Milliseconds","Minutes","Month","Seconds"],i=0;i<n.length;i++)t(a,"get"+n[i],e,"getUTC"+n[i]),t(a,"set"+n[i],e,"setUTC"+n[i]);return a}function y(e,t){if("browser"==t.timezone)return new Date(e);if(t.timezone&&"utc"!=t.timezone){if("undefined"==typeof timezoneJS||void 0===timezoneJS.Date)return n(new Date(e));var a=new timezoneJS.Date;return a.setTimezone(t.timezone),a.setTime(e),a}return n(new Date(e))}var w={second:1e3,minute:6e4,hour:36e5,day:864e5,month:2592e6,quarter:7776e6,year:525949.2*60*1e3},e=[[1,"second"],[2,"second"],[5,"second"],[10,"second"],[30,"second"],[1,"minute"],[2,"minute"],[5,"minute"],[10,"minute"],[30,"minute"],[1,"hour"],[2,"hour"],[4,"hour"],[8,"hour"],[12,"hour"],[1,"day"],[2,"day"],[3,"day"],[.25,"month"],[.5,"month"],[1,"month"],[2,"month"]],D=e.concat([[3,"month"],[6,"month"],[1,"year"]]),A=e.concat([[1,"quarter"],[2,"quarter"],[1,"year"]]);a.plot.plugins.push({init:function(e){e.hooks.processOptions.push(function(e,t){a.each(e.getAxes(),function(e,t){var b=t.options;"time"==b.mode&&(t.tickGenerator=function(e){var t=[],a=y(e.min,b),n=0,i=b.tickSize&&"quarter"===b.tickSize[1]||b.minTickSize&&"quarter"===b.minTickSize[1]?A:D;null!=b.minTickSize&&(n="number"==typeof b.tickSize?b.tickSize:b.minTickSize[0]*w[b.minTickSize[1]]);for(var r=0;r<i.length-1&&!(e.delta<(i[r][0]*w[i[r][1]]+i[r+1][0]*w[i[r+1][1]])/2&&i[r][0]*w[i[r][1]]>=n);++r);var o=i[r][0],l=i[r][1];if("year"==l){if(null!=b.minTickSize&&"year"==b.minTickSize[1])o=Math.floor(b.minTickSize[0]);else{var s=Math.pow(10,Math.floor(Math.log(e.delta/w.year)/Math.LN10)),u=e.delta/w.year/s;o=u<1.5?1:u<3?2:u<7.5?5:10,o*=s}o<1&&(o=1)}e.tickSize=b.tickSize||[o,l];var c=e.tickSize[0];l=e.tickSize[1];var d=c*w[l];"second"==l?a.setSeconds(S(a.getSeconds(),c)):"minute"==l?a.setMinutes(S(a.getMinutes(),c)):"hour"==l?a.setHours(S(a.getHours(),c)):"month"==l?a.setMonth(S(a.getMonth(),c)):"quarter"==l?a.setMonth(3*S(a.getMonth()/3,c)):"year"==l&&a.setFullYear(S(a.getFullYear(),c)),a.setMilliseconds(0),w.minute<=d&&a.setSeconds(0),w.hour<=d&&(a.setMinutes(0),a.setSeconds(0)),w.day<=d&&(a.setHours(0),a.setMinutes(0),a.setSeconds(0)),4*w.day<=d&&a.setDate(1),2*w.month<=d&&a.setMonth(S(a.getMonth(),3)),2*w.quarter<=d&&a.setMonth(S(a.getMonth(),6)),w.year<=d&&a.setMonth(0);var p,g=0,h=Number.NaN,f=Math.abs(a.getTimezoneOffset());do{if(p=h,h=a.getTime(),t.push(h),"month"==l||"quarter"==l)if(c<1){a.setDate(1);var m=a.getTime();a.setMonth(a.getMonth()+("quarter"==l?3:1));var v=a.getTime();a.setTime(h+g*w.hour+(v-m)*c),g=a.getHours(),a.setHours(0,0,0,0)}else a.setMonth(a.getMonth()+c*("quarter"==l?3:1));else"year"==l?a.setFullYear(a.getFullYear()+c):a.setTime(h+d);var x=Math.abs(a.getTimezoneOffset());x!=f&&(a.setMinutes(f-x),"month"==l&&a.setHours(0,0,0,0)),f=x}while(h<e.max&&h!=p);return t},t.tickFormatter=function(e,t){var a=y(e,t.options);if(null!=b.timeformat)return s(a,b.timeformat,b.monthNames,b.dayNames);var n=t.options.tickSize&&"quarter"==t.options.tickSize[1]||t.options.minTickSize&&"quarter"==t.options.minTickSize[1],i=t.tickSize[0]*w[t.tickSize[1]],r=t.max-t.min,o=b.twelveHourClock?" %p":"",l=b.twelveHourClock?"%I":"%H";return s(a,i<w.minute?l+":%M:%S"+o:i<w.day?r<2*w.day?l+":%M"+o:"%b %d "+l+":%M"+o:i<w.month?"%b %d":n&&i<w.quarter||!n&&i<w.year?r<w.year?"%b":"%b %Y":n&&i<w.year?r<w.year?"Q%q":"Q%q %Y":"%Y",b.monthNames,b.dayNames)})})})},options:{xaxis:{timezone:null,timeformat:null,twelveHourClock:!1,monthNames:null}},name:"time",version:"1.0"}),a.plot.formatDate=s}(jQuery),function(i){function r(e){var t,a=this,n=e.data||{};if(n.elem)a=e.dragTarget=n.elem,e.dragProxy=d.proxy||a,e.cursorOffsetX=n.pageX-n.left,e.cursorOffsetY=n.pageY-n.top,e.offsetX=e.pageX-e.cursorOffsetX,e.offsetY=e.pageY-e.cursorOffsetY;else if(d.dragging||0<n.which&&e.which!=n.which||i(e.target).is(n.not))return;switch(e.type){case"mousedown":return i.extend(n,i(a).offset(),{elem:a,target:e.target,pageX:e.pageX,pageY:e.pageY}),u.add(document,"mousemove mouseup",r,n),s(a,!1),d.dragging=null,!1;case!d.dragging&&"mousemove":if(l(e.pageX-n.pageX)+l(e.pageY-n.pageY)<n.distance)break;e.target=n.target,!1!==(t=o(e,"dragstart",a))&&(d.dragging=a,d.proxy=e.dragProxy=i(t||a)[0]);case"mousemove":if(d.dragging){if(t=o(e,"drag",a),c.drop&&(c.drop.allowed=!1!==t,c.drop.handler(e)),!1!==t)break;e.type="mouseup"}case"mouseup":u.remove(document,"mousemove mouseup",r),d.dragging&&(c.drop&&c.drop.handler(e),o(e,"dragend",a)),s(a,!0),d.dragging=d.proxy=n.elem=!1}return!0}function o(e,t,a){e.type=t;var n=i.event.dispatch.call(a,e);return!1!==n&&(n||e.result)}function l(e){return Math.pow(e,2)}function t(){return!1===d.dragging}function s(e,t){e&&(e.unselectable=t?"off":"on",e.onselectstart=function(){return t},e.style&&(e.style.MozUserSelect=t?"":"none"))}i.fn.drag=function(e,t,a){return t&&this.bind("dragstart",e),a&&this.bind("dragend",a),e?this.bind("drag",t||e):this.trigger("drag")};var u=i.event,c=u.special,d=c.drag={not:":input",distance:0,which:1,dragging:!1,setup:function(e){(e=i.extend({distance:d.distance,which:d.which,not:d.not},e||{})).distance=l(e.distance),u.add(this,"mousedown",r,e),this.attachEvent&&this.attachEvent("ondragstart",t)},teardown:function(){u.remove(this,"mousedown",r),this===d.dragging&&(d.dragging=d.proxy=!1),s(this,!0),this.detachEvent&&this.detachEvent("ondragstart",t)}};c.dragstart=c.dragend={setup:function(){},teardown:function(){}}}(jQuery),function(o){function t(e){var t=e||window.event,a=[].slice.call(arguments,1),n=0,i=0,r=0;return(e=o.event.fix(t)).type="mousewheel",t.wheelDelta&&(n=t.wheelDelta/120),t.detail&&(n=-t.detail/3),r=n,void 0!==t.axis&&t.axis===t.HORIZONTAL_AXIS&&(r=0,i=-1*n),void 0!==t.wheelDeltaY&&(r=t.wheelDeltaY/120),void 0!==t.wheelDeltaX&&(i=-1*t.wheelDeltaX/120),a.unshift(e,n,i,r),(o.event.dispatch||o.event.handle).apply(this,a)}var a=["DOMMouseScroll","mousewheel"];if(o.event.fixHooks)for(var e=a.length;e;)o.event.fixHooks[a[--e]]=o.event.mouseHooks;o.event.special.mousewheel={setup:function(){if(this.addEventListener)for(var e=a.length;e;)this.addEventListener(a[--e],t,!1);else this.onmousewheel=t},teardown:function(){if(this.removeEventListener)for(var e=a.length;e;)this.removeEventListener(a[--e],t,!1);else this.onmousewheel=null}},o.fn.extend({mousewheel:function(e){return e?this.bind("mousewheel",e):this.trigger("mousewheel")},unmousewheel:function(e){return this.unbind("mousewheel",e)}})}(jQuery),function(p){p.plot.plugins.push({init:function(s){function n(e,t){var a=s.offset();a.left=e.pageX-a.left,a.top=e.pageY-a.top,t?s.zoomOut({center:a}):s.zoom({center:a})}function i(e,t){return e.preventDefault(),n(e,t<0),!1}var a="default",r=0,o=0,l=null;function u(e){if(1!=e.which)return!1;var t=s.getPlaceholder().css("cursor");t&&(a=t),s.getPlaceholder().css("cursor",s.getOptions().pan.cursor),r=e.pageX,o=e.pageY}function c(e){var t=s.getOptions().pan.frameRate;!l&&t&&(l=setTimeout(function(){s.pan({left:r-e.pageX,top:o-e.pageY}),r=e.pageX,o=e.pageY,l=null},1/t*1e3))}function d(e){l&&(clearTimeout(l),l=null),s.getPlaceholder().css("cursor",a),s.pan({left:r-e.pageX,top:o-e.pageY})}s.zoomOut=function(e){e||(e={}),e.amount||(e.amount=s.getOptions().zoom.amount),e.amount=1/e.amount,s.zoom(e)},s.zoom=function(e){e||(e={});var t=e.center,a=e.amount||s.getOptions().zoom.amount,n=s.width(),i=s.height();t||(t={left:n/2,top:i/2});var r=t.left/n,o=t.top/i,u={x:{min:t.left-r*n/a,max:t.left+(1-r)*n/a},y:{min:t.top-o*i/a,max:t.top+(1-o)*i/a}};p.each(s.getAxes(),function(e,t){var a=t.options,n=u[t.direction].min,i=u[t.direction].max,r=a.zoomRange,o=a.panRange;if(!1!==r){if(n=t.c2p(n),(i=t.c2p(i))<n){var l=n;n=i,i=l}o&&(null!=o[0]&&n<o[0]&&(n=o[0]),null!=o[1]&&i>o[1]&&(i=o[1]));var s=i-n;r&&(null!=r[0]&&s<r[0]||null!=r[1]&&s>r[1])||(a.min=n,a.max=i)}}),s.setupGrid(),s.draw(),e.preventEvent||s.getPlaceholder().trigger("plotzoom",[s,e])},s.pan=function(e){var l={x:+e.left,y:+e.top};isNaN(l.x)&&(l.x=0),isNaN(l.y)&&(l.y=0),p.each(s.getAxes(),function(e,t){var a,n,i=t.options,r=l[t.direction];a=t.c2p(t.p2c(t.min)+r),n=t.c2p(t.p2c(t.max)+r);var o=i.panRange;!1!==o&&(o&&(null!=o[0]&&o[0]>a&&(a+=r=o[0]-a,n+=r),null!=o[1]&&o[1]<n&&(a+=r=o[1]-n,n+=r)),i.min=a,i.max=n)}),s.setupGrid(),s.draw(),e.preventEvent||s.getPlaceholder().trigger("plotpan",[s,e])},s.hooks.bindEvents.push(function(e,t){var a=e.getOptions();a.zoom.interactive&&(t[a.zoom.trigger](n),t.mousewheel(i)),a.pan.interactive&&(t.bind("dragstart",{distance:10},u),t.bind("drag",c),t.bind("dragend",d))}),s.hooks.shutdown.push(function(e,t){t.unbind(e.getOptions().zoom.trigger,n),t.unbind("mousewheel",i),t.unbind("dragstart",u),t.unbind("drag",c),t.unbind("dragend",d),l&&clearTimeout(l)})},options:{xaxis:{zoomRange:null,panRange:null},zoom:{interactive:!1,trigger:"dblclick",amount:1.5},pan:{interactive:!1,cursor:"move",frameRate:20}},name:"navigate",version:"1.3"})}(jQuery),function(m){var v,x,b,S=Object.prototype.hasOwnProperty;m.plot.plugins.push({init:function(f,e){var t=e.Canvas;null==v&&(x=t.prototype.getTextInfo,b=t.prototype.addText,v=t.prototype.render),t.prototype.render=function(){if(!f.getOptions().canvas)return v.call(this);var e=this.context,t=this._textCache;for(var a in e.save(),e.textBaseline="middle",t)if(S.call(t,a)){var n=t[a];for(var i in n)if(S.call(n,i)){var r=n[i],o=!0;for(var l in r)if(S.call(r,l)){var s=r[l],u=s.positions,c=s.lines;o&&(e.fillStyle=s.font.color,e.font=s.font.definition,o=!1);for(var d,p=0;d=u[p];p++)if(d.active)for(var g,h=0;g=d.lines[h];h++)e.fillText(c[h].text,g[0],g[1]);else u.splice(p--,1);0==u.length&&delete r[l]}}}e.restore()},t.prototype.getTextInfo=function(e,t,a,n,i){if(!f.getOptions().canvas)return x.call(this,e,t,a,n,i);var r,o,l,s;if(t=""+t,r="object"==typeof a?a.style+" "+a.variant+" "+a.weight+" "+a.size+"px "+a.family:a,null==(o=this._textCache[e])&&(o=this._textCache[e]={}),null==(l=o[r])&&(l=o[r]={}),null==(s=l[t])){var u=this.context;if("object"!=typeof a){var c=m("<div>&nbsp;</div>").css("position","absolute").addClass("string"==typeof a?a:null).appendTo(this.getTextLayer(e));(a={lineHeight:c.height(),style:c.css("font-style"),variant:c.css("font-variant"),weight:c.css("font-weight"),family:c.css("font-family"),color:c.css("color")}).size=c.css("line-height",1).height(),c.remove()}r=a.style+" "+a.variant+" "+a.weight+" "+a.size+"px "+a.family,s=l[t]={width:0,height:0,positions:[],lines:[],font:{definition:r,color:a.color}},u.save(),u.font=r;for(var d=(t+"").replace(/<br ?\/?>|\r\n|\r/g,"\n").split("\n"),p=0;p<d.length;++p){var g=d[p],h=u.measureText(g);s.width=Math.max(h.width,s.width),s.height+=a.lineHeight,s.lines.push({text:g,width:h.width,height:a.lineHeight})}u.restore()}return s},t.prototype.addText=function(e,t,a,n,i,r,o,l,s){if(!f.getOptions().canvas)return b.call(this,e,t,a,n,i,r,o,l,s);var u,c=this.getTextInfo(e,n,i,r,o),d=c.positions,p=c.lines;a+=c.height/p.length/2,a="middle"==s?Math.round(a-c.height/2):"bottom"==s?Math.round(a-c.height):Math.round(a),window.opera&&window.opera.version().split(".")[0]<12&&(a-=2);for(var g,h=0;g=d[h];h++)if(g.x==t&&g.y==a)return void(g.active=!0);for(g={active:!0,lines:[],x:t,y:a},d.push(g),h=0;u=p[h];h++)"center"==l?g.lines.push([Math.round(t-u.width/2),a]):"right"==l?g.lines.push([Math.round(t-u.width),a]):g.lines.push([Math.round(t),a]),a+=u.height}},options:{canvas:!0},name:"canvas",version:"1.0"})}(jQuery),function(f){f.plot.plugins.push({init:function(u){var c={first:{x:-1,y:-1},second:{x:-1,y:-1},show:!1,active:!1},a={},n=null;function i(e){c.active&&(d(e),u.getPlaceholder().trigger("plotselecting",[t()]))}function r(e){1==e.which&&(document.body.focus(),void 0!==document.onselectstart&&null==a.onselectstart&&(a.onselectstart=document.onselectstart,document.onselectstart=function(){return!1}),void 0!==document.ondrag&&null==a.ondrag&&(a.ondrag=document.ondrag,document.ondrag=function(){return!1}),s(c.first,e),c.active=!0,n=function(e){var t;t=e,n=null,void 0!==document.onselectstart&&(document.onselectstart=a.onselectstart),void 0!==document.ondrag&&(document.ondrag=a.ondrag),c.active=!1,d(t),h()?o():(u.getPlaceholder().trigger("plotunselected",[]),u.getPlaceholder().trigger("plotselecting",[null]))},f(document).one("mouseup",n))}function t(){if(!h())return null;if(!c.show)return null;var i={},r=c.first,o=c.second;return f.each(u.getAxes(),function(e,t){if(t.used){var a=t.c2p(r[t.direction]),n=t.c2p(o[t.direction]);i[e]={from:Math.min(a,n),to:Math.max(a,n)}}}),i}function o(){var e=t();u.getPlaceholder().trigger("plotselected",[e]),e.xaxis&&e.yaxis&&u.getPlaceholder().trigger("selected",[{x1:e.xaxis.from,y1:e.yaxis.from,x2:e.xaxis.to,y2:e.yaxis.to}])}function l(e,t,a){return t<e?e:a<t?a:t}function s(e,t){var a=u.getOptions(),n=u.getPlaceholder().offset(),i=u.getPlotOffset();e.x=l(0,t.pageX-n.left-i.left,u.width()),e.y=l(0,t.pageY-n.top-i.top,u.height()),"y"==a.selection.mode&&(e.x=e==c.first?0:u.width()),"x"==a.selection.mode&&(e.y=e==c.first?0:u.height())}function d(e){null!=e.pageX&&(s(c.second,e),h()?(c.show=!0,u.triggerRedrawOverlay()):p(!0))}function p(e){c.show&&(c.show=!1,u.triggerRedrawOverlay(),e||u.getPlaceholder().trigger("plotunselected",[]))}function g(e,t){var a,n,i,r,o=u.getAxes();for(var l in o)if((a=o[l]).direction==t&&(e[r=t+a.n+"axis"]||1!=a.n||(r=t+"axis"),e[r])){n=e[r].from,i=e[r].to;break}if(e[r]||(a="x"==t?u.getXAxes()[0]:u.getYAxes()[0],n=e[t+"1"],i=e[t+"2"]),null!=n&&null!=i&&i<n){var s=n;n=i,i=s}return{from:n,to:i,axis:a}}function h(){var e=u.getOptions().selection.minSize;return Math.abs(c.second.x-c.first.x)>=e&&Math.abs(c.second.y-c.first.y)>=e}u.clearSelection=p,u.setSelection=function(e,t){var a,n=u.getOptions();"y"==n.selection.mode?(c.first.x=0,c.second.x=u.width()):(a=g(e,"x"),c.first.x=a.axis.p2c(a.from),c.second.x=a.axis.p2c(a.to)),"x"==n.selection.mode?(c.first.y=0,c.second.y=u.height()):(a=g(e,"y"),c.first.y=a.axis.p2c(a.from),c.second.y=a.axis.p2c(a.to)),c.show=!0,u.triggerRedrawOverlay(),!t&&h()&&o()},u.getSelection=t,u.hooks.bindEvents.push(function(e,t){null!=e.getOptions().selection.mode&&(t.mousemove(i),t.mousedown(r))}),u.hooks.drawOverlay.push(function(e,t){if(c.show&&h()){var a=e.getPlotOffset(),n=e.getOptions();t.save(),t.translate(a.left,a.top);var i=f.color.parse(n.selection.color);t.strokeStyle=i.scale("a",.8).toString(),t.lineWidth=1,t.lineJoin=n.selection.shape,t.fillStyle=i.scale("a",.4).toString();var r=Math.min(c.first.x,c.second.x)+.5,o=Math.min(c.first.y,c.second.y)+.5,l=Math.abs(c.second.x-c.first.x)-1,s=Math.abs(c.second.y-c.first.y)-1;t.fillRect(r,o,l,s),t.strokeRect(r,o,l,s),t.restore()}}),u.hooks.shutdown.push(function(e,t){t.unbind("mousemove",i),t.unbind("mousedown",r),n&&f(document).unbind("mouseup",n)})},options:{selection:{mode:null,color:"#e8cfac",shape:"round",minSize:5}},name:"selection",version:"1.1"})}(jQuery),function(o){function t(e,t,a){var n=e.getPlotOffset();if(a.images&&a.images.show)for(var i=a.datapoints.points,r=a.datapoints.pointsize,o=0;o<i.length;o+=r){var l,s=i[o],u=i[o+1],c=i[o+2],d=i[o+3],p=i[o+4],g=a.xaxis,h=a.yaxis;if(!(!s||s.width<=0||s.height<=0)&&(d<u&&(l=d,d=u,u=l),p<c&&(l=p,p=c,c=l),"center"==a.images.anchor&&(u-=l=.5*(d-u)/(s.width-1),d+=l,c-=l=.5*(p-c)/(s.height-1),p+=l),!(u==d||c==p||u>=g.max||d<=g.min||c>=h.max||p<=h.min))){var f=0,m=0,v=s.width,x=s.height;u<g.min&&(f+=(v-f)*(g.min-u)/(d-u),u=g.min),d>g.max&&(v+=(v-f)*(g.max-d)/(d-u),d=g.max),c<h.min&&(x+=(m-x)*(h.min-c)/(p-c),c=h.min),p>h.max&&(m+=(m-x)*(h.max-p)/(p-c),p=h.max),u=g.p2c(u),d=g.p2c(d),c=h.p2c(c),d<u&&(l=d,d=u,u=l),(p=h.p2c(p))<c&&(l=p,p=c,c=l),l=t.globalAlpha,t.globalAlpha*=a.images.alpha,t.drawImage(s,f,m,v-f,x-m,u+n.left,c+n.top,d-u,p-c),t.globalAlpha=l}}}function a(e,t,a,n){t.images.show&&(n.format=[{required:!0},{x:!0,number:!0,required:!0},{y:!0,number:!0,required:!0},{x:!0,number:!0,required:!0},{y:!0,number:!0,required:!0}])}o.plot.image={},o.plot.image.loadDataImages=function(e,t,a){var n=[],i=[],r=t.series.images.show;o.each(e,function(e,t){(r||t.images.show)&&(t.data&&(t=t.data),o.each(t,function(e,t){"string"==typeof t[0]&&(n.push(t[0]),i.push(t))}))}),o.plot.image.load(n,function(n){o.each(i,function(e,t){var a=t[0];n[a]&&(t[0]=n[a])}),a()})},o.plot.image.load=function(e,n){var i=e.length,r={};0==i&&n({}),o.each(e,function(e,t){var a=function(){--i,r[t]=this,0==i&&n(r)};o("<img />").load(a).error(a).attr("src",t)})},o.plot.plugins.push({init:function(e){e.hooks.processRawData.push(a),e.hooks.drawSeries.push(t)},options:{series:{images:{show:!1,alpha:1,anchor:"corner"}}},name:"image",version:"1.1"})}(jQuery),function(V){var e=!1,T=0,I={xaxis:{from:null,to:null},yaxis:{from:null,to:null}},M=!1;V.plot.plugins.push({init:function(i){var v=!1,x=!1,b={x:-1,y:-1},S=0,y=!1,w={x:0,y:0},D=1,A={x:50,y:50};i.getOptions(),i.hooks.processOptions.push(function(e,t){var a=e.getPlaceholder();if(t.touch.autoWidth,t.touch.autoHeight){var n=a.parent();n.siblings().each(function(){V(this).outerHeight()}),parseInt(n.css("padding-top"),10),parseInt(n.css("padding-bottom"),10),window.innerHeight}}),i.hooks.bindEvents.push(function(m,e){var o=m.getPlaceholder(),t=V('<div class="flot-touch-container" style="position: absolute;top: 0;bottom: 0;left: 0;right: 0;/*z-index: 1000;*/"/>');o.css({overflow:"hidden"}).children("canvas").wrapAll(t),o.bind("touchstart",function(e){var t=e.originalEvent.touches,a=o.children("div.flot-touch-container");1===t.length?(v=!0,b={x:t[0].pageX,y:t[0].pageY},S=0):2===t.length&&(x=!0,b={x:(t[0].pageX+t[1].pageX)/2,y:(t[0].pageY+t[1].pageY)/2},S=Math.sqrt(Math.pow(t[1].pageX-t[0].pageX,2)+Math.pow(t[1].pageY-t[0].pageY,2)));var n=o.offset(),i={x:n.left,y:n.top,width:o.width(),height:o.height()},r={x:b.x,y:b.y};return r.x<i.x?r.x=i.x:r.x>i.x+i.width&&(r.x=i.x+i.width),r.y<i.y?r.y=i.y:r.y>i.y+i.height&&(r.y=i.y+i.height),A={x:Math.round(r.x/i.width*100),y:Math.round(r.y/i.height*100)},a.css("-webkit-transform-origin",A.x+"% "+A.y+"%"),!0}),o.bind("touchmove",function(e){var t,a,n=e.originalEvent.touches;return v&&1===n.length?(t={x:n[0].pageX,y:n[0].pageY},function(e){var t=i.getPlaceholder(),a=i.getOptions();switch(w.x-=e.x,w.y-=e.y,a.touch.pan.toLowerCase()){case"x":t.children("div.flot-touch-container").css("-webkit-transform","translateX("+w.x+"px)");break;case"y":t.children("div.flot-touch-container").css("-webkit-transform","translateY("+w.y+"px)");break;default:t.children("div.flot-touch-container").css("-webkit-transform","translate("+w.x+"px,"+w.y+"px)")}}({x:b.x-t.x,y:b.y-t.y}),b=t,y=!(S=0)):x&&2===n.length&&(a=Math.sqrt(Math.pow(n[1].pageX-n[0].pageX,2)+Math.pow(n[1].pageY-n[0].pageY,2)),t={x:(n[0].pageX+n[1].pageX)/2,y:(n[0].pageY+n[1].pageY)/2},function(e){var t=i.getPlaceholder(),a=i.getOptions(),n=t.children("div.flot-touch-container");switch(D*=1+e/100,a.touch.scale.toLowerCase()){case"x":n.css("-webkit-transform","scaleX("+D+")");break;case"y":n.css("-webkit-transform","scaleY("+D+")");break;default:n.css("-webkit-transform","scale("+D+")")}}(a-S),b=t,S=a,y=!0),e.preventDefault(),!0}),o.bind("touchend",function(e){var t=m.getPlaceholder(),s=m.getOptions(),a=t.children("div.flot-touch-container"),u=m.getData(),n=!1;0===w.x&&0===w.y||(n=y=!0,V.each(m.getAxes(),function(e,t){var a=t.options.min,n=t.options.max;if(t.direction===s.touch.pan.toLowerCase()||"xy"==s.touch.pan.toLowerCase()){var i=t.c2p(t.p2c(t.min)-w[t.direction]),r=t.c2p(t.p2c(t.max)-w[t.direction]);if(void 0!==s.series.carpet&&1==s.series.carpet.show){t.options.min<i?i+=864e5:r-=864e5;var o=new Date(i);o.setHours(0,0,0,0),t.options.min=o.getTime();var l=new Date(r);l.setHours(23,59,59,999),t.options.max=l.getTime()}else void 0!==s.series.bars&&1==s.series.bars.show?i<a?(t.options.min=u[0].roundXaxis(u[0].dataInterval,new Date(i),"middle").getTime(),t.options.max=u[0].roundXaxis(u[0].dataInterval,new Date(r),"middle",-1).getTime(),t.options.min):(t.options.min=u[0].roundXaxis(u[0].dataInterval,new Date(i),"middle",1).getTime(),t.options.max=u[0].roundXaxis(u[0].dataInterval,new Date(r),"middle").getTime(),n==t.options.max&&(t.options.min=u[0].roundXaxis(u[0].dataInterval,new Date(t.options.min),"middle",1).getTime(),t.options.max=u[0].roundXaxis(u[0].dataInterval,new Date(t.options.max),"middle",1).getTime())):(t.options.min=i,t.options.max=r);I={xaxis:{from:t.options.min,to:t.options.max}}}}));var i=!1;if(1!==D){i=y=!0;var r=m.width(),o=m.height(),l=Math.round(A.x/100*r),c=Math.round(A.y/100*o),d={x:{min:l-A.x/100*r/D,max:l+(1-A.x/100)*r/D},y:{min:c-A.y/100*o/D,max:c+(1-A.y/100)*o/D}};V.each(m.getAxes(),function(e,t){if(t.direction===s.touch.scale.toLowerCase()||"xy"==s.touch.scale.toLowerCase()){var a=t.c2p(d[t.direction].min),n=t.c2p(d[t.direction].max);if(n<a){var i=a;a=n,n=i}if(void 0!==s.series.carpet&&1==s.series.carpet.show){var r=new Date(a);r.setHours(0,0,0,0),t.options.min=r.getTime();var o=new Date(n);o.setHours(23,59,59,999),t.options.max=o.getTime()}else void 0!==s.series.bars&&1==s.series.bars.show?(t.options.min=u[0].roundXaxis(u[0].dataInterval,new Date(a),"middle").getTime(),t.options.max=u[0].roundXaxis(u[0].dataInterval,new Date(n),"middle").getTime(),t.options.min==t.options.max&&(t.options.max=u[0].roundXaxis(u[0].dataInterval,new Date(n),"middle",1).getTime())):(t.options.min=a,t.options.max=n);I={xaxis:{from:t.options.min,to:t.options.max},yaxis:{from:d.y.min,to:d.y.max}}}})}0;var p=(new Date).getTime();if(void 0!==s.series.carpet&&1!=s.series.carpet.show)p-T<400&&!y?(I={xaxis:{from:null,to:null},yaxis:{from:null,to:null}},m.getPlaceholder().trigger("dblclick",I)):m.getPlaceholder().trigger("handletouch",{fromTo:I,touchPan:n,applyScale:i});else if(void 0!==s.series.carpet&&1==s.series.carpet.show){if(0!==w.x||0!==w.y||1!=D)m.getPlaceholder().trigger("handletouch",{fromTo:I,touchPan:n,applyScale:i}),M=!0;else if(1==M)M=!1;else if(p-T<400&&!y&&1==D){var g={xaxis:{from:null,to:null},yaxis:{from:null,to:null}},h=new Date(u[0].data[0][0]);g.xaxis.from=h.getTime();var f=new Date(u[0].data[u[0].data.length-1][0]);g.xaxis.to=f.getTime(),m.getPlaceholder().trigger("dblclick",I)}}else(y||1!=D)&&(m.getPlaceholder().trigger("handletouch",{fromTo:I,touchPan:n,applyScale:i}),M=!0);return T=y?0:(new Date).getTime(),x=v=!1,b={x:-1,y:-1},w={x:S=0,y:0},D=1,y=!(A={x:50,y:50}),a.css({"-webkit-transform":"translate("+w.x+"px,"+w.y+"px) scale("+D+")","-webkit-transform-origin":A.x+"% "+A.y+"%"}),!0})}),i.hooks.shutdown.push(function(e,t){e.getPlaceholder().unbind("touchstart").unbind("touchmove").unbind("touchend")}),e||(V(document).bind("ready orientationchange",function(e){}),e=!0)},options:{touch:{pan:"xy",scale:"xy",autoWidth:!0,autoHeight:!0}},name:"touch",version:"1.0"})}(jQuery),function(w){var n;function a(a,g,e){var h=n.getData(),f=n.getOptions(),m=[],v={},x=-1/0,b=1/0,S=0,y=0;w.each(a.getAxes(),function(e,t){if("y"==t.direction){var p=t.options.font.lineHeight/a.getPlaceholder()[0].clientWidth*2;t.tickGenerator=function(e){var a=[];m=[],v={},x=-1/0,b=1/0,y=S=0,f.globalStringDictionary.recountedDictionary={},w.each(h,function(e,n){var t=n.mappingDictionary;if(n.isVisible)if(void 0!==t){var i,r=0,a=n.yaxis.max-n.yaxis.min,o=a/3,l=o/5;0==n.nonDigitalSeriesCount&&(l=(o=a)/10);var s=(o-2*l)/n.digitalSeriesCount;1==n.digitalSeriesCount&&0==n.nonDigitalSeriesCount&&(s=o),n.yaxis.min,i=n.yaxis.min+l/2+s*n.digitalOrder;var u=0;angular.forEach(n.dictionary,function(e,t){u++});var c=s/u;g.dictionaryRecounted={},f.globalStringDictionary.recountedDictionary[n.idx]={},w.each(t,function(e,t){var a=t*c+i;m.push([a,e]),v[a]=e,f.globalStringDictionary.recountedDictionary[n.idx][n.dictionary[e]]=a,x<a&&(x=a),a<b&&(b=a),r++}),0<r?y++:S++}else S++});var t,n,i,r,o=(t=e.min,(n=e.tickSize)*Math.floor(t/n)),l=0,s=Number.NaN;r=(e.max-e.min)/3;var u=e.min+r,c=0,d=e.max-(e.max-e.min)*p;for(0<S&&(c=Math.abs(e.max-e.min)/13,c=-Math.abs(e.max-e.min)/13);i=s,(u+c<(s=o+l*e.tickSize)&&0<S||0==y)&&s<d&&a.push(s),++l,s<e.max&&s!=i;);return a.push(e.max),1==e.n&&0<m.length&&w.each(m,function(e,t){a.push(t[0])}),a},t.tickFormatter=function(e,t){return void 0!==v[e]?v[e]:e==t.max?null!=t.options.axisUnits?t.options.axisUnits:"":(Math.round(1e3*e)/1e3).toString()}}})}function i(e,t){if(isNaN(e)){var a=t.tickDecimals?Math.pow(10,t.tickDecimals):1,n=""+Math.round(value*a)/a;if(null!=t.tickDecimals){var i=n.indexOf("."),r=-1==i?0:n.length-i-1;if(r<t.tickDecimals)return Math.round((r?n:n+".")+(""+a).substr(1,t.tickDecimals-r))}return Math.round(n)}return e}w.plot.plugins.push({init:function(e){e.hooks.processOptions.push(function(e,t){t.series.lines.show&&!t.series.carpet.show&&((n=e).hooks.processDatapoints.push(a),n.getOptions().tickFormatter=i)})},options:{},name:"yAxisDigitalDictionary",version:"0.1"})}(jQuery),function(e){var s=null;e.plot.plugins.push({init:function(a){var l={};function n(e){if(!l.locked){if(-1==l.x)l.x=-1;else{var t=a.offset();l.x=Math.max(0,Math.min(e.pageX-t.left,a.width())),l.y=Math.max(0,Math.min(e.pageY-t.top,a.height())),a.triggerRedrawOverlay()}a.triggerRedrawOverlay()}}function i(e){if(!l.locked)if(a.getSelection&&a.getSelection())l.x=-1;else{var t=a.offset();l.x=Math.max(0,Math.min(e.pageX-t.left,a.width())),l.y=Math.max(0,Math.min(e.pageY-t.top,a.height())),a.triggerRedrawOverlay()}}l=null==s?{x:-1,y:-1,locked:!1}:s,a.setCrosshair=function(e){if(e){var t=a.p2c(e);l.x=Math.max(0,Math.min(t.left,a.width())),l.y=Math.max(0,Math.min(t.top,a.height()))}else l.x=-1;a.triggerRedrawOverlay()},a.clearCrosshair=a.setCrosshair,a.lockCrosshair=function(e){e&&a.setCrosshair(e),l.locked=!0},a.unlockCrosshair=function(){l.locked=!1},a.hooks.bindEvents.push(function(e,t){e.getOptions().crosshair.mode&&(t.mouseout(n),t.mousemove(i))}),a.hooks.drawOverlay.push(function(e,t){var a=e.getOptions().crosshair;if(a.mode){var n=e.getPlotOffset();if(t.save(),t.translate(n.left,n.top),-1!=(s=l).x){var i=e.getOptions().crosshair.lineWidth%2==0?0:.5;if(t.strokeStyle=a.color,t.lineWidth=a.lineWidth,t.lineJoin="round",t.beginPath(),-1!=a.mode.indexOf("x")){var r=Math.round(l.x)+i;t.moveTo(r,0),t.lineTo(r,e.height())}if(-1!=a.mode.indexOf("y")){var o=Math.round(l.y)+i;t.moveTo(0,o),t.lineTo(e.width(),o)}t.stroke()}t.restore()}}),a.hooks.shutdown.push(function(e,t){t.unbind("mouseout",n),t.unbind("mousemove",i)})},options:{crosshair:{mode:null,color:"rgba(170, 0, 0, 0.80)",lineWidth:1}},name:"crosshair",version:"1.0"})}(jQuery),esgAngularDependencies.push("Evaluators.Base"),angular.module("Evaluators.Base",[]).factory("WebpanelEvaluator",["$log","$injector","ESGXmlHelper","EsgConfirmAction","ESGPromise","RcWareVisionAPI",function(o,l,s,e,t,u){var a=function(e){this.varRef=s.getAttributeNS(e.node,"","varRef"),this.targetPropertyName=s.getAttributeNS(e.node,"","targetPropertyName"),this.roundingMode=s.getAttributeNS(e.node,"","roundingMode");var t=s.getXPathResult(e.node,"hmi:transform/hmi:*",e.nsResolver,e.xmlDoc);if((this.gadgetTransformation=null)!=t&&null!=t[0]){var a=t[0];try{var n=l.get(a.tagName)}catch(e){o.log("missing evaluator: "+a.tagName)}if(null!=n){var i=new n({node:a,nsResolver:u.nsResolver,xmlDoc:e.xmlDoc},l);this.gadgetTransformation=i}}var r=s.getXPathResult(e.node,"hmi:mappings/hmi:valueStateMapping",e.nsResolver,e.xmlDoc);this.valueStateMappings={},0<r.length&&angular.forEach(r,function(e){var t={value:s.getAttributeNS(e,"","value"),state:s.getAttributeNS(e,"","state")};this.valueStateMappings[t.value]=t},this)};return a.prototype.getState=function(e){return null!=this.valueStateMappings[e]?this.valueStateMappings[e].state:e},a}]),esgAngularDependencies.push("Evaluators.boolStateEvaluator"),angular.module("Evaluators.boolStateEvaluator",[]).factory("boolStateEvaluator",["$log","ESGXmlHelper","WebpanelEvaluator","WebpanelGadget","WebpanelData",function(e,t,a,n,i){var r=function(e){a.call(this,e),this.defaultState="true"==t.getAttributeNS(e.node,"","defaultState"),i.registerGadgetDp(this.varRef)};return angular.extend(r.prototype,a.prototype),r}]),esgAngularDependencies.push("Evaluators.intValueEvaluator"),angular.module("Evaluators.intValueEvaluator",[]).factory("intValueEvaluator",["$log","ESGXmlHelper","WebpanelEvaluator","WebpanelGadget","WebpanelData",function(e,t,a,n,i){var r=function(e){a.call(this,e),this.defaultState=t.getAttributeNS(e.node,"","defaultState"),i.registerGadgetDp(this.varRef)};return angular.extend(r.prototype,a.prototype),r}]),esgAngularDependencies.push("Evaluators.intStateEvaluator"),angular.module("Evaluators.intStateEvaluator",[]).factory("intStateEvaluator",["$log","ESGXmlHelper","WebpanelEvaluator","WebpanelGadget","WebpanelData",function(e,t,a,n,i){var r=function(e){a.call(this,e),this.defaultState=t.getAttributeNS(e.node,"","defaultState"),i.registerGadgetDp(this.varRef)};return angular.extend(r.prototype,a.prototype),r}]),esgAngularDependencies.push("Evaluators.textValueEvaluator"),angular.module("Evaluators.textValueEvaluator",[]).factory("textValueEvaluator",["$log","ESGXmlHelper","WebpanelEvaluator","WebpanelGadget","WebpanelData",function(e,t,a,n,i){var r=function(e){a.call(this,e),this.format=t.getAttributeNS(e.node,"","stringFormat"),i.registerGadgetDp(this.varRef)};return angular.extend(r.prototype,a.prototype),r}]),esgAngularDependencies.push("Evaluators.boolValueEvaluator"),angular.module("Evaluators.boolValueEvaluator",[]).factory("boolValueEvaluator",["$log","ESGXmlHelper","WebpanelEvaluator","WebpanelGadget","WebpanelData",function(e,t,a,n,i){var r=function(e){a.call(this,e),this.defaultState=t.getAttributeNS(e.node,"","defaultState"),i.registerGadgetDp(this.varRef)};return angular.extend(r.prototype,a.prototype),r}]),esgAngularDependencies.push("Evaluators.intMaskStateEvaluator"),angular.module("Evaluators.intMaskStateEvaluator",[]).factory("intMaskStateEvaluator",["$log","ESGXmlHelper","WebpanelEvaluator","WebpanelGadget","WebpanelData",function(e,a,n,t,i){var r=function(e){n.call(this,e),this.defaultState=a.getAttributeNS(e.node,"","defaultState");var t=a.getXPathResult(e.node,"hmi:mappings/hmi:maskStateMapping",e.nsResolver,e.xmlDoc);this.maskStateMappings=[],0<t.length&&angular.forEach(t,function(e){var t={and:a.getAttributeNS(e,"","andMask"),nop:a.getAttributeNS(e,"","nopMask"),state:a.getAttributeNS(e,"","state")};this.maskStateMappings.push(t)},this),i.registerGadgetDp(this.varRef)};angular.extend(r.prototype,n.prototype);return r.prototype.getState=function(e){for(var t,a,n,i,r,o,l=null,s=0;s<this.maskStateMappings.length;s++){var u=this.maskStateMappings[s];if(t=e,a=u.and,n=u.nop,r=i=void 0,i=bigInt(t.toString()),r=bigInt(a),o=bigInt(n),0==i.or(o).compare(r.or(o))){l=u.state;break}}return l},r}]),esgAngularDependencies.push("Actions.linearTransform"),angular.module("Actions.linearTransform",[]).factory("linearTransform",["$log","ESGXmlHelper","RcWareVisionAPI","WebpanelData","WebpanelVariable",function(e,t,a,n,i){var r=function(e){this.min=parseFloat(t.getAttributeNS(e.node,"","min")),this.max=parseFloat(t.getAttributeNS(e.node,"","max")),this.k=parseFloat(t.getAttributeNS(e.node,"","k")),this.q=parseFloat(t.getAttributeNS(e.node,"","q"))};return r.prototype.transform=function(e){var t=this.k*e+this.q;return t<this.min?this.min:t>this.max?this.max:t},r}]);
//# sourceMappingURL=RcWareVisionUserJs.min.js.map